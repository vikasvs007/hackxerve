function qge(e,t){for(var a=0;a<t.length;a++){const o=t[a];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in e)){const d=Object.getOwnPropertyDescriptor(o,l);d&&Object.defineProperty(e,l,d.get?d:{enumerable:!0,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(l){if(l.ep)return;l.ep=!0;const d=a(l);fetch(l.href,d)}})();var Al=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Pq={exports:{}},GT={},xq={exports:{}},rn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ov=Symbol.for("react.element"),Yge=Symbol.for("react.portal"),Xge=Symbol.for("react.fragment"),Jge=Symbol.for("react.strict_mode"),Qge=Symbol.for("react.profiler"),Zge=Symbol.for("react.provider"),eye=Symbol.for("react.context"),tye=Symbol.for("react.forward_ref"),nye=Symbol.for("react.suspense"),rye=Symbol.for("react.memo"),iye=Symbol.for("react.lazy"),qW=Symbol.iterator;function aye(e){return e===null||typeof e!="object"?null:(e=qW&&e[qW]||e["@@iterator"],typeof e=="function"?e:null)}var Dq={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lq=Object.assign,kq={};function dp(e,t,a){this.props=e,this.context=t,this.refs=kq,this.updater=a||Dq}dp.prototype.isReactComponent={};dp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};dp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Mq(){}Mq.prototype=dp.prototype;function kx(e,t,a){this.props=e,this.context=t,this.refs=kq,this.updater=a||Dq}var Mx=kx.prototype=new Mq;Mx.constructor=kx;Lq(Mx,dp.prototype);Mx.isPureReactComponent=!0;var YW=Array.isArray,Uq=Object.prototype.hasOwnProperty,Ux={current:null},jq={key:!0,ref:!0,__self:!0,__source:!0};function Vq(e,t,a){var o,l={},d=null,p=null;if(t!=null)for(o in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(d=""+t.key),t)Uq.call(t,o)&&!jq.hasOwnProperty(o)&&(l[o]=t[o]);var g=arguments.length-2;if(g===1)l.children=a;else if(1<g){for(var v=Array(g),E=0;E<g;E++)v[E]=arguments[E+2];l.children=v}if(e&&e.defaultProps)for(o in g=e.defaultProps,g)l[o]===void 0&&(l[o]=g[o]);return{$$typeof:ov,type:e,key:d,ref:p,props:l,_owner:Ux.current}}function oye(e,t){return{$$typeof:ov,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jx(e){return typeof e=="object"&&e!==null&&e.$$typeof===ov}function sye(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return t[a]})}var XW=/\/+/g;function XA(e,t){return typeof e=="object"&&e!==null&&e.key!=null?sye(""+e.key):t.toString(36)}function JS(e,t,a,o,l){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(d){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case ov:case Yge:p=!0}}if(p)return p=e,l=l(p),e=o===""?"."+XA(p,0):o,YW(l)?(a="",e!=null&&(a=e.replace(XW,"$&/")+"/"),JS(l,t,a,"",function(E){return E})):l!=null&&(jx(l)&&(l=oye(l,a+(!l.key||p&&p.key===l.key?"":(""+l.key).replace(XW,"$&/")+"/")+e)),t.push(l)),1;if(p=0,o=o===""?".":o+":",YW(e))for(var g=0;g<e.length;g++){d=e[g];var v=o+XA(d,g);p+=JS(d,t,a,v,l)}else if(v=aye(e),typeof v=="function")for(e=v.call(e),g=0;!(d=e.next()).done;)d=d.value,v=o+XA(d,g++),p+=JS(d,t,a,v,l);else if(d==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function gS(e,t,a){if(e==null)return e;var o=[],l=0;return JS(e,o,"","",function(d){return t.call(a,d,l++)}),o}function cye(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qi={current:null},QS={transition:null},lye={ReactCurrentDispatcher:Qi,ReactCurrentBatchConfig:QS,ReactCurrentOwner:Ux};function Bq(){throw Error("act(...) is not supported in production builds of React.")}rn.Children={map:gS,forEach:function(e,t,a){gS(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return gS(e,function(){t++}),t},toArray:function(e){return gS(e,function(t){return t})||[]},only:function(e){if(!jx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rn.Component=dp;rn.Fragment=Xge;rn.Profiler=Qge;rn.PureComponent=kx;rn.StrictMode=Jge;rn.Suspense=nye;rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lye;rn.act=Bq;rn.cloneElement=function(e,t,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=Lq({},e.props),l=e.key,d=e.ref,p=e._owner;if(t!=null){if(t.ref!==void 0&&(d=t.ref,p=Ux.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(v in t)Uq.call(t,v)&&!jq.hasOwnProperty(v)&&(o[v]=t[v]===void 0&&g!==void 0?g[v]:t[v])}var v=arguments.length-2;if(v===1)o.children=a;else if(1<v){g=Array(v);for(var E=0;E<v;E++)g[E]=arguments[E+2];o.children=g}return{$$typeof:ov,type:e.type,key:l,ref:d,props:o,_owner:p}};rn.createContext=function(e){return e={$$typeof:eye,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zge,_context:e},e.Consumer=e};rn.createElement=Vq;rn.createFactory=function(e){var t=Vq.bind(null,e);return t.type=e,t};rn.createRef=function(){return{current:null}};rn.forwardRef=function(e){return{$$typeof:tye,render:e}};rn.isValidElement=jx;rn.lazy=function(e){return{$$typeof:iye,_payload:{_status:-1,_result:e},_init:cye}};rn.memo=function(e,t){return{$$typeof:rye,type:e,compare:t===void 0?null:t}};rn.startTransition=function(e){var t=QS.transition;QS.transition={};try{e()}finally{QS.transition=t}};rn.unstable_act=Bq;rn.useCallback=function(e,t){return Qi.current.useCallback(e,t)};rn.useContext=function(e){return Qi.current.useContext(e)};rn.useDebugValue=function(){};rn.useDeferredValue=function(e){return Qi.current.useDeferredValue(e)};rn.useEffect=function(e,t){return Qi.current.useEffect(e,t)};rn.useId=function(){return Qi.current.useId()};rn.useImperativeHandle=function(e,t,a){return Qi.current.useImperativeHandle(e,t,a)};rn.useInsertionEffect=function(e,t){return Qi.current.useInsertionEffect(e,t)};rn.useLayoutEffect=function(e,t){return Qi.current.useLayoutEffect(e,t)};rn.useMemo=function(e,t){return Qi.current.useMemo(e,t)};rn.useReducer=function(e,t,a){return Qi.current.useReducer(e,t,a)};rn.useRef=function(e){return Qi.current.useRef(e)};rn.useState=function(e){return Qi.current.useState(e)};rn.useSyncExternalStore=function(e,t,a){return Qi.current.useSyncExternalStore(e,t,a)};rn.useTransition=function(){return Qi.current.useTransition()};rn.version="18.3.1";xq.exports=rn;var x=xq.exports;const ye=Kn(x),uye=qge({__proto__:null,default:ye},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dye=x,hye=Symbol.for("react.element"),fye=Symbol.for("react.fragment"),pye=Object.prototype.hasOwnProperty,mye=dye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gye={key:!0,ref:!0,__self:!0,__source:!0};function Fq(e,t,a){var o,l={},d=null,p=null;a!==void 0&&(d=""+a),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(p=t.ref);for(o in t)pye.call(t,o)&&!gye.hasOwnProperty(o)&&(l[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)l[o]===void 0&&(l[o]=t[o]);return{$$typeof:hye,type:e,key:d,ref:p,props:l,_owner:mye.current}}GT.Fragment=fye;GT.jsx=Fq;GT.jsxs=Fq;Pq.exports=GT;var C=Pq.exports,cN={},Wq={exports:{}},Wa={},Gq={exports:{}},$q={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ue,ve){var Ce=ue.length;ue.push(ve);e:for(;0<Ce;){var Ve=Ce-1>>>1,Pe=ue[Ve];if(0<l(Pe,ve))ue[Ve]=ve,ue[Ce]=Pe,Ce=Ve;else break e}}function a(ue){return ue.length===0?null:ue[0]}function o(ue){if(ue.length===0)return null;var ve=ue[0],Ce=ue.pop();if(Ce!==ve){ue[0]=Ce;e:for(var Ve=0,Pe=ue.length,Ge=Pe>>>1;Ve<Ge;){var nt=2*(Ve+1)-1,Re=ue[nt],wt=nt+1,It=ue[wt];if(0>l(Re,Ce))wt<Pe&&0>l(It,Re)?(ue[Ve]=It,ue[wt]=Ce,Ve=wt):(ue[Ve]=Re,ue[nt]=Ce,Ve=nt);else if(wt<Pe&&0>l(It,Ce))ue[Ve]=It,ue[wt]=Ce,Ve=wt;else break e}}return ve}function l(ue,ve){var Ce=ue.sortIndex-ve.sortIndex;return Ce!==0?Ce:ue.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var p=Date,g=p.now();e.unstable_now=function(){return p.now()-g}}var v=[],E=[],T=1,b=null,R=3,N=!1,P=!1,L=!1,M=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(ue){for(var ve=a(E);ve!==null;){if(ve.callback===null)o(E);else if(ve.startTime<=ue)o(E),ve.sortIndex=ve.expirationTime,t(v,ve);else break;ve=a(E)}}function z(ue){if(L=!1,B(ue),!P)if(a(v)!==null)P=!0,me(V);else{var ve=a(E);ve!==null&&_e(z,ve.startTime-ue)}}function V(ue,ve){P=!1,L&&(L=!1,D(ne),ne=-1),N=!0;var Ce=R;try{for(B(ve),b=a(v);b!==null&&(!(b.expirationTime>ve)||ue&&!ee());){var Ve=b.callback;if(typeof Ve=="function"){b.callback=null,R=b.priorityLevel;var Pe=Ve(b.expirationTime<=ve);ve=e.unstable_now(),typeof Pe=="function"?b.callback=Pe:b===a(v)&&o(v),B(ve)}else o(v);b=a(v)}if(b!==null)var Ge=!0;else{var nt=a(E);nt!==null&&_e(z,nt.startTime-ve),Ge=!1}return Ge}finally{b=null,R=Ce,N=!1}}var G=!1,q=null,ne=-1,Z=5,le=-1;function ee(){return!(e.unstable_now()-le<Z)}function ce(){if(q!==null){var ue=e.unstable_now();le=ue;var ve=!0;try{ve=q(!0,ue)}finally{ve?be():(G=!1,q=null)}}else G=!1}var be;if(typeof U=="function")be=function(){U(ce)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,fe=ae.port2;ae.port1.onmessage=ce,be=function(){fe.postMessage(null)}}else be=function(){M(ce,0)};function me(ue){q=ue,G||(G=!0,be())}function _e(ue,ve){ne=M(function(){ue(e.unstable_now())},ve)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_continueExecution=function(){P||N||(P=!0,me(V))},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return a(v)},e.unstable_next=function(ue){switch(R){case 1:case 2:case 3:var ve=3;break;default:ve=R}var Ce=R;R=ve;try{return ue()}finally{R=Ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ue,ve){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var Ce=R;R=ue;try{return ve()}finally{R=Ce}},e.unstable_scheduleCallback=function(ue,ve,Ce){var Ve=e.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Ve+Ce:Ve):Ce=Ve,ue){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=Ce+Pe,ue={id:T++,callback:ve,priorityLevel:ue,startTime:Ce,expirationTime:Pe,sortIndex:-1},Ce>Ve?(ue.sortIndex=Ce,t(E,ue),a(v)===null&&ue===a(E)&&(L?(D(ne),ne=-1):L=!0,_e(z,Ce-Ve))):(ue.sortIndex=Pe,t(v,ue),P||N||(P=!0,me(V))),ue},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(ue){var ve=R;return function(){var Ce=R;R=ve;try{return ue.apply(this,arguments)}finally{R=Ce}}}})($q);Gq.exports=$q;var yye=Gq.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vye=x,Fa=yye;function qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hq=new Set,ry={};function Ad(e,t){Uf(e,t),Uf(e+"Capture",t)}function Uf(e,t){for(ry[e]=t,e=0;e<t.length;e++)Hq.add(t[e])}var wc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lN=Object.prototype.hasOwnProperty,_ye=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,JW={},QW={};function Eye(e){return lN.call(QW,e)?!0:lN.call(JW,e)?!1:_ye.test(e)?QW[e]=!0:(JW[e]=!0,!1)}function Sye(e,t,a,o){if(a!==null&&a.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function bye(e,t,a,o){if(t===null||typeof t>"u"||Sye(e,t,a,o))return!0;if(o)return!1;if(a!==null)switch(a.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zi(e,t,a,o,l,d,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=d,this.removeEmptyString=p}var Ci={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ci[e]=new Zi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ci[t]=new Zi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ci[e]=new Zi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ci[e]=new Zi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ci[e]=new Zi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ci[e]=new Zi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ci[e]=new Zi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ci[e]=new Zi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ci[e]=new Zi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Vx=/[\-:]([a-z])/g;function Bx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Vx,Bx);Ci[t]=new Zi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Vx,Bx);Ci[t]=new Zi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Vx,Bx);Ci[t]=new Zi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ci[e]=new Zi(e,1,!1,e.toLowerCase(),null,!1,!1)});Ci.xlinkHref=new Zi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ci[e]=new Zi(e,1,!1,e.toLowerCase(),null,!0,!0)});function Fx(e,t,a,o){var l=Ci.hasOwnProperty(t)?Ci[t]:null;(l!==null?l.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(bye(t,a,l,o)&&(a=null),o||l===null?Eye(t)&&(a===null?e.removeAttribute(t):e.setAttribute(t,""+a)):l.mustUseProperty?e[l.propertyName]=a===null?l.type===3?!1:"":a:(t=l.attributeName,o=l.attributeNamespace,a===null?e.removeAttribute(t):(l=l.type,a=l===3||l===4&&a===!0?"":""+a,o?e.setAttributeNS(o,t,a):e.setAttribute(t,a))))}var Pc=vye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yS=Symbol.for("react.element"),lf=Symbol.for("react.portal"),uf=Symbol.for("react.fragment"),Wx=Symbol.for("react.strict_mode"),uN=Symbol.for("react.profiler"),zq=Symbol.for("react.provider"),Kq=Symbol.for("react.context"),Gx=Symbol.for("react.forward_ref"),dN=Symbol.for("react.suspense"),hN=Symbol.for("react.suspense_list"),$x=Symbol.for("react.memo"),Sl=Symbol.for("react.lazy"),qq=Symbol.for("react.offscreen"),ZW=Symbol.iterator;function lg(e){return e===null||typeof e!="object"?null:(e=ZW&&e[ZW]||e["@@iterator"],typeof e=="function"?e:null)}var wr=Object.assign,JA;function Lg(e){if(JA===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);JA=t&&t[1]||""}return`
`+JA+e}var QA=!1;function ZA(e,t){if(!e||QA)return"";QA=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(E){var o=E}Reflect.construct(e,[],t)}else{try{t.call()}catch(E){o=E}e.call(t.prototype)}else{try{throw Error()}catch(E){o=E}e()}}catch(E){if(E&&o&&typeof E.stack=="string"){for(var l=E.stack.split(`
`),d=o.stack.split(`
`),p=l.length-1,g=d.length-1;1<=p&&0<=g&&l[p]!==d[g];)g--;for(;1<=p&&0<=g;p--,g--)if(l[p]!==d[g]){if(p!==1||g!==1)do if(p--,g--,0>g||l[p]!==d[g]){var v=`
`+l[p].replace(" at new "," at ");return e.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",e.displayName)),v}while(1<=p&&0<=g);break}}}finally{QA=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Lg(e):""}function Tye(e){switch(e.tag){case 5:return Lg(e.type);case 16:return Lg("Lazy");case 13:return Lg("Suspense");case 19:return Lg("SuspenseList");case 0:case 2:case 15:return e=ZA(e.type,!1),e;case 11:return e=ZA(e.type.render,!1),e;case 1:return e=ZA(e.type,!0),e;default:return""}}function fN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case uf:return"Fragment";case lf:return"Portal";case uN:return"Profiler";case Wx:return"StrictMode";case dN:return"Suspense";case hN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Kq:return(e.displayName||"Context")+".Consumer";case zq:return(e._context.displayName||"Context")+".Provider";case Gx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $x:return t=e.displayName||null,t!==null?t:fN(e.type)||"Memo";case Sl:t=e._payload,e=e._init;try{return fN(e(t))}catch{}}return null}function wye(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fN(t);case 8:return t===Wx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Hl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Yq(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Cye(e){var t=Yq(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var l=a.get,d=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(p){o=""+p,d.call(this,p)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(p){o=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vS(e){e._valueTracker||(e._valueTracker=Cye(e))}function Xq(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),o="";return e&&(o=Yq(e)?e.checked?"true":"false":e.value),e=o,e!==a?(t.setValue(e),!0):!1}function lb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pN(e,t){var a=t.checked;return wr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function eG(e,t){var a=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;a=Hl(t.value!=null?t.value:a),e._wrapperState={initialChecked:o,initialValue:a,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Jq(e,t){t=t.checked,t!=null&&Fx(e,"checked",t,!1)}function mN(e,t){Jq(e,t);var a=Hl(t.value),o=t.type;if(a!=null)o==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?gN(e,t.type,a):t.hasOwnProperty("defaultValue")&&gN(e,t.type,Hl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function tG(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function gN(e,t,a){(t!=="number"||lb(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var kg=Array.isArray;function Cf(e,t,a,o){if(e=e.options,t){t={};for(var l=0;l<a.length;l++)t["$"+a[l]]=!0;for(a=0;a<e.length;a++)l=t.hasOwnProperty("$"+e[a].value),e[a].selected!==l&&(e[a].selected=l),l&&o&&(e[a].defaultSelected=!0)}else{for(a=""+Hl(a),t=null,l=0;l<e.length;l++){if(e[l].value===a){e[l].selected=!0,o&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function yN(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qe(91));return wr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nG(e,t){var a=t.value;if(a==null){if(a=t.children,t=t.defaultValue,a!=null){if(t!=null)throw Error(qe(92));if(kg(a)){if(1<a.length)throw Error(qe(93));a=a[0]}t=a}t==null&&(t=""),a=t}e._wrapperState={initialValue:Hl(a)}}function Qq(e,t){var a=Hl(t.value),o=Hl(t.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),t.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),o!=null&&(e.defaultValue=""+o)}function rG(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zq(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vN(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zq(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _S,e7=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,a,o,l){MSApp.execUnsafeLocalFunction(function(){return e(t,a,o,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_S=_S||document.createElement("div"),_S.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_S.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function iy(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var Fg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rye=["Webkit","ms","Moz","O"];Object.keys(Fg).forEach(function(e){Rye.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fg[t]=Fg[e]})});function t7(e,t,a){return t==null||typeof t=="boolean"||t===""?"":a||typeof t!="number"||t===0||Fg.hasOwnProperty(e)&&Fg[e]?(""+t).trim():t+"px"}function n7(e,t){e=e.style;for(var a in t)if(t.hasOwnProperty(a)){var o=a.indexOf("--")===0,l=t7(a,t[a],o);a==="float"&&(a="cssFloat"),o?e.setProperty(a,l):e[a]=l}}var Oye=wr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _N(e,t){if(t){if(Oye[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qe(62))}}function EN(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var SN=null;function Hx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var bN=null,Rf=null,Of=null;function iG(e){if(e=lv(e)){if(typeof bN!="function")throw Error(qe(280));var t=e.stateNode;t&&(t=qT(t),bN(e.stateNode,e.type,t))}}function r7(e){Rf?Of?Of.push(e):Of=[e]:Rf=e}function i7(){if(Rf){var e=Rf,t=Of;if(Of=Rf=null,iG(e),t)for(e=0;e<t.length;e++)iG(t[e])}}function a7(e,t){return e(t)}function o7(){}var eI=!1;function s7(e,t,a){if(eI)return e(t,a);eI=!0;try{return a7(e,t,a)}finally{eI=!1,(Rf!==null||Of!==null)&&(o7(),i7())}}function ay(e,t){var a=e.stateNode;if(a===null)return null;var o=qT(a);if(o===null)return null;a=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(qe(231,t,typeof a));return a}var TN=!1;if(wc)try{var ug={};Object.defineProperty(ug,"passive",{get:function(){TN=!0}}),window.addEventListener("test",ug,ug),window.removeEventListener("test",ug,ug)}catch{TN=!1}function Aye(e,t,a,o,l,d,p,g,v){var E=Array.prototype.slice.call(arguments,3);try{t.apply(a,E)}catch(T){this.onError(T)}}var Wg=!1,ub=null,db=!1,wN=null,Iye={onError:function(e){Wg=!0,ub=e}};function Nye(e,t,a,o,l,d,p,g,v){Wg=!1,ub=null,Aye.apply(Iye,arguments)}function Pye(e,t,a,o,l,d,p,g,v){if(Nye.apply(this,arguments),Wg){if(Wg){var E=ub;Wg=!1,ub=null}else throw Error(qe(198));db||(db=!0,wN=E)}}function Id(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function c7(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function aG(e){if(Id(e)!==e)throw Error(qe(188))}function xye(e){var t=e.alternate;if(!t){if(t=Id(e),t===null)throw Error(qe(188));return t!==e?null:e}for(var a=e,o=t;;){var l=a.return;if(l===null)break;var d=l.alternate;if(d===null){if(o=l.return,o!==null){a=o;continue}break}if(l.child===d.child){for(d=l.child;d;){if(d===a)return aG(l),e;if(d===o)return aG(l),t;d=d.sibling}throw Error(qe(188))}if(a.return!==o.return)a=l,o=d;else{for(var p=!1,g=l.child;g;){if(g===a){p=!0,a=l,o=d;break}if(g===o){p=!0,o=l,a=d;break}g=g.sibling}if(!p){for(g=d.child;g;){if(g===a){p=!0,a=d,o=l;break}if(g===o){p=!0,o=d,a=l;break}g=g.sibling}if(!p)throw Error(qe(189))}}if(a.alternate!==o)throw Error(qe(190))}if(a.tag!==3)throw Error(qe(188));return a.stateNode.current===a?e:t}function l7(e){return e=xye(e),e!==null?u7(e):null}function u7(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=u7(e);if(t!==null)return t;e=e.sibling}return null}var d7=Fa.unstable_scheduleCallback,oG=Fa.unstable_cancelCallback,Dye=Fa.unstable_shouldYield,Lye=Fa.unstable_requestPaint,Ur=Fa.unstable_now,kye=Fa.unstable_getCurrentPriorityLevel,zx=Fa.unstable_ImmediatePriority,h7=Fa.unstable_UserBlockingPriority,hb=Fa.unstable_NormalPriority,Mye=Fa.unstable_LowPriority,f7=Fa.unstable_IdlePriority,$T=null,Ms=null;function Uye(e){if(Ms&&typeof Ms.onCommitFiberRoot=="function")try{Ms.onCommitFiberRoot($T,e,void 0,(e.current.flags&128)===128)}catch{}}var ts=Math.clz32?Math.clz32:Bye,jye=Math.log,Vye=Math.LN2;function Bye(e){return e>>>=0,e===0?32:31-(jye(e)/Vye|0)|0}var ES=64,SS=4194304;function Mg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function fb(e,t){var a=e.pendingLanes;if(a===0)return 0;var o=0,l=e.suspendedLanes,d=e.pingedLanes,p=a&268435455;if(p!==0){var g=p&~l;g!==0?o=Mg(g):(d&=p,d!==0&&(o=Mg(d)))}else p=a&~l,p!==0?o=Mg(p):d!==0&&(o=Mg(d));if(o===0)return 0;if(t!==0&&t!==o&&!(t&l)&&(l=o&-o,d=t&-t,l>=d||l===16&&(d&4194240)!==0))return t;if(o&4&&(o|=a&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)a=31-ts(t),l=1<<a,o|=e[a],t&=~l;return o}function Fye(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wye(e,t){for(var a=e.suspendedLanes,o=e.pingedLanes,l=e.expirationTimes,d=e.pendingLanes;0<d;){var p=31-ts(d),g=1<<p,v=l[p];v===-1?(!(g&a)||g&o)&&(l[p]=Fye(g,t)):v<=t&&(e.expiredLanes|=g),d&=~g}}function CN(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function p7(){var e=ES;return ES<<=1,!(ES&4194240)&&(ES=64),e}function tI(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function sv(e,t,a){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ts(t),e[t]=a}function Gye(e,t){var a=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<a;){var l=31-ts(a),d=1<<l;t[l]=0,o[l]=-1,e[l]=-1,a&=~d}}function Kx(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var o=31-ts(a),l=1<<o;l&t|e[o]&t&&(e[o]|=t),a&=~l}}var jn=0;function m7(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var g7,qx,y7,v7,_7,RN=!1,bS=[],Dl=null,Ll=null,kl=null,oy=new Map,sy=new Map,Cl=[],$ye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sG(e,t){switch(e){case"focusin":case"focusout":Dl=null;break;case"dragenter":case"dragleave":Ll=null;break;case"mouseover":case"mouseout":kl=null;break;case"pointerover":case"pointerout":oy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":sy.delete(t.pointerId)}}function dg(e,t,a,o,l,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:a,eventSystemFlags:o,nativeEvent:d,targetContainers:[l]},t!==null&&(t=lv(t),t!==null&&qx(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Hye(e,t,a,o,l){switch(t){case"focusin":return Dl=dg(Dl,e,t,a,o,l),!0;case"dragenter":return Ll=dg(Ll,e,t,a,o,l),!0;case"mouseover":return kl=dg(kl,e,t,a,o,l),!0;case"pointerover":var d=l.pointerId;return oy.set(d,dg(oy.get(d)||null,e,t,a,o,l)),!0;case"gotpointercapture":return d=l.pointerId,sy.set(d,dg(sy.get(d)||null,e,t,a,o,l)),!0}return!1}function E7(e){var t=ad(e.target);if(t!==null){var a=Id(t);if(a!==null){if(t=a.tag,t===13){if(t=c7(a),t!==null){e.blockedOn=t,_7(e.priority,function(){y7(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ZS(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=ON(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);SN=o,a.target.dispatchEvent(o),SN=null}else return t=lv(a),t!==null&&qx(t),e.blockedOn=a,!1;t.shift()}return!0}function cG(e,t,a){ZS(e)&&a.delete(t)}function zye(){RN=!1,Dl!==null&&ZS(Dl)&&(Dl=null),Ll!==null&&ZS(Ll)&&(Ll=null),kl!==null&&ZS(kl)&&(kl=null),oy.forEach(cG),sy.forEach(cG)}function hg(e,t){e.blockedOn===t&&(e.blockedOn=null,RN||(RN=!0,Fa.unstable_scheduleCallback(Fa.unstable_NormalPriority,zye)))}function cy(e){function t(l){return hg(l,e)}if(0<bS.length){hg(bS[0],e);for(var a=1;a<bS.length;a++){var o=bS[a];o.blockedOn===e&&(o.blockedOn=null)}}for(Dl!==null&&hg(Dl,e),Ll!==null&&hg(Ll,e),kl!==null&&hg(kl,e),oy.forEach(t),sy.forEach(t),a=0;a<Cl.length;a++)o=Cl[a],o.blockedOn===e&&(o.blockedOn=null);for(;0<Cl.length&&(a=Cl[0],a.blockedOn===null);)E7(a),a.blockedOn===null&&Cl.shift()}var Af=Pc.ReactCurrentBatchConfig,pb=!0;function Kye(e,t,a,o){var l=jn,d=Af.transition;Af.transition=null;try{jn=1,Yx(e,t,a,o)}finally{jn=l,Af.transition=d}}function qye(e,t,a,o){var l=jn,d=Af.transition;Af.transition=null;try{jn=4,Yx(e,t,a,o)}finally{jn=l,Af.transition=d}}function Yx(e,t,a,o){if(pb){var l=ON(e,t,a,o);if(l===null)dI(e,t,o,mb,a),sG(e,o);else if(Hye(l,e,t,a,o))o.stopPropagation();else if(sG(e,o),t&4&&-1<$ye.indexOf(e)){for(;l!==null;){var d=lv(l);if(d!==null&&g7(d),d=ON(e,t,a,o),d===null&&dI(e,t,o,mb,a),d===l)break;l=d}l!==null&&o.stopPropagation()}else dI(e,t,o,null,a)}}var mb=null;function ON(e,t,a,o){if(mb=null,e=Hx(o),e=ad(e),e!==null)if(t=Id(e),t===null)e=null;else if(a=t.tag,a===13){if(e=c7(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return mb=e,null}function S7(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kye()){case zx:return 1;case h7:return 4;case hb:case Mye:return 16;case f7:return 536870912;default:return 16}default:return 16}}var Il=null,Xx=null,eb=null;function b7(){if(eb)return eb;var e,t=Xx,a=t.length,o,l="value"in Il?Il.value:Il.textContent,d=l.length;for(e=0;e<a&&t[e]===l[e];e++);var p=a-e;for(o=1;o<=p&&t[a-o]===l[d-o];o++);return eb=l.slice(e,1<o?1-o:void 0)}function tb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function TS(){return!0}function lG(){return!1}function Ga(e){function t(a,o,l,d,p){this._reactName=a,this._targetInst=l,this.type=o,this.nativeEvent=d,this.target=p,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(a=e[g],this[g]=a?a(d):d[g]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?TS:lG,this.isPropagationStopped=lG,this}return wr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=TS)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=TS)},persist:function(){},isPersistent:TS}),t}var hp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jx=Ga(hp),cv=wr({},hp,{view:0,detail:0}),Yye=Ga(cv),nI,rI,fg,HT=wr({},cv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fg&&(fg&&e.type==="mousemove"?(nI=e.screenX-fg.screenX,rI=e.screenY-fg.screenY):rI=nI=0,fg=e),nI)},movementY:function(e){return"movementY"in e?e.movementY:rI}}),uG=Ga(HT),Xye=wr({},HT,{dataTransfer:0}),Jye=Ga(Xye),Qye=wr({},cv,{relatedTarget:0}),iI=Ga(Qye),Zye=wr({},hp,{animationName:0,elapsedTime:0,pseudoElement:0}),eve=Ga(Zye),tve=wr({},hp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nve=Ga(tve),rve=wr({},hp,{data:0}),dG=Ga(rve),ive={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ave={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ove={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sve(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ove[e])?!!t[e]:!1}function Qx(){return sve}var cve=wr({},cv,{key:function(e){if(e.key){var t=ive[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=tb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ave[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qx,charCode:function(e){return e.type==="keypress"?tb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?tb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lve=Ga(cve),uve=wr({},HT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hG=Ga(uve),dve=wr({},cv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qx}),hve=Ga(dve),fve=wr({},hp,{propertyName:0,elapsedTime:0,pseudoElement:0}),pve=Ga(fve),mve=wr({},HT,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gve=Ga(mve),yve=[9,13,27,32],Zx=wc&&"CompositionEvent"in window,Gg=null;wc&&"documentMode"in document&&(Gg=document.documentMode);var vve=wc&&"TextEvent"in window&&!Gg,T7=wc&&(!Zx||Gg&&8<Gg&&11>=Gg),fG=" ",pG=!1;function w7(e,t){switch(e){case"keyup":return yve.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C7(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var df=!1;function _ve(e,t){switch(e){case"compositionend":return C7(t);case"keypress":return t.which!==32?null:(pG=!0,fG);case"textInput":return e=t.data,e===fG&&pG?null:e;default:return null}}function Eve(e,t){if(df)return e==="compositionend"||!Zx&&w7(e,t)?(e=b7(),eb=Xx=Il=null,df=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return T7&&t.locale!=="ko"?null:t.data;default:return null}}var Sve={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mG(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sve[e.type]:t==="textarea"}function R7(e,t,a,o){r7(o),t=gb(t,"onChange"),0<t.length&&(a=new Jx("onChange","change",null,a,o),e.push({event:a,listeners:t}))}var $g=null,ly=null;function bve(e){U7(e,0)}function zT(e){var t=pf(e);if(Xq(t))return e}function Tve(e,t){if(e==="change")return t}var O7=!1;if(wc){var aI;if(wc){var oI="oninput"in document;if(!oI){var gG=document.createElement("div");gG.setAttribute("oninput","return;"),oI=typeof gG.oninput=="function"}aI=oI}else aI=!1;O7=aI&&(!document.documentMode||9<document.documentMode)}function yG(){$g&&($g.detachEvent("onpropertychange",A7),ly=$g=null)}function A7(e){if(e.propertyName==="value"&&zT(ly)){var t=[];R7(t,ly,e,Hx(e)),s7(bve,t)}}function wve(e,t,a){e==="focusin"?(yG(),$g=t,ly=a,$g.attachEvent("onpropertychange",A7)):e==="focusout"&&yG()}function Cve(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zT(ly)}function Rve(e,t){if(e==="click")return zT(t)}function Ove(e,t){if(e==="input"||e==="change")return zT(t)}function Ave(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var is=typeof Object.is=="function"?Object.is:Ave;function uy(e,t){if(is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var l=a[o];if(!lN.call(t,l)||!is(e[l],t[l]))return!1}return!0}function vG(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _G(e,t){var a=vG(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=t&&o>=t)return{node:a,offset:t-e};e=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=vG(a)}}function I7(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?I7(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function N7(){for(var e=window,t=lb();t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=lb(e.document)}return t}function e1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ive(e){var t=N7(),a=e.focusedElem,o=e.selectionRange;if(t!==a&&a&&a.ownerDocument&&I7(a.ownerDocument.documentElement,a)){if(o!==null&&e1(a)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in a)a.selectionStart=t,a.selectionEnd=Math.min(e,a.value.length);else if(e=(t=a.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=a.textContent.length,d=Math.min(o.start,l);o=o.end===void 0?d:Math.min(o.end,l),!e.extend&&d>o&&(l=o,o=d,d=l),l=_G(a,d);var p=_G(a,o);l&&p&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),d>o?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=a;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<t.length;a++)e=t[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Nve=wc&&"documentMode"in document&&11>=document.documentMode,hf=null,AN=null,Hg=null,IN=!1;function EG(e,t,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;IN||hf==null||hf!==lb(o)||(o=hf,"selectionStart"in o&&e1(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Hg&&uy(Hg,o)||(Hg=o,o=gb(AN,"onSelect"),0<o.length&&(t=new Jx("onSelect","select",null,t,a),e.push({event:t,listeners:o}),t.target=hf)))}function wS(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var ff={animationend:wS("Animation","AnimationEnd"),animationiteration:wS("Animation","AnimationIteration"),animationstart:wS("Animation","AnimationStart"),transitionend:wS("Transition","TransitionEnd")},sI={},P7={};wc&&(P7=document.createElement("div").style,"AnimationEvent"in window||(delete ff.animationend.animation,delete ff.animationiteration.animation,delete ff.animationstart.animation),"TransitionEvent"in window||delete ff.transitionend.transition);function KT(e){if(sI[e])return sI[e];if(!ff[e])return e;var t=ff[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in P7)return sI[e]=t[a];return e}var x7=KT("animationend"),D7=KT("animationiteration"),L7=KT("animationstart"),k7=KT("transitionend"),M7=new Map,SG="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xl(e,t){M7.set(e,t),Ad(t,[e])}for(var cI=0;cI<SG.length;cI++){var lI=SG[cI],Pve=lI.toLowerCase(),xve=lI[0].toUpperCase()+lI.slice(1);Xl(Pve,"on"+xve)}Xl(x7,"onAnimationEnd");Xl(D7,"onAnimationIteration");Xl(L7,"onAnimationStart");Xl("dblclick","onDoubleClick");Xl("focusin","onFocus");Xl("focusout","onBlur");Xl(k7,"onTransitionEnd");Uf("onMouseEnter",["mouseout","mouseover"]);Uf("onMouseLeave",["mouseout","mouseover"]);Uf("onPointerEnter",["pointerout","pointerover"]);Uf("onPointerLeave",["pointerout","pointerover"]);Ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ug="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dve=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ug));function bG(e,t,a){var o=e.type||"unknown-event";e.currentTarget=a,Pye(o,t,void 0,e),e.currentTarget=null}function U7(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],l=o.event;o=o.listeners;e:{var d=void 0;if(t)for(var p=o.length-1;0<=p;p--){var g=o[p],v=g.instance,E=g.currentTarget;if(g=g.listener,v!==d&&l.isPropagationStopped())break e;bG(l,g,E),d=v}else for(p=0;p<o.length;p++){if(g=o[p],v=g.instance,E=g.currentTarget,g=g.listener,v!==d&&l.isPropagationStopped())break e;bG(l,g,E),d=v}}}if(db)throw e=wN,db=!1,wN=null,e}function sr(e,t){var a=t[LN];a===void 0&&(a=t[LN]=new Set);var o=e+"__bubble";a.has(o)||(j7(t,e,2,!1),a.add(o))}function uI(e,t,a){var o=0;t&&(o|=4),j7(a,e,o,t)}var CS="_reactListening"+Math.random().toString(36).slice(2);function dy(e){if(!e[CS]){e[CS]=!0,Hq.forEach(function(a){a!=="selectionchange"&&(Dve.has(a)||uI(a,!1,e),uI(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[CS]||(t[CS]=!0,uI("selectionchange",!1,t))}}function j7(e,t,a,o){switch(S7(t)){case 1:var l=Kye;break;case 4:l=qye;break;default:l=Yx}a=l.bind(null,t,a,e),l=void 0,!TN||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),o?l!==void 0?e.addEventListener(t,a,{capture:!0,passive:l}):e.addEventListener(t,a,!0):l!==void 0?e.addEventListener(t,a,{passive:l}):e.addEventListener(t,a,!1)}function dI(e,t,a,o,l){var d=o;if(!(t&1)&&!(t&2)&&o!==null)e:for(;;){if(o===null)return;var p=o.tag;if(p===3||p===4){var g=o.stateNode.containerInfo;if(g===l||g.nodeType===8&&g.parentNode===l)break;if(p===4)for(p=o.return;p!==null;){var v=p.tag;if((v===3||v===4)&&(v=p.stateNode.containerInfo,v===l||v.nodeType===8&&v.parentNode===l))return;p=p.return}for(;g!==null;){if(p=ad(g),p===null)return;if(v=p.tag,v===5||v===6){o=d=p;continue e}g=g.parentNode}}o=o.return}s7(function(){var E=d,T=Hx(a),b=[];e:{var R=M7.get(e);if(R!==void 0){var N=Jx,P=e;switch(e){case"keypress":if(tb(a)===0)break e;case"keydown":case"keyup":N=lve;break;case"focusin":P="focus",N=iI;break;case"focusout":P="blur",N=iI;break;case"beforeblur":case"afterblur":N=iI;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=uG;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Jye;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=hve;break;case x7:case D7:case L7:N=eve;break;case k7:N=pve;break;case"scroll":N=Yye;break;case"wheel":N=gve;break;case"copy":case"cut":case"paste":N=nve;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=hG}var L=(t&4)!==0,M=!L&&e==="scroll",D=L?R!==null?R+"Capture":null:R;L=[];for(var U=E,B;U!==null;){B=U;var z=B.stateNode;if(B.tag===5&&z!==null&&(B=z,D!==null&&(z=ay(U,D),z!=null&&L.push(hy(U,z,B)))),M)break;U=U.return}0<L.length&&(R=new N(R,P,null,a,T),b.push({event:R,listeners:L}))}}if(!(t&7)){e:{if(R=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",R&&a!==SN&&(P=a.relatedTarget||a.fromElement)&&(ad(P)||P[Cc]))break e;if((N||R)&&(R=T.window===T?T:(R=T.ownerDocument)?R.defaultView||R.parentWindow:window,N?(P=a.relatedTarget||a.toElement,N=E,P=P?ad(P):null,P!==null&&(M=Id(P),P!==M||P.tag!==5&&P.tag!==6)&&(P=null)):(N=null,P=E),N!==P)){if(L=uG,z="onMouseLeave",D="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&(L=hG,z="onPointerLeave",D="onPointerEnter",U="pointer"),M=N==null?R:pf(N),B=P==null?R:pf(P),R=new L(z,U+"leave",N,a,T),R.target=M,R.relatedTarget=B,z=null,ad(T)===E&&(L=new L(D,U+"enter",P,a,T),L.target=B,L.relatedTarget=M,z=L),M=z,N&&P)t:{for(L=N,D=P,U=0,B=L;B;B=tf(B))U++;for(B=0,z=D;z;z=tf(z))B++;for(;0<U-B;)L=tf(L),U--;for(;0<B-U;)D=tf(D),B--;for(;U--;){if(L===D||D!==null&&L===D.alternate)break t;L=tf(L),D=tf(D)}L=null}else L=null;N!==null&&TG(b,R,N,L,!1),P!==null&&M!==null&&TG(b,M,P,L,!0)}}e:{if(R=E?pf(E):window,N=R.nodeName&&R.nodeName.toLowerCase(),N==="select"||N==="input"&&R.type==="file")var V=Tve;else if(mG(R))if(O7)V=Ove;else{V=Cve;var G=wve}else(N=R.nodeName)&&N.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&(V=Rve);if(V&&(V=V(e,E))){R7(b,V,a,T);break e}G&&G(e,R,E),e==="focusout"&&(G=R._wrapperState)&&G.controlled&&R.type==="number"&&gN(R,"number",R.value)}switch(G=E?pf(E):window,e){case"focusin":(mG(G)||G.contentEditable==="true")&&(hf=G,AN=E,Hg=null);break;case"focusout":Hg=AN=hf=null;break;case"mousedown":IN=!0;break;case"contextmenu":case"mouseup":case"dragend":IN=!1,EG(b,a,T);break;case"selectionchange":if(Nve)break;case"keydown":case"keyup":EG(b,a,T)}var q;if(Zx)e:{switch(e){case"compositionstart":var ne="onCompositionStart";break e;case"compositionend":ne="onCompositionEnd";break e;case"compositionupdate":ne="onCompositionUpdate";break e}ne=void 0}else df?w7(e,a)&&(ne="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(ne="onCompositionStart");ne&&(T7&&a.locale!=="ko"&&(df||ne!=="onCompositionStart"?ne==="onCompositionEnd"&&df&&(q=b7()):(Il=T,Xx="value"in Il?Il.value:Il.textContent,df=!0)),G=gb(E,ne),0<G.length&&(ne=new dG(ne,e,null,a,T),b.push({event:ne,listeners:G}),q?ne.data=q:(q=C7(a),q!==null&&(ne.data=q)))),(q=vve?_ve(e,a):Eve(e,a))&&(E=gb(E,"onBeforeInput"),0<E.length&&(T=new dG("onBeforeInput","beforeinput",null,a,T),b.push({event:T,listeners:E}),T.data=q))}U7(b,t)})}function hy(e,t,a){return{instance:e,listener:t,currentTarget:a}}function gb(e,t){for(var a=t+"Capture",o=[];e!==null;){var l=e,d=l.stateNode;l.tag===5&&d!==null&&(l=d,d=ay(e,a),d!=null&&o.unshift(hy(e,d,l)),d=ay(e,t),d!=null&&o.push(hy(e,d,l))),e=e.return}return o}function tf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function TG(e,t,a,o,l){for(var d=t._reactName,p=[];a!==null&&a!==o;){var g=a,v=g.alternate,E=g.stateNode;if(v!==null&&v===o)break;g.tag===5&&E!==null&&(g=E,l?(v=ay(a,d),v!=null&&p.unshift(hy(a,v,g))):l||(v=ay(a,d),v!=null&&p.push(hy(a,v,g)))),a=a.return}p.length!==0&&e.push({event:t,listeners:p})}var Lve=/\r\n?/g,kve=/\u0000|\uFFFD/g;function wG(e){return(typeof e=="string"?e:""+e).replace(Lve,`
`).replace(kve,"")}function RS(e,t,a){if(t=wG(t),wG(e)!==t&&a)throw Error(qe(425))}function yb(){}var NN=null,PN=null;function xN(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var DN=typeof setTimeout=="function"?setTimeout:void 0,Mve=typeof clearTimeout=="function"?clearTimeout:void 0,CG=typeof Promise=="function"?Promise:void 0,Uve=typeof queueMicrotask=="function"?queueMicrotask:typeof CG<"u"?function(e){return CG.resolve(null).then(e).catch(jve)}:DN;function jve(e){setTimeout(function(){throw e})}function hI(e,t){var a=t,o=0;do{var l=a.nextSibling;if(e.removeChild(a),l&&l.nodeType===8)if(a=l.data,a==="/$"){if(o===0){e.removeChild(l),cy(t);return}o--}else a!=="$"&&a!=="$?"&&a!=="$!"||o++;a=l}while(a);cy(t)}function Ml(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function RG(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}var fp=Math.random().toString(36).slice(2),Ds="__reactFiber$"+fp,fy="__reactProps$"+fp,Cc="__reactContainer$"+fp,LN="__reactEvents$"+fp,Vve="__reactListeners$"+fp,Bve="__reactHandles$"+fp;function ad(e){var t=e[Ds];if(t)return t;for(var a=e.parentNode;a;){if(t=a[Cc]||a[Ds]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=RG(e);e!==null;){if(a=e[Ds])return a;e=RG(e)}return t}e=a,a=e.parentNode}return null}function lv(e){return e=e[Ds]||e[Cc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function pf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function qT(e){return e[fy]||null}var kN=[],mf=-1;function Jl(e){return{current:e}}function ur(e){0>mf||(e.current=kN[mf],kN[mf]=null,mf--)}function Zn(e,t){mf++,kN[mf]=e.current,e.current=t}var zl={},Fi=Jl(zl),va=Jl(!1),_d=zl;function jf(e,t){var a=e.type.contextTypes;if(!a)return zl;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var l={},d;for(d in a)l[d]=t[d];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function _a(e){return e=e.childContextTypes,e!=null}function vb(){ur(va),ur(Fi)}function OG(e,t,a){if(Fi.current!==zl)throw Error(qe(168));Zn(Fi,t),Zn(va,a)}function V7(e,t,a){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return a;o=o.getChildContext();for(var l in o)if(!(l in t))throw Error(qe(108,wye(e)||"Unknown",l));return wr({},a,o)}function _b(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zl,_d=Fi.current,Zn(Fi,e),Zn(va,va.current),!0}function AG(e,t,a){var o=e.stateNode;if(!o)throw Error(qe(169));a?(e=V7(e,t,_d),o.__reactInternalMemoizedMergedChildContext=e,ur(va),ur(Fi),Zn(Fi,e)):ur(va),Zn(va,a)}var pc=null,YT=!1,fI=!1;function B7(e){pc===null?pc=[e]:pc.push(e)}function Fve(e){YT=!0,B7(e)}function Ql(){if(!fI&&pc!==null){fI=!0;var e=0,t=jn;try{var a=pc;for(jn=1;e<a.length;e++){var o=a[e];do o=o(!0);while(o!==null)}pc=null,YT=!1}catch(l){throw pc!==null&&(pc=pc.slice(e+1)),d7(zx,Ql),l}finally{jn=t,fI=!1}}return null}var gf=[],yf=0,Eb=null,Sb=0,mo=[],go=0,Ed=null,mc=1,gc="";function Zu(e,t){gf[yf++]=Sb,gf[yf++]=Eb,Eb=e,Sb=t}function F7(e,t,a){mo[go++]=mc,mo[go++]=gc,mo[go++]=Ed,Ed=e;var o=mc;e=gc;var l=32-ts(o)-1;o&=~(1<<l),a+=1;var d=32-ts(t)+l;if(30<d){var p=l-l%5;d=(o&(1<<p)-1).toString(32),o>>=p,l-=p,mc=1<<32-ts(t)+l|a<<l|o,gc=d+e}else mc=1<<d|a<<l|o,gc=e}function t1(e){e.return!==null&&(Zu(e,1),F7(e,1,0))}function n1(e){for(;e===Eb;)Eb=gf[--yf],gf[yf]=null,Sb=gf[--yf],gf[yf]=null;for(;e===Ed;)Ed=mo[--go],mo[go]=null,gc=mo[--go],mo[go]=null,mc=mo[--go],mo[go]=null}var Ba=null,Va=null,pr=!1,Qo=null;function W7(e,t){var a=yo(5,null,null,0);a.elementType="DELETED",a.stateNode=t,a.return=e,t=e.deletions,t===null?(e.deletions=[a],e.flags|=16):t.push(a)}function IG(e,t){switch(e.tag){case 5:var a=e.type;return t=t.nodeType!==1||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ba=e,Va=Ml(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ba=e,Va=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(a=Ed!==null?{id:mc,overflow:gc}:null,e.memoizedState={dehydrated:t,treeContext:a,retryLane:1073741824},a=yo(18,null,null,0),a.stateNode=t,a.return=e,e.child=a,Ba=e,Va=null,!0):!1;default:return!1}}function MN(e){return(e.mode&1)!==0&&(e.flags&128)===0}function UN(e){if(pr){var t=Va;if(t){var a=t;if(!IG(e,t)){if(MN(e))throw Error(qe(418));t=Ml(a.nextSibling);var o=Ba;t&&IG(e,t)?W7(o,a):(e.flags=e.flags&-4097|2,pr=!1,Ba=e)}}else{if(MN(e))throw Error(qe(418));e.flags=e.flags&-4097|2,pr=!1,Ba=e}}}function NG(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ba=e}function OS(e){if(e!==Ba)return!1;if(!pr)return NG(e),pr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xN(e.type,e.memoizedProps)),t&&(t=Va)){if(MN(e))throw G7(),Error(qe(418));for(;t;)W7(e,t),t=Ml(t.nextSibling)}if(NG(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(t===0){Va=Ml(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++}e=e.nextSibling}Va=null}}else Va=Ba?Ml(e.stateNode.nextSibling):null;return!0}function G7(){for(var e=Va;e;)e=Ml(e.nextSibling)}function Vf(){Va=Ba=null,pr=!1}function r1(e){Qo===null?Qo=[e]:Qo.push(e)}var Wve=Pc.ReactCurrentBatchConfig;function pg(e,t,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(qe(309));var o=a.stateNode}if(!o)throw Error(qe(147,e));var l=o,d=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===d?t.ref:(t=function(p){var g=l.refs;p===null?delete g[d]:g[d]=p},t._stringRef=d,t)}if(typeof e!="string")throw Error(qe(284));if(!a._owner)throw Error(qe(290,e))}return e}function AS(e,t){throw e=Object.prototype.toString.call(t),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function PG(e){var t=e._init;return t(e._payload)}function $7(e){function t(D,U){if(e){var B=D.deletions;B===null?(D.deletions=[U],D.flags|=16):B.push(U)}}function a(D,U){if(!e)return null;for(;U!==null;)t(D,U),U=U.sibling;return null}function o(D,U){for(D=new Map;U!==null;)U.key!==null?D.set(U.key,U):D.set(U.index,U),U=U.sibling;return D}function l(D,U){return D=Bl(D,U),D.index=0,D.sibling=null,D}function d(D,U,B){return D.index=B,e?(B=D.alternate,B!==null?(B=B.index,B<U?(D.flags|=2,U):B):(D.flags|=2,U)):(D.flags|=1048576,U)}function p(D){return e&&D.alternate===null&&(D.flags|=2),D}function g(D,U,B,z){return U===null||U.tag!==6?(U=EI(B,D.mode,z),U.return=D,U):(U=l(U,B),U.return=D,U)}function v(D,U,B,z){var V=B.type;return V===uf?T(D,U,B.props.children,z,B.key):U!==null&&(U.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Sl&&PG(V)===U.type)?(z=l(U,B.props),z.ref=pg(D,U,B),z.return=D,z):(z=cb(B.type,B.key,B.props,null,D.mode,z),z.ref=pg(D,U,B),z.return=D,z)}function E(D,U,B,z){return U===null||U.tag!==4||U.stateNode.containerInfo!==B.containerInfo||U.stateNode.implementation!==B.implementation?(U=SI(B,D.mode,z),U.return=D,U):(U=l(U,B.children||[]),U.return=D,U)}function T(D,U,B,z,V){return U===null||U.tag!==7?(U=pd(B,D.mode,z,V),U.return=D,U):(U=l(U,B),U.return=D,U)}function b(D,U,B){if(typeof U=="string"&&U!==""||typeof U=="number")return U=EI(""+U,D.mode,B),U.return=D,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case yS:return B=cb(U.type,U.key,U.props,null,D.mode,B),B.ref=pg(D,null,U),B.return=D,B;case lf:return U=SI(U,D.mode,B),U.return=D,U;case Sl:var z=U._init;return b(D,z(U._payload),B)}if(kg(U)||lg(U))return U=pd(U,D.mode,B,null),U.return=D,U;AS(D,U)}return null}function R(D,U,B,z){var V=U!==null?U.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return V!==null?null:g(D,U,""+B,z);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case yS:return B.key===V?v(D,U,B,z):null;case lf:return B.key===V?E(D,U,B,z):null;case Sl:return V=B._init,R(D,U,V(B._payload),z)}if(kg(B)||lg(B))return V!==null?null:T(D,U,B,z,null);AS(D,B)}return null}function N(D,U,B,z,V){if(typeof z=="string"&&z!==""||typeof z=="number")return D=D.get(B)||null,g(U,D,""+z,V);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case yS:return D=D.get(z.key===null?B:z.key)||null,v(U,D,z,V);case lf:return D=D.get(z.key===null?B:z.key)||null,E(U,D,z,V);case Sl:var G=z._init;return N(D,U,B,G(z._payload),V)}if(kg(z)||lg(z))return D=D.get(B)||null,T(U,D,z,V,null);AS(U,z)}return null}function P(D,U,B,z){for(var V=null,G=null,q=U,ne=U=0,Z=null;q!==null&&ne<B.length;ne++){q.index>ne?(Z=q,q=null):Z=q.sibling;var le=R(D,q,B[ne],z);if(le===null){q===null&&(q=Z);break}e&&q&&le.alternate===null&&t(D,q),U=d(le,U,ne),G===null?V=le:G.sibling=le,G=le,q=Z}if(ne===B.length)return a(D,q),pr&&Zu(D,ne),V;if(q===null){for(;ne<B.length;ne++)q=b(D,B[ne],z),q!==null&&(U=d(q,U,ne),G===null?V=q:G.sibling=q,G=q);return pr&&Zu(D,ne),V}for(q=o(D,q);ne<B.length;ne++)Z=N(q,D,ne,B[ne],z),Z!==null&&(e&&Z.alternate!==null&&q.delete(Z.key===null?ne:Z.key),U=d(Z,U,ne),G===null?V=Z:G.sibling=Z,G=Z);return e&&q.forEach(function(ee){return t(D,ee)}),pr&&Zu(D,ne),V}function L(D,U,B,z){var V=lg(B);if(typeof V!="function")throw Error(qe(150));if(B=V.call(B),B==null)throw Error(qe(151));for(var G=V=null,q=U,ne=U=0,Z=null,le=B.next();q!==null&&!le.done;ne++,le=B.next()){q.index>ne?(Z=q,q=null):Z=q.sibling;var ee=R(D,q,le.value,z);if(ee===null){q===null&&(q=Z);break}e&&q&&ee.alternate===null&&t(D,q),U=d(ee,U,ne),G===null?V=ee:G.sibling=ee,G=ee,q=Z}if(le.done)return a(D,q),pr&&Zu(D,ne),V;if(q===null){for(;!le.done;ne++,le=B.next())le=b(D,le.value,z),le!==null&&(U=d(le,U,ne),G===null?V=le:G.sibling=le,G=le);return pr&&Zu(D,ne),V}for(q=o(D,q);!le.done;ne++,le=B.next())le=N(q,D,ne,le.value,z),le!==null&&(e&&le.alternate!==null&&q.delete(le.key===null?ne:le.key),U=d(le,U,ne),G===null?V=le:G.sibling=le,G=le);return e&&q.forEach(function(ce){return t(D,ce)}),pr&&Zu(D,ne),V}function M(D,U,B,z){if(typeof B=="object"&&B!==null&&B.type===uf&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case yS:e:{for(var V=B.key,G=U;G!==null;){if(G.key===V){if(V=B.type,V===uf){if(G.tag===7){a(D,G.sibling),U=l(G,B.props.children),U.return=D,D=U;break e}}else if(G.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Sl&&PG(V)===G.type){a(D,G.sibling),U=l(G,B.props),U.ref=pg(D,G,B),U.return=D,D=U;break e}a(D,G);break}else t(D,G);G=G.sibling}B.type===uf?(U=pd(B.props.children,D.mode,z,B.key),U.return=D,D=U):(z=cb(B.type,B.key,B.props,null,D.mode,z),z.ref=pg(D,U,B),z.return=D,D=z)}return p(D);case lf:e:{for(G=B.key;U!==null;){if(U.key===G)if(U.tag===4&&U.stateNode.containerInfo===B.containerInfo&&U.stateNode.implementation===B.implementation){a(D,U.sibling),U=l(U,B.children||[]),U.return=D,D=U;break e}else{a(D,U);break}else t(D,U);U=U.sibling}U=SI(B,D.mode,z),U.return=D,D=U}return p(D);case Sl:return G=B._init,M(D,U,G(B._payload),z)}if(kg(B))return P(D,U,B,z);if(lg(B))return L(D,U,B,z);AS(D,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,U!==null&&U.tag===6?(a(D,U.sibling),U=l(U,B),U.return=D,D=U):(a(D,U),U=EI(B,D.mode,z),U.return=D,D=U),p(D)):a(D,U)}return M}var Bf=$7(!0),H7=$7(!1),bb=Jl(null),Tb=null,vf=null,i1=null;function a1(){i1=vf=Tb=null}function o1(e){var t=bb.current;ur(bb),e._currentValue=t}function jN(e,t,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===a)break;e=e.return}}function If(e,t){Tb=e,i1=vf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ga=!0),e.firstContext=null)}function So(e){var t=e._currentValue;if(i1!==e)if(e={context:e,memoizedValue:t,next:null},vf===null){if(Tb===null)throw Error(qe(308));vf=e,Tb.dependencies={lanes:0,firstContext:e}}else vf=vf.next=e;return t}var od=null;function s1(e){od===null?od=[e]:od.push(e)}function z7(e,t,a,o){var l=t.interleaved;return l===null?(a.next=a,s1(t)):(a.next=l.next,l.next=a),t.interleaved=a,Rc(e,o)}function Rc(e,t){e.lanes|=t;var a=e.alternate;for(a!==null&&(a.lanes|=t),a=e,e=e.return;e!==null;)e.childLanes|=t,a=e.alternate,a!==null&&(a.childLanes|=t),a=e,e=e.return;return a.tag===3?a.stateNode:null}var bl=!1;function c1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ec(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ul(e,t,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,mn&2){var l=o.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),o.pending=t,Rc(e,a)}return l=o.interleaved,l===null?(t.next=t,s1(o)):(t.next=l.next,l.next=t),o.interleaved=t,Rc(e,a)}function nb(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,a|=o,t.lanes=a,Kx(e,a)}}function xG(e,t){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var l=null,d=null;if(a=a.firstBaseUpdate,a!==null){do{var p={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};d===null?l=d=p:d=d.next=p,a=a.next}while(a!==null);d===null?l=d=t:d=d.next=t}else l=d=t;a={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:d,shared:o.shared,effects:o.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function wb(e,t,a,o){var l=e.updateQueue;bl=!1;var d=l.firstBaseUpdate,p=l.lastBaseUpdate,g=l.shared.pending;if(g!==null){l.shared.pending=null;var v=g,E=v.next;v.next=null,p===null?d=E:p.next=E,p=v;var T=e.alternate;T!==null&&(T=T.updateQueue,g=T.lastBaseUpdate,g!==p&&(g===null?T.firstBaseUpdate=E:g.next=E,T.lastBaseUpdate=v))}if(d!==null){var b=l.baseState;p=0,T=E=v=null,g=d;do{var R=g.lane,N=g.eventTime;if((o&R)===R){T!==null&&(T=T.next={eventTime:N,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var P=e,L=g;switch(R=t,N=a,L.tag){case 1:if(P=L.payload,typeof P=="function"){b=P.call(N,b,R);break e}b=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=L.payload,R=typeof P=="function"?P.call(N,b,R):P,R==null)break e;b=wr({},b,R);break e;case 2:bl=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,R=l.effects,R===null?l.effects=[g]:R.push(g))}else N={eventTime:N,lane:R,tag:g.tag,payload:g.payload,callback:g.callback,next:null},T===null?(E=T=N,v=b):T=T.next=N,p|=R;if(g=g.next,g===null){if(g=l.shared.pending,g===null)break;R=g,g=R.next,R.next=null,l.lastBaseUpdate=R,l.shared.pending=null}}while(!0);if(T===null&&(v=b),l.baseState=v,l.firstBaseUpdate=E,l.lastBaseUpdate=T,t=l.shared.interleaved,t!==null){l=t;do p|=l.lane,l=l.next;while(l!==t)}else d===null&&(l.shared.lanes=0);bd|=p,e.lanes=p,e.memoizedState=b}}function DG(e,t,a){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],l=o.callback;if(l!==null){if(o.callback=null,o=a,typeof l!="function")throw Error(qe(191,l));l.call(o)}}}var uv={},Us=Jl(uv),py=Jl(uv),my=Jl(uv);function sd(e){if(e===uv)throw Error(qe(174));return e}function l1(e,t){switch(Zn(my,t),Zn(py,e),Zn(Us,uv),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vN(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vN(t,e)}ur(Us),Zn(Us,t)}function Ff(){ur(Us),ur(py),ur(my)}function q7(e){sd(my.current);var t=sd(Us.current),a=vN(t,e.type);t!==a&&(Zn(py,e),Zn(Us,a))}function u1(e){py.current===e&&(ur(Us),ur(py))}var br=Jl(0);function Cb(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var pI=[];function d1(){for(var e=0;e<pI.length;e++)pI[e]._workInProgressVersionPrimary=null;pI.length=0}var rb=Pc.ReactCurrentDispatcher,mI=Pc.ReactCurrentBatchConfig,Sd=0,Tr=null,Jr=null,di=null,Rb=!1,zg=!1,gy=0,Gve=0;function ki(){throw Error(qe(321))}function h1(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!is(e[a],t[a]))return!1;return!0}function f1(e,t,a,o,l,d){if(Sd=d,Tr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rb.current=e===null||e.memoizedState===null?Kve:qve,e=a(o,l),zg){d=0;do{if(zg=!1,gy=0,25<=d)throw Error(qe(301));d+=1,di=Jr=null,t.updateQueue=null,rb.current=Yve,e=a(o,l)}while(zg)}if(rb.current=Ob,t=Jr!==null&&Jr.next!==null,Sd=0,di=Jr=Tr=null,Rb=!1,t)throw Error(qe(300));return e}function p1(){var e=gy!==0;return gy=0,e}function Ps(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?Tr.memoizedState=di=e:di=di.next=e,di}function bo(){if(Jr===null){var e=Tr.alternate;e=e!==null?e.memoizedState:null}else e=Jr.next;var t=di===null?Tr.memoizedState:di.next;if(t!==null)di=t,Jr=e;else{if(e===null)throw Error(qe(310));Jr=e,e={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},di===null?Tr.memoizedState=di=e:di=di.next=e}return di}function yy(e,t){return typeof t=="function"?t(e):t}function gI(e){var t=bo(),a=t.queue;if(a===null)throw Error(qe(311));a.lastRenderedReducer=e;var o=Jr,l=o.baseQueue,d=a.pending;if(d!==null){if(l!==null){var p=l.next;l.next=d.next,d.next=p}o.baseQueue=l=d,a.pending=null}if(l!==null){d=l.next,o=o.baseState;var g=p=null,v=null,E=d;do{var T=E.lane;if((Sd&T)===T)v!==null&&(v=v.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),o=E.hasEagerState?E.eagerState:e(o,E.action);else{var b={lane:T,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};v===null?(g=v=b,p=o):v=v.next=b,Tr.lanes|=T,bd|=T}E=E.next}while(E!==null&&E!==d);v===null?p=o:v.next=g,is(o,t.memoizedState)||(ga=!0),t.memoizedState=o,t.baseState=p,t.baseQueue=v,a.lastRenderedState=o}if(e=a.interleaved,e!==null){l=e;do d=l.lane,Tr.lanes|=d,bd|=d,l=l.next;while(l!==e)}else l===null&&(a.lanes=0);return[t.memoizedState,a.dispatch]}function yI(e){var t=bo(),a=t.queue;if(a===null)throw Error(qe(311));a.lastRenderedReducer=e;var o=a.dispatch,l=a.pending,d=t.memoizedState;if(l!==null){a.pending=null;var p=l=l.next;do d=e(d,p.action),p=p.next;while(p!==l);is(d,t.memoizedState)||(ga=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),a.lastRenderedState=d}return[d,o]}function Y7(){}function X7(e,t){var a=Tr,o=bo(),l=t(),d=!is(o.memoizedState,l);if(d&&(o.memoizedState=l,ga=!0),o=o.queue,m1(Z7.bind(null,a,o,e),[e]),o.getSnapshot!==t||d||di!==null&&di.memoizedState.tag&1){if(a.flags|=2048,vy(9,Q7.bind(null,a,o,l,t),void 0,null),fi===null)throw Error(qe(349));Sd&30||J7(a,t,l)}return l}function J7(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Tr.updateQueue,t===null?(t={lastEffect:null,stores:null},Tr.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Q7(e,t,a,o){t.value=a,t.getSnapshot=o,eY(t)&&tY(e)}function Z7(e,t,a){return a(function(){eY(t)&&tY(e)})}function eY(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!is(e,a)}catch{return!0}}function tY(e){var t=Rc(e,1);t!==null&&ns(t,e,1,-1)}function LG(e){var t=Ps();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yy,lastRenderedState:e},t.queue=e,e=e.dispatch=zve.bind(null,Tr,e),[t.memoizedState,e]}function vy(e,t,a,o){return e={tag:e,create:t,destroy:a,deps:o,next:null},t=Tr.updateQueue,t===null?(t={lastEffect:null,stores:null},Tr.updateQueue=t,t.lastEffect=e.next=e):(a=t.lastEffect,a===null?t.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,t.lastEffect=e)),e}function nY(){return bo().memoizedState}function ib(e,t,a,o){var l=Ps();Tr.flags|=e,l.memoizedState=vy(1|t,a,void 0,o===void 0?null:o)}function XT(e,t,a,o){var l=bo();o=o===void 0?null:o;var d=void 0;if(Jr!==null){var p=Jr.memoizedState;if(d=p.destroy,o!==null&&h1(o,p.deps)){l.memoizedState=vy(t,a,d,o);return}}Tr.flags|=e,l.memoizedState=vy(1|t,a,d,o)}function kG(e,t){return ib(8390656,8,e,t)}function m1(e,t){return XT(2048,8,e,t)}function rY(e,t){return XT(4,2,e,t)}function iY(e,t){return XT(4,4,e,t)}function aY(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function oY(e,t,a){return a=a!=null?a.concat([e]):null,XT(4,4,aY.bind(null,t,e),a)}function g1(){}function sY(e,t){var a=bo();t=t===void 0?null:t;var o=a.memoizedState;return o!==null&&t!==null&&h1(t,o[1])?o[0]:(a.memoizedState=[e,t],e)}function cY(e,t){var a=bo();t=t===void 0?null:t;var o=a.memoizedState;return o!==null&&t!==null&&h1(t,o[1])?o[0]:(e=e(),a.memoizedState=[e,t],e)}function lY(e,t,a){return Sd&21?(is(a,t)||(a=p7(),Tr.lanes|=a,bd|=a,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ga=!0),e.memoizedState=a)}function $ve(e,t){var a=jn;jn=a!==0&&4>a?a:4,e(!0);var o=mI.transition;mI.transition={};try{e(!1),t()}finally{jn=a,mI.transition=o}}function uY(){return bo().memoizedState}function Hve(e,t,a){var o=Vl(e);if(a={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null},dY(e))hY(t,a);else if(a=z7(e,t,a,o),a!==null){var l=Ji();ns(a,e,o,l),fY(a,t,o)}}function zve(e,t,a){var o=Vl(e),l={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null};if(dY(e))hY(t,l);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var p=t.lastRenderedState,g=d(p,a);if(l.hasEagerState=!0,l.eagerState=g,is(g,p)){var v=t.interleaved;v===null?(l.next=l,s1(t)):(l.next=v.next,v.next=l),t.interleaved=l;return}}catch{}finally{}a=z7(e,t,l,o),a!==null&&(l=Ji(),ns(a,e,o,l),fY(a,t,o))}}function dY(e){var t=e.alternate;return e===Tr||t!==null&&t===Tr}function hY(e,t){zg=Rb=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function fY(e,t,a){if(a&4194240){var o=t.lanes;o&=e.pendingLanes,a|=o,t.lanes=a,Kx(e,a)}}var Ob={readContext:So,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},Kve={readContext:So,useCallback:function(e,t){return Ps().memoizedState=[e,t===void 0?null:t],e},useContext:So,useEffect:kG,useImperativeHandle:function(e,t,a){return a=a!=null?a.concat([e]):null,ib(4194308,4,aY.bind(null,t,e),a)},useLayoutEffect:function(e,t){return ib(4194308,4,e,t)},useInsertionEffect:function(e,t){return ib(4,2,e,t)},useMemo:function(e,t){var a=Ps();return t=t===void 0?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var o=Ps();return t=a!==void 0?a(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=Hve.bind(null,Tr,e),[o.memoizedState,e]},useRef:function(e){var t=Ps();return e={current:e},t.memoizedState=e},useState:LG,useDebugValue:g1,useDeferredValue:function(e){return Ps().memoizedState=e},useTransition:function(){var e=LG(!1),t=e[0];return e=$ve.bind(null,e[1]),Ps().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,a){var o=Tr,l=Ps();if(pr){if(a===void 0)throw Error(qe(407));a=a()}else{if(a=t(),fi===null)throw Error(qe(349));Sd&30||J7(o,t,a)}l.memoizedState=a;var d={value:a,getSnapshot:t};return l.queue=d,kG(Z7.bind(null,o,d,e),[e]),o.flags|=2048,vy(9,Q7.bind(null,o,d,a,t),void 0,null),a},useId:function(){var e=Ps(),t=fi.identifierPrefix;if(pr){var a=gc,o=mc;a=(o&~(1<<32-ts(o)-1)).toString(32)+a,t=":"+t+"R"+a,a=gy++,0<a&&(t+="H"+a.toString(32)),t+=":"}else a=Gve++,t=":"+t+"r"+a.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},qve={readContext:So,useCallback:sY,useContext:So,useEffect:m1,useImperativeHandle:oY,useInsertionEffect:rY,useLayoutEffect:iY,useMemo:cY,useReducer:gI,useRef:nY,useState:function(){return gI(yy)},useDebugValue:g1,useDeferredValue:function(e){var t=bo();return lY(t,Jr.memoizedState,e)},useTransition:function(){var e=gI(yy)[0],t=bo().memoizedState;return[e,t]},useMutableSource:Y7,useSyncExternalStore:X7,useId:uY,unstable_isNewReconciler:!1},Yve={readContext:So,useCallback:sY,useContext:So,useEffect:m1,useImperativeHandle:oY,useInsertionEffect:rY,useLayoutEffect:iY,useMemo:cY,useReducer:yI,useRef:nY,useState:function(){return yI(yy)},useDebugValue:g1,useDeferredValue:function(e){var t=bo();return Jr===null?t.memoizedState=e:lY(t,Jr.memoizedState,e)},useTransition:function(){var e=yI(yy)[0],t=bo().memoizedState;return[e,t]},useMutableSource:Y7,useSyncExternalStore:X7,useId:uY,unstable_isNewReconciler:!1};function Yo(e,t){if(e&&e.defaultProps){t=wr({},t),e=e.defaultProps;for(var a in e)t[a]===void 0&&(t[a]=e[a]);return t}return t}function VN(e,t,a,o){t=e.memoizedState,a=a(o,t),a=a==null?t:wr({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var JT={isMounted:function(e){return(e=e._reactInternals)?Id(e)===e:!1},enqueueSetState:function(e,t,a){e=e._reactInternals;var o=Ji(),l=Vl(e),d=Ec(o,l);d.payload=t,a!=null&&(d.callback=a),t=Ul(e,d,l),t!==null&&(ns(t,e,l,o),nb(t,e,l))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var o=Ji(),l=Vl(e),d=Ec(o,l);d.tag=1,d.payload=t,a!=null&&(d.callback=a),t=Ul(e,d,l),t!==null&&(ns(t,e,l,o),nb(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Ji(),o=Vl(e),l=Ec(a,o);l.tag=2,t!=null&&(l.callback=t),t=Ul(e,l,o),t!==null&&(ns(t,e,o,a),nb(t,e,o))}};function MG(e,t,a,o,l,d,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,d,p):t.prototype&&t.prototype.isPureReactComponent?!uy(a,o)||!uy(l,d):!0}function pY(e,t,a){var o=!1,l=zl,d=t.contextType;return typeof d=="object"&&d!==null?d=So(d):(l=_a(t)?_d:Fi.current,o=t.contextTypes,d=(o=o!=null)?jf(e,l):zl),t=new t(a,d),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=JT,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=d),t}function UG(e,t,a,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,o),t.state!==e&&JT.enqueueReplaceState(t,t.state,null)}function BN(e,t,a,o){var l=e.stateNode;l.props=a,l.state=e.memoizedState,l.refs={},c1(e);var d=t.contextType;typeof d=="object"&&d!==null?l.context=So(d):(d=_a(t)?_d:Fi.current,l.context=jf(e,d)),l.state=e.memoizedState,d=t.getDerivedStateFromProps,typeof d=="function"&&(VN(e,t,d,a),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&JT.enqueueReplaceState(l,l.state,null),wb(e,a,l,o),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Wf(e,t){try{var a="",o=t;do a+=Tye(o),o=o.return;while(o);var l=a}catch(d){l=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:t,stack:l,digest:null}}function vI(e,t,a){return{value:e,source:null,stack:a??null,digest:t??null}}function FN(e,t){try{console.error(t.value)}catch(a){setTimeout(function(){throw a})}}var Xve=typeof WeakMap=="function"?WeakMap:Map;function mY(e,t,a){a=Ec(-1,a),a.tag=3,a.payload={element:null};var o=t.value;return a.callback=function(){Ib||(Ib=!0,JN=o),FN(e,t)},a}function gY(e,t,a){a=Ec(-1,a),a.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var l=t.value;a.payload=function(){return o(l)},a.callback=function(){FN(e,t)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(a.callback=function(){FN(e,t),typeof o!="function"&&(jl===null?jl=new Set([this]):jl.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),a}function jG(e,t,a){var o=e.pingCache;if(o===null){o=e.pingCache=new Xve;var l=new Set;o.set(t,l)}else l=o.get(t),l===void 0&&(l=new Set,o.set(t,l));l.has(a)||(l.add(a),e=u_e.bind(null,e,t,a),t.then(e,e))}function VG(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function BG(e,t,a,o,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(t=Ec(-1,1),t.tag=2,Ul(a,t,1))),a.lanes|=1),e)}var Jve=Pc.ReactCurrentOwner,ga=!1;function Yi(e,t,a,o){t.child=e===null?H7(t,null,a,o):Bf(t,e.child,a,o)}function FG(e,t,a,o,l){a=a.render;var d=t.ref;return If(t,l),o=f1(e,t,a,o,d,l),a=p1(),e!==null&&!ga?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Oc(e,t,l)):(pr&&a&&t1(t),t.flags|=1,Yi(e,t,o,l),t.child)}function WG(e,t,a,o,l){if(e===null){var d=a.type;return typeof d=="function"&&!w1(d)&&d.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(t.tag=15,t.type=d,yY(e,t,d,o,l)):(e=cb(a.type,null,o,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!(e.lanes&l)){var p=d.memoizedProps;if(a=a.compare,a=a!==null?a:uy,a(p,o)&&e.ref===t.ref)return Oc(e,t,l)}return t.flags|=1,e=Bl(d,o),e.ref=t.ref,e.return=t,t.child=e}function yY(e,t,a,o,l){if(e!==null){var d=e.memoizedProps;if(uy(d,o)&&e.ref===t.ref)if(ga=!1,t.pendingProps=o=d,(e.lanes&l)!==0)e.flags&131072&&(ga=!0);else return t.lanes=e.lanes,Oc(e,t,l)}return WN(e,t,a,o,l)}function vY(e,t,a){var o=t.pendingProps,l=o.children,d=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zn(Ef,ka),ka|=a;else{if(!(a&1073741824))return e=d!==null?d.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Zn(Ef,ka),ka|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:a,Zn(Ef,ka),ka|=o}else d!==null?(o=d.baseLanes|a,t.memoizedState=null):o=a,Zn(Ef,ka),ka|=o;return Yi(e,t,l,a),t.child}function _Y(e,t){var a=t.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(t.flags|=512,t.flags|=2097152)}function WN(e,t,a,o,l){var d=_a(a)?_d:Fi.current;return d=jf(t,d),If(t,l),a=f1(e,t,a,o,d,l),o=p1(),e!==null&&!ga?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Oc(e,t,l)):(pr&&o&&t1(t),t.flags|=1,Yi(e,t,a,l),t.child)}function GG(e,t,a,o,l){if(_a(a)){var d=!0;_b(t)}else d=!1;if(If(t,l),t.stateNode===null)ab(e,t),pY(t,a,o),BN(t,a,o,l),o=!0;else if(e===null){var p=t.stateNode,g=t.memoizedProps;p.props=g;var v=p.context,E=a.contextType;typeof E=="object"&&E!==null?E=So(E):(E=_a(a)?_d:Fi.current,E=jf(t,E));var T=a.getDerivedStateFromProps,b=typeof T=="function"||typeof p.getSnapshotBeforeUpdate=="function";b||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(g!==o||v!==E)&&UG(t,p,o,E),bl=!1;var R=t.memoizedState;p.state=R,wb(t,o,p,l),v=t.memoizedState,g!==o||R!==v||va.current||bl?(typeof T=="function"&&(VN(t,a,T,o),v=t.memoizedState),(g=bl||MG(t,a,g,o,R,v,E))?(b||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=v),p.props=o,p.state=v,p.context=E,o=g):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{p=t.stateNode,K7(e,t),g=t.memoizedProps,E=t.type===t.elementType?g:Yo(t.type,g),p.props=E,b=t.pendingProps,R=p.context,v=a.contextType,typeof v=="object"&&v!==null?v=So(v):(v=_a(a)?_d:Fi.current,v=jf(t,v));var N=a.getDerivedStateFromProps;(T=typeof N=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(g!==b||R!==v)&&UG(t,p,o,v),bl=!1,R=t.memoizedState,p.state=R,wb(t,o,p,l);var P=t.memoizedState;g!==b||R!==P||va.current||bl?(typeof N=="function"&&(VN(t,a,N,o),P=t.memoizedState),(E=bl||MG(t,a,E,o,R,P,v)||!1)?(T||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,P,v),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,P,v)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||g===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=P),p.props=o,p.state=P,p.context=v,o=E):(typeof p.componentDidUpdate!="function"||g===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),o=!1)}return GN(e,t,a,o,d,l)}function GN(e,t,a,o,l,d){_Y(e,t);var p=(t.flags&128)!==0;if(!o&&!p)return l&&AG(t,a,!1),Oc(e,t,d);o=t.stateNode,Jve.current=t;var g=p&&typeof a.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&p?(t.child=Bf(t,e.child,null,d),t.child=Bf(t,null,g,d)):Yi(e,t,g,d),t.memoizedState=o.state,l&&AG(t,a,!0),t.child}function EY(e){var t=e.stateNode;t.pendingContext?OG(e,t.pendingContext,t.pendingContext!==t.context):t.context&&OG(e,t.context,!1),l1(e,t.containerInfo)}function $G(e,t,a,o,l){return Vf(),r1(l),t.flags|=256,Yi(e,t,a,o),t.child}var $N={dehydrated:null,treeContext:null,retryLane:0};function HN(e){return{baseLanes:e,cachePool:null,transitions:null}}function SY(e,t,a){var o=t.pendingProps,l=br.current,d=!1,p=(t.flags&128)!==0,g;if((g=p)||(g=e!==null&&e.memoizedState===null?!1:(l&2)!==0),g?(d=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Zn(br,l&1),e===null)return UN(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=o.children,e=o.fallback,d?(o=t.mode,d=t.child,p={mode:"hidden",children:p},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=p):d=ew(p,o,0,null),e=pd(e,o,a,null),d.return=t,e.return=t,d.sibling=e,t.child=d,t.child.memoizedState=HN(a),t.memoizedState=$N,e):y1(t,p));if(l=e.memoizedState,l!==null&&(g=l.dehydrated,g!==null))return Qve(e,t,p,o,g,l,a);if(d){d=o.fallback,p=t.mode,l=e.child,g=l.sibling;var v={mode:"hidden",children:o.children};return!(p&1)&&t.child!==l?(o=t.child,o.childLanes=0,o.pendingProps=v,t.deletions=null):(o=Bl(l,v),o.subtreeFlags=l.subtreeFlags&14680064),g!==null?d=Bl(g,d):(d=pd(d,p,a,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,p=e.child.memoizedState,p=p===null?HN(a):{baseLanes:p.baseLanes|a,cachePool:null,transitions:p.transitions},d.memoizedState=p,d.childLanes=e.childLanes&~a,t.memoizedState=$N,o}return d=e.child,e=d.sibling,o=Bl(d,{mode:"visible",children:o.children}),!(t.mode&1)&&(o.lanes=a),o.return=t,o.sibling=null,e!==null&&(a=t.deletions,a===null?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=o,t.memoizedState=null,o}function y1(e,t){return t=ew({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function IS(e,t,a,o){return o!==null&&r1(o),Bf(t,e.child,null,a),e=y1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Qve(e,t,a,o,l,d,p){if(a)return t.flags&256?(t.flags&=-257,o=vI(Error(qe(422))),IS(e,t,p,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(d=o.fallback,l=t.mode,o=ew({mode:"visible",children:o.children},l,0,null),d=pd(d,l,p,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,t.mode&1&&Bf(t,e.child,null,p),t.child.memoizedState=HN(p),t.memoizedState=$N,d);if(!(t.mode&1))return IS(e,t,p,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var g=o.dgst;return o=g,d=Error(qe(419)),o=vI(d,o,void 0),IS(e,t,p,o)}if(g=(p&e.childLanes)!==0,ga||g){if(o=fi,o!==null){switch(p&-p){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(o.suspendedLanes|p)?0:l,l!==0&&l!==d.retryLane&&(d.retryLane=l,Rc(e,l),ns(o,e,l,-1))}return T1(),o=vI(Error(qe(421))),IS(e,t,p,o)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=d_e.bind(null,e),l._reactRetry=t,null):(e=d.treeContext,Va=Ml(l.nextSibling),Ba=t,pr=!0,Qo=null,e!==null&&(mo[go++]=mc,mo[go++]=gc,mo[go++]=Ed,mc=e.id,gc=e.overflow,Ed=t),t=y1(t,o.children),t.flags|=4096,t)}function HG(e,t,a){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),jN(e.return,t,a)}function _I(e,t,a,o,l){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:l}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=a,d.tailMode=l)}function bY(e,t,a){var o=t.pendingProps,l=o.revealOrder,d=o.tail;if(Yi(e,t,o.children,a),o=br.current,o&2)o=o&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&HG(e,a,t);else if(e.tag===19)HG(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Zn(br,o),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(a=t.child,l=null;a!==null;)e=a.alternate,e!==null&&Cb(e)===null&&(l=a),a=a.sibling;a=l,a===null?(l=t.child,t.child=null):(l=a.sibling,a.sibling=null),_I(t,!1,l,a,d);break;case"backwards":for(a=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Cb(e)===null){t.child=l;break}e=l.sibling,l.sibling=a,a=l,l=e}_I(t,!0,a,null,d);break;case"together":_I(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ab(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Oc(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),bd|=t.lanes,!(a&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(qe(153));if(t.child!==null){for(e=t.child,a=Bl(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=Bl(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Zve(e,t,a){switch(t.tag){case 3:EY(t),Vf();break;case 5:q7(t);break;case 1:_a(t.type)&&_b(t);break;case 4:l1(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,l=t.memoizedProps.value;Zn(bb,o._currentValue),o._currentValue=l;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(Zn(br,br.current&1),t.flags|=128,null):a&t.child.childLanes?SY(e,t,a):(Zn(br,br.current&1),e=Oc(e,t,a),e!==null?e.sibling:null);Zn(br,br.current&1);break;case 19:if(o=(a&t.childLanes)!==0,e.flags&128){if(o)return bY(e,t,a);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Zn(br,br.current),o)break;return null;case 22:case 23:return t.lanes=0,vY(e,t,a)}return Oc(e,t,a)}var TY,zN,wY,CY;TY=function(e,t){for(var a=t.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};zN=function(){};wY=function(e,t,a,o){var l=e.memoizedProps;if(l!==o){e=t.stateNode,sd(Us.current);var d=null;switch(a){case"input":l=pN(e,l),o=pN(e,o),d=[];break;case"select":l=wr({},l,{value:void 0}),o=wr({},o,{value:void 0}),d=[];break;case"textarea":l=yN(e,l),o=yN(e,o),d=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=yb)}_N(a,o);var p;a=null;for(E in l)if(!o.hasOwnProperty(E)&&l.hasOwnProperty(E)&&l[E]!=null)if(E==="style"){var g=l[E];for(p in g)g.hasOwnProperty(p)&&(a||(a={}),a[p]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(ry.hasOwnProperty(E)?d||(d=[]):(d=d||[]).push(E,null));for(E in o){var v=o[E];if(g=l!=null?l[E]:void 0,o.hasOwnProperty(E)&&v!==g&&(v!=null||g!=null))if(E==="style")if(g){for(p in g)!g.hasOwnProperty(p)||v&&v.hasOwnProperty(p)||(a||(a={}),a[p]="");for(p in v)v.hasOwnProperty(p)&&g[p]!==v[p]&&(a||(a={}),a[p]=v[p])}else a||(d||(d=[]),d.push(E,a)),a=v;else E==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,g=g?g.__html:void 0,v!=null&&g!==v&&(d=d||[]).push(E,v)):E==="children"?typeof v!="string"&&typeof v!="number"||(d=d||[]).push(E,""+v):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(ry.hasOwnProperty(E)?(v!=null&&E==="onScroll"&&sr("scroll",e),d||g===v||(d=[])):(d=d||[]).push(E,v))}a&&(d=d||[]).push("style",a);var E=d;(t.updateQueue=E)&&(t.flags|=4)}};CY=function(e,t,a,o){a!==o&&(t.flags|=4)};function mg(e,t){if(!pr)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Mi(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(t)for(var l=e.child;l!==null;)a|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)a|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=o,e.childLanes=a,t}function e_e(e,t,a){var o=t.pendingProps;switch(n1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(t),null;case 1:return _a(t.type)&&vb(),Mi(t),null;case 3:return o=t.stateNode,Ff(),ur(va),ur(Fi),d1(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(OS(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Qo!==null&&(eP(Qo),Qo=null))),zN(e,t),Mi(t),null;case 5:u1(t);var l=sd(my.current);if(a=t.type,e!==null&&t.stateNode!=null)wY(e,t,a,o,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(qe(166));return Mi(t),null}if(e=sd(Us.current),OS(t)){o=t.stateNode,a=t.type;var d=t.memoizedProps;switch(o[Ds]=t,o[fy]=d,e=(t.mode&1)!==0,a){case"dialog":sr("cancel",o),sr("close",o);break;case"iframe":case"object":case"embed":sr("load",o);break;case"video":case"audio":for(l=0;l<Ug.length;l++)sr(Ug[l],o);break;case"source":sr("error",o);break;case"img":case"image":case"link":sr("error",o),sr("load",o);break;case"details":sr("toggle",o);break;case"input":eG(o,d),sr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},sr("invalid",o);break;case"textarea":nG(o,d),sr("invalid",o)}_N(a,d),l=null;for(var p in d)if(d.hasOwnProperty(p)){var g=d[p];p==="children"?typeof g=="string"?o.textContent!==g&&(d.suppressHydrationWarning!==!0&&RS(o.textContent,g,e),l=["children",g]):typeof g=="number"&&o.textContent!==""+g&&(d.suppressHydrationWarning!==!0&&RS(o.textContent,g,e),l=["children",""+g]):ry.hasOwnProperty(p)&&g!=null&&p==="onScroll"&&sr("scroll",o)}switch(a){case"input":vS(o),tG(o,d,!0);break;case"textarea":vS(o),rG(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=yb)}o=l,t.updateQueue=o,o!==null&&(t.flags|=4)}else{p=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zq(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=p.createElement(a,{is:o.is}):(e=p.createElement(a),a==="select"&&(p=e,o.multiple?p.multiple=!0:o.size&&(p.size=o.size))):e=p.createElementNS(e,a),e[Ds]=t,e[fy]=o,TY(e,t,!1,!1),t.stateNode=e;e:{switch(p=EN(a,o),a){case"dialog":sr("cancel",e),sr("close",e),l=o;break;case"iframe":case"object":case"embed":sr("load",e),l=o;break;case"video":case"audio":for(l=0;l<Ug.length;l++)sr(Ug[l],e);l=o;break;case"source":sr("error",e),l=o;break;case"img":case"image":case"link":sr("error",e),sr("load",e),l=o;break;case"details":sr("toggle",e),l=o;break;case"input":eG(e,o),l=pN(e,o),sr("invalid",e);break;case"option":l=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},l=wr({},o,{value:void 0}),sr("invalid",e);break;case"textarea":nG(e,o),l=yN(e,o),sr("invalid",e);break;default:l=o}_N(a,l),g=l;for(d in g)if(g.hasOwnProperty(d)){var v=g[d];d==="style"?n7(e,v):d==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&e7(e,v)):d==="children"?typeof v=="string"?(a!=="textarea"||v!=="")&&iy(e,v):typeof v=="number"&&iy(e,""+v):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ry.hasOwnProperty(d)?v!=null&&d==="onScroll"&&sr("scroll",e):v!=null&&Fx(e,d,v,p))}switch(a){case"input":vS(e),tG(e,o,!1);break;case"textarea":vS(e),rG(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Hl(o.value));break;case"select":e.multiple=!!o.multiple,d=o.value,d!=null?Cf(e,!!o.multiple,d,!1):o.defaultValue!=null&&Cf(e,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=yb)}switch(a){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mi(t),null;case 6:if(e&&t.stateNode!=null)CY(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(qe(166));if(a=sd(my.current),sd(Us.current),OS(t)){if(o=t.stateNode,a=t.memoizedProps,o[Ds]=t,(d=o.nodeValue!==a)&&(e=Ba,e!==null))switch(e.tag){case 3:RS(o.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&RS(o.nodeValue,a,(e.mode&1)!==0)}d&&(t.flags|=4)}else o=(a.nodeType===9?a:a.ownerDocument).createTextNode(o),o[Ds]=t,t.stateNode=o}return Mi(t),null;case 13:if(ur(br),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pr&&Va!==null&&t.mode&1&&!(t.flags&128))G7(),Vf(),t.flags|=98560,d=!1;else if(d=OS(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(qe(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(qe(317));d[Ds]=t}else Vf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mi(t),d=!1}else Qo!==null&&(eP(Qo),Qo=null),d=!0;if(!d)return t.flags&65536?t:null}return t.flags&128?(t.lanes=a,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,t.mode&1&&(e===null||br.current&1?Qr===0&&(Qr=3):T1())),t.updateQueue!==null&&(t.flags|=4),Mi(t),null);case 4:return Ff(),zN(e,t),e===null&&dy(t.stateNode.containerInfo),Mi(t),null;case 10:return o1(t.type._context),Mi(t),null;case 17:return _a(t.type)&&vb(),Mi(t),null;case 19:if(ur(br),d=t.memoizedState,d===null)return Mi(t),null;if(o=(t.flags&128)!==0,p=d.rendering,p===null)if(o)mg(d,!1);else{if(Qr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(p=Cb(e),p!==null){for(t.flags|=128,mg(d,!1),o=p.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=a,a=t.child;a!==null;)d=a,e=o,d.flags&=14680066,p=d.alternate,p===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=p.childLanes,d.lanes=p.lanes,d.child=p.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=p.memoizedProps,d.memoizedState=p.memoizedState,d.updateQueue=p.updateQueue,d.type=p.type,e=p.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return Zn(br,br.current&1|2),t.child}e=e.sibling}d.tail!==null&&Ur()>Gf&&(t.flags|=128,o=!0,mg(d,!1),t.lanes=4194304)}else{if(!o)if(e=Cb(p),e!==null){if(t.flags|=128,o=!0,a=e.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),mg(d,!0),d.tail===null&&d.tailMode==="hidden"&&!p.alternate&&!pr)return Mi(t),null}else 2*Ur()-d.renderingStartTime>Gf&&a!==1073741824&&(t.flags|=128,o=!0,mg(d,!1),t.lanes=4194304);d.isBackwards?(p.sibling=t.child,t.child=p):(a=d.last,a!==null?a.sibling=p:t.child=p,d.last=p)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=Ur(),t.sibling=null,a=br.current,Zn(br,o?a&1|2:a&1),t):(Mi(t),null);case 22:case 23:return b1(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&t.mode&1?ka&1073741824&&(Mi(t),t.subtreeFlags&6&&(t.flags|=8192)):Mi(t),null;case 24:return null;case 25:return null}throw Error(qe(156,t.tag))}function t_e(e,t){switch(n1(t),t.tag){case 1:return _a(t.type)&&vb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ff(),ur(va),ur(Fi),d1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return u1(t),null;case 13:if(ur(br),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(qe(340));Vf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ur(br),null;case 4:return Ff(),null;case 10:return o1(t.type._context),null;case 22:case 23:return b1(),null;case 24:return null;default:return null}}var NS=!1,ji=!1,n_e=typeof WeakSet=="function"?WeakSet:Set,st=null;function _f(e,t){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(o){Nr(e,t,o)}else a.current=null}function KN(e,t,a){try{a()}catch(o){Nr(e,t,o)}}var zG=!1;function r_e(e,t){if(NN=pb,e=N7(),e1(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var l=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{a.nodeType,d.nodeType}catch{a=null;break e}var p=0,g=-1,v=-1,E=0,T=0,b=e,R=null;t:for(;;){for(var N;b!==a||l!==0&&b.nodeType!==3||(g=p+l),b!==d||o!==0&&b.nodeType!==3||(v=p+o),b.nodeType===3&&(p+=b.nodeValue.length),(N=b.firstChild)!==null;)R=b,b=N;for(;;){if(b===e)break t;if(R===a&&++E===l&&(g=p),R===d&&++T===o&&(v=p),(N=b.nextSibling)!==null)break;b=R,R=b.parentNode}b=N}a=g===-1||v===-1?null:{start:g,end:v}}else a=null}a=a||{start:0,end:0}}else a=null;for(PN={focusedElem:e,selectionRange:a},pb=!1,st=t;st!==null;)if(t=st,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,st=e;else for(;st!==null;){t=st;try{var P=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var L=P.memoizedProps,M=P.memoizedState,D=t.stateNode,U=D.getSnapshotBeforeUpdate(t.elementType===t.type?L:Yo(t.type,L),M);D.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var B=t.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(z){Nr(t,t.return,z)}if(e=t.sibling,e!==null){e.return=t.return,st=e;break}st=t.return}return P=zG,zG=!1,P}function Kg(e,t,a){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&e)===e){var d=l.destroy;l.destroy=void 0,d!==void 0&&KN(t,a,d)}l=l.next}while(l!==o)}}function QT(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var a=t=t.next;do{if((a.tag&e)===e){var o=a.create;a.destroy=o()}a=a.next}while(a!==t)}}function qN(e){var t=e.ref;if(t!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof t=="function"?t(e):t.current=e}}function RY(e){var t=e.alternate;t!==null&&(e.alternate=null,RY(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ds],delete t[fy],delete t[LN],delete t[Vve],delete t[Bve])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function OY(e){return e.tag===5||e.tag===3||e.tag===4}function KG(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||OY(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function YN(e,t,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?a.nodeType===8?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(a.nodeType===8?(t=a.parentNode,t.insertBefore(e,a)):(t=a,t.appendChild(e)),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=yb));else if(o!==4&&(e=e.child,e!==null))for(YN(e,t,a),e=e.sibling;e!==null;)YN(e,t,a),e=e.sibling}function XN(e,t,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(XN(e,t,a),e=e.sibling;e!==null;)XN(e,t,a),e=e.sibling}var bi=null,Xo=!1;function ml(e,t,a){for(a=a.child;a!==null;)AY(e,t,a),a=a.sibling}function AY(e,t,a){if(Ms&&typeof Ms.onCommitFiberUnmount=="function")try{Ms.onCommitFiberUnmount($T,a)}catch{}switch(a.tag){case 5:ji||_f(a,t);case 6:var o=bi,l=Xo;bi=null,ml(e,t,a),bi=o,Xo=l,bi!==null&&(Xo?(e=bi,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):bi.removeChild(a.stateNode));break;case 18:bi!==null&&(Xo?(e=bi,a=a.stateNode,e.nodeType===8?hI(e.parentNode,a):e.nodeType===1&&hI(e,a),cy(e)):hI(bi,a.stateNode));break;case 4:o=bi,l=Xo,bi=a.stateNode.containerInfo,Xo=!0,ml(e,t,a),bi=o,Xo=l;break;case 0:case 11:case 14:case 15:if(!ji&&(o=a.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var d=l,p=d.destroy;d=d.tag,p!==void 0&&(d&2||d&4)&&KN(a,t,p),l=l.next}while(l!==o)}ml(e,t,a);break;case 1:if(!ji&&(_f(a,t),o=a.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(g){Nr(a,t,g)}ml(e,t,a);break;case 21:ml(e,t,a);break;case 22:a.mode&1?(ji=(o=ji)||a.memoizedState!==null,ml(e,t,a),ji=o):ml(e,t,a);break;default:ml(e,t,a)}}function qG(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new n_e),t.forEach(function(o){var l=h_e.bind(null,e,o);a.has(o)||(a.add(o),o.then(l,l))})}}function zo(e,t){var a=t.deletions;if(a!==null)for(var o=0;o<a.length;o++){var l=a[o];try{var d=e,p=t,g=p;e:for(;g!==null;){switch(g.tag){case 5:bi=g.stateNode,Xo=!1;break e;case 3:bi=g.stateNode.containerInfo,Xo=!0;break e;case 4:bi=g.stateNode.containerInfo,Xo=!0;break e}g=g.return}if(bi===null)throw Error(qe(160));AY(d,p,l),bi=null,Xo=!1;var v=l.alternate;v!==null&&(v.return=null),l.return=null}catch(E){Nr(l,t,E)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)IY(t,e),t=t.sibling}function IY(e,t){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zo(t,e),Ns(e),o&4){try{Kg(3,e,e.return),QT(3,e)}catch(L){Nr(e,e.return,L)}try{Kg(5,e,e.return)}catch(L){Nr(e,e.return,L)}}break;case 1:zo(t,e),Ns(e),o&512&&a!==null&&_f(a,a.return);break;case 5:if(zo(t,e),Ns(e),o&512&&a!==null&&_f(a,a.return),e.flags&32){var l=e.stateNode;try{iy(l,"")}catch(L){Nr(e,e.return,L)}}if(o&4&&(l=e.stateNode,l!=null)){var d=e.memoizedProps,p=a!==null?a.memoizedProps:d,g=e.type,v=e.updateQueue;if(e.updateQueue=null,v!==null)try{g==="input"&&d.type==="radio"&&d.name!=null&&Jq(l,d),EN(g,p);var E=EN(g,d);for(p=0;p<v.length;p+=2){var T=v[p],b=v[p+1];T==="style"?n7(l,b):T==="dangerouslySetInnerHTML"?e7(l,b):T==="children"?iy(l,b):Fx(l,T,b,E)}switch(g){case"input":mN(l,d);break;case"textarea":Qq(l,d);break;case"select":var R=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!d.multiple;var N=d.value;N!=null?Cf(l,!!d.multiple,N,!1):R!==!!d.multiple&&(d.defaultValue!=null?Cf(l,!!d.multiple,d.defaultValue,!0):Cf(l,!!d.multiple,d.multiple?[]:"",!1))}l[fy]=d}catch(L){Nr(e,e.return,L)}}break;case 6:if(zo(t,e),Ns(e),o&4){if(e.stateNode===null)throw Error(qe(162));l=e.stateNode,d=e.memoizedProps;try{l.nodeValue=d}catch(L){Nr(e,e.return,L)}}break;case 3:if(zo(t,e),Ns(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{cy(t.containerInfo)}catch(L){Nr(e,e.return,L)}break;case 4:zo(t,e),Ns(e);break;case 13:zo(t,e),Ns(e),l=e.child,l.flags&8192&&(d=l.memoizedState!==null,l.stateNode.isHidden=d,!d||l.alternate!==null&&l.alternate.memoizedState!==null||(E1=Ur())),o&4&&qG(e);break;case 22:if(T=a!==null&&a.memoizedState!==null,e.mode&1?(ji=(E=ji)||T,zo(t,e),ji=E):zo(t,e),Ns(e),o&8192){if(E=e.memoizedState!==null,(e.stateNode.isHidden=E)&&!T&&e.mode&1)for(st=e,T=e.child;T!==null;){for(b=st=T;st!==null;){switch(R=st,N=R.child,R.tag){case 0:case 11:case 14:case 15:Kg(4,R,R.return);break;case 1:_f(R,R.return);var P=R.stateNode;if(typeof P.componentWillUnmount=="function"){o=R,a=R.return;try{t=o,P.props=t.memoizedProps,P.state=t.memoizedState,P.componentWillUnmount()}catch(L){Nr(o,a,L)}}break;case 5:_f(R,R.return);break;case 22:if(R.memoizedState!==null){XG(b);continue}}N!==null?(N.return=R,st=N):XG(b)}T=T.sibling}e:for(T=null,b=e;;){if(b.tag===5){if(T===null){T=b;try{l=b.stateNode,E?(d=l.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(g=b.stateNode,v=b.memoizedProps.style,p=v!=null&&v.hasOwnProperty("display")?v.display:null,g.style.display=t7("display",p))}catch(L){Nr(e,e.return,L)}}}else if(b.tag===6){if(T===null)try{b.stateNode.nodeValue=E?"":b.memoizedProps}catch(L){Nr(e,e.return,L)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===e)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===e)break e;for(;b.sibling===null;){if(b.return===null||b.return===e)break e;T===b&&(T=null),b=b.return}T===b&&(T=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:zo(t,e),Ns(e),o&4&&qG(e);break;case 21:break;default:zo(t,e),Ns(e)}}function Ns(e){var t=e.flags;if(t&2){try{e:{for(var a=e.return;a!==null;){if(OY(a)){var o=a;break e}a=a.return}throw Error(qe(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(iy(l,""),o.flags&=-33);var d=KG(e);XN(e,d,l);break;case 3:case 4:var p=o.stateNode.containerInfo,g=KG(e);YN(e,g,p);break;default:throw Error(qe(161))}}catch(v){Nr(e,e.return,v)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function i_e(e,t,a){st=e,NY(e)}function NY(e,t,a){for(var o=(e.mode&1)!==0;st!==null;){var l=st,d=l.child;if(l.tag===22&&o){var p=l.memoizedState!==null||NS;if(!p){var g=l.alternate,v=g!==null&&g.memoizedState!==null||ji;g=NS;var E=ji;if(NS=p,(ji=v)&&!E)for(st=l;st!==null;)p=st,v=p.child,p.tag===22&&p.memoizedState!==null?JG(l):v!==null?(v.return=p,st=v):JG(l);for(;d!==null;)st=d,NY(d),d=d.sibling;st=l,NS=g,ji=E}YG(e)}else l.subtreeFlags&8772&&d!==null?(d.return=l,st=d):YG(e)}}function YG(e){for(;st!==null;){var t=st;if(t.flags&8772){var a=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ji||QT(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!ji)if(a===null)o.componentDidMount();else{var l=t.elementType===t.type?a.memoizedProps:Yo(t.type,a.memoizedProps);o.componentDidUpdate(l,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=t.updateQueue;d!==null&&DG(t,d,o);break;case 3:var p=t.updateQueue;if(p!==null){if(a=null,t.child!==null)switch(t.child.tag){case 5:a=t.child.stateNode;break;case 1:a=t.child.stateNode}DG(t,p,a)}break;case 5:var g=t.stateNode;if(a===null&&t.flags&4){a=g;var v=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&a.focus();break;case"img":v.src&&(a.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var E=t.alternate;if(E!==null){var T=E.memoizedState;if(T!==null){var b=T.dehydrated;b!==null&&cy(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}ji||t.flags&512&&qN(t)}catch(R){Nr(t,t.return,R)}}if(t===e){st=null;break}if(a=t.sibling,a!==null){a.return=t.return,st=a;break}st=t.return}}function XG(e){for(;st!==null;){var t=st;if(t===e){st=null;break}var a=t.sibling;if(a!==null){a.return=t.return,st=a;break}st=t.return}}function JG(e){for(;st!==null;){var t=st;try{switch(t.tag){case 0:case 11:case 15:var a=t.return;try{QT(4,t)}catch(v){Nr(t,a,v)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var l=t.return;try{o.componentDidMount()}catch(v){Nr(t,l,v)}}var d=t.return;try{qN(t)}catch(v){Nr(t,d,v)}break;case 5:var p=t.return;try{qN(t)}catch(v){Nr(t,p,v)}}}catch(v){Nr(t,t.return,v)}if(t===e){st=null;break}var g=t.sibling;if(g!==null){g.return=t.return,st=g;break}st=t.return}}var a_e=Math.ceil,Ab=Pc.ReactCurrentDispatcher,v1=Pc.ReactCurrentOwner,_o=Pc.ReactCurrentBatchConfig,mn=0,fi=null,Gr=null,wi=0,ka=0,Ef=Jl(0),Qr=0,_y=null,bd=0,ZT=0,_1=0,qg=null,ma=null,E1=0,Gf=1/0,fc=null,Ib=!1,JN=null,jl=null,PS=!1,Nl=null,Nb=0,Yg=0,QN=null,ob=-1,sb=0;function Ji(){return mn&6?Ur():ob!==-1?ob:ob=Ur()}function Vl(e){return e.mode&1?mn&2&&wi!==0?wi&-wi:Wve.transition!==null?(sb===0&&(sb=p7()),sb):(e=jn,e!==0||(e=window.event,e=e===void 0?16:S7(e.type)),e):1}function ns(e,t,a,o){if(50<Yg)throw Yg=0,QN=null,Error(qe(185));sv(e,a,o),(!(mn&2)||e!==fi)&&(e===fi&&(!(mn&2)&&(ZT|=a),Qr===4&&Rl(e,wi)),Ea(e,o),a===1&&mn===0&&!(t.mode&1)&&(Gf=Ur()+500,YT&&Ql()))}function Ea(e,t){var a=e.callbackNode;Wye(e,t);var o=fb(e,e===fi?wi:0);if(o===0)a!==null&&oG(a),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(a!=null&&oG(a),t===1)e.tag===0?Fve(QG.bind(null,e)):B7(QG.bind(null,e)),Uve(function(){!(mn&6)&&Ql()}),a=null;else{switch(m7(o)){case 1:a=zx;break;case 4:a=h7;break;case 16:a=hb;break;case 536870912:a=f7;break;default:a=hb}a=jY(a,PY.bind(null,e))}e.callbackPriority=t,e.callbackNode=a}}function PY(e,t){if(ob=-1,sb=0,mn&6)throw Error(qe(327));var a=e.callbackNode;if(Nf()&&e.callbackNode!==a)return null;var o=fb(e,e===fi?wi:0);if(o===0)return null;if(o&30||o&e.expiredLanes||t)t=Pb(e,o);else{t=o;var l=mn;mn|=2;var d=DY();(fi!==e||wi!==t)&&(fc=null,Gf=Ur()+500,fd(e,t));do try{c_e();break}catch(g){xY(e,g)}while(!0);a1(),Ab.current=d,mn=l,Gr!==null?t=0:(fi=null,wi=0,t=Qr)}if(t!==0){if(t===2&&(l=CN(e),l!==0&&(o=l,t=ZN(e,l))),t===1)throw a=_y,fd(e,0),Rl(e,o),Ea(e,Ur()),a;if(t===6)Rl(e,o);else{if(l=e.current.alternate,!(o&30)&&!o_e(l)&&(t=Pb(e,o),t===2&&(d=CN(e),d!==0&&(o=d,t=ZN(e,d))),t===1))throw a=_y,fd(e,0),Rl(e,o),Ea(e,Ur()),a;switch(e.finishedWork=l,e.finishedLanes=o,t){case 0:case 1:throw Error(qe(345));case 2:ed(e,ma,fc);break;case 3:if(Rl(e,o),(o&130023424)===o&&(t=E1+500-Ur(),10<t)){if(fb(e,0)!==0)break;if(l=e.suspendedLanes,(l&o)!==o){Ji(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=DN(ed.bind(null,e,ma,fc),t);break}ed(e,ma,fc);break;case 4:if(Rl(e,o),(o&4194240)===o)break;for(t=e.eventTimes,l=-1;0<o;){var p=31-ts(o);d=1<<p,p=t[p],p>l&&(l=p),o&=~d}if(o=l,o=Ur()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*a_e(o/1960))-o,10<o){e.timeoutHandle=DN(ed.bind(null,e,ma,fc),o);break}ed(e,ma,fc);break;case 5:ed(e,ma,fc);break;default:throw Error(qe(329))}}}return Ea(e,Ur()),e.callbackNode===a?PY.bind(null,e):null}function ZN(e,t){var a=qg;return e.current.memoizedState.isDehydrated&&(fd(e,t).flags|=256),e=Pb(e,t),e!==2&&(t=ma,ma=a,t!==null&&eP(t)),e}function eP(e){ma===null?ma=e:ma.push.apply(ma,e)}function o_e(e){for(var t=e;;){if(t.flags&16384){var a=t.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var o=0;o<a.length;o++){var l=a[o],d=l.getSnapshot;l=l.value;try{if(!is(d(),l))return!1}catch{return!1}}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rl(e,t){for(t&=~_1,t&=~ZT,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-ts(t),o=1<<a;e[a]=-1,t&=~o}}function QG(e){if(mn&6)throw Error(qe(327));Nf();var t=fb(e,0);if(!(t&1))return Ea(e,Ur()),null;var a=Pb(e,t);if(e.tag!==0&&a===2){var o=CN(e);o!==0&&(t=o,a=ZN(e,o))}if(a===1)throw a=_y,fd(e,0),Rl(e,t),Ea(e,Ur()),a;if(a===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ed(e,ma,fc),Ea(e,Ur()),null}function S1(e,t){var a=mn;mn|=1;try{return e(t)}finally{mn=a,mn===0&&(Gf=Ur()+500,YT&&Ql())}}function Td(e){Nl!==null&&Nl.tag===0&&!(mn&6)&&Nf();var t=mn;mn|=1;var a=_o.transition,o=jn;try{if(_o.transition=null,jn=1,e)return e()}finally{jn=o,_o.transition=a,mn=t,!(mn&6)&&Ql()}}function b1(){ka=Ef.current,ur(Ef)}function fd(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Mve(a)),Gr!==null)for(a=Gr.return;a!==null;){var o=a;switch(n1(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&vb();break;case 3:Ff(),ur(va),ur(Fi),d1();break;case 5:u1(o);break;case 4:Ff();break;case 13:ur(br);break;case 19:ur(br);break;case 10:o1(o.type._context);break;case 22:case 23:b1()}a=a.return}if(fi=e,Gr=e=Bl(e.current,null),wi=ka=t,Qr=0,_y=null,_1=ZT=bd=0,ma=qg=null,od!==null){for(t=0;t<od.length;t++)if(a=od[t],o=a.interleaved,o!==null){a.interleaved=null;var l=o.next,d=a.pending;if(d!==null){var p=d.next;d.next=l,o.next=p}a.pending=o}od=null}return e}function xY(e,t){do{var a=Gr;try{if(a1(),rb.current=Ob,Rb){for(var o=Tr.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Rb=!1}if(Sd=0,di=Jr=Tr=null,zg=!1,gy=0,v1.current=null,a===null||a.return===null){Qr=1,_y=t,Gr=null;break}e:{var d=e,p=a.return,g=a,v=t;if(t=wi,g.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var E=v,T=g,b=T.tag;if(!(T.mode&1)&&(b===0||b===11||b===15)){var R=T.alternate;R?(T.updateQueue=R.updateQueue,T.memoizedState=R.memoizedState,T.lanes=R.lanes):(T.updateQueue=null,T.memoizedState=null)}var N=VG(p);if(N!==null){N.flags&=-257,BG(N,p,g,d,t),N.mode&1&&jG(d,E,t),t=N,v=E;var P=t.updateQueue;if(P===null){var L=new Set;L.add(v),t.updateQueue=L}else P.add(v);break e}else{if(!(t&1)){jG(d,E,t),T1();break e}v=Error(qe(426))}}else if(pr&&g.mode&1){var M=VG(p);if(M!==null){!(M.flags&65536)&&(M.flags|=256),BG(M,p,g,d,t),r1(Wf(v,g));break e}}d=v=Wf(v,g),Qr!==4&&(Qr=2),qg===null?qg=[d]:qg.push(d),d=p;do{switch(d.tag){case 3:d.flags|=65536,t&=-t,d.lanes|=t;var D=mY(d,v,t);xG(d,D);break e;case 1:g=v;var U=d.type,B=d.stateNode;if(!(d.flags&128)&&(typeof U.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(jl===null||!jl.has(B)))){d.flags|=65536,t&=-t,d.lanes|=t;var z=gY(d,g,t);xG(d,z);break e}}d=d.return}while(d!==null)}kY(a)}catch(V){t=V,Gr===a&&a!==null&&(Gr=a=a.return);continue}break}while(!0)}function DY(){var e=Ab.current;return Ab.current=Ob,e===null?Ob:e}function T1(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),fi===null||!(bd&268435455)&&!(ZT&268435455)||Rl(fi,wi)}function Pb(e,t){var a=mn;mn|=2;var o=DY();(fi!==e||wi!==t)&&(fc=null,fd(e,t));do try{s_e();break}catch(l){xY(e,l)}while(!0);if(a1(),mn=a,Ab.current=o,Gr!==null)throw Error(qe(261));return fi=null,wi=0,Qr}function s_e(){for(;Gr!==null;)LY(Gr)}function c_e(){for(;Gr!==null&&!Dye();)LY(Gr)}function LY(e){var t=UY(e.alternate,e,ka);e.memoizedProps=e.pendingProps,t===null?kY(e):Gr=t,v1.current=null}function kY(e){var t=e;do{var a=t.alternate;if(e=t.return,t.flags&32768){if(a=t_e(a,t),a!==null){a.flags&=32767,Gr=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qr=6,Gr=null;return}}else if(a=e_e(a,t,ka),a!==null){Gr=a;return}if(t=t.sibling,t!==null){Gr=t;return}Gr=t=e}while(t!==null);Qr===0&&(Qr=5)}function ed(e,t,a){var o=jn,l=_o.transition;try{_o.transition=null,jn=1,l_e(e,t,a,o)}finally{_o.transition=l,jn=o}return null}function l_e(e,t,a,o){do Nf();while(Nl!==null);if(mn&6)throw Error(qe(327));a=e.finishedWork;var l=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var d=a.lanes|a.childLanes;if(Gye(e,d),e===fi&&(Gr=fi=null,wi=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||PS||(PS=!0,jY(hb,function(){return Nf(),null})),d=(a.flags&15990)!==0,a.subtreeFlags&15990||d){d=_o.transition,_o.transition=null;var p=jn;jn=1;var g=mn;mn|=4,v1.current=null,r_e(e,a),IY(a,e),Ive(PN),pb=!!NN,PN=NN=null,e.current=a,i_e(a),Lye(),mn=g,jn=p,_o.transition=d}else e.current=a;if(PS&&(PS=!1,Nl=e,Nb=l),d=e.pendingLanes,d===0&&(jl=null),Uye(a.stateNode),Ea(e,Ur()),t!==null)for(o=e.onRecoverableError,a=0;a<t.length;a++)l=t[a],o(l.value,{componentStack:l.stack,digest:l.digest});if(Ib)throw Ib=!1,e=JN,JN=null,e;return Nb&1&&e.tag!==0&&Nf(),d=e.pendingLanes,d&1?e===QN?Yg++:(Yg=0,QN=e):Yg=0,Ql(),null}function Nf(){if(Nl!==null){var e=m7(Nb),t=_o.transition,a=jn;try{if(_o.transition=null,jn=16>e?16:e,Nl===null)var o=!1;else{if(e=Nl,Nl=null,Nb=0,mn&6)throw Error(qe(331));var l=mn;for(mn|=4,st=e.current;st!==null;){var d=st,p=d.child;if(st.flags&16){var g=d.deletions;if(g!==null){for(var v=0;v<g.length;v++){var E=g[v];for(st=E;st!==null;){var T=st;switch(T.tag){case 0:case 11:case 15:Kg(8,T,d)}var b=T.child;if(b!==null)b.return=T,st=b;else for(;st!==null;){T=st;var R=T.sibling,N=T.return;if(RY(T),T===E){st=null;break}if(R!==null){R.return=N,st=R;break}st=N}}}var P=d.alternate;if(P!==null){var L=P.child;if(L!==null){P.child=null;do{var M=L.sibling;L.sibling=null,L=M}while(L!==null)}}st=d}}if(d.subtreeFlags&2064&&p!==null)p.return=d,st=p;else e:for(;st!==null;){if(d=st,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Kg(9,d,d.return)}var D=d.sibling;if(D!==null){D.return=d.return,st=D;break e}st=d.return}}var U=e.current;for(st=U;st!==null;){p=st;var B=p.child;if(p.subtreeFlags&2064&&B!==null)B.return=p,st=B;else e:for(p=U;st!==null;){if(g=st,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:QT(9,g)}}catch(V){Nr(g,g.return,V)}if(g===p){st=null;break e}var z=g.sibling;if(z!==null){z.return=g.return,st=z;break e}st=g.return}}if(mn=l,Ql(),Ms&&typeof Ms.onPostCommitFiberRoot=="function")try{Ms.onPostCommitFiberRoot($T,e)}catch{}o=!0}return o}finally{jn=a,_o.transition=t}}return!1}function ZG(e,t,a){t=Wf(a,t),t=mY(e,t,1),e=Ul(e,t,1),t=Ji(),e!==null&&(sv(e,1,t),Ea(e,t))}function Nr(e,t,a){if(e.tag===3)ZG(e,e,a);else for(;t!==null;){if(t.tag===3){ZG(t,e,a);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(jl===null||!jl.has(o))){e=Wf(a,e),e=gY(t,e,1),t=Ul(t,e,1),e=Ji(),t!==null&&(sv(t,1,e),Ea(t,e));break}}t=t.return}}function u_e(e,t,a){var o=e.pingCache;o!==null&&o.delete(t),t=Ji(),e.pingedLanes|=e.suspendedLanes&a,fi===e&&(wi&a)===a&&(Qr===4||Qr===3&&(wi&130023424)===wi&&500>Ur()-E1?fd(e,0):_1|=a),Ea(e,t)}function MY(e,t){t===0&&(e.mode&1?(t=SS,SS<<=1,!(SS&130023424)&&(SS=4194304)):t=1);var a=Ji();e=Rc(e,t),e!==null&&(sv(e,t,a),Ea(e,a))}function d_e(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),MY(e,a)}function h_e(e,t){var a=0;switch(e.tag){case 13:var o=e.stateNode,l=e.memoizedState;l!==null&&(a=l.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(qe(314))}o!==null&&o.delete(t),MY(e,a)}var UY;UY=function(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps||va.current)ga=!0;else{if(!(e.lanes&a)&&!(t.flags&128))return ga=!1,Zve(e,t,a);ga=!!(e.flags&131072)}else ga=!1,pr&&t.flags&1048576&&F7(t,Sb,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;ab(e,t),e=t.pendingProps;var l=jf(t,Fi.current);If(t,a),l=f1(null,t,o,e,l,a);var d=p1();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_a(o)?(d=!0,_b(t)):d=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,c1(t),l.updater=JT,t.stateNode=l,l._reactInternals=t,BN(t,o,e,a),t=GN(null,t,o,!0,d,a)):(t.tag=0,pr&&d&&t1(t),Yi(null,t,l,a),t=t.child),t;case 16:o=t.elementType;e:{switch(ab(e,t),e=t.pendingProps,l=o._init,o=l(o._payload),t.type=o,l=t.tag=p_e(o),e=Yo(o,e),l){case 0:t=WN(null,t,o,e,a);break e;case 1:t=GG(null,t,o,e,a);break e;case 11:t=FG(null,t,o,e,a);break e;case 14:t=WG(null,t,o,Yo(o.type,e),a);break e}throw Error(qe(306,o,""))}return t;case 0:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:Yo(o,l),WN(e,t,o,l,a);case 1:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:Yo(o,l),GG(e,t,o,l,a);case 3:e:{if(EY(t),e===null)throw Error(qe(387));o=t.pendingProps,d=t.memoizedState,l=d.element,K7(e,t),wb(t,o,null,a);var p=t.memoizedState;if(o=p.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){l=Wf(Error(qe(423)),t),t=$G(e,t,o,a,l);break e}else if(o!==l){l=Wf(Error(qe(424)),t),t=$G(e,t,o,a,l);break e}else for(Va=Ml(t.stateNode.containerInfo.firstChild),Ba=t,pr=!0,Qo=null,a=H7(t,null,o,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Vf(),o===l){t=Oc(e,t,a);break e}Yi(e,t,o,a)}t=t.child}return t;case 5:return q7(t),e===null&&UN(t),o=t.type,l=t.pendingProps,d=e!==null?e.memoizedProps:null,p=l.children,xN(o,l)?p=null:d!==null&&xN(o,d)&&(t.flags|=32),_Y(e,t),Yi(e,t,p,a),t.child;case 6:return e===null&&UN(t),null;case 13:return SY(e,t,a);case 4:return l1(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Bf(t,null,o,a):Yi(e,t,o,a),t.child;case 11:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:Yo(o,l),FG(e,t,o,l,a);case 7:return Yi(e,t,t.pendingProps,a),t.child;case 8:return Yi(e,t,t.pendingProps.children,a),t.child;case 12:return Yi(e,t,t.pendingProps.children,a),t.child;case 10:e:{if(o=t.type._context,l=t.pendingProps,d=t.memoizedProps,p=l.value,Zn(bb,o._currentValue),o._currentValue=p,d!==null)if(is(d.value,p)){if(d.children===l.children&&!va.current){t=Oc(e,t,a);break e}}else for(d=t.child,d!==null&&(d.return=t);d!==null;){var g=d.dependencies;if(g!==null){p=d.child;for(var v=g.firstContext;v!==null;){if(v.context===o){if(d.tag===1){v=Ec(-1,a&-a),v.tag=2;var E=d.updateQueue;if(E!==null){E=E.shared;var T=E.pending;T===null?v.next=v:(v.next=T.next,T.next=v),E.pending=v}}d.lanes|=a,v=d.alternate,v!==null&&(v.lanes|=a),jN(d.return,a,t),g.lanes|=a;break}v=v.next}}else if(d.tag===10)p=d.type===t.type?null:d.child;else if(d.tag===18){if(p=d.return,p===null)throw Error(qe(341));p.lanes|=a,g=p.alternate,g!==null&&(g.lanes|=a),jN(p,a,t),p=d.sibling}else p=d.child;if(p!==null)p.return=d;else for(p=d;p!==null;){if(p===t){p=null;break}if(d=p.sibling,d!==null){d.return=p.return,p=d;break}p=p.return}d=p}Yi(e,t,l.children,a),t=t.child}return t;case 9:return l=t.type,o=t.pendingProps.children,If(t,a),l=So(l),o=o(l),t.flags|=1,Yi(e,t,o,a),t.child;case 14:return o=t.type,l=Yo(o,t.pendingProps),l=Yo(o.type,l),WG(e,t,o,l,a);case 15:return yY(e,t,t.type,t.pendingProps,a);case 17:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:Yo(o,l),ab(e,t),t.tag=1,_a(o)?(e=!0,_b(t)):e=!1,If(t,a),pY(t,o,l),BN(t,o,l,a),GN(null,t,o,!0,e,a);case 19:return bY(e,t,a);case 22:return vY(e,t,a)}throw Error(qe(156,t.tag))};function jY(e,t){return d7(e,t)}function f_e(e,t,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(e,t,a,o){return new f_e(e,t,a,o)}function w1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function p_e(e){if(typeof e=="function")return w1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gx)return 11;if(e===$x)return 14}return 2}function Bl(e,t){var a=e.alternate;return a===null?(a=yo(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function cb(e,t,a,o,l,d){var p=2;if(o=e,typeof e=="function")w1(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case uf:return pd(a.children,l,d,t);case Wx:p=8,l|=8;break;case uN:return e=yo(12,a,t,l|2),e.elementType=uN,e.lanes=d,e;case dN:return e=yo(13,a,t,l),e.elementType=dN,e.lanes=d,e;case hN:return e=yo(19,a,t,l),e.elementType=hN,e.lanes=d,e;case qq:return ew(a,l,d,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case zq:p=10;break e;case Kq:p=9;break e;case Gx:p=11;break e;case $x:p=14;break e;case Sl:p=16,o=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return t=yo(p,a,t,l),t.elementType=e,t.type=o,t.lanes=d,t}function pd(e,t,a,o){return e=yo(7,e,o,t),e.lanes=a,e}function ew(e,t,a,o){return e=yo(22,e,o,t),e.elementType=qq,e.lanes=a,e.stateNode={isHidden:!1},e}function EI(e,t,a){return e=yo(6,e,null,t),e.lanes=a,e}function SI(e,t,a){return t=yo(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function m_e(e,t,a,o,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tI(0),this.expirationTimes=tI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tI(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function C1(e,t,a,o,l,d,p,g,v){return e=new m_e(e,t,a,g,v),t===1?(t=1,d===!0&&(t|=8)):t=0,d=yo(3,null,null,t),e.current=d,d.stateNode=e,d.memoizedState={element:o,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},c1(d),e}function g_e(e,t,a){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:lf,key:o==null?null:""+o,children:e,containerInfo:t,implementation:a}}function VY(e){if(!e)return zl;e=e._reactInternals;e:{if(Id(e)!==e||e.tag!==1)throw Error(qe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_a(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qe(171))}if(e.tag===1){var a=e.type;if(_a(a))return V7(e,a,t)}return t}function BY(e,t,a,o,l,d,p,g,v){return e=C1(a,o,!0,e,l,d,p,g,v),e.context=VY(null),a=e.current,o=Ji(),l=Vl(a),d=Ec(o,l),d.callback=t??null,Ul(a,d,l),e.current.lanes=l,sv(e,l,o),Ea(e,o),e}function tw(e,t,a,o){var l=t.current,d=Ji(),p=Vl(l);return a=VY(a),t.context===null?t.context=a:t.pendingContext=a,t=Ec(d,p),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=Ul(l,t,p),e!==null&&(ns(e,l,p,d),nb(e,l,p)),p}function xb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function e$(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function R1(e,t){e$(e,t),(e=e.alternate)&&e$(e,t)}var FY=typeof reportError=="function"?reportError:function(e){console.error(e)};function O1(e){this._internalRoot=e}nw.prototype.render=O1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(qe(409));tw(e,t,null,null)};nw.prototype.unmount=O1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Td(function(){tw(null,e,null,null)}),t[Cc]=null}};function nw(e){this._internalRoot=e}nw.prototype.unstable_scheduleHydration=function(e){if(e){var t=v7();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Cl.length&&t!==0&&t<Cl[a].priority;a++);Cl.splice(a,0,e),a===0&&E7(e)}};function A1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function t$(){}function y_e(e,t,a,o,l){if(l){if(typeof o=="function"){var d=o;o=function(){var E=xb(p);d.call(E)}}var p=BY(t,o,e,0,null,!1,!1,"",t$);return e._reactRootContainer=p,e[Cc]=p.current,dy(e.nodeType===8?e.parentNode:e),Td(),p}for(;l=e.lastChild;)e.removeChild(l);if(typeof o=="function"){var g=o;o=function(){var E=xb(v);g.call(E)}}var v=C1(e,0,!1,null,null,!1,!1,"",t$);return e._reactRootContainer=v,e[Cc]=v.current,dy(e.nodeType===8?e.parentNode:e),Td(function(){tw(t,v,a,o)}),v}function iw(e,t,a,o,l){var d=a._reactRootContainer;if(d){var p=d;if(typeof l=="function"){var g=l;l=function(){var v=xb(p);g.call(v)}}tw(t,p,e,l)}else p=y_e(a,t,e,l,o);return xb(p)}g7=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var a=Mg(t.pendingLanes);a!==0&&(Kx(t,a|1),Ea(t,Ur()),!(mn&6)&&(Gf=Ur()+500,Ql()))}break;case 13:Td(function(){var o=Rc(e,1);if(o!==null){var l=Ji();ns(o,e,1,l)}}),R1(e,1)}};qx=function(e){if(e.tag===13){var t=Rc(e,134217728);if(t!==null){var a=Ji();ns(t,e,134217728,a)}R1(e,134217728)}};y7=function(e){if(e.tag===13){var t=Vl(e),a=Rc(e,t);if(a!==null){var o=Ji();ns(a,e,t,o)}R1(e,t)}};v7=function(){return jn};_7=function(e,t){var a=jn;try{return jn=e,t()}finally{jn=a}};bN=function(e,t,a){switch(t){case"input":if(mN(e,a),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var o=a[t];if(o!==e&&o.form===e.form){var l=qT(o);if(!l)throw Error(qe(90));Xq(o),mN(o,l)}}}break;case"textarea":Qq(e,a);break;case"select":t=a.value,t!=null&&Cf(e,!!a.multiple,t,!1)}};a7=S1;o7=Td;var v_e={usingClientEntryPoint:!1,Events:[lv,pf,qT,r7,i7,S1]},gg={findFiberByHostInstance:ad,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},__e={bundleType:gg.bundleType,version:gg.version,rendererPackageName:gg.rendererPackageName,rendererConfig:gg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=l7(e),e===null?null:e.stateNode},findFiberByHostInstance:gg.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xS.isDisabled&&xS.supportsFiber)try{$T=xS.inject(__e),Ms=xS}catch{}}Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=v_e;Wa.createPortal=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!A1(t))throw Error(qe(200));return g_e(e,t,null,a)};Wa.createRoot=function(e,t){if(!A1(e))throw Error(qe(299));var a=!1,o="",l=FY;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=C1(e,1,!1,null,null,a,!1,o,l),e[Cc]=t.current,dy(e.nodeType===8?e.parentNode:e),new O1(t)};Wa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=l7(t),e=e===null?null:e.stateNode,e};Wa.flushSync=function(e){return Td(e)};Wa.hydrate=function(e,t,a){if(!rw(t))throw Error(qe(200));return iw(null,e,t,!0,a)};Wa.hydrateRoot=function(e,t,a){if(!A1(e))throw Error(qe(405));var o=a!=null&&a.hydratedSources||null,l=!1,d="",p=FY;if(a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onRecoverableError!==void 0&&(p=a.onRecoverableError)),t=BY(t,null,e,1,a??null,l,!1,d,p),e[Cc]=t.current,dy(e),o)for(e=0;e<o.length;e++)a=o[e],l=a._getVersion,l=l(a._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[a,l]:t.mutableSourceEagerHydrationData.push(a,l);return new nw(t)};Wa.render=function(e,t,a){if(!rw(t))throw Error(qe(200));return iw(null,e,t,!1,a)};Wa.unmountComponentAtNode=function(e){if(!rw(e))throw Error(qe(40));return e._reactRootContainer?(Td(function(){iw(null,null,e,!1,function(){e._reactRootContainer=null,e[Cc]=null})}),!0):!1};Wa.unstable_batchedUpdates=S1;Wa.unstable_renderSubtreeIntoContainer=function(e,t,a,o){if(!rw(a))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return iw(e,t,a,!1,o)};Wa.version="18.3.1-next-f1338f8080-20240426";function WY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WY)}catch(e){console.error(e)}}WY(),Wq.exports=Wa;var Nd=Wq.exports,n$=Nd;cN.createRoot=n$.createRoot,cN.hydrateRoot=n$.hydrateRoot;/**
 * @remix-run/router v1.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ey(){return Ey=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Ey.apply(this,arguments)}var Pl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Pl||(Pl={}));const r$="popstate";function E_e(e){e===void 0&&(e={});function t(o,l){let{pathname:d,search:p,hash:g}=o.location;return tP("",{pathname:d,search:p,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function a(o,l){return typeof l=="string"?l:Db(l)}return b_e(t,a,null,e)}function jr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function GY(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function S_e(){return Math.random().toString(36).substr(2,8)}function i$(e,t){return{usr:e.state,key:e.key,idx:t}}function tP(e,t,a,o){return a===void 0&&(a=null),Ey({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?pp(t):t,{state:a,key:t&&t.key||o||S_e()})}function Db(e){let{pathname:t="/",search:a="",hash:o=""}=e;return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(t+=o.charAt(0)==="#"?o:"#"+o),t}function pp(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}function b_e(e,t,a,o){o===void 0&&(o={});let{window:l=document.defaultView,v5Compat:d=!1}=o,p=l.history,g=Pl.Pop,v=null,E=T();E==null&&(E=0,p.replaceState(Ey({},p.state,{idx:E}),""));function T(){return(p.state||{idx:null}).idx}function b(){g=Pl.Pop;let M=T(),D=M==null?null:M-E;E=M,v&&v({action:g,location:L.location,delta:D})}function R(M,D){g=Pl.Push;let U=tP(L.location,M,D);E=T()+1;let B=i$(U,E),z=L.createHref(U);try{p.pushState(B,"",z)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;l.location.assign(z)}d&&v&&v({action:g,location:L.location,delta:1})}function N(M,D){g=Pl.Replace;let U=tP(L.location,M,D);E=T();let B=i$(U,E),z=L.createHref(U);p.replaceState(B,"",z),d&&v&&v({action:g,location:L.location,delta:0})}function P(M){let D=l.location.origin!=="null"?l.location.origin:l.location.href,U=typeof M=="string"?M:Db(M);return U=U.replace(/ $/,"%20"),jr(D,"No window.location.(origin|href) available to create URL for href: "+U),new URL(U,D)}let L={get action(){return g},get location(){return e(l,p)},listen(M){if(v)throw new Error("A history only accepts one active listener");return l.addEventListener(r$,b),v=M,()=>{l.removeEventListener(r$,b),v=null}},createHref(M){return t(l,M)},createURL:P,encodeLocation(M){let D=P(M);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:R,replace:N,go(M){return p.go(M)}};return L}var a$;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(a$||(a$={}));function T_e(e,t,a){return a===void 0&&(a="/"),w_e(e,t,a)}function w_e(e,t,a,o){let l=typeof t=="string"?pp(t):t,d=I1(l.pathname||"/",a);if(d==null)return null;let p=$Y(e);C_e(p);let g=null;for(let v=0;g==null&&v<p.length;++v){let E=U_e(d);g=L_e(p[v],E)}return g}function $Y(e,t,a,o){t===void 0&&(t=[]),a===void 0&&(a=[]),o===void 0&&(o="");let l=(d,p,g)=>{let v={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};v.relativePath.startsWith("/")&&(jr(v.relativePath.startsWith(o),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(o.length));let E=Fl([o,v.relativePath]),T=a.concat(v);d.children&&d.children.length>0&&(jr(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+E+'".')),$Y(d.children,t,T,E)),!(d.path==null&&!d.index)&&t.push({path:E,score:x_e(E,d.index),routesMeta:T})};return e.forEach((d,p)=>{var g;if(d.path===""||!((g=d.path)!=null&&g.includes("?")))l(d,p);else for(let v of HY(d.path))l(d,p,v)}),t}function HY(e){let t=e.split("/");if(t.length===0)return[];let[a,...o]=t,l=a.endsWith("?"),d=a.replace(/\?$/,"");if(o.length===0)return l?[d,""]:[d];let p=HY(o.join("/")),g=[];return g.push(...p.map(v=>v===""?d:[d,v].join("/"))),l&&g.push(...p),g.map(v=>e.startsWith("/")&&v===""?"/":v)}function C_e(e){e.sort((t,a)=>t.score!==a.score?a.score-t.score:D_e(t.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}const R_e=/^:[\w-]+$/,O_e=3,A_e=2,I_e=1,N_e=10,P_e=-2,o$=e=>e==="*";function x_e(e,t){let a=e.split("/"),o=a.length;return a.some(o$)&&(o+=P_e),t&&(o+=A_e),a.filter(l=>!o$(l)).reduce((l,d)=>l+(R_e.test(d)?O_e:d===""?I_e:N_e),o)}function D_e(e,t){return e.length===t.length&&e.slice(0,-1).every((o,l)=>o===t[l])?e[e.length-1]-t[t.length-1]:0}function L_e(e,t,a){let{routesMeta:o}=e,l={},d="/",p=[];for(let g=0;g<o.length;++g){let v=o[g],E=g===o.length-1,T=d==="/"?t:t.slice(d.length)||"/",b=k_e({path:v.relativePath,caseSensitive:v.caseSensitive,end:E},T),R=v.route;if(!b)return null;Object.assign(l,b.params),p.push({params:l,pathname:Fl([d,b.pathname]),pathnameBase:F_e(Fl([d,b.pathnameBase])),route:R}),b.pathnameBase!=="/"&&(d=Fl([d,b.pathnameBase]))}return p}function k_e(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,o]=M_e(e.path,e.caseSensitive,e.end),l=t.match(a);if(!l)return null;let d=l[0],p=d.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:o.reduce((E,T,b)=>{let{paramName:R,isOptional:N}=T;if(R==="*"){let L=g[b]||"";p=d.slice(0,d.length-L.length).replace(/(.)\/+$/,"$1")}const P=g[b];return N&&!P?E[R]=void 0:E[R]=(P||"").replace(/%2F/g,"/"),E},{}),pathname:d,pathnameBase:p,pattern:e}}function M_e(e,t,a){t===void 0&&(t=!1),a===void 0&&(a=!0),GY(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,g,v)=>(o.push({paramName:g,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),o]}function U_e(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return GY(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function I1(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,o=e.charAt(a);return o&&o!=="/"?null:e.slice(a)||"/"}function j_e(e,t){t===void 0&&(t="/");let{pathname:a,search:o="",hash:l=""}=typeof e=="string"?pp(e):e;return{pathname:a?a.startsWith("/")?a:V_e(a,t):t,search:W_e(o),hash:G_e(l)}}function V_e(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?a.length>1&&a.pop():l!=="."&&a.push(l)}),a.length>1?a.join("/"):"/"}function bI(e,t,a,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function B_e(e){return e.filter((t,a)=>a===0||t.route.path&&t.route.path.length>0)}function N1(e,t){let a=B_e(e);return t?a.map((o,l)=>l===a.length-1?o.pathname:o.pathnameBase):a.map(o=>o.pathnameBase)}function P1(e,t,a,o){o===void 0&&(o=!1);let l;typeof e=="string"?l=pp(e):(l=Ey({},e),jr(!l.pathname||!l.pathname.includes("?"),bI("?","pathname","search",l)),jr(!l.pathname||!l.pathname.includes("#"),bI("#","pathname","hash",l)),jr(!l.search||!l.search.includes("#"),bI("#","search","hash",l)));let d=e===""||l.pathname==="",p=d?"/":l.pathname,g;if(p==null)g=a;else{let b=t.length-1;if(!o&&p.startsWith("..")){let R=p.split("/");for(;R[0]==="..";)R.shift(),b-=1;l.pathname=R.join("/")}g=b>=0?t[b]:"/"}let v=j_e(l,g),E=p&&p!=="/"&&p.endsWith("/"),T=(d||p===".")&&a.endsWith("/");return!v.pathname.endsWith("/")&&(E||T)&&(v.pathname+="/"),v}const Fl=e=>e.join("/").replace(/\/\/+/g,"/"),F_e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),W_e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,G_e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $_e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const zY=["post","put","patch","delete"];new Set(zY);const H_e=["get",...zY];new Set(H_e);/**
 * React Router v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sy(){return Sy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Sy.apply(this,arguments)}const x1=x.createContext(null),z_e=x.createContext(null),Zl=x.createContext(null),aw=x.createContext(null),eu=x.createContext({outlet:null,matches:[],isDataRoute:!1}),KY=x.createContext(null);function K_e(e,t){let{relative:a}=t===void 0?{}:t;mp()||jr(!1);let{basename:o,navigator:l}=x.useContext(Zl),{hash:d,pathname:p,search:g}=YY(e,{relative:a}),v=p;return o!=="/"&&(v=p==="/"?o:Fl([o,p])),l.createHref({pathname:v,search:g,hash:d})}function mp(){return x.useContext(aw)!=null}function gp(){return mp()||jr(!1),x.useContext(aw).location}function qY(e){x.useContext(Zl).static||x.useLayoutEffect(e)}function yp(){let{isDataRoute:e}=x.useContext(eu);return e?oEe():q_e()}function q_e(){mp()||jr(!1);let e=x.useContext(x1),{basename:t,future:a,navigator:o}=x.useContext(Zl),{matches:l}=x.useContext(eu),{pathname:d}=gp(),p=JSON.stringify(N1(l,a.v7_relativeSplatPath)),g=x.useRef(!1);return qY(()=>{g.current=!0}),x.useCallback(function(E,T){if(T===void 0&&(T={}),!g.current)return;if(typeof E=="number"){o.go(E);return}let b=P1(E,JSON.parse(p),d,T.relative==="path");e==null&&t!=="/"&&(b.pathname=b.pathname==="/"?t:Fl([t,b.pathname])),(T.replace?o.replace:o.push)(b,T.state,T)},[t,o,p,d,e])}function YY(e,t){let{relative:a}=t===void 0?{}:t,{future:o}=x.useContext(Zl),{matches:l}=x.useContext(eu),{pathname:d}=gp(),p=JSON.stringify(N1(l,o.v7_relativeSplatPath));return x.useMemo(()=>P1(e,JSON.parse(p),d,a==="path"),[e,p,d,a])}function Y_e(e,t){return X_e(e,t)}function X_e(e,t,a,o){mp()||jr(!1);let{navigator:l,static:d}=x.useContext(Zl),{matches:p}=x.useContext(eu),g=p[p.length-1],v=g?g.params:{};g&&g.pathname;let E=g?g.pathnameBase:"/";g&&g.route;let T=gp(),b;if(t){var R;let D=typeof t=="string"?pp(t):t;E==="/"||(R=D.pathname)!=null&&R.startsWith(E)||jr(!1),b=D}else b=T;let N=b.pathname||"/",P=N;if(E!=="/"){let D=E.replace(/^\//,"").split("/");P="/"+N.replace(/^\//,"").split("/").slice(D.length).join("/")}let L=T_e(e,{pathname:P}),M=tEe(L&&L.map(D=>Object.assign({},D,{params:Object.assign({},v,D.params),pathname:Fl([E,l.encodeLocation?l.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?E:Fl([E,l.encodeLocation?l.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),p,a,o);return t&&M?x.createElement(aw.Provider,{value:{location:Sy({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Pl.Pop}},M):M}function J_e(){let e=aEe(),t=$_e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),a?x.createElement("pre",{style:l},a):null,null)}const Q_e=x.createElement(J_e,null);class Z_e extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){console.error("React Router caught the following error during render",t,a)}render(){return this.state.error!==void 0?x.createElement(eu.Provider,{value:this.props.routeContext},x.createElement(KY.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eEe(e){let{routeContext:t,match:a,children:o}=e,l=x.useContext(x1);return l&&l.static&&l.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=a.route.id),x.createElement(eu.Provider,{value:t},o)}function tEe(e,t,a,o){var l;if(t===void 0&&(t=[]),a===void 0&&(a=null),o===void 0&&(o=null),e==null){var d;if(!a)return null;if(a.errors)e=a.matches;else if((d=o)!=null&&d.v7_partialHydration&&t.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let p=e,g=(l=a)==null?void 0:l.errors;if(g!=null){let T=p.findIndex(b=>b.route.id&&(g==null?void 0:g[b.route.id])!==void 0);T>=0||jr(!1),p=p.slice(0,Math.min(p.length,T+1))}let v=!1,E=-1;if(a&&o&&o.v7_partialHydration)for(let T=0;T<p.length;T++){let b=p[T];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(E=T),b.route.id){let{loaderData:R,errors:N}=a,P=b.route.loader&&R[b.route.id]===void 0&&(!N||N[b.route.id]===void 0);if(b.route.lazy||P){v=!0,E>=0?p=p.slice(0,E+1):p=[p[0]];break}}}return p.reduceRight((T,b,R)=>{let N,P=!1,L=null,M=null;a&&(N=g&&b.route.id?g[b.route.id]:void 0,L=b.route.errorElement||Q_e,v&&(E<0&&R===0?(P=!0,M=null):E===R&&(P=!0,M=b.route.hydrateFallbackElement||null)));let D=t.concat(p.slice(0,R+1)),U=()=>{let B;return N?B=L:P?B=M:b.route.Component?B=x.createElement(b.route.Component,null):b.route.element?B=b.route.element:B=T,x.createElement(eEe,{match:b,routeContext:{outlet:T,matches:D,isDataRoute:a!=null},children:B})};return a&&(b.route.ErrorBoundary||b.route.errorElement||R===0)?x.createElement(Z_e,{location:a.location,revalidation:a.revalidation,component:L,error:N,children:U(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):U()},null)}var XY=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(XY||{}),Lb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Lb||{});function nEe(e){let t=x.useContext(x1);return t||jr(!1),t}function rEe(e){let t=x.useContext(z_e);return t||jr(!1),t}function iEe(e){let t=x.useContext(eu);return t||jr(!1),t}function JY(e){let t=iEe(),a=t.matches[t.matches.length-1];return a.route.id||jr(!1),a.route.id}function aEe(){var e;let t=x.useContext(KY),a=rEe(Lb.UseRouteError),o=JY(Lb.UseRouteError);return t!==void 0?t:(e=a.errors)==null?void 0:e[o]}function oEe(){let{router:e}=nEe(XY.UseNavigateStable),t=JY(Lb.UseNavigateStable),a=x.useRef(!1);return qY(()=>{a.current=!0}),x.useCallback(function(l,d){d===void 0&&(d={}),a.current&&(typeof l=="number"?e.navigate(l):e.navigate(l,Sy({fromRouteId:t},d)))},[e,t])}function sEe(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Sf(e){let{to:t,replace:a,state:o,relative:l}=e;mp()||jr(!1);let{future:d,static:p}=x.useContext(Zl),{matches:g}=x.useContext(eu),{pathname:v}=gp(),E=yp(),T=P1(t,N1(g,d.v7_relativeSplatPath),v,l==="path"),b=JSON.stringify(T);return x.useEffect(()=>E(JSON.parse(b),{replace:a,state:o,relative:l}),[E,b,l,a,o]),null}function li(e){jr(!1)}function cEe(e){let{basename:t="/",children:a=null,location:o,navigationType:l=Pl.Pop,navigator:d,static:p=!1,future:g}=e;mp()&&jr(!1);let v=t.replace(/^\/*/,"/"),E=x.useMemo(()=>({basename:v,navigator:d,static:p,future:Sy({v7_relativeSplatPath:!1},g)}),[v,g,d,p]);typeof o=="string"&&(o=pp(o));let{pathname:T="/",search:b="",hash:R="",state:N=null,key:P="default"}=o,L=x.useMemo(()=>{let M=I1(T,v);return M==null?null:{location:{pathname:M,search:b,hash:R,state:N,key:P},navigationType:l}},[v,T,b,R,N,P,l]);return L==null?null:x.createElement(Zl.Provider,{value:E},x.createElement(aw.Provider,{children:a,value:L}))}function TI(e){let{children:t,location:a}=e;return Y_e(nP(t),a)}new Promise(()=>{});function nP(e,t){t===void 0&&(t=[]);let a=[];return x.Children.forEach(e,(o,l)=>{if(!x.isValidElement(o))return;let d=[...t,l];if(o.type===x.Fragment){a.push.apply(a,nP(o.props.children,d));return}o.type!==li&&jr(!1),!o.props.index||!o.props.children||jr(!1);let p={id:o.props.id||d.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(p.children=nP(o.props.children,d)),a.push(p)}),a}/**
 * React Router DOM v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rP(){return rP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},rP.apply(this,arguments)}function lEe(e,t){if(e==null)return{};var a={},o=Object.keys(e),l,d;for(d=0;d<o.length;d++)l=o[d],!(t.indexOf(l)>=0)&&(a[l]=e[l]);return a}function uEe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function dEe(e,t){return e.button===0&&(!t||t==="_self")&&!uEe(e)}const hEe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],fEe="6";try{window.__reactRouterVersion=fEe}catch{}const pEe="startTransition",s$=uye[pEe];function mEe(e){let{basename:t,children:a,future:o,window:l}=e,d=x.useRef();d.current==null&&(d.current=E_e({window:l,v5Compat:!0}));let p=d.current,[g,v]=x.useState({action:p.action,location:p.location}),{v7_startTransition:E}=o||{},T=x.useCallback(b=>{E&&s$?s$(()=>v(b)):v(b)},[v,E]);return x.useLayoutEffect(()=>p.listen(T),[p,T]),x.useEffect(()=>sEe(o),[o]),x.createElement(cEe,{basename:t,children:a,location:g.location,navigationType:g.action,navigator:p,future:o})}const gEe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yEe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DS=x.forwardRef(function(t,a){let{onClick:o,relative:l,reloadDocument:d,replace:p,state:g,target:v,to:E,preventScrollReset:T,viewTransition:b}=t,R=lEe(t,hEe),{basename:N}=x.useContext(Zl),P,L=!1;if(typeof E=="string"&&yEe.test(E)&&(P=E,gEe))try{let B=new URL(window.location.href),z=E.startsWith("//")?new URL(B.protocol+E):new URL(E),V=I1(z.pathname,N);z.origin===B.origin&&V!=null?E=V+z.search+z.hash:L=!0}catch{}let M=K_e(E,{relative:l}),D=vEe(E,{replace:p,state:g,target:v,preventScrollReset:T,relative:l,viewTransition:b});function U(B){o&&o(B),B.defaultPrevented||D(B)}return x.createElement("a",rP({},R,{href:P||M,onClick:L||d?o:U,ref:a,target:v}))});var c$;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(c$||(c$={}));var l$;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(l$||(l$={}));function vEe(e,t){let{target:a,replace:o,state:l,preventScrollReset:d,relative:p,viewTransition:g}=t===void 0?{}:t,v=yp(),E=gp(),T=YY(e,{relative:p});return x.useCallback(b=>{if(dEe(b,a)){b.preventDefault();let R=o!==void 0?o:Db(E)===Db(T);v(e,{replace:R,state:l,preventScrollReset:d,relative:p,viewTransition:g})}},[E,v,T,o,l,a,e,d,p,g])}const _Ee=[{id:"1",email:"farmer@example.com",password:"password123",name:"John Farmer",type:"farmer"},{id:"2",email:"retailer@example.com",password:"password123",name:"Mike Retailer",type:"retailer"},{id:"3",email:"farmer2@example.com",password:"password123",name:"Sarah Farmer",type:"farmer"},{id:"4",email:"farmer3@example.com",password:"password123",name:"David Farmer",type:"farmer"},{id:"5",email:"retailer2@example.com",password:"password123",name:"Lisa Retailer",type:"retailer"},{id:"6",email:"retailer3@example.com",password:"password123",name:"Tom Retailer",type:"retailer"},{id:"7",email:"admin@example.com",password:"admin123",name:"Admin User",type:"admin"}],QY=x.createContext(void 0),wI="freshchain_user",EEe=({children:e})=>{const[t,a]=x.useState({user:null,isAuthenticated:!1,loading:!0});x.useEffect(()=>{try{const p=localStorage.getItem(wI);if(p){const g=JSON.parse(p);a({user:g,isAuthenticated:!0,loading:!1})}else a(g=>({...g,loading:!1}))}catch(p){console.error("Error loading user data:",p),a(g=>({...g,loading:!1}))}},[]);const o=async p=>{try{await new Promise(E=>setTimeout(E,500));const g=_Ee.find(E=>E.email===p.email&&E.type===p.type&&E.password===p.password);if(!g)throw new Error("Invalid credentials");const v={id:g.id,name:g.name,email:g.email,type:g.type};localStorage.setItem(wI,JSON.stringify(v)),a({user:v,isAuthenticated:!0,loading:!1})}catch(g){throw console.error("Login failed:",g),g}},l=()=>{localStorage.removeItem(wI),a({user:null,isAuthenticated:!1,loading:!1})},d={user:t.user,isAuthenticated:t.isAuthenticated,loading:t.loading,login:o,logout:l};return C.jsx(QY.Provider,{value:d,children:e})},dv=()=>{const e=x.useContext(QY);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},ZY=x.createContext(void 0),u$="freshchain_cart",SEe=({children:e})=>{const[t,a]=x.useState([]);x.useEffect(()=>{const E=localStorage.getItem(u$);E&&a(JSON.parse(E))},[]),x.useEffect(()=>{localStorage.setItem(u$,JSON.stringify(t))},[t]);const o=(E,T)=>{a(b=>b.find(N=>N.id===E.id)?b.map(N=>N.id===E.id?{...N,quantity:N.quantity+T}:N):[...b,{id:E.id,name:E.name,price:E.price,quantity:T,unit:E.unit,farmerName:E.farmerName}])},l=E=>{a(T=>T.filter(b=>b.id!==E))},d=(E,T)=>{a(b=>b.map(R=>R.id===E?{...R,quantity:Math.max(0,T)}:R).filter(R=>R.quantity>0))},p=()=>{a([])},g=()=>t.reduce((E,T)=>E+T.quantity,0),v=()=>t.reduce((E,T)=>E+T.price*T.quantity,0);return C.jsx(ZY.Provider,{value:{items:t,addToCart:o,removeFromCart:l,updateQuantity:d,clearCart:p,getItemCount:g,getTotal:v},children:e})},e9=()=>{const e=x.useContext(ZY);if(e===void 0)throw new Error("useCart must be used within a CartProvider");return e},t9=x.createContext(void 0),bEe=[{id:"1",name:"Fresh Tomatoes",description:"Organically grown tomatoes",price:40,quantity:100,unit:"kg",farmerId:"1",farmerName:"John Farmer",category:"Vegetables",image:"https://example.com/tomatoes.jpg"},{id:"2",name:"Potatoes",description:"Farm fresh potatoes",price:30,quantity:150,unit:"kg",farmerId:"1",farmerName:"John Farmer",category:"Vegetables",image:"https://example.com/potatoes.jpg"}],TEe=({children:e})=>{const[t,a]=x.useState(bEe),o=v=>{const E={...v,id:Date.now().toString()};a(T=>[...T,E])},l=(v,E)=>{a(T=>T.map(b=>b.id===v?{...b,...E}:b))},d=v=>{a(E=>E.filter(T=>T.id!==v))},p=v=>t.filter(E=>E.farmerId===v),g=()=>t;return C.jsx(t9.Provider,{value:{products:t,addProduct:o,updateProduct:l,deleteProduct:d,getProductsByFarmer:p,getAllProducts:g},children:e})},n9=()=>{const e=x.useContext(t9);if(e===void 0)throw new Error("useProducts must be used within a ProductProvider");return e},r9=x.createContext(void 0),wEe=()=>{const e=x.useContext(r9);if(!e)throw new Error("useAdmin must be used within an AdminProvider");return e},CEe=({children:e})=>{const[t,a]=x.useState([]),g={inventory:t,addInventoryItem:v=>{const E={...v,id:Date.now().toString(),lastUpdated:new Date};a([...t,E])},updateInventoryItem:(v,E)=>{a(t.map(T=>T.id===v?{...T,...E,lastUpdated:new Date}:T))},deleteInventoryItem:v=>{a(t.filter(E=>E.id!==v))},getInventoryStats:()=>({totalItems:t.reduce((v,E)=>v+E.quantity,0),totalValue:t.reduce((v,E)=>v+E.price*E.quantity,0),lowStockItems:t.filter(v=>v.quantity<10)})};return C.jsx(r9.Provider,{value:g,children:e})},i9=x.createContext(void 0),REe=()=>{const e=x.useContext(i9);if(!e)throw new Error("useMarketPrices must be used within a MarketPriceProvider");return e},a9=({children:e})=>{const[t,a]=x.useState([]),[o,l]=x.useState(!0),[d,p]=x.useState(null),g=[{crop:"Tonnes Bottle Gourd",price:1300,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.118461"},{crop:"Tonnes Bottle Gourd",price:1200,unit:"al",location:"Davangere",date:"2025-02-01T06:30:40.118521"},{crop:"5 Tonnes Bottle Gourd",price:250,unit:"al",location:"Mysore",date:"2025-02-01T06:30:40.118570"},{crop:"Tonnes Brinjal",price:2900,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.118617"},{crop:"Tonnes Brinjal",price:1500,unit:"al",location:"Chintamani",date:"2025-02-01T06:30:40.118756"},{crop:"Tonnes Brinjal",price:3e3,unit:"al",location:"Ramanagara",date:"2025-02-01T06:30:40.118958"},{crop:"Tonnes Brinjal",price:1900,unit:"al",location:"Shimoga",date:"2025-02-01T06:30:40.119050"},{crop:"9 Tonnes Brinjal",price:1900,unit:"al",location:"Mysore",date:"2025-02-01T06:30:40.118846"},{crop:"Tonnes Cabbage",price:900,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.119094"},{crop:"Tonnes Cabbage",price:800,unit:"al",location:"Davangere",date:"2025-02-01T06:30:40.119185"},{crop:"Tonnes Cabbage",price:800,unit:"al",location:"Ramanagara",date:"2025-02-01T06:30:40.119276"},{crop:"Tonnes Cabbage",price:1383,unit:"al",location:"Santhesargur",date:"2025-02-01T06:30:40.119321"},{crop:"Tonnes Cabbage",price:400,unit:"al",location:"Shimoga",date:"2025-02-01T06:30:40.119365"},{crop:"Tonnes Carrot",price:4400,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.119682"},{crop:"Tonnes Carrot",price:2500,unit:"al",location:"Chintamani",date:"2025-02-01T06:30:40.119788"},{crop:"Tonnes Carrot",price:3500,unit:"al",location:"Davangere",date:"2025-02-01T06:30:40.119837"},{crop:"Tonnes Carrot",price:3950,unit:"al",location:"Hoskote",date:"2025-02-01T06:30:40.119883"},{crop:"Tonnes Carrot",price:3e3,unit:"al",location:"Ramanagara",date:"2025-02-01T06:30:40.119985"},{crop:"Tonnes Tomato",price:1100,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.125525"},{crop:"Tonnes Tomato",price:500,unit:"al",location:"Davangere",date:"2025-02-01T06:30:40.125615"},{crop:"Tonnes Tomato",price:1500,unit:"al",location:"Gundlupet",date:"2025-02-01T06:30:40.125659"},{crop:"Tonnes Tomato",price:1800,unit:"al",location:"Ramanagara",date:"2025-02-01T06:30:40.125882"},{crop:"Tonnes Tomato",price:800,unit:"al",location:"Shimoga",date:"2025-02-01T06:30:40.126200"},{crop:"Tonnes Green Chilly",price:4400,unit:"al",location:"Bangalore",date:"2025-02-01T06:30:40.122078"},{crop:"Tonnes Green Chilly",price:3e3,unit:"al",location:"Chintamani",date:"2025-02-01T06:30:40.122205"},{crop:"Tonnes Green Chilly",price:2500,unit:"al",location:"Davangere",date:"2025-02-01T06:30:40.122434"},{crop:"Tonnes Green Chilly",price:3400,unit:"al",location:"Gundlupet",date:"2025-02-01T06:30:40.122491"},{crop:"Tonnes Green Chilly",price:5e3,unit:"al",location:"Ramanagara",date:"2025-02-01T06:30:40.122646"}],v=()=>{l(!0);try{a(g),p(null)}catch{p("Failed to fetch market prices")}finally{l(!1)}};return x.useEffect(()=>{v()},[]),C.jsx(i9.Provider,{value:{priceData:t,loading:o,error:d,refreshPrices:v},children:e})},CI=({children:e,allowedUserTypes:t})=>{const{user:a,isAuthenticated:o,loading:l}=dv(),d=gp();return l?C.jsx("div",{className:"flex items-center justify-center min-h-screen",children:C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):o?a&&!t.includes(a.type)?C.jsx(Sf,{to:"/unauthorized",replace:!0}):C.jsx(C.Fragment,{children:e}):C.jsx(Sf,{to:"/login",state:{from:d},replace:!0})},OEe=()=>{const[e,t]=x.useState(""),[a,o]=x.useState(""),[l,d]=x.useState("retailer"),[p,g]=x.useState(""),{login:v}=dv(),E=yp(),T=async b=>{b.preventDefault(),g("");try{switch(await v({email:e,password:a,type:l}),l){case"farmer":E("/farmer/dashboard");break;case"retailer":E("/retailer/shop");break;case"admin":E("/admin");break}}catch{g("Failed to login. Please check your credentials.")}};return C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50",children:C.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-10 rounded-2xl shadow-xl",children:[C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"flex items-center justify-center mb-4",children:C.jsx("svg",{className:"w-12 h-12 text-green-500",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:C.jsx("path",{d:"M12.75 2.75c-3.17 0-5.75 2.58-5.75 5.75 0 2.01 1.03 3.77 2.59 4.78l-.29 6.72h6.9l-.29-6.72c1.56-1.01 2.59-2.77 2.59-4.78 0-3.17-2.58-5.75-5.75-5.75zm0 9.5c-2.07 0-3.75-1.68-3.75-3.75s1.68-3.75 3.75-3.75 3.75 1.68 3.75 3.75-1.68 3.75-3.75 3.75z"})})}),C.jsx("h2",{className:"text-4xl font-extrabold text-gray-900 tracking-tight mb-2",children:"FreshChain"}),C.jsx("p",{className:"text-sm text-gray-600 mb-8",children:"Connecting Farmers and Retailers"})]}),C.jsxs("form",{className:"mt-8 space-y-6",onSubmit:T,children:[p&&C.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:C.jsxs("div",{className:"flex",children:[C.jsx("div",{className:"flex-shrink-0",children:C.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:C.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),C.jsx("div",{className:"ml-3",children:C.jsx("p",{className:"text-sm text-red-700",children:p})})]})}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"email-address",className:"block text-sm font-medium text-gray-700",children:"Email address"}),C.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 block w-full px-4 py-3 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter your email",value:e,onChange:b=>t(b.target.value)})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),C.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"mt-1 block w-full px-4 py-3 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter your password",value:a,onChange:b=>o(b.target.value)})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"I am a:"}),C.jsxs("select",{value:l,onChange:b=>d(b.target.value),className:"mt-1 block w-full px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[C.jsx("option",{value:"retailer",children:"Retailer"}),C.jsx("option",{value:"farmer",children:"Farmer"}),C.jsx("option",{value:"admin",children:"Admin"})]})]})]}),C.jsx("div",{children:C.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200",children:"Sign in"})})]}),C.jsx("div",{className:"mt-6",children:C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"absolute inset-0 flex items-center",children:C.jsx("div",{className:"w-full border-t border-gray-300"})}),C.jsx("div",{className:"relative flex justify-center text-sm",children:C.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Sustainable Agriculture, Connected Future"})})]})})]})})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var AEe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IEe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Tt=(e,t)=>{const a=x.forwardRef(({color:o="currentColor",size:l=24,strokeWidth:d=2,absoluteStrokeWidth:p,className:g="",children:v,...E},T)=>x.createElement("svg",{ref:T,...AEe,width:l,height:l,stroke:o,strokeWidth:p?Number(d)*24/Number(l):d,className:["lucide",`lucide-${IEe(e)}`,g].join(" "),...E},[...t.map(([b,R])=>x.createElement(b,R)),...Array.isArray(v)?v:[v]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NEe=Tt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=Tt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PEe=Tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=Tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h$=Tt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xEe=Tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DEe=Tt("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=Tt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=Tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LEe=Tt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=Tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=Tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kEe=Tt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MEe=Tt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UEe=Tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jEe=Tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VEe=Tt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BEe=Tt("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FEe=Tt("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WEe=Tt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=Tt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GEe=Tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ee=Tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Tt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HEe=Tt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zEe=Tt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KEe=Tt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=Tt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Tt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qEe=Tt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YEe=Tt("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XEe=Tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=Tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=Tt("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JEe=Tt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=Tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QEe=Tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=Tt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=Tt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZEe=Tt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eSe=Tt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tSe=Tt("Tractor",[["path",{d:"m10 11 11 .9c.6 0 .9.5.8 1.1l-.8 5h-1",key:"2w242w"}],["path",{d:"M16 18h-5",key:"bq60fd"}],["path",{d:"M18 5a1 1 0 0 0-1 1v5.573",key:"1kv8ia"}],["path",{d:"M3 4h9l1 7.246",key:"d639it"}],["path",{d:"M4 11V4",key:"9ft8pt"}],["path",{d:"M7 15h.01",key:"k5ht0j"}],["path",{d:"M8 10.1V4",key:"1jgyzo"}],["circle",{cx:"18",cy:"18",r:"2",key:"1emm8v"}],["circle",{cx:"7",cy:"15",r:"5",key:"ddtuc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=Tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nSe=Tt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rSe=Tt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=Tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=Tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iSe=Tt("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=Tt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aSe=Tt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=Tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var m9={exports:{}};(function(e,t){(function(a,o){e.exports=o()})(Al,function(){function a(n,r){return r.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(s){if(s!=="default"&&!(s in n)){var c=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(n,s,c.get?c:{enumerable:!0,get:function(){return i[s]}})}})}),Object.freeze(n)}var o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Al<"u"?Al:typeof self<"u"?self:{};function l(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var d=function(n){try{return!!n()}catch{return!0}},p=!d(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),g=p,v=Function.prototype,E=v.call,T=g&&v.bind.bind(E,E),b=g?T:function(n){return function(){return E.apply(n,arguments)}},R=b({}.isPrototypeOf),N=function(n){return n&&n.Math===Math&&n},P=N(typeof globalThis=="object"&&globalThis)||N(typeof window=="object"&&window)||N(typeof self=="object"&&self)||N(typeof o=="object"&&o)||N(typeof o=="object"&&o)||function(){return this}()||Function("return this")(),L=p,M=Function.prototype,D=M.apply,U=M.call,B=typeof Reflect=="object"&&Reflect.apply||(L?U.bind(D):function(){return U.apply(D,arguments)}),z=b,V=z({}.toString),G=z("".slice),q=function(n){return G(V(n),8,-1)},ne=q,Z=b,le=function(n){if(ne(n)==="Function")return Z(n)},ee=typeof document=="object"&&document.all,ce=ee===void 0&&ee!==void 0?function(n){return typeof n=="function"||n===ee}:function(n){return typeof n=="function"},be={},ae=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),fe=p,me=Function.prototype.call,_e=fe?me.bind(me):function(){return me.apply(me,arguments)},ue={},ve={}.propertyIsEnumerable,Ce=Object.getOwnPropertyDescriptor,Ve=Ce&&!ve.call({1:2},1);ue.f=Ve?function(n){var r=Ce(this,n);return!!r&&r.enumerable}:ve;var Pe,Ge,nt=function(n,r){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:r}},Re=d,wt=q,It=Object,lt=b("".split),ze=Re(function(){return!It("z").propertyIsEnumerable(0)})?function(n){return wt(n)==="String"?lt(n,""):It(n)}:It,He=function(n){return n==null},tt=He,Be=TypeError,zt=function(n){if(tt(n))throw new Be("Can't call method on "+n);return n},Wt=ze,Ct=zt,Tn=function(n){return Wt(Ct(n))},xr=ce,Bn=function(n){return typeof n=="object"?n!==null:xr(n)},er={},Ro=er,Ri=P,$a=ce,Oo=function(n){return $a(n)?n:void 0},gr=function(n,r){return arguments.length<2?Oo(Ro[n])||Oo(Ri[n]):Ro[n]&&Ro[n][r]||Ri[n]&&Ri[n][r]},kc=P.navigator,Lp=kc&&kc.userAgent,ea=Lp?String(Lp):"",kp=P,Mc=ea,Mp=kp.process,ou=kp.Deno,Up=Mp&&Mp.versions||ou&&ou.version,su=Up&&Up.v8;su&&(Ge=(Pe=su.split("."))[0]>0&&Pe[0]<4?1:+(Pe[0]+Pe[1])),!Ge&&Mc&&(!(Pe=Mc.match(/Edge\/(\d+)/))||Pe[1]>=74)&&(Pe=Mc.match(/Chrome\/(\d+)/))&&(Ge=+Pe[1]);var ss=Ge,cu=ss,Ev=d,kd=P.String,Gs=!!Object.getOwnPropertySymbols&&!Ev(function(){var n=Symbol("symbol detection");return!kd(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&cu&&cu<41}),lu=Gs&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Sv=gr,bv=ce,Tv=R,Md=Object,Uc=lu?function(n){return typeof n=="symbol"}:function(n){var r=Sv("Symbol");return bv(r)&&Tv(r.prototype,Md(n))},Ud=String,$s=function(n){try{return Ud(n)}catch{return"Object"}},jd=ce,wv=$s,Xw=TypeError,Vr=function(n){if(jd(n))return n;throw new Xw(wv(n)+" is not a function")},Lt=Vr,EZ=He,Cv=function(n,r){var i=n[r];return EZ(i)?void 0:Lt(i)},YD=_e,XD=ce,JD=Bn,SZ=TypeError,QD={exports:{}},bZ=!0,ZD=P,TZ=Object.defineProperty,wZ=P,CZ=function(n,r){try{TZ(ZD,n,{value:r,configurable:!0,writable:!0})}catch{ZD[n]=r}return r},eL="__core-js_shared__",tL=QD.exports=wZ[eL]||CZ(eL,{});(tL.versions||(tL.versions=[])).push({version:"3.39.0",mode:"pure",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Jw=QD.exports,nL=Jw,Vd=function(n,r){return nL[n]||(nL[n]=r||{})},RZ=zt,OZ=Object,cs=function(n){return OZ(RZ(n))},AZ=cs,IZ=b({}.hasOwnProperty),Dr=Object.hasOwn||function(n,r){return IZ(AZ(n),r)},NZ=b,PZ=0,xZ=Math.random(),DZ=NZ(1 .toString),Qw=function(n){return"Symbol("+(n===void 0?"":n)+")_"+DZ(++PZ+xZ,36)},LZ=Vd,rL=Dr,kZ=Qw,MZ=Gs,UZ=lu,Bd=P.Symbol,Zw=LZ("wks"),jZ=UZ?Bd.for||Bd:Bd&&Bd.withoutSetter||kZ,Fn=function(n){return rL(Zw,n)||(Zw[n]=MZ&&rL(Bd,n)?Bd[n]:jZ("Symbol."+n)),Zw[n]},VZ=_e,iL=Bn,aL=Uc,BZ=Cv,FZ=function(n,r){var i,s;if(XD(i=n.toString)&&!JD(s=YD(i,n))||XD(i=n.valueOf)&&!JD(s=YD(i,n)))return s;throw new SZ("Can't convert object to primitive value")},WZ=TypeError,GZ=Fn("toPrimitive"),$Z=function(n,r){if(!iL(n)||aL(n))return n;var i,s=BZ(n,GZ);if(s){if(i=VZ(s,n,r),!iL(i)||aL(i))return i;throw new WZ("Can't convert object to primitive value")}return FZ(n)},HZ=Uc,eC=function(n){var r=$Z(n,"string");return HZ(r)?r:r+""},oL=Bn,tC=P.document,zZ=oL(tC)&&oL(tC.createElement),nC=function(n){return zZ?tC.createElement(n):{}},KZ=nC,sL=!ae&&!d(function(){return Object.defineProperty(KZ("div"),"a",{get:function(){return 7}}).a!==7}),qZ=ae,YZ=_e,XZ=ue,JZ=nt,QZ=Tn,ZZ=eC,eee=Dr,tee=sL,cL=Object.getOwnPropertyDescriptor;be.f=qZ?cL:function(n,r){if(n=QZ(n),r=ZZ(r),tee)try{return cL(n,r)}catch{}if(eee(n,r))return JZ(!YZ(XZ.f,n,r),n[r])};var nee=d,ree=ce,iee=/#|\.prototype\./,jp=function(n,r){var i=oee[aee(n)];return i===cee||i!==see&&(ree(r)?nee(r):!!r)},aee=jp.normalize=function(n){return String(n).replace(iee,".").toLowerCase()},oee=jp.data={},see=jp.NATIVE="N",cee=jp.POLYFILL="P",lL=jp,lee=Vr,uee=p,dee=le(le.bind),jc=function(n,r){return lee(n),r===void 0?n:uee?dee(n,r):function(){return n.apply(r,arguments)}},Ha={},uL=ae&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),hee=Bn,fee=String,pee=TypeError,Wi=function(n){if(hee(n))return n;throw new pee(fee(n)+" is not an object")},mee=ae,gee=sL,yee=uL,Rv=Wi,dL=eC,vee=TypeError,rC=Object.defineProperty,_ee=Object.getOwnPropertyDescriptor,iC="enumerable",aC="configurable",oC="writable";Ha.f=mee?yee?function(n,r,i){if(Rv(n),r=dL(r),Rv(i),typeof n=="function"&&r==="prototype"&&"value"in i&&oC in i&&!i[oC]){var s=_ee(n,r);s&&s[oC]&&(n[r]=i.value,i={configurable:aC in i?i[aC]:s[aC],enumerable:iC in i?i[iC]:s[iC],writable:!1})}return rC(n,r,i)}:rC:function(n,r,i){if(Rv(n),r=dL(r),Rv(i),gee)try{return rC(n,r,i)}catch{}if("get"in i||"set"in i)throw new vee("Accessors not supported");return"value"in i&&(n[r]=i.value),n};var Eee=Ha,See=nt,uu=ae?function(n,r,i){return Eee.f(n,r,See(1,i))}:function(n,r,i){return n[r]=i,n},Vp=P,bee=B,Tee=le,wee=ce,Cee=be.f,Ree=lL,Fd=er,Oee=jc,Wd=uu,hL=Dr,Aee=function(n){var r=function(i,s,c){if(this instanceof r){switch(arguments.length){case 0:return new n;case 1:return new n(i);case 2:return new n(i,s)}return new n(i,s,c)}return bee(n,this,arguments)};return r.prototype=n.prototype,r},kt=function(n,r){var i,s,c,u,h,f,m,y,_,S=n.target,w=n.global,O=n.stat,W=n.proto,k=w?Vp:O?Vp[S]:Vp[S]&&Vp[S].prototype,j=w?Fd:Fd[S]||Wd(Fd,S,{})[S],H=j.prototype;for(u in r)s=!(i=Ree(w?u:S+(O?".":"#")+u,n.forced))&&k&&hL(k,u),f=j[u],s&&(m=n.dontCallGetSet?(_=Cee(k,u))&&_.value:k[u]),h=s&&m?m:r[u],(i||W||typeof f!=typeof h)&&(y=n.bind&&s?Oee(h,Vp):n.wrap&&s?Aee(h):W&&wee(h)?Tee(h):h,(n.sham||h&&h.sham||f&&f.sham)&&Wd(y,"sham",!0),Wd(j,u,y),W&&(hL(Fd,c=S+"Prototype")||Wd(Fd,c,{}),Wd(Fd[c],u,h),n.real&&H&&(i||!H[u])&&Wd(H,u,h)))},Iee=Math.ceil,Nee=Math.floor,Pee=Math.trunc||function(n){var r=+n;return(r>0?Nee:Iee)(r)},xee=Pee,sC=function(n){var r=+n;return r!=r||r===0?0:xee(r)},Dee=sC,Lee=Math.max,kee=Math.min,cC=function(n,r){var i=Dee(n);return i<0?Lee(i+r,0):kee(i,r)},Mee=sC,Uee=Math.min,fL=function(n){var r=Mee(n);return r>0?Uee(r,9007199254740991):0},jee=fL,Vc=function(n){return jee(n.length)},Vee=Tn,Bee=cC,Fee=Vc,pL=function(n){return function(r,i,s){var c=Vee(r),u=Fee(c);if(u===0)return!n&&-1;var h,f=Bee(s,u);if(n&&i!=i){for(;u>f;)if((h=c[f++])!=h)return!0}else for(;u>f;f++)if((n||f in c)&&c[f]===i)return n||f||0;return!n&&-1}},lC={includes:pL(!0),indexOf:pL(!1)},Wee=lC.includes;kt({target:"Array",proto:!0,forced:d(function(){return!Array(1).includes()})},{includes:function(n){return Wee(this,n,arguments.length>1?arguments[1]:void 0)}});var Gee=P,$ee=er,za=function(n,r){var i=$ee[n+"Prototype"],s=i&&i[r];if(s)return s;var c=Gee[n],u=c&&c.prototype;return u&&u[r]},Hee=za("Array","includes"),zee=Bn,Kee=q,qee=Fn("match"),mL=function(n){var r;return zee(n)&&((r=n[qee])!==void 0?!!r:Kee(n)==="RegExp")},Yee=mL,Xee=TypeError,gL={};gL[Fn("toStringTag")]="z";var uC=String(gL)==="[object z]",Jee=uC,Qee=ce,Ov=q,Zee=Fn("toStringTag"),ete=Object,tte=Ov(function(){return arguments}())==="Arguments",Hs=Jee?Ov:function(n){var r,i,s;return n===void 0?"Undefined":n===null?"Null":typeof(i=function(c,u){try{return c[u]}catch{}}(r=ete(n),Zee))=="string"?i:tte?Ov(r):(s=Ov(r))==="Object"&&Qee(r.callee)?"Arguments":s},nte=Hs,rte=String,ta=function(n){if(nte(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return rte(n)},ite=Fn("match"),ate=kt,ote=function(n){if(Yee(n))throw new Xee("The method doesn't accept regular expressions");return n},ste=zt,yL=ta,cte=function(n){var r=/./;try{"/./"[n](r)}catch{try{return r[ite]=!1,"/./"[n](r)}catch{}}return!1},lte=b("".indexOf);ate({target:"String",proto:!0,forced:!cte("includes")},{includes:function(n){return!!~lte(yL(ste(this)),yL(ote(n)),arguments.length>1?arguments[1]:void 0)}});var ute=za("String","includes"),vL=R,dte=Hee,hte=ute,dC=Array.prototype,hC=String.prototype,fte=function(n){var r=n.includes;return n===dC||vL(dC,n)&&r===dC.includes?dte:typeof n=="string"||n===hC||vL(hC,n)&&r===hC.includes?hte:r},Oe=l(fte),pte=Vr,mte=cs,gte=ze,yte=Vc,_L=TypeError,EL="Reduce of empty array with no initial value",SL=function(n){return function(r,i,s,c){var u=mte(r),h=gte(u),f=yte(u);if(pte(i),f===0&&s<2)throw new _L(EL);var m=n?f-1:0,y=n?-1:1;if(s<2)for(;;){if(m in h){c=h[m],m+=y;break}if(m+=y,n?m<0:f<=m)throw new _L(EL)}for(;n?m>=0:f>m;m+=y)m in h&&(c=i(c,h[m],m,u));return c}},vte={left:SL(!1),right:SL(!0)},_te=d,Av=function(n,r){var i=[][n];return!!i&&_te(function(){i.call(null,r||function(){return 1},1)})},Bp=P,Ete=ea,Ste=q,Iv=function(n){return Ete.slice(0,n.length)===n},fC=Iv("Bun/")?"BUN":Iv("Cloudflare-Workers")?"CLOUDFLARE":Iv("Deno/")?"DENO":Iv("Node.js/")?"NODE":Bp.Bun&&typeof Bun.version=="string"?"BUN":Bp.Deno&&typeof Deno.version=="object"?"DENO":Ste(Bp.process)==="process"?"NODE":Bp.window&&Bp.document?"BROWSER":"REST",Nv=fC==="NODE",bte=vte.left;kt({target:"Array",proto:!0,forced:!Nv&&ss>79&&ss<83||!Av("reduce")},{reduce:function(n){var r=arguments.length;return bte(this,n,r,r>1?arguments[1]:void 0)}});var Tte=za("Array","reduce"),wte=R,Cte=Tte,pC=Array.prototype,Rte=function(n){var r=n.reduce;return n===pC||wte(pC,n)&&r===pC.reduce?Cte:r},bL=Rte,Ao=l(bL),Ote=q,Fp=Array.isArray||function(n){return Ote(n)==="Array"},Ate=kt,Ite=Fp,Nte=b([].reverse),TL=[1,2];Ate({target:"Array",proto:!0,forced:String(TL)===String(TL.reverse())},{reverse:function(){return Ite(this)&&(this.length=this.length),Nte(this)}});var Pte=za("Array","reverse"),xte=R,Dte=Pte,mC=Array.prototype,Lte=function(n){var r=n.reverse;return n===mC||xte(mC,n)&&r===mC.reverse?Dte:r},wL=Lte,CL=l(wL),kte=Qw,RL=Vd("keys"),Pv=function(n){return RL[n]||(RL[n]=kte(n))},Mte=!d(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}),Ute=Dr,jte=ce,Vte=cs,Bte=Mte,OL=Pv("IE_PROTO"),gC=Object,Fte=gC.prototype,yC=Bte?gC.getPrototypeOf:function(n){var r=Vte(n);if(Ute(r,OL))return r[OL];var i=r.constructor;return jte(i)&&r instanceof i?i.prototype:r instanceof gC?Fte:null},Wte=b,Gte=Vr,$te=Bn,Hte=function(n){return $te(n)||n===null},zte=String,Kte=TypeError,qte=function(n,r,i){try{return Wte(Gte(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Yte=Bn,Xte=zt,Jte=function(n){if(Hte(n))return n;throw new Kte("Can't set "+zte(n)+" as a prototype")},Qte=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,i={};try{(n=qte(Object.prototype,"__proto__","set"))(i,[]),r=i instanceof Array}catch{}return function(s,c){return Xte(s),Jte(c),Yte(s)&&(r?n(s,c):s.__proto__=c),s}}():void 0),xv={},Dv={},vC=Dr,Zte=Tn,ene=lC.indexOf,tne=Dv,AL=b([].push),IL=function(n,r){var i,s=Zte(n),c=0,u=[];for(i in s)!vC(tne,i)&&vC(s,i)&&AL(u,i);for(;r.length>c;)vC(s,i=r[c++])&&(~ene(u,i)||AL(u,i));return u},_C=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],nne=IL,rne=_C.concat("length","prototype");xv.f=Object.getOwnPropertyNames||function(n){return nne(n,rne)};var Wp={};Wp.f=Object.getOwnPropertySymbols;var ine=gr,ane=xv,one=Wp,sne=Wi,cne=b([].concat),lne=ine("Reflect","ownKeys")||function(n){var r=ane.f(sne(n)),i=one.f;return i?cne(r,i(n)):r},NL=Dr,une=lne,dne=be,hne=Ha,EC={},fne=IL,pne=_C,Lv=Object.keys||function(n){return fne(n,pne)},mne=ae,gne=uL,yne=Ha,vne=Wi,_ne=Tn,Ene=Lv;EC.f=mne&&!gne?Object.defineProperties:function(n,r){vne(n);for(var i,s=_ne(r),c=Ene(r),u=c.length,h=0;u>h;)yne.f(n,i=c[h++],s[i]);return n};var kv,PL=gr("document","documentElement"),Sne=Wi,bne=EC,xL=_C,Tne=Dv,wne=PL,Cne=nC,SC="prototype",bC="script",DL=Pv("IE_PROTO"),TC=function(){},LL=function(n){return"<"+bC+">"+n+"</"+bC+">"},kL=function(n){n.write(LL("")),n.close();var r=n.parentWindow.Object;return n=null,r},Mv=function(){try{kv=new ActiveXObject("htmlfile")}catch{}var n,r,i;Mv=typeof document<"u"?document.domain&&kv?kL(kv):(r=Cne("iframe"),i="java"+bC+":",r.style.display="none",wne.appendChild(r),r.src=String(i),(n=r.contentWindow.document).open(),n.write(LL("document.F=Object")),n.close(),n.F):kL(kv);for(var s=xL.length;s--;)delete Mv[SC][xL[s]];return Mv()};Tne[DL]=!0;var Gp=Object.create||function(n,r){var i;return n!==null?(TC[SC]=Sne(n),i=new TC,TC[SC]=null,i[DL]=n):i=Mv(),r===void 0?i:bne.f(i,r)},Rne=Bn,One=uu,ML=Error,Ane=b("".replace),Ine=String(new ML("zxcasd").stack),UL=/\n\s*at [^:]*:[^\n]*/,Nne=UL.test(Ine),Pne=nt,xne=!d(function(){var n=new Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",Pne(1,7)),n.stack!==7)}),Dne=uu,Lne=function(n,r){if(Nne&&typeof n=="string"&&!ML.prepareStackTrace)for(;r--;)n=Ane(n,UL,"");return n},kne=xne,jL=Error.captureStackTrace,du={},Mne=du,Une=Fn("iterator"),jne=Array.prototype,VL=function(n){return n!==void 0&&(Mne.Array===n||jne[Une]===n)},Vne=Hs,BL=Cv,Bne=He,Fne=du,Wne=Fn("iterator"),Uv=function(n){if(!Bne(n))return BL(n,Wne)||BL(n,"@@iterator")||Fne[Vne(n)]},Gne=_e,$ne=Vr,Hne=Wi,zne=$s,Kne=Uv,qne=TypeError,wC=function(n,r){var i=arguments.length<2?Kne(n):r;if($ne(i))return Hne(Gne(i,n));throw new qne(zne(n)+" is not iterable")},Yne=_e,FL=Wi,Xne=Cv,WL=function(n,r,i){var s,c;FL(n);try{if(!(s=Xne(n,"return"))){if(r==="throw")throw i;return i}s=Yne(s,n)}catch(u){c=!0,s=u}if(r==="throw")throw i;if(c)throw s;return FL(s),i},Jne=jc,Qne=_e,Zne=Wi,ere=$s,tre=VL,nre=Vc,GL=R,rre=wC,ire=Uv,$L=WL,are=TypeError,jv=function(n,r){this.stopped=n,this.result=r},HL=jv.prototype,$p=function(n,r,i){var s,c,u,h,f,m,y,_=i&&i.that,S=!(!i||!i.AS_ENTRIES),w=!(!i||!i.IS_RECORD),O=!(!i||!i.IS_ITERATOR),W=!(!i||!i.INTERRUPTED),k=Jne(r,_),j=function(K){return s&&$L(s,"normal",K),new jv(!0,K)},H=function(K){return S?(Zne(K),W?k(K[0],K[1],j):k(K[0],K[1])):W?k(K,j):k(K)};if(w)s=n.iterator;else if(O)s=n;else{if(!(c=ire(n)))throw new are(ere(n)+" is not iterable");if(tre(c)){for(u=0,h=nre(n);h>u;u++)if((f=H(n[u]))&&GL(HL,f))return f;return new jv(!1)}s=rre(n,c)}for(m=w?n.next:s.next;!(y=Qne(m,s)).done;){try{f=H(y.value)}catch(K){$L(s,"throw",K)}if(typeof f=="object"&&f&&GL(HL,f))return f}return new jv(!1)},ore=ta,sre=kt,cre=R,lre=yC,Vv=Qte,ure=function(n,r,i){for(var s=une(r),c=hne.f,u=dne.f,h=0;h<s.length;h++){var f=s[h];NL(n,f)||NL(i,f)||c(n,f,u(r,f))}},zL=Gp,CC=uu,RC=nt,dre=function(n,r){Rne(r)&&"cause"in r&&One(n,"cause",r.cause)},hre=function(n,r,i,s){kne&&(jL?jL(n,r):Dne(n,"stack",Lne(i,s)))},fre=$p,pre=function(n,r){return n===void 0?arguments.length<2?"":r:ore(n)},mre=Fn("toStringTag"),Bv=Error,gre=[].push,Gd=function(n,r){var i,s=cre(OC,this);Vv?i=Vv(new Bv,s?lre(this):OC):(i=s?this:zL(OC),CC(i,mre,"Error")),r!==void 0&&CC(i,"message",pre(r)),hre(i,Gd,i.stack,1),arguments.length>2&&dre(i,arguments[2]);var c=[];return fre(n,gre,{that:c}),CC(i,"errors",c),i};Vv?Vv(Gd,Bv):ure(Gd,Bv,{name:!0});var OC=Gd.prototype=zL(Bv.prototype,{constructor:RC(1,Gd),message:RC(1,""),name:RC(1,"AggregateError")});sre({global:!0,constructor:!0,arity:2},{AggregateError:Gd});var Fv,Hp,Wv,yre=ce,KL=P.WeakMap,vre=yre(KL)&&/native code/.test(String(KL)),qL=P,_re=Bn,Ere=uu,AC=Dr,IC=Jw,Sre=Pv,bre=Dv,YL="Object already initialized",NC=qL.TypeError,Tre=qL.WeakMap;if(vre||IC.state){var ls=IC.state||(IC.state=new Tre);ls.get=ls.get,ls.has=ls.has,ls.set=ls.set,Fv=function(n,r){if(ls.has(n))throw new NC(YL);return r.facade=n,ls.set(n,r),r},Hp=function(n){return ls.get(n)||{}},Wv=function(n){return ls.has(n)}}else{var $d=Sre("state");bre[$d]=!0,Fv=function(n,r){if(AC(n,$d))throw new NC(YL);return r.facade=n,Ere(n,$d,r),r},Hp=function(n){return AC(n,$d)?n[$d]:{}},Wv=function(n){return AC(n,$d)}}var hu,XL,JL,fu={set:Fv,get:Hp,has:Wv,enforce:function(n){return Wv(n)?Hp(n):Fv(n,{})},getterFor:function(n){return function(r){var i;if(!_re(r)||(i=Hp(r)).type!==n)throw new NC("Incompatible receiver, "+n+" required");return i}}},PC=ae,wre=Dr,QL=Function.prototype,Cre=PC&&Object.getOwnPropertyDescriptor,xC=wre(QL,"name"),ZL={EXISTS:xC,PROPER:xC&&(function(){}).name==="something",CONFIGURABLE:xC&&(!PC||PC&&Cre(QL,"name").configurable)},Rre=uu,Bc=function(n,r,i,s){return s&&s.enumerable?n[r]=i:Rre(n,r,i),n},Ore=d,Are=ce,Ire=Bn,Nre=Gp,ek=yC,Pre=Bc,DC=Fn("iterator"),tk=!1;[].keys&&("next"in(JL=[].keys())?(XL=ek(ek(JL)))!==Object.prototype&&(hu=XL):tk=!0);var xre=!Ire(hu)||Ore(function(){var n={};return hu[DC].call(n)!==n});Are((hu=xre?{}:Nre(hu))[DC])||Pre(hu,DC,function(){return this});var nk={IteratorPrototype:hu,BUGGY_SAFARI_ITERATORS:tk},Dre=Hs,Lre=uC?{}.toString:function(){return"[object "+Dre(this)+"]"},kre=uC,Mre=Ha.f,Ure=uu,jre=Dr,Vre=Lre,rk=Fn("toStringTag"),zs=function(n,r,i,s){var c=i?n:n&&n.prototype;c&&(jre(c,rk)||Mre(c,rk,{configurable:!0,value:r}),s&&!kre&&Ure(c,"toString",Vre))},Bre=nk.IteratorPrototype,Fre=Gp,Wre=nt,Gre=zs,$re=du,Hre=function(){return this},LC=function(n,r,i,s){var c=r+" Iterator";return n.prototype=Fre(Bre,{next:Wre(+!s,i)}),Gre(n,c,!1,!0),$re[c]=Hre,n},zre=kt,Kre=_e,qre=ZL,Yre=LC,Xre=yC,Jre=zs,ik=Bc,ak=du,Qre=nk,Zre=qre.PROPER,Gv=Qre.BUGGY_SAFARI_ITERATORS,kC=Fn("iterator"),ok="keys",$v="values",sk="entries",eie=function(){return this},ck=function(n,r,i,s,c,u,h){Yre(i,r,s);var f,m,y,_=function(H){if(H===c&&k)return k;if(!Gv&&H&&H in O)return O[H];switch(H){case ok:case $v:case sk:return function(){return new i(this,H)}}return function(){return new i(this)}},S=r+" Iterator",w=!1,O=n.prototype,W=O[kC]||O["@@iterator"]||c&&O[c],k=!Gv&&W||_(c),j=r==="Array"&&O.entries||W;if(j&&(f=Xre(j.call(new n)))!==Object.prototype&&f.next&&(Jre(f,S,!0,!0),ak[S]=eie),Zre&&c===$v&&W&&W.name!==$v&&(w=!0,k=function(){return Kre(W,this)}),c)if(m={values:_($v),keys:u?k:_(ok),entries:_(sk)},h)for(y in m)(Gv||w||!(y in O))&&ik(O,y,m[y]);else zre({target:r,proto:!0,forced:Gv||w},m);return h&&O[kC]!==k&&ik(O,kC,k,{name:c}),ak[r]=k,m},Hv=function(n,r){return{value:n,done:r}},tie=Tn,lk=du,uk=fu;Ha.f;var nie=ck,zv=Hv,dk="Array Iterator",rie=uk.set,iie=uk.getterFor(dk);nie(Array,"Array",function(n,r){rie(this,{type:dk,target:tie(n),index:0,kind:r})},function(){var n=iie(this),r=n.target,i=n.index++;if(!r||i>=r.length)return n.target=null,zv(void 0,!0);switch(n.kind){case"keys":return zv(i,!1);case"values":return zv(r[i],!1)}return zv([i,r[i]],!1)},"values"),lk.Arguments=lk.Array;var aie=Ha,Kv=function(n,r,i){return aie.f(n,r,i)},oie=gr,sie=Kv,cie=ae,hk=Fn("species"),lie=R,uie=TypeError,MC=function(n,r){if(lie(r,n))return n;throw new uie("Incorrect invocation")},die=ce,UC=Jw,hie=b(Function.toString);die(UC.inspectSource)||(UC.inspectSource=function(n){return hie(n)});var fk=UC.inspectSource,fie=b,pie=d,pk=ce,mie=Hs,gie=fk,mk=function(){},gk=gr("Reflect","construct"),jC=/^\s*(?:class|function)\b/,yie=fie(jC.exec),vie=!jC.test(mk),zp=function(n){if(!pk(n))return!1;try{return gk(mk,[],n),!0}catch{return!1}},yk=function(n){if(!pk(n))return!1;switch(mie(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return vie||!!yie(jC,gie(n))}catch{return!0}};yk.sham=!0;var Kp,Hd,vk,VC,qv=!gk||pie(function(){var n;return zp(zp.call)||!zp(Object)||!zp(function(){n=!0})||n})?yk:zp,_ie=qv,Eie=$s,Sie=TypeError,_k=Wi,bie=function(n){if(_ie(n))return n;throw new Sie(Eie(n)+" is not a constructor")},Tie=He,wie=Fn("species"),BC=function(n,r){var i,s=_k(n).constructor;return s===void 0||Tie(i=_k(s)[wie])?r:bie(i)},Fc=b([].slice),Cie=TypeError,pu=function(n,r){if(n<r)throw new Cie("Not enough arguments");return n},Ek=/(?:ipad|iphone|ipod).*applewebkit/i.test(ea),ba=P,Rie=B,Oie=jc,Sk=ce,Aie=Dr,bk=d,Tk=PL,Iie=Fc,wk=nC,Nie=pu,Pie=Ek,xie=Nv,FC=ba.setImmediate,WC=ba.clearImmediate,Die=ba.process,GC=ba.Dispatch,Lie=ba.Function,Ck=ba.MessageChannel,kie=ba.String,$C=0,qp={},Rk="onreadystatechange";bk(function(){Kp=ba.location});var HC=function(n){if(Aie(qp,n)){var r=qp[n];delete qp[n],r()}},zC=function(n){return function(){HC(n)}},Ok=function(n){HC(n.data)},Ak=function(n){ba.postMessage(kie(n),Kp.protocol+"//"+Kp.host)};FC&&WC||(FC=function(n){Nie(arguments.length,1);var r=Sk(n)?n:Lie(n),i=Iie(arguments,1);return qp[++$C]=function(){Rie(r,void 0,i)},Hd($C),$C},WC=function(n){delete qp[n]},xie?Hd=function(n){Die.nextTick(zC(n))}:GC&&GC.now?Hd=function(n){GC.now(zC(n))}:Ck&&!Pie?(VC=(vk=new Ck).port2,vk.port1.onmessage=Ok,Hd=Oie(VC.postMessage,VC)):ba.addEventListener&&Sk(ba.postMessage)&&!ba.importScripts&&Kp&&Kp.protocol!=="file:"&&!bk(Ak)?(Hd=Ak,ba.addEventListener("message",Ok,!1)):Hd=Rk in wk("script")?function(n){Tk.appendChild(wk("script"))[Rk]=function(){Tk.removeChild(this),HC(n)}}:function(n){setTimeout(zC(n),0)});var Yv={set:FC,clear:WC},Ik=P,Mie=ae,Uie=Object.getOwnPropertyDescriptor,Nk=function(n){if(!Mie)return Ik[n];var r=Uie(Ik,n);return r&&r.value},Pk=function(){this.head=null,this.tail=null};Pk.prototype={add:function(n){var r={item:n,next:null},i=this.tail;i?i.next=r:this.head=r,this.tail=r},get:function(){var n=this.head;if(n)return(this.head=n.next)===null&&(this.tail=null),n.item}};var zd,KC,qC,YC,xk,Dk=Pk,jie=/ipad|iphone|ipod/i.test(ea)&&typeof Pebble<"u",Vie=/web0s(?!.*chrome)/i.test(ea),Kd=P,Bie=Nk,Lk=jc,XC=Yv.set,Fie=Dk,Wie=Ek,Gie=jie,$ie=Vie,JC=Nv,kk=Kd.MutationObserver||Kd.WebKitMutationObserver,Mk=Kd.document,Uk=Kd.process,Xv=Kd.Promise,QC=Bie("queueMicrotask");if(!QC){var Jv=new Fie,Qv=function(){var n,r;for(JC&&(n=Uk.domain)&&n.exit();r=Jv.get();)try{r()}catch(i){throw Jv.head&&zd(),i}n&&n.enter()};Wie||JC||$ie||!kk||!Mk?!Gie&&Xv&&Xv.resolve?((YC=Xv.resolve(void 0)).constructor=Xv,xk=Lk(YC.then,YC),zd=function(){xk(Qv)}):JC?zd=function(){Uk.nextTick(Qv)}:(XC=Lk(XC,Kd),zd=function(){XC(Qv)}):(KC=!0,qC=Mk.createTextNode(""),new kk(Qv).observe(qC,{characterData:!0}),zd=function(){qC.data=KC=!KC}),QC=function(n){Jv.head||zd(),Jv.add(n)}}var jk=QC,qd=function(n){try{return{error:!1,value:n()}}catch(r){return{error:!0,value:r}}},mu=P.Promise,Hie=P,Yp=mu,zie=ce,Kie=lL,qie=fk,Yie=Fn,Vk=fC,ZC=ss,Bk=Yp&&Yp.prototype,Xie=Yie("species"),Fk=!1,Wk=zie(Hie.PromiseRejectionEvent),Jie=Kie("Promise",function(){var n=qie(Yp),r=n!==String(Yp);if(!r&&ZC===66||!Bk.catch||!Bk.finally)return!0;if(!ZC||ZC<51||!/native code/.test(n)){var i=new Yp(function(c){c(1)}),s=function(c){c(function(){},function(){})};if((i.constructor={})[Xie]=s,!(Fk=i.then(function(){})instanceof s))return!0}return!(r||Vk!=="BROWSER"&&Vk!=="DENO"||Wk)}),Xp={CONSTRUCTOR:Jie,REJECTION_EVENT:Wk,SUBCLASSING:Fk},us={},Gk=Vr,Qie=TypeError,Zie=function(n){var r,i;this.promise=new n(function(s,c){if(r!==void 0||i!==void 0)throw new Qie("Bad Promise constructor");r=s,i=c}),this.resolve=Gk(r),this.reject=Gk(i)};us.f=function(n){return new Zie(n)};var eR,$k,eae=kt,Zv=Nv,Wc=P,Jp=_e,tae=Bc,nae=zs,rae=function(n){var r=oie(n);cie&&r&&!r[hk]&&sie(r,hk,{configurable:!0,get:function(){return this}})},iae=Vr,tR=ce,aae=Bn,oae=MC,sae=BC,Hk=Yv.set,nR=jk,cae=function(n,r){try{arguments.length===1?console.error(n):console.error(n,r)}catch{}},lae=qd,uae=Dk,zk=fu,rR=mu,Kk=Xp,qk=us,e_="Promise",Yk=Kk.CONSTRUCTOR,dae=Kk.REJECTION_EVENT,iR=zk.getterFor(e_),hae=zk.set,fae=rR&&rR.prototype,Qp=rR,aR=fae,Xk=Wc.TypeError,oR=Wc.document,sR=Wc.process,cR=qk.f,pae=cR,mae=!!(oR&&oR.createEvent&&Wc.dispatchEvent),Jk="unhandledrejection",Qk=function(n){var r;return!(!aae(n)||!tR(r=n.then))&&r},Zk=function(n,r){var i,s,c,u=r.value,h=r.state===1,f=h?n.ok:n.fail,m=n.resolve,y=n.reject,_=n.domain;try{f?(h||(r.rejection===2&&yae(r),r.rejection=1),f===!0?i=u:(_&&_.enter(),i=f(u),_&&(_.exit(),c=!0)),i===n.promise?y(new Xk("Promise-chain cycle")):(s=Qk(i))?Jp(s,i,m,y):m(i)):y(u)}catch(S){_&&!c&&_.exit(),y(S)}},eM=function(n,r){n.notified||(n.notified=!0,nR(function(){for(var i,s=n.reactions;i=s.get();)Zk(i,n);n.notified=!1,r&&!n.rejection&&gae(n)}))},tM=function(n,r,i){var s,c;mae?((s=oR.createEvent("Event")).promise=r,s.reason=i,s.initEvent(n,!1,!0),Wc.dispatchEvent(s)):s={promise:r,reason:i},!dae&&(c=Wc["on"+n])?c(s):n===Jk&&cae("Unhandled promise rejection",i)},gae=function(n){Jp(Hk,Wc,function(){var r,i=n.facade,s=n.value;if(nM(n)&&(r=lae(function(){Zv?sR.emit("unhandledRejection",s,i):tM(Jk,i,s)}),n.rejection=Zv||nM(n)?2:1,r.error))throw r.value})},nM=function(n){return n.rejection!==1&&!n.parent},yae=function(n){Jp(Hk,Wc,function(){var r=n.facade;Zv?sR.emit("rejectionHandled",r):tM("rejectionhandled",r,n.value)})},Yd=function(n,r,i){return function(s){n(r,s,i)}},Xd=function(n,r,i){n.done||(n.done=!0,i&&(n=i),n.value=r,n.state=2,eM(n,!0))},lR=function(n,r,i){if(!n.done){n.done=!0,i&&(n=i);try{if(n.facade===r)throw new Xk("Promise can't be resolved itself");var s=Qk(r);s?nR(function(){var c={done:!1};try{Jp(s,r,Yd(lR,c,n),Yd(Xd,c,n))}catch(u){Xd(c,u,n)}}):(n.value=r,n.state=1,eM(n,!1))}catch(c){Xd({done:!1},c,n)}}};Yk&&(aR=(Qp=function(n){oae(this,aR),iae(n),Jp(eR,this);var r=iR(this);try{n(Yd(lR,r),Yd(Xd,r))}catch(i){Xd(r,i)}}).prototype,(eR=function(n){hae(this,{type:e_,done:!1,notified:!1,parent:!1,reactions:new uae,rejection:!1,state:0,value:null})}).prototype=tae(aR,"then",function(n,r){var i=iR(this),s=cR(sae(this,Qp));return i.parent=!0,s.ok=!tR(n)||n,s.fail=tR(r)&&r,s.domain=Zv?sR.domain:void 0,i.state===0?i.reactions.add(s):nR(function(){Zk(s,i)}),s.promise}),$k=function(){var n=new eR,r=iR(n);this.promise=n,this.resolve=Yd(lR,r),this.reject=Yd(Xd,r)},qk.f=cR=function(n){return n===Qp||n===void 0?new $k(n):pae(n)}),eae({global:!0,constructor:!0,wrap:!0,forced:Yk},{Promise:Qp}),nae(Qp,e_,!1,!0),rae(e_);var rM=Fn("iterator"),iM=!1;try{var vae=0,aM={next:function(){return{done:!!vae++}},return:function(){iM=!0}};aM[rM]=function(){return this},Array.from(aM,function(){throw 2})}catch{}var _ae=mu,Eae=function(n,r){try{if(!r&&!iM)return!1}catch{return!1}var i=!1;try{var s={};s[rM]=function(){return{next:function(){return{done:i=!0}}}},n(s)}catch{}return i},t_=Xp.CONSTRUCTOR||!Eae(function(n){_ae.all(n).then(void 0,function(){})}),Sae=_e,bae=Vr,Tae=us,wae=qd,Cae=$p;kt({target:"Promise",stat:!0,forced:t_},{all:function(n){var r=this,i=Tae.f(r),s=i.resolve,c=i.reject,u=wae(function(){var h=bae(r.resolve),f=[],m=0,y=1;Cae(n,function(_){var S=m++,w=!1;y++,Sae(h,r,_).then(function(O){w||(w=!0,f[S]=O,--y||s(f))},c)}),--y||s(f)});return u.error&&c(u.value),i.promise}});var Rae=kt,Oae=Xp.CONSTRUCTOR;mu&&mu.prototype,Rae({target:"Promise",proto:!0,forced:Oae,real:!0},{catch:function(n){return this.then(void 0,n)}});var Aae=_e,Iae=Vr,Nae=us,Pae=qd,xae=$p;kt({target:"Promise",stat:!0,forced:t_},{race:function(n){var r=this,i=Nae.f(r),s=i.reject,c=Pae(function(){var u=Iae(r.resolve);xae(n,function(h){Aae(u,r,h).then(i.resolve,s)})});return c.error&&s(c.value),i.promise}});var Dae=us;kt({target:"Promise",stat:!0,forced:Xp.CONSTRUCTOR},{reject:function(n){var r=Dae.f(this);return(0,r.reject)(n),r.promise}});var Lae=Wi,kae=Bn,Mae=us,oM=function(n,r){if(Lae(n),kae(r)&&r.constructor===n)return r;var i=Mae.f(n);return(0,i.resolve)(r),i.promise},Uae=kt,jae=mu,Vae=Xp.CONSTRUCTOR,Bae=oM,Fae=gr("Promise"),Wae=!Vae;Uae({target:"Promise",stat:!0,forced:!0},{resolve:function(n){return Bae(Wae&&this===Fae?jae:this,n)}});var Gae=_e,$ae=Vr,Hae=us,zae=qd,Kae=$p;kt({target:"Promise",stat:!0,forced:t_},{allSettled:function(n){var r=this,i=Hae.f(r),s=i.resolve,c=i.reject,u=zae(function(){var h=$ae(r.resolve),f=[],m=0,y=1;Kae(n,function(_){var S=m++,w=!1;y++,Gae(h,r,_).then(function(O){w||(w=!0,f[S]={status:"fulfilled",value:O},--y||s(f))},function(O){w||(w=!0,f[S]={status:"rejected",reason:O},--y||s(f))})}),--y||s(f)});return u.error&&c(u.value),i.promise}});var qae=_e,Yae=Vr,Xae=gr,Jae=us,Qae=qd,Zae=$p,sM="No one promise resolved";kt({target:"Promise",stat:!0,forced:t_},{any:function(n){var r=this,i=Xae("AggregateError"),s=Jae.f(r),c=s.resolve,u=s.reject,h=Qae(function(){var f=Yae(r.resolve),m=[],y=0,_=1,S=!1;Zae(n,function(w){var O=y++,W=!1;_++,qae(f,r,w).then(function(k){W||S||(S=!0,c(k))},function(k){W||S||(W=!0,m[O]=k,--_||u(new i(m,sM)))})}),--_||u(new i(m,sM))});return h.error&&u(h.value),s.promise}});var eoe=kt,toe=B,noe=Fc,roe=us,ioe=Vr,cM=qd,uR=P.Promise,lM=!1;eoe({target:"Promise",stat:!0,forced:!uR||!uR.try||cM(function(){uR.try(function(n){lM=n===8},8)}).error||!lM},{try:function(n){var r=arguments.length>1?noe(arguments,1):[],i=roe.f(this),s=cM(function(){return toe(ioe(n),void 0,r)});return(s.error?i.reject:i.resolve)(s.value),i.promise}});var aoe=us;kt({target:"Promise",stat:!0},{withResolvers:function(){var n=aoe.f(this);return{promise:n.promise,resolve:n.resolve,reject:n.reject}}});var ooe=kt,dR=mu,soe=d,coe=gr,loe=ce,uoe=BC,uM=oM,doe=dR&&dR.prototype;ooe({target:"Promise",proto:!0,real:!0,forced:!!dR&&soe(function(){doe.finally.call({then:function(){}},function(){})})},{finally:function(n){var r=uoe(this,coe("Promise")),i=loe(n);return this.then(i?function(s){return uM(r,n()).then(function(){return s})}:n,i?function(s){return uM(r,n()).then(function(){throw s})}:n)}});var hR=b,hoe=sC,foe=ta,poe=zt,moe=hR("".charAt),dM=hR("".charCodeAt),goe=hR("".slice),hM=function(n){return function(r,i){var s,c,u=foe(poe(r)),h=hoe(i),f=u.length;return h<0||h>=f?n?"":void 0:(s=dM(u,h))<55296||s>56319||h+1===f||(c=dM(u,h+1))<56320||c>57343?n?moe(u,h):s:n?goe(u,h,h+2):c-56320+(s-55296<<10)+65536}},fR={codeAt:hM(!1),charAt:hM(!0)},yoe=fR.charAt,voe=ta,fM=fu,_oe=ck,pM=Hv,mM="String Iterator",Eoe=fM.set,Soe=fM.getterFor(mM);_oe(String,"String",function(n){Eoe(this,{type:mM,string:voe(n),index:0})},function(){var n,r=Soe(this),i=r.string,s=r.index;return s>=i.length?pM(void 0,!0):(n=yoe(i,s),r.index+=n.length,pM(n,!1))});var boe=er.Promise,Toe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},woe=P,Coe=zs,gM=du;for(var pR in Toe)Coe(woe[pR],pR),gM[pR]=gM.Array;var yM=boe,Ie=l(yM),Roe=za("Array","values"),Ooe=Hs,Aoe=Dr,Ioe=R,Noe=Roe,mR=Array.prototype,Poe={DOMTokenList:!0,NodeList:!0},xoe=function(n){var r=n.values;return n===mR||Ioe(mR,n)&&r===mR.values||Aoe(Poe,Ooe(n))?Noe:r},na=l(xoe),Doe=kt,Loe=b,koe=cC,Moe=RangeError,vM=String.fromCharCode,_M=String.fromCodePoint,Uoe=Loe([].join);Doe({target:"String",stat:!0,arity:1,forced:!!_M&&_M.length!==1},{fromCodePoint:function(n){for(var r,i=[],s=arguments.length,c=0;s>c;){if(r=+arguments[c++],koe(r,1114111)!==r)throw new Moe(r+" is not a valid code point");i[c]=r<65536?vM(r):vM(55296+((r-=65536)>>10),r%1024+56320)}return Uoe(i,"")}});var joe=d,Voe=bZ,Boe=Fn("iterator"),n_=!joe(function(){var n=new URL("b?a=1&b=2&c=3","https://a"),r=n.searchParams,i=new URLSearchParams("a=1&a=2&b=3"),s="";return n.pathname="c%20d",r.forEach(function(c,u){r.delete("b"),s+=u+c}),i.delete("a",2),i.delete("b",void 0),!n.toJSON||!i.has("a",1)||i.has("a",2)||!i.has("a",void 0)||i.has("b")||!r.size&&Voe||!r.sort||n.href!=="https://a/c%20d?a=1&c=3"||r.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!r[Boe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||s!=="a1c3"||new URL("https://x",void 0).host!=="x"}),Foe=Bc,EM=Fc,Woe=Math.floor,gR=function(n,r){var i=n.length;if(i<8)for(var s,c,u=1;u<i;){for(c=u,s=n[u];c&&r(n[c-1],s)>0;)n[c]=n[--c];c!==u++&&(n[c]=s)}else for(var h=Woe(i/2),f=gR(EM(n,0,h),r),m=gR(EM(n,h),r),y=f.length,_=m.length,S=0,w=0;S<y||w<_;)n[S+w]=S<y&&w<_?r(f[S],m[w])<=0?f[S++]:m[w++]:S<y?f[S++]:m[w++];return n},SM=gR,yR=kt,bM=P,vR=Nk,Goe=gr,r_=_e,Io=b,Zp=ae,TM=n_,wM=Bc,$oe=Kv,Hoe=function(n,r,i){for(var s in r)i.unsafe&&n[s]?n[s]=r[s]:Foe(n,s,r[s],i);return n},zoe=zs,Koe=LC,_R=fu,CM=MC,ER=ce,qoe=Dr,Yoe=jc,Xoe=Hs,Joe=Wi,RM=Bn,Gi=ta,Qoe=Gp,OM=nt,AM=wC,Zoe=Uv,i_=Hv,Jd=pu,ese=SM,tse=Fn("iterator"),Qd="URLSearchParams",IM=Qd+"Iterator",NM=_R.set,Ka=_R.getterFor(Qd),nse=_R.getterFor(IM),PM=vR("fetch"),a_=vR("Request"),em=vR("Headers"),SR=a_&&a_.prototype,xM=em&&em.prototype,rse=bM.TypeError,ise=bM.encodeURIComponent,ase=String.fromCharCode,ose=Goe("String","fromCodePoint"),sse=parseInt,o_=Io("".charAt),DM=Io([].join),Gc=Io([].push),LM=Io("".replace),cse=Io([].shift),kM=Io([].splice),MM=Io("".split),UM=Io("".slice),lse=Io(/./.exec),use=/\+/g,dse=/^[0-9a-f]+$/i,jM=function(n,r){var i=UM(n,r,r+2);return lse(dse,i)?sse(i,16):NaN},hse=function(n){for(var r=0,i=128;i>0&&n&i;i>>=1)r++;return r},fse=function(n){var r=null;switch(n.length){case 1:r=n[0];break;case 2:r=(31&n[0])<<6|63&n[1];break;case 3:r=(15&n[0])<<12|(63&n[1])<<6|63&n[2];break;case 4:r=(7&n[0])<<18|(63&n[1])<<12|(63&n[2])<<6|63&n[3]}return r>1114111?null:r},VM=function(n){for(var r=(n=LM(n,use," ")).length,i="",s=0;s<r;){var c=o_(n,s);if(c==="%"){if(o_(n,s+1)==="%"||s+3>r){i+="%",s++;continue}var u=jM(n,s+1);if(u!=u){i+=c,s++;continue}s+=2;var h=hse(u);if(h===0)c=ase(u);else{if(h===1||h>4){i+="",s++;continue}for(var f=[u],m=1;m<h&&!(++s+3>r||o_(n,s)!=="%");){var y=jM(n,s+1);if(y!=y){s+=3;break}if(y>191||y<128)break;Gc(f,y),s+=2,m++}if(f.length!==h){i+="";continue}var _=fse(f);_===null?i+="":c=ose(_)}}i+=c,s++}return i},pse=/[!'()~]|%20/g,mse={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},gse=function(n){return mse[n]},BM=function(n){return LM(ise(n),pse,gse)},bR=Koe(function(n,r){NM(this,{type:IM,target:Ka(n).entries,index:0,kind:r})},Qd,function(){var n=nse(this),r=n.target,i=n.index++;if(!r||i>=r.length)return n.target=null,i_(void 0,!0);var s=r[i];switch(n.kind){case"keys":return i_(s.key,!1);case"values":return i_(s.value,!1)}return i_([s.key,s.value],!1)},!0),FM=function(n){this.entries=[],this.url=null,n!==void 0&&(RM(n)?this.parseObject(n):this.parseQuery(typeof n=="string"?o_(n,0)==="?"?UM(n,1):n:Gi(n)))};FM.prototype={type:Qd,bindURL:function(n){this.url=n,this.update()},parseObject:function(n){var r,i,s,c,u,h,f,m=this.entries,y=Zoe(n);if(y)for(i=(r=AM(n,y)).next;!(s=r_(i,r)).done;){if(u=(c=AM(Joe(s.value))).next,(h=r_(u,c)).done||(f=r_(u,c)).done||!r_(u,c).done)throw new rse("Expected sequence with length 2");Gc(m,{key:Gi(h.value),value:Gi(f.value)})}else for(var _ in n)qoe(n,_)&&Gc(m,{key:_,value:Gi(n[_])})},parseQuery:function(n){if(n)for(var r,i,s=this.entries,c=MM(n,"&"),u=0;u<c.length;)(r=c[u++]).length&&(i=MM(r,"="),Gc(s,{key:VM(cse(i)),value:VM(DM(i,"="))}))},serialize:function(){for(var n,r=this.entries,i=[],s=0;s<r.length;)n=r[s++],Gc(i,BM(n.key)+"="+BM(n.value));return DM(i,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var s_=function(){CM(this,Zd);var n=NM(this,new FM(arguments.length>0?arguments[0]:void 0));Zp||(this.size=n.entries.length)},Zd=s_.prototype;if(Hoe(Zd,{append:function(n,r){var i=Ka(this);Jd(arguments.length,2),Gc(i.entries,{key:Gi(n),value:Gi(r)}),Zp||this.length++,i.updateURL()},delete:function(n){for(var r=Ka(this),i=Jd(arguments.length,1),s=r.entries,c=Gi(n),u=i<2?void 0:arguments[1],h=u===void 0?u:Gi(u),f=0;f<s.length;){var m=s[f];if(m.key!==c||h!==void 0&&m.value!==h)f++;else if(kM(s,f,1),h!==void 0)break}Zp||(this.size=s.length),r.updateURL()},get:function(n){var r=Ka(this).entries;Jd(arguments.length,1);for(var i=Gi(n),s=0;s<r.length;s++)if(r[s].key===i)return r[s].value;return null},getAll:function(n){var r=Ka(this).entries;Jd(arguments.length,1);for(var i=Gi(n),s=[],c=0;c<r.length;c++)r[c].key===i&&Gc(s,r[c].value);return s},has:function(n){for(var r=Ka(this).entries,i=Jd(arguments.length,1),s=Gi(n),c=i<2?void 0:arguments[1],u=c===void 0?c:Gi(c),h=0;h<r.length;){var f=r[h++];if(f.key===s&&(u===void 0||f.value===u))return!0}return!1},set:function(n,r){var i=Ka(this);Jd(arguments.length,1);for(var s,c=i.entries,u=!1,h=Gi(n),f=Gi(r),m=0;m<c.length;m++)(s=c[m]).key===h&&(u?kM(c,m--,1):(u=!0,s.value=f));u||Gc(c,{key:h,value:f}),Zp||(this.size=c.length),i.updateURL()},sort:function(){var n=Ka(this);ese(n.entries,function(r,i){return r.key>i.key?1:-1}),n.updateURL()},forEach:function(n){for(var r,i=Ka(this).entries,s=Yoe(n,arguments.length>1?arguments[1]:void 0),c=0;c<i.length;)s((r=i[c++]).value,r.key,this)},keys:function(){return new bR(this,"keys")},values:function(){return new bR(this,"values")},entries:function(){return new bR(this,"entries")}},{enumerable:!0}),wM(Zd,tse,Zd.entries,{name:"entries"}),wM(Zd,"toString",function(){return Ka(this).serialize()},{enumerable:!0}),Zp&&$oe(Zd,"size",{get:function(){return Ka(this).entries.length},configurable:!0,enumerable:!0}),zoe(s_,Qd),yR({global:!0,constructor:!0,forced:!TM},{URLSearchParams:s_}),!TM&&ER(em)){var yse=Io(xM.has),vse=Io(xM.set),WM=function(n){if(RM(n)){var r,i=n.body;if(Xoe(i)===Qd)return r=n.headers?new em(n.headers):new em,yse(r,"content-type")||vse(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Qoe(n,{body:OM(0,Gi(i)),headers:OM(0,r)})}return n};if(ER(PM)&&yR({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(n){return PM(n,arguments.length>1?WM(arguments[1]):{})}}),ER(a_)){var TR=function(n){return CM(this,SR),new a_(n,arguments.length>1?WM(arguments[1]):{})};SR.constructor=TR,TR.prototype=SR,yR({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:TR})}}var qa,_se={URLSearchParams:s_,getState:Ka},Ese=er.URLSearchParams,GM=ae,Sse=b,bse=_e,Tse=d,wR=Lv,wse=Wp,Cse=ue,Rse=cs,Ose=ze,eh=Object.assign,$M=Object.defineProperty,Ase=Sse([].concat),Ise=!eh||Tse(function(){if(GM&&eh({b:1},eh($M({},"a",{enumerable:!0,get:function(){$M(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var n={},r={},i=Symbol("assign detection"),s="abcdefghijklmnopqrst";return n[i]=7,s.split("").forEach(function(c){r[c]=c}),eh({},n)[i]!==7||wR(eh({},r)).join("")!==s})?function(n,r){for(var i=Rse(n),s=arguments.length,c=1,u=wse.f,h=Cse.f;s>c;)for(var f,m=Ose(arguments[c++]),y=u?Ase(wR(m),u(m)):wR(m),_=y.length,S=0;_>S;)f=y[S++],GM&&!bse(h,m,f)||(i[f]=m[f]);return i}:eh,Nse=Wi,Pse=WL,xse=ae,Dse=Ha,Lse=nt,CR=function(n,r,i){xse?Dse.f(n,r,Lse(0,i)):n[r]=i},kse=jc,Mse=_e,Use=cs,jse=function(n,r,i,s){try{return s?r(Nse(i)[0],i[1]):r(i)}catch(c){Pse(n,"throw",c)}},Vse=VL,Bse=qv,Fse=Vc,HM=CR,Wse=wC,Gse=Uv,zM=Array,gu=b,RR=2147483647,$se=/[^\0-\u007E]/,KM=/[.\u3002\uFF0E\uFF61]/g,qM="Overflow: input needs wider integers to process",YM=RangeError,Hse=gu(KM.exec),th=Math.floor,OR=String.fromCharCode,XM=gu("".charCodeAt),JM=gu([].join),$c=gu([].push),zse=gu("".replace),Kse=gu("".split),qse=gu("".toLowerCase),QM=function(n){return n+22+75*(n<26)},Yse=function(n,r,i){var s=0;for(n=i?th(n/700):n>>1,n+=th(n/r);n>455;)n=th(n/35),s+=36;return th(s+36*n/(n+38))},Xse=function(n){var r=[];n=function(H){for(var K=[],Q=0,ie=H.length;Q<ie;){var re=XM(H,Q++);if(re>=55296&&re<=56319&&Q<ie){var te=XM(H,Q++);(64512&te)==56320?$c(K,((1023&re)<<10)+(1023&te)+65536):($c(K,re),Q--)}else $c(K,re)}return K}(n);var i,s,c=n.length,u=128,h=0,f=72;for(i=0;i<n.length;i++)(s=n[i])<128&&$c(r,OR(s));var m=r.length,y=m;for(m&&$c(r,"-");y<c;){var _=RR;for(i=0;i<n.length;i++)(s=n[i])>=u&&s<_&&(_=s);var S=y+1;if(_-u>th((RR-h)/S))throw new YM(qM);for(h+=(_-u)*S,u=_,i=0;i<n.length;i++){if((s=n[i])<u&&++h>RR)throw new YM(qM);if(s===u){for(var w=h,O=36;;){var W=O<=f?1:O>=f+26?26:O-f;if(w<W)break;var k=w-W,j=36-W;$c(r,OR(QM(W+k%j))),w=th(k/j),O+=36}$c(r,OR(QM(w))),f=Yse(h,S,y===m),h=0,y++}}h++,u++}return JM(r,"")},Jse=kt,AR=ae,Qse=n_,IR=P,ZM=jc,Ya=b,c_=Bc,Xa=Kv,Zse=MC,NR=Dr,PR=Ise,nh=function(n){var r=Use(n),i=Bse(this),s=arguments.length,c=s>1?arguments[1]:void 0,u=c!==void 0;u&&(c=kse(c,s>2?arguments[2]:void 0));var h,f,m,y,_,S,w=Gse(r),O=0;if(!w||this===zM&&Vse(w))for(h=Fse(r),f=i?new this(h):zM(h);h>O;O++)S=u?c(r[O],O):r[O],HM(f,O,S);else for(f=i?new this:[],_=(y=Wse(r,w)).next;!(m=Mse(_,y)).done;O++)S=u?jse(y,c,[m.value,O],!0):m.value,HM(f,O,S);return f.length=O,f},No=Fc,ece=fR.codeAt,tce=function(n){var r,i,s=[],c=Kse(zse(qse(n),KM,"."),".");for(r=0;r<c.length;r++)i=c[r],$c(s,Hse($se,i)?"xn--"+Xse(i):i);return JM(s,".")},Ks=ta,nce=zs,rce=pu,e2=_se,t2=fu,ice=t2.set,l_=t2.getterFor("URL"),ace=e2.URLSearchParams,oce=e2.getState,tm=IR.URL,xR=IR.TypeError,u_=IR.parseInt,sce=Math.floor,n2=Math.pow,Ja=Ya("".charAt),Po=Ya(/./.exec),nm=Ya([].join),cce=Ya(1 .toString),lce=Ya([].pop),rh=Ya([].push),DR=Ya("".replace),uce=Ya([].shift),dce=Ya("".split),rm=Ya("".slice),d_=Ya("".toLowerCase),hce=Ya([].unshift),LR="Invalid scheme",yu="Invalid host",r2="Invalid port",i2=/[a-z]/i,fce=/[\d+-.a-z]/i,kR=/\d/,pce=/^0x/i,mce=/^[0-7]+$/,gce=/^\d+$/,a2=/^[\da-f]+$/i,yce=/[\0\t\n\r #%/:<>?@[\\\]^|]/,vce=/[\0\t\n\r #/:<>?@[\\\]^|]/,_ce=/^[\u0000-\u0020]+/,Ece=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Sce=/[\t\n\r]/g,im=function(n){var r,i,s,c;if(typeof n=="number"){for(r=[],i=0;i<4;i++)hce(r,n%256),n=sce(n/256);return nm(r,".")}if(typeof n=="object"){for(r="",s=function(u){for(var h=null,f=1,m=null,y=0,_=0;_<8;_++)u[_]!==0?(y>f&&(h=m,f=y),m=null,y=0):(m===null&&(m=_),++y);return y>f?m:h}(n),i=0;i<8;i++)c&&n[i]===0||(c&&(c=!1),s===i?(r+=i?":":"::",c=!0):(r+=cce(n[i],16),i<7&&(r+=":")));return"["+r+"]"}return n},h_={},o2=PR({},h_,{" ":1,'"':1,"<":1,">":1,"`":1}),s2=PR({},o2,{"#":1,"?":1,"{":1,"}":1}),MR=PR({},s2,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Hc=function(n,r){var i=ece(n,0);return i>32&&i<127&&!NR(r,n)?n:encodeURIComponent(n)},f_={ftp:21,file:null,http:80,https:443,ws:80,wss:443},am=function(n,r){var i;return n.length===2&&Po(i2,Ja(n,0))&&((i=Ja(n,1))===":"||!r&&i==="|")},c2=function(n){var r;return n.length>1&&am(rm(n,0,2))&&(n.length===2||(r=Ja(n,2))==="/"||r==="\\"||r==="?"||r==="#")},bce=function(n){return n==="."||d_(n)==="%2e"},UR={},l2={},jR={},u2={},d2={},VR={},h2={},f2={},p_={},m_={},BR={},FR={},WR={},GR={},p2={},$R={},ih={},ds={},m2={},vu={},qs={},HR=function(n,r,i){var s,c,u,h=Ks(n);if(r){if(c=this.parse(h))throw new xR(c);this.searchParams=null}else{if(i!==void 0&&(s=new HR(i,!0)),c=this.parse(h,null,s))throw new xR(c);(u=oce(new ace)).bindURL(this),this.searchParams=u}};HR.prototype={type:"URL",parse:function(n,r,i){var s,c,u,h,f,m=this,y=r||UR,_=0,S="",w=!1,O=!1,W=!1;for(n=Ks(n),r||(m.scheme="",m.username="",m.password="",m.host=null,m.port=null,m.path=[],m.query=null,m.fragment=null,m.cannotBeABaseURL=!1,n=DR(n,_ce,""),n=DR(n,Ece,"$1")),n=DR(n,Sce,""),s=nh(n);_<=s.length;){switch(c=s[_],y){case UR:if(!c||!Po(i2,c)){if(r)return LR;y=jR;continue}S+=d_(c),y=l2;break;case l2:if(c&&(Po(fce,c)||c==="+"||c==="-"||c==="."))S+=d_(c);else{if(c!==":"){if(r)return LR;S="",y=jR,_=0;continue}if(r&&(m.isSpecial()!==NR(f_,S)||S==="file"&&(m.includesCredentials()||m.port!==null)||m.scheme==="file"&&!m.host))return;if(m.scheme=S,r)return void(m.isSpecial()&&f_[m.scheme]===m.port&&(m.port=null));S="",m.scheme==="file"?y=GR:m.isSpecial()&&i&&i.scheme===m.scheme?y=u2:m.isSpecial()?y=f2:s[_+1]==="/"?(y=d2,_++):(m.cannotBeABaseURL=!0,rh(m.path,""),y=m2)}break;case jR:if(!i||i.cannotBeABaseURL&&c!=="#")return LR;if(i.cannotBeABaseURL&&c==="#"){m.scheme=i.scheme,m.path=No(i.path),m.query=i.query,m.fragment="",m.cannotBeABaseURL=!0,y=qs;break}y=i.scheme==="file"?GR:VR;continue;case u2:if(c!=="/"||s[_+1]!=="/"){y=VR;continue}y=p_,_++;break;case d2:if(c==="/"){y=m_;break}y=ds;continue;case VR:if(m.scheme=i.scheme,c===qa)m.username=i.username,m.password=i.password,m.host=i.host,m.port=i.port,m.path=No(i.path),m.query=i.query;else if(c==="/"||c==="\\"&&m.isSpecial())y=h2;else if(c==="?")m.username=i.username,m.password=i.password,m.host=i.host,m.port=i.port,m.path=No(i.path),m.query="",y=vu;else{if(c!=="#"){m.username=i.username,m.password=i.password,m.host=i.host,m.port=i.port,m.path=No(i.path),m.path.length--,y=ds;continue}m.username=i.username,m.password=i.password,m.host=i.host,m.port=i.port,m.path=No(i.path),m.query=i.query,m.fragment="",y=qs}break;case h2:if(!m.isSpecial()||c!=="/"&&c!=="\\"){if(c!=="/"){m.username=i.username,m.password=i.password,m.host=i.host,m.port=i.port,y=ds;continue}y=m_}else y=p_;break;case f2:if(y=p_,c!=="/"||Ja(S,_+1)!=="/")continue;_++;break;case p_:if(c!=="/"&&c!=="\\"){y=m_;continue}break;case m_:if(c==="@"){w&&(S="%40"+S),w=!0,u=nh(S);for(var k=0;k<u.length;k++){var j=u[k];if(j!==":"||W){var H=Hc(j,MR);W?m.password+=H:m.username+=H}else W=!0}S=""}else if(c===qa||c==="/"||c==="?"||c==="#"||c==="\\"&&m.isSpecial()){if(w&&S==="")return"Invalid authority";_-=nh(S).length+1,S="",y=BR}else S+=c;break;case BR:case FR:if(r&&m.scheme==="file"){y=$R;continue}if(c!==":"||O){if(c===qa||c==="/"||c==="?"||c==="#"||c==="\\"&&m.isSpecial()){if(m.isSpecial()&&S==="")return yu;if(r&&S===""&&(m.includesCredentials()||m.port!==null))return;if(h=m.parseHost(S))return h;if(S="",y=ih,r)return;continue}c==="["?O=!0:c==="]"&&(O=!1),S+=c}else{if(S==="")return yu;if(h=m.parseHost(S))return h;if(S="",y=WR,r===FR)return}break;case WR:if(!Po(kR,c)){if(c===qa||c==="/"||c==="?"||c==="#"||c==="\\"&&m.isSpecial()||r){if(S!==""){var K=u_(S,10);if(K>65535)return r2;m.port=m.isSpecial()&&K===f_[m.scheme]?null:K,S=""}if(r)return;y=ih;continue}return r2}S+=c;break;case GR:if(m.scheme="file",c==="/"||c==="\\")y=p2;else{if(!i||i.scheme!=="file"){y=ds;continue}switch(c){case qa:m.host=i.host,m.path=No(i.path),m.query=i.query;break;case"?":m.host=i.host,m.path=No(i.path),m.query="",y=vu;break;case"#":m.host=i.host,m.path=No(i.path),m.query=i.query,m.fragment="",y=qs;break;default:c2(nm(No(s,_),""))||(m.host=i.host,m.path=No(i.path),m.shortenPath()),y=ds;continue}}break;case p2:if(c==="/"||c==="\\"){y=$R;break}i&&i.scheme==="file"&&!c2(nm(No(s,_),""))&&(am(i.path[0],!0)?rh(m.path,i.path[0]):m.host=i.host),y=ds;continue;case $R:if(c===qa||c==="/"||c==="\\"||c==="?"||c==="#"){if(!r&&am(S))y=ds;else if(S===""){if(m.host="",r)return;y=ih}else{if(h=m.parseHost(S))return h;if(m.host==="localhost"&&(m.host=""),r)return;S="",y=ih}continue}S+=c;break;case ih:if(m.isSpecial()){if(y=ds,c!=="/"&&c!=="\\")continue}else if(r||c!=="?")if(r||c!=="#"){if(c!==qa&&(y=ds,c!=="/"))continue}else m.fragment="",y=qs;else m.query="",y=vu;break;case ds:if(c===qa||c==="/"||c==="\\"&&m.isSpecial()||!r&&(c==="?"||c==="#")){if((f=d_(f=S))===".."||f==="%2e."||f===".%2e"||f==="%2e%2e"?(m.shortenPath(),c==="/"||c==="\\"&&m.isSpecial()||rh(m.path,"")):bce(S)?c==="/"||c==="\\"&&m.isSpecial()||rh(m.path,""):(m.scheme==="file"&&!m.path.length&&am(S)&&(m.host&&(m.host=""),S=Ja(S,0)+":"),rh(m.path,S)),S="",m.scheme==="file"&&(c===qa||c==="?"||c==="#"))for(;m.path.length>1&&m.path[0]==="";)uce(m.path);c==="?"?(m.query="",y=vu):c==="#"&&(m.fragment="",y=qs)}else S+=Hc(c,s2);break;case m2:c==="?"?(m.query="",y=vu):c==="#"?(m.fragment="",y=qs):c!==qa&&(m.path[0]+=Hc(c,h_));break;case vu:r||c!=="#"?c!==qa&&(c==="'"&&m.isSpecial()?m.query+="%27":m.query+=c==="#"?"%23":Hc(c,h_)):(m.fragment="",y=qs);break;case qs:c!==qa&&(m.fragment+=Hc(c,o2))}_++}},parseHost:function(n){var r,i,s;if(Ja(n,0)==="["){if(Ja(n,n.length-1)!=="]"||(r=function(c){var u,h,f,m,y,_,S,w=[0,0,0,0,0,0,0,0],O=0,W=null,k=0,j=function(){return Ja(c,k)};if(j()===":"){if(Ja(c,1)!==":")return;k+=2,W=++O}for(;j();){if(O===8)return;if(j()!==":"){for(u=h=0;h<4&&Po(a2,j());)u=16*u+u_(j(),16),k++,h++;if(j()==="."){if(h===0||(k-=h,O>6))return;for(f=0;j();){if(m=null,f>0){if(!(j()==="."&&f<4))return;k++}if(!Po(kR,j()))return;for(;Po(kR,j());){if(y=u_(j(),10),m===null)m=y;else{if(m===0)return;m=10*m+y}if(m>255)return;k++}w[O]=256*w[O]+m,++f!=2&&f!==4||O++}if(f!==4)return;break}if(j()===":"){if(k++,!j())return}else if(j())return;w[O++]=u}else{if(W!==null)return;k++,W=++O}}if(W!==null)for(_=O-W,O=7;O!==0&&_>0;)S=w[O],w[O--]=w[W+_-1],w[W+--_]=S;else if(O!==8)return;return w}(rm(n,1,-1)),!r))return yu;this.host=r}else if(this.isSpecial()){if(n=tce(n),Po(yce,n)||(r=function(c){var u,h,f,m,y,_,S,w=dce(c,".");if(w.length&&w[w.length-1]===""&&w.length--,(u=w.length)>4)return c;for(h=[],f=0;f<u;f++){if((m=w[f])==="")return c;if(y=10,m.length>1&&Ja(m,0)==="0"&&(y=Po(pce,m)?16:8,m=rm(m,y===8?1:2)),m==="")_=0;else{if(!Po(y===10?gce:y===8?mce:a2,m))return c;_=u_(m,y)}rh(h,_)}for(f=0;f<u;f++)if(_=h[f],f===u-1){if(_>=n2(256,5-u))return null}else if(_>255)return null;for(S=lce(h),f=0;f<h.length;f++)S+=h[f]*n2(256,3-f);return S}(n),r===null))return yu;this.host=r}else{if(Po(vce,n))return yu;for(r="",i=nh(n),s=0;s<i.length;s++)r+=Hc(i[s],h_);this.host=r}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return NR(f_,this.scheme)},shortenPath:function(){var n=this.path,r=n.length;!r||this.scheme==="file"&&r===1&&am(n[0],!0)||n.length--},serialize:function(){var n=this,r=n.scheme,i=n.username,s=n.password,c=n.host,u=n.port,h=n.path,f=n.query,m=n.fragment,y=r+":";return c!==null?(y+="//",n.includesCredentials()&&(y+=i+(s?":"+s:"")+"@"),y+=im(c),u!==null&&(y+=":"+u)):r==="file"&&(y+="//"),y+=n.cannotBeABaseURL?h[0]:h.length?"/"+nm(h,"/"):"",f!==null&&(y+="?"+f),m!==null&&(y+="#"+m),y},setHref:function(n){var r=this.parse(n);if(r)throw new xR(r);this.searchParams.update()},getOrigin:function(){var n=this.scheme,r=this.port;if(n==="blob")try{return new ah(n.path[0]).origin}catch{return"null"}return n!=="file"&&this.isSpecial()?n+"://"+im(this.host)+(r!==null?":"+r:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(n){this.parse(Ks(n)+":",UR)},getUsername:function(){return this.username},setUsername:function(n){var r=nh(Ks(n));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var i=0;i<r.length;i++)this.username+=Hc(r[i],MR)}},getPassword:function(){return this.password},setPassword:function(n){var r=nh(Ks(n));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var i=0;i<r.length;i++)this.password+=Hc(r[i],MR)}},getHost:function(){var n=this.host,r=this.port;return n===null?"":r===null?im(n):im(n)+":"+r},setHost:function(n){this.cannotBeABaseURL||this.parse(n,BR)},getHostname:function(){var n=this.host;return n===null?"":im(n)},setHostname:function(n){this.cannotBeABaseURL||this.parse(n,FR)},getPort:function(){var n=this.port;return n===null?"":Ks(n)},setPort:function(n){this.cannotHaveUsernamePasswordPort()||((n=Ks(n))===""?this.port=null:this.parse(n,WR))},getPathname:function(){var n=this.path;return this.cannotBeABaseURL?n[0]:n.length?"/"+nm(n,"/"):""},setPathname:function(n){this.cannotBeABaseURL||(this.path=[],this.parse(n,ih))},getSearch:function(){var n=this.query;return n?"?"+n:""},setSearch:function(n){(n=Ks(n))===""?this.query=null:(Ja(n,0)==="?"&&(n=rm(n,1)),this.query="",this.parse(n,vu)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var n=this.fragment;return n?"#"+n:""},setHash:function(n){(n=Ks(n))!==""?(Ja(n,0)==="#"&&(n=rm(n,1)),this.fragment="",this.parse(n,qs)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ah=function(n){var r=Zse(this,$i),i=rce(arguments.length,1)>1?arguments[1]:void 0,s=ice(r,new HR(n,!1,i));AR||(r.href=s.serialize(),r.origin=s.getOrigin(),r.protocol=s.getProtocol(),r.username=s.getUsername(),r.password=s.getPassword(),r.host=s.getHost(),r.hostname=s.getHostname(),r.port=s.getPort(),r.pathname=s.getPathname(),r.search=s.getSearch(),r.searchParams=s.getSearchParams(),r.hash=s.getHash())},$i=ah.prototype,Qa=function(n,r){return{get:function(){return l_(this)[n]()},set:r&&function(i){return l_(this)[r](i)},configurable:!0,enumerable:!0}};if(AR&&(Xa($i,"href",Qa("serialize","setHref")),Xa($i,"origin",Qa("getOrigin")),Xa($i,"protocol",Qa("getProtocol","setProtocol")),Xa($i,"username",Qa("getUsername","setUsername")),Xa($i,"password",Qa("getPassword","setPassword")),Xa($i,"host",Qa("getHost","setHost")),Xa($i,"hostname",Qa("getHostname","setHostname")),Xa($i,"port",Qa("getPort","setPort")),Xa($i,"pathname",Qa("getPathname","setPathname")),Xa($i,"search",Qa("getSearch","setSearch")),Xa($i,"searchParams",Qa("getSearchParams")),Xa($i,"hash",Qa("getHash","setHash"))),c_($i,"toJSON",function(){return l_(this).serialize()},{enumerable:!0}),c_($i,"toString",function(){return l_(this).serialize()},{enumerable:!0}),tm){var g2=tm.createObjectURL,y2=tm.revokeObjectURL;g2&&c_(ah,"createObjectURL",ZM(g2,tm)),y2&&c_(ah,"revokeObjectURL",ZM(y2,tm))}nce(ah,"URL"),Jse({global:!0,constructor:!0,forced:!Qse,sham:!AR},{URL:ah});var Tce=kt,v2=d,wce=pu,_2=ta,Cce=n_,zR=gr("URL"),Rce=Cce&&v2(function(){zR.canParse()}),Oce=v2(function(){return zR.canParse.length!==1});Tce({target:"URL",stat:!0,forced:!Rce||Oce},{canParse:function(n){var r=wce(arguments.length,1),i=_2(n),s=r<2||arguments[1]===void 0?void 0:_2(arguments[1]);try{return!!new zR(i,s)}catch{return!1}}});var Ace=kt,Ice=pu,E2=ta,Nce=n_,Pce=gr("URL");Ace({target:"URL",stat:!0,forced:!Nce},{parse:function(n){var r=Ice(arguments.length,1),i=E2(n),s=r<2||arguments[1]===void 0?void 0:E2(arguments[1]);try{return new Pce(i,s)}catch{return null}}});var g_=l(er.URL);let S2=!0,b2=!0;function y_(n,r,i){const s=n.match(r);return s&&s.length>=i&&parseInt(s[i],10)}function _u(n,r,i){if(!n.RTCPeerConnection)return;const s=n.RTCPeerConnection.prototype,c=s.addEventListener;s.addEventListener=function(h,f){if(h!==r)return c.apply(this,arguments);const m=y=>{const _=i(y);_&&(f.handleEvent?f.handleEvent(_):f(_))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(f,m),c.apply(this,[h,m])};const u=s.removeEventListener;s.removeEventListener=function(h,f){if(h!==r||!this._eventMap||!this._eventMap[r])return u.apply(this,arguments);if(!this._eventMap[r].has(f))return u.apply(this,arguments);const m=this._eventMap[r].get(f);return this._eventMap[r].delete(f),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,u.apply(this,[h,m])},Object.defineProperty(s,"on"+r,{get(){return this["_on"+r]},set(h){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),h&&this.addEventListener(r,this["_on"+r]=h)},enumerable:!0,configurable:!0})}function xce(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(S2=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function Dce(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(b2=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function T2(){if(typeof window=="object"){if(S2)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function KR(n,r){b2&&console.warn(n+" is deprecated, please use "+r+" instead.")}function w2(n){return Object.prototype.toString.call(n)==="[object Object]"}function C2(n){var r;return w2(n)?Ao(r=Object.keys(n)).call(r,function(i,s){const c=w2(n[s]),u=c?C2(n[s]):n[s],h=c&&!Object.keys(u).length;return u===void 0||h?i:Object.assign(i,{[s]:u})},{}):n}function qR(n,r,i){r&&!i.has(r.id)&&(i.set(r.id,r),Object.keys(r).forEach(s=>{s.endsWith("Id")?qR(n,n.get(r[s]),i):s.endsWith("Ids")&&r[s].forEach(c=>{qR(n,n.get(c),i)})}))}function R2(n,r,i){const s=i?"outbound-rtp":"inbound-rtp",c=new Map;if(r===null)return c;const u=[];return n.forEach(h=>{h.type==="track"&&h.trackIdentifier===r.id&&u.push(h)}),u.forEach(h=>{n.forEach(f=>{f.type===s&&f.trackId===h.id&&qR(n,f,c)})}),c}const O2=T2;function A2(n,r){const i=n&&n.navigator;if(!i.mediaDevices)return;const s=function(h){if(typeof h!="object"||h.mandatory||h.optional)return h;const f={};return Object.keys(h).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const y=typeof h[m]=="object"?h[m]:{ideal:h[m]};y.exact!==void 0&&typeof y.exact=="number"&&(y.min=y.max=y.exact);const _=function(S,w){return S?S+w.charAt(0).toUpperCase()+w.slice(1):w==="deviceId"?"sourceId":w};if(y.ideal!==void 0){f.optional=f.optional||[];let S={};typeof y.ideal=="number"?(S[_("min",m)]=y.ideal,f.optional.push(S),S={},S[_("max",m)]=y.ideal,f.optional.push(S)):(S[_("",m)]=y.ideal,f.optional.push(S))}y.exact!==void 0&&typeof y.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[_("",m)]=y.exact):["min","max"].forEach(S=>{y[S]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[_(S,m)]=y[S])})}),h.advanced&&(f.optional=(f.optional||[]).concat(h.advanced)),f},c=function(h,f){if(r.version>=61)return f(h);if((h=JSON.parse(JSON.stringify(h)))&&typeof h.audio=="object"){const m=function(y,_,S){_ in y&&!(S in y)&&(y[S]=y[_],delete y[_])};m((h=JSON.parse(JSON.stringify(h))).audio,"autoGainControl","googAutoGainControl"),m(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=s(h.audio)}if(h&&typeof h.video=="object"){let m=h.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const y=r.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||y)){let _;if(delete h.video.facingMode,m.exact==="environment"||m.ideal==="environment"?_=["back","rear"]:m.exact!=="user"&&m.ideal!=="user"||(_=["front"]),_)return i.mediaDevices.enumerateDevices().then(S=>{let w=(S=S.filter(O=>O.kind==="videoinput")).find(O=>_.some(W=>{var k;return Oe(k=O.label.toLowerCase()).call(k,W)}));return!w&&S.length&&Oe(_).call(_,"back")&&(w=S[S.length-1]),w&&(h.video.deviceId=m.exact?{exact:w.deviceId}:{ideal:w.deviceId}),h.video=s(h.video),O2("chrome: "+JSON.stringify(h)),f(h)})}h.video=s(h.video)}return O2("chrome: "+JSON.stringify(h)),f(h)},u=function(h){return r.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=(function(h,f,m){c(h,y=>{i.webkitGetUserMedia(y,f,_=>{m&&m(u(_))})})}).bind(i),i.mediaDevices.getUserMedia){const h=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(f){return c(f,m=>h(m).then(y=>{if(m.audio&&!y.getAudioTracks().length||m.video&&!y.getVideoTracks().length)throw y.getTracks().forEach(_=>{_.stop()}),new DOMException("","NotFoundError");return y},y=>Ie.reject(u(y))))}}}function I2(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function N2(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const r=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",s=>{let c;c=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===s.track.id):{track:s.track};const u=new Event("track");u.track=s.track,u.receiver=c,u.transceiver={receiver:c},u.streams=[i.stream],this.dispatchEvent(u)}),i.stream.getTracks().forEach(s=>{let c;c=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===s.id):{track:s};const u=new Event("track");u.track=s,u.receiver=c,u.transceiver={receiver:c},u.streams=[i.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else _u(n,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function P2(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const r=function(c,u){return{track:u,get dtmf(){return this._dtmf===void 0&&(u.kind==="audio"?this._dtmf=c.createDTMFSender(u):this._dtmf=null),this._dtmf},_pc:c}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(h,f){let m=c.apply(this,arguments);return m||(m=r(this,h),this._senders.push(m)),m};const u=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(h){u.apply(this,arguments);const f=this._senders.indexOf(h);f!==-1&&this._senders.splice(f,1)}}const i=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],i.apply(this,[c]),c.getTracks().forEach(u=>{this._senders.push(r(this,u))})};const s=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],s.apply(this,[c]),c.getTracks().forEach(u=>{const h=this._senders.find(f=>f.track===u);h&&this._senders.splice(this._senders.indexOf(h),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const r=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(s=>s._pc=this),i},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function x2(n){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[i,s,c]=arguments;if(arguments.length>0&&typeof i=="function")return r.apply(this,arguments);if(r.length===0&&(arguments.length===0||typeof i!="function"))return r.apply(this,[]);const u=function(f){const m={};return f.result().forEach(y=>{const _={id:y.id,timestamp:y.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[y.type]||y.type};y.names().forEach(S=>{_[S]=y.stat(S)}),m[_.id]=_}),m},h=function(f){return new Map(Object.keys(f).map(m=>[m,f[m]]))};if(arguments.length>=2){const f=function(m){s(h(u(m)))};return r.apply(this,[f,i])}return new Ie((f,m)=>{r.apply(this,[function(y){f(h(u(y)))},m])}).then(s,c)}}function D2(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const i=n.RTCPeerConnection.prototype.getSenders;i&&(n.RTCPeerConnection.prototype.getSenders=function(){const c=i.apply(this,[]);return c.forEach(u=>u._pc=this),c});const s=n.RTCPeerConnection.prototype.addTrack;s&&(n.RTCPeerConnection.prototype.addTrack=function(){const c=s.apply(this,arguments);return c._pc=this,c}),n.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(u=>R2(u,c.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const i=n.RTCPeerConnection.prototype.getReceivers;i&&(n.RTCPeerConnection.prototype.getReceivers=function(){const s=i.apply(this,[]);return s.forEach(c=>c._pc=this),s}),_u(n,"track",s=>(s.receiver._pc=s.srcElement,s)),n.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(c=>R2(c,s.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype)||!("getStats"in n.RTCRtpReceiver.prototype))return;const r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const i=arguments[0];let s,c,u;return this.getSenders().forEach(h=>{h.track===i&&(s?u=!0:s=h)}),this.getReceivers().forEach(h=>(h.track===i&&(c?u=!0:c=h),h.track===i)),u||s&&c?Ie.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():c?c.getStats():Ie.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function L2(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const r=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(u,h){if(!h)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=r.apply(this,arguments);return this._shimmedLocalStreams[h.id]?this._shimmedLocalStreams[h.id].indexOf(f)===-1&&this._shimmedLocalStreams[h.id].push(f):this._shimmedLocalStreams[h.id]=[h,f],f};const i=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(m=>{if(this.getSenders().find(_=>_.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const h=this.getSenders();i.apply(this,arguments);const f=this.getSenders().filter(m=>h.indexOf(m)===-1);this._shimmedLocalStreams[u.id]=[u].concat(f)};const s=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],s.apply(this,arguments)};const c=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(h=>{const f=this._shimmedLocalStreams[h].indexOf(u);f!==-1&&this._shimmedLocalStreams[h].splice(f,1),this._shimmedLocalStreams[h].length===1&&delete this._shimmedLocalStreams[h]}),c.apply(this,arguments)}}function k2(n,r){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&r.version>=65)return L2(n);const i=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const m=i.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(y=>this._reverseStreams[y.id])};const s=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(y=>{if(this.getSenders().find(S=>S.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const y=new n.MediaStream(m.getTracks());this._streams[m.id]=y,this._reverseStreams[y.id]=m,m=y}s.apply(this,[m])};const c=n.RTCPeerConnection.prototype.removeStream;function u(m,y){let _=y.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const w=m._reverseStreams[S],O=m._streams[w.id];_=_.replace(new RegExp(O.id,"g"),w.id)}),new RTCSessionDescription({type:y.type,sdp:_})}n.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},n.RTCPeerConnection.prototype.addTrack=function(m,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _=[].slice.call(arguments,1);if(_.length!==1||!_[0].getTracks().find(O=>O===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(O=>O.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const w=this._streams[y.id];if(w)w.addTrack(m),Ie.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const O=new n.MediaStream([m]);this._streams[y.id]=O,this._reverseStreams[O.id]=y,this.addStream(O)}return this.getSenders().find(O=>O.track===m)},["createOffer","createAnswer"].forEach(function(m){const y=n.RTCPeerConnection.prototype[m],_={[m](){const S=arguments;return arguments.length&&typeof arguments[0]=="function"?y.apply(this,[w=>{const O=u(this,w);S[0].apply(null,[O])},w=>{S[1]&&S[1].apply(null,w)},arguments[2]]):y.apply(this,arguments).then(w=>u(this,w))}};n.RTCPeerConnection.prototype[m]=_[m]});const h=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(m,y){let _=y.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const w=m._reverseStreams[S],O=m._streams[w.id];_=_.replace(new RegExp(w.id,"g"),O.id)}),new RTCSessionDescription({type:y.type,sdp:_})}(this,arguments[0]),h.apply(this,arguments)):h.apply(this,arguments)};const f=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const m=f.get.apply(this);return m.type===""?m:u(this,m)}}),n.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(m._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let y;this._streams=this._streams||{},Object.keys(this._streams).forEach(_=>{this._streams[_].getTracks().find(S=>m.track===S)&&(y=this._streams[_])}),y&&(y.getTracks().length===1?this.removeStream(this._reverseStreams[y.id]):y.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function YR(n,r){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=n.RTCPeerConnection.prototype[i],c={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=c[i]})}function M2(n,r){_u(n,"negotiationneeded",i=>{const s=i.target;if(!(r.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")||s.signalingState==="stable")return i})}var U2=Object.freeze({__proto__:null,fixNegotiationNeeded:M2,shimAddTrackRemoveTrack:k2,shimAddTrackRemoveTrackWithNative:L2,shimGetDisplayMedia:function(n,r){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(typeof r=="function"?n.navigator.mediaDevices.getDisplayMedia=function(i){return r(i).then(s=>{const c=i.video&&i.video.width,u=i.video&&i.video.height,h=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:h||3}},c&&(i.video.mandatory.maxWidth=c),u&&(i.video.mandatory.maxHeight=u),n.navigator.mediaDevices.getUserMedia(i)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:P2,shimGetStats:x2,shimGetUserMedia:A2,shimMediaStream:I2,shimOnTrack:N2,shimPeerConnection:YR,shimSenderReceiverGetStats:D2});function j2(n,r){const i=n&&n.navigator,s=n&&n.MediaStreamTrack;if(i.getUserMedia=function(c,u,h){KR("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(c).then(u,h)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const c=function(h,f,m){f in h&&!(m in h)&&(h[m]=h[f],delete h[f])},u=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(h){return typeof h=="object"&&typeof h.audio=="object"&&(h=JSON.parse(JSON.stringify(h)),c(h.audio,"autoGainControl","mozAutoGainControl"),c(h.audio,"noiseSuppression","mozNoiseSuppression")),u(h)},s&&s.prototype.getSettings){const h=s.prototype.getSettings;s.prototype.getSettings=function(){const f=h.apply(this,arguments);return c(f,"mozAutoGainControl","autoGainControl"),c(f,"mozNoiseSuppression","noiseSuppression"),f}}if(s&&s.prototype.applyConstraints){const h=s.prototype.applyConstraints;s.prototype.applyConstraints=function(f){return this.kind==="audio"&&typeof f=="object"&&(f=JSON.parse(JSON.stringify(f)),c(f,"autoGainControl","mozAutoGainControl"),c(f,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[f])}}}}function V2(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function XR(n,r){if(typeof n!="object"||!n.RTCPeerConnection&&!n.mozRTCPeerConnection)return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const u=n.RTCPeerConnection.prototype[c],h={[c](){return arguments[0]=new(c==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),u.apply(this,arguments)}};n.RTCPeerConnection.prototype[c]=h[c]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[c,u,h]=arguments;return s.apply(this,[c||null]).then(f=>{if(r.version<53&&!u)try{f.forEach(m=>{m.type=i[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;f.forEach((y,_)=>{f.set(_,Object.assign({},y,{type:i[y.type]||y.type}))})}return f}).then(u,h)}}function B2(n){if(typeof n!="object"||!n.RTCPeerConnection||!n.RTCRtpSender||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const r=n.RTCPeerConnection.prototype.getSenders;r&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=r.apply(this,[]);return s.forEach(c=>c._pc=this),s});const i=n.RTCPeerConnection.prototype.addTrack;i&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Ie.resolve(new Map)}}function F2(n){if(typeof n!="object"||!n.RTCPeerConnection||!n.RTCRtpSender||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const r=n.RTCPeerConnection.prototype.getReceivers;r&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(s=>s._pc=this),i}),_u(n,"track",i=>(i.receiver._pc=i.srcElement,i)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function W2(n){n.RTCPeerConnection&&!("removeStream"in n.RTCPeerConnection.prototype)&&(n.RTCPeerConnection.prototype.removeStream=function(r){KR("removeStream","removeTrack"),this.getSenders().forEach(i=>{var s;i.track&&Oe(s=r.getTracks()).call(s,i.track)&&this.removeTrack(i)})})}function G2(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function $2(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype.addTransceiver;r&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const s=i.length>0;s&&i.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=r.apply(this,arguments);if(s){const{sender:u}=c,h=u.getParameters();(!("encodings"in h)||h.encodings.length===1&&Object.keys(h.encodings[0]).length===0)&&(h.encodings=i,u.sendEncodings=i,this.setParametersPromises.push(u.setParameters(h).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return c})}function H2(n){if(typeof n!="object"||!n.RTCRtpSender)return;const r=n.RTCRtpSender.prototype.getParameters;r&&(n.RTCRtpSender.prototype.getParameters=function(){const i=r.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function z2(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ie.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function K2(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ie.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}var q2=Object.freeze({__proto__:null,shimAddTransceiver:$2,shimCreateAnswer:K2,shimCreateOffer:z2,shimGetDisplayMedia:function(n,r){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Ie.reject(s)}return i.video===!0?i.video={mediaSource:r}:i.video.mediaSource=r,n.navigator.mediaDevices.getUserMedia(i)})},shimGetParameters:H2,shimGetUserMedia:j2,shimOnTrack:V2,shimPeerConnection:XR,shimRTCDataChannel:G2,shimReceiverGetStats:F2,shimRemoveStream:W2,shimSenderGetStats:B2});function Y2(n){if(typeof n=="object"&&n.RTCPeerConnection){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const r=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(i){var s;this._localStreams||(this._localStreams=[]),Oe(s=this._localStreams).call(s,i)||this._localStreams.push(i),i.getAudioTracks().forEach(c=>r.call(this,c,i)),i.getVideoTracks().forEach(c=>r.call(this,c,i))},n.RTCPeerConnection.prototype.addTrack=function(i){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return c&&c.forEach(h=>{var f;this._localStreams?Oe(f=this._localStreams).call(f,h)||this._localStreams.push(h):this._localStreams=[h]}),r.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(r);if(i===-1)return;this._localStreams.splice(i,1);const s=r.getTracks();this.getSenders().forEach(c=>{Oe(s).call(s,c.track)&&this.removeTrack(c)})})}}function X2(n){if(typeof n=="object"&&n.RTCPeerConnection&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(c=>{var u;if(this._remoteStreams||(this._remoteStreams=[]),Oe(u=this._remoteStreams).call(u,c))return;this._remoteStreams.push(c);const h=new Event("addstream");h.stream=c,this.dispatchEvent(h)})})}});const r=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(c=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(c)>=0)return;i._remoteStreams.push(c);const u=new Event("addstream");u.stream=c,i.dispatchEvent(u)})}),r.apply(i,arguments)}}}function J2(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.createOffer,s=r.createAnswer,c=r.setLocalDescription,u=r.setRemoteDescription,h=r.addIceCandidate;r.createOffer=function(m,y){const _=arguments.length>=2?arguments[2]:arguments[0],S=i.apply(this,[_]);return y?(S.then(m,y),Ie.resolve()):S},r.createAnswer=function(m,y){const _=arguments.length>=2?arguments[2]:arguments[0],S=s.apply(this,[_]);return y?(S.then(m,y),Ie.resolve()):S};let f=function(m,y,_){const S=c.apply(this,[m]);return _?(S.then(y,_),Ie.resolve()):S};r.setLocalDescription=f,f=function(m,y,_){const S=u.apply(this,[m]);return _?(S.then(y,_),Ie.resolve()):S},r.setRemoteDescription=f,f=function(m,y,_){const S=h.apply(this,[m]);return _?(S.then(y,_),Ie.resolve()):S},r.addIceCandidate=f}function Q2(n){const r=n&&n.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const i=r.mediaDevices,s=i.getUserMedia.bind(i);r.mediaDevices.getUserMedia=c=>s(Z2(c))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(i,s,c){r.mediaDevices.getUserMedia(i).then(s,c)}).bind(r))}function Z2(n){return n&&n.video!==void 0?Object.assign({},n,{video:C2(n.video)}):n}function eU(n){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection;n.RTCPeerConnection=function(i,s){if(i&&i.iceServers){const c=[];for(let u=0;u<i.iceServers.length;u++){let h=i.iceServers[u];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(KR("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,c.push(h)):c.push(i.iceServers[u])}i.iceServers=c}return new r(i,s)},n.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get:()=>r.generateCertificate})}function tU(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function nU(n){const r=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(i){if(i){i.offerToReceiveAudio!==void 0&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const s=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveAudio!==!0||s||this.addTransceiver("audio",{direction:"recvonly"}),i.offerToReceiveVideo!==void 0&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const c=this.getTransceivers().find(u=>u.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):i.offerToReceiveVideo!==!0||c||this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function rU(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var iU=Object.freeze({__proto__:null,shimAudioContext:rU,shimCallbacksAPI:J2,shimConstraints:Z2,shimCreateOfferLegacy:nU,shimGetUserMedia:Q2,shimLocalStreamsAPI:Y2,shimRTCIceServerUrls:eU,shimRemoteStreamsAPI:X2,shimTrackEventTransceiver:tU}),aU=`	
\v\f\r \u2028\u2029\uFEFF`,Lce=zt,kce=ta,JR=aU,oU=b("".replace),Mce=RegExp("^["+JR+"]+"),Uce=RegExp("(^|[^"+JR+"])["+JR+"]+$"),QR=function(n){return function(r){var i=kce(Lce(r));return 1&n&&(i=oU(i,Mce,"")),2&n&&(i=oU(i,Uce,"$1")),i}},jce={start:QR(1),end:QR(2),trim:QR(3)},Vce=ZL.PROPER,Bce=d,sU=aU,Fce=jce.trim;kt({target:"String",proto:!0,forced:function(n){return Bce(function(){return!!sU[n]()||""[n]()!==""||Vce&&sU[n].name!==n})}("trim")},{trim:function(){return Fce(this)}});var Wce=za("String","trim"),Gce=R,$ce=Wce,ZR=String.prototype,Hce=function(n){var r=n.trim;return typeof n=="string"||n===ZR||Gce(ZR,n)&&r===ZR.trim?$ce:r},Hr=l(Hce),cU={exports:{}};(function(n){const r={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};r.localCName=r.generateIdentifier(),r.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},r.splitSections=function(i){return i.split(`
m=`).map((s,c)=>(c>0?"m="+s:s).trim()+`\r
`)},r.getDescription=function(i){const s=r.splitSections(i);return s&&s[0]},r.getMediaSections=function(i){const s=r.splitSections(i);return s.shift(),s},r.matchPrefix=function(i,s){return r.splitLines(i).filter(c=>c.indexOf(s)===0)},r.parseCandidate=function(i){let s;s=i.indexOf("a=candidate:")===0?i.substring(12).split(" "):i.substring(10).split(" ");const c={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let u=8;u<s.length;u+=2)switch(s[u]){case"raddr":c.relatedAddress=s[u+1];break;case"rport":c.relatedPort=parseInt(s[u+1],10);break;case"tcptype":c.tcpType=s[u+1];break;case"ufrag":c.ufrag=s[u+1],c.usernameFragment=s[u+1];break;default:c[s[u]]===void 0&&(c[s[u]]=s[u+1])}return c},r.writeCandidate=function(i){const s=[];s.push(i.foundation);const c=i.component;c==="rtp"?s.push(1):c==="rtcp"?s.push(2):s.push(c),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const u=i.type;return s.push("typ"),s.push(u),u!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},r.parseIceOptions=function(i){return i.substring(14).split(" ")},r.parseRtpMap=function(i){let s=i.substring(9).split(" ");const c={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),c.name=s[0],c.clockRate=parseInt(s[1],10),c.channels=s.length===3?parseInt(s[2],10):1,c.numChannels=c.channels,c},r.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const c=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(c!==1?"/"+c:"")+`\r
`},r.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},r.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},r.parseFmtp=function(i){const s={};let c;const u=i.substring(i.indexOf(" ")+1).split(";");for(let h=0;h<u.length;h++)c=u[h].trim().split("="),s[c[0].trim()]=c[1];return s},r.writeFmtp=function(i){let s="",c=i.payloadType;if(i.preferredPayloadType!==void 0&&(c=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const u=[];Object.keys(i.parameters).forEach(h=>{i.parameters[h]!==void 0?u.push(h+"="+i.parameters[h]):u.push(h)}),s+="a=fmtp:"+c+" "+u.join(";")+`\r
`}return s},r.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},r.writeRtcpFb=function(i){let s="",c=i.payloadType;return i.preferredPayloadType!==void 0&&(c=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(u=>{s+="a=rtcp-fb:"+c+" "+u.type+(u.parameter&&u.parameter.length?" "+u.parameter:"")+`\r
`}),s},r.parseSsrcMedia=function(i){const s=i.indexOf(" "),c={ssrc:parseInt(i.substring(7,s),10)},u=i.indexOf(":",s);return u>-1?(c.attribute=i.substring(s+1,u),c.value=i.substring(u+1)):c.attribute=i.substring(s+1),c},r.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(c=>parseInt(c,10))}},r.getMid=function(i){const s=r.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},r.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},r.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:r.matchPrefix(i+s,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(i,s){let c="a=setup:"+s+`\r
`;return i.fingerprints.forEach(u=>{c+="a=fingerprint:"+u.algorithm+" "+u.value+`\r
`}),c},r.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},r.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?r.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},r.getCryptoParameters=function(i,s){return r.matchPrefix(i+s,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(i,s){const c=r.matchPrefix(i+s,"a=ice-ufrag:")[0],u=r.matchPrefix(i+s,"a=ice-pwd:")[0];return c&&u?{usernameFragment:c.substring(12),password:u.substring(10)}:null},r.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},r.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=r.splitLines(i)[0].split(" ");s.profile=c[2];for(let h=3;h<c.length;h++){const f=c[h],m=r.matchPrefix(i,"a=rtpmap:"+f+" ")[0];if(m){const y=r.parseRtpMap(m),_=r.matchPrefix(i,"a=fmtp:"+f+" ");switch(y.parameters=_.length?r.parseFmtp(_[0]):{},y.rtcpFeedback=r.matchPrefix(i,"a=rtcp-fb:"+f+" ").map(r.parseRtcpFb),s.codecs.push(y),y.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(y.name.toUpperCase())}}}r.matchPrefix(i,"a=extmap:").forEach(h=>{s.headerExtensions.push(r.parseExtmap(h))});const u=r.matchPrefix(i,"a=rtcp-fb:* ").map(r.parseRtcpFb);return s.codecs.forEach(h=>{u.forEach(f=>{h.rtcpFeedback.find(m=>m.type===f.type&&m.parameter===f.parameter)||h.rtcpFeedback.push(f)})}),s},r.writeRtpDescription=function(i,s){let c="";c+="m="+i+" ",c+=s.codecs.length>0?"9":"0",c+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",c+=s.codecs.map(h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType).join(" ")+`\r
`,c+=`c=IN IP4 0.0.0.0\r
`,c+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(h=>{c+=r.writeRtpMap(h),c+=r.writeFmtp(h),c+=r.writeRtcpFb(h)});let u=0;return s.codecs.forEach(h=>{h.maxptime>u&&(u=h.maxptime)}),u>0&&(c+="a=maxptime:"+u+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(h=>{c+=r.writeExtmap(h)}),c},r.parseRtpEncodingParameters=function(i){const s=[],c=r.parseRtpParameters(i),u=c.fecMechanisms.indexOf("RED")!==-1,h=c.fecMechanisms.indexOf("ULPFEC")!==-1,f=r.matchPrefix(i,"a=ssrc:").map(w=>r.parseSsrcMedia(w)).filter(w=>w.attribute==="cname"),m=f.length>0&&f[0].ssrc;let y;const _=r.matchPrefix(i,"a=ssrc-group:FID").map(w=>w.substring(17).split(" ").map(O=>parseInt(O,10)));_.length>0&&_[0].length>1&&_[0][0]===m&&(y=_[0][1]),c.codecs.forEach(w=>{if(w.name.toUpperCase()==="RTX"&&w.parameters.apt){let O={ssrc:m,codecPayloadType:parseInt(w.parameters.apt,10)};m&&y&&(O.rtx={ssrc:y}),s.push(O),u&&(O=JSON.parse(JSON.stringify(O)),O.fec={ssrc:m,mechanism:h?"red+ulpfec":"red"},s.push(O))}}),s.length===0&&m&&s.push({ssrc:m});let S=r.matchPrefix(i,"b=");return S.length&&(S=S[0].indexOf("b=TIAS:")===0?parseInt(S[0].substring(7),10):S[0].indexOf("b=AS:")===0?1e3*parseInt(S[0].substring(5),10)*.95-16e3:void 0,s.forEach(w=>{w.maxBitrate=S})),s},r.parseRtcpParameters=function(i){const s={},c=r.matchPrefix(i,"a=ssrc:").map(f=>r.parseSsrcMedia(f)).filter(f=>f.attribute==="cname")[0];c&&(s.cname=c.value,s.ssrc=c.ssrc);const u=r.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=u.length>0,s.compound=u.length===0;const h=r.matchPrefix(i,"a=rtcp-mux");return s.mux=h.length>0,s},r.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},r.parseMsid=function(i){let s;const c=r.matchPrefix(i,"a=msid:");if(c.length===1)return s=c[0].substring(7).split(" "),{stream:s[0],track:s[1]};const u=r.matchPrefix(i,"a=ssrc:").map(h=>r.parseSsrcMedia(h)).filter(h=>h.attribute==="msid");return u.length>0?(s=u[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},r.parseSctpDescription=function(i){const s=r.parseMLine(i),c=r.matchPrefix(i,"a=max-message-size:");let u;c.length>0&&(u=parseInt(c[0].substring(19),10)),isNaN(u)&&(u=65536);const h=r.matchPrefix(i,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substring(12),10),protocol:s.fmt,maxMessageSize:u};const f=r.matchPrefix(i,"a=sctpmap:");if(f.length>0){const m=f[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:u}}},r.writeSctpDescription=function(i,s){let c=[];return c=i.protocol!=="DTLS/SCTP"?["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&c.push("a=max-message-size:"+s.maxMessageSize+`\r
`),c.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(i,s,c){let u;const h=s!==void 0?s:2;return u=i||r.generateSessionId(),`v=0\r
o=`+(c||"thisisadapterortc")+" "+u+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(i,s){const c=r.splitLines(i);for(let u=0;u<c.length;u++)switch(c[u]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[u].substring(2)}return s?r.getDirection(s):"sendrecv"},r.getKind=function(i){return r.splitLines(i)[0].split(" ")[0].substring(2)},r.isRejected=function(i){return i.split(" ",2)[1]==="0"},r.parseMLine=function(i){const s=r.splitLines(i)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},r.parseOLine=function(i){const s=r.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},r.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=r.splitLines(i);for(let c=0;c<s.length;c++)if(s[c].length<2||s[c].charAt(1)!=="=")return!1;return!0},n.exports=r})(cU);var lU=cU.exports,oh=l(lU),zce=a({__proto__:null,default:oh},[lU]);function v_(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const r=n.RTCIceCandidate;n.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&((i=JSON.parse(JSON.stringify(i))).candidate=i.candidate.substr(2)),i.candidate&&i.candidate.length){const s=new r(i),c=oh.parseCandidate(i.candidate),u=Object.assign(s,c);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new r(i)},n.RTCIceCandidate.prototype=r.prototype,_u(n,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new n.RTCIceCandidate(i.candidate),writable:"false"}),i))}function e0(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||_u(n,"icecandidate",r=>{if(r.candidate){const i=oh.parseCandidate(r.candidate.candidate);i.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return r})}function __(n,r){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const i=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:s}=this.getConfiguration();s==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(s){if(!s||!s.sdp)return!1;const c=oh.splitSections(s.sdp);return c.shift(),c.some(u=>{const h=oh.parseMLine(u);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const s=function(m){const y=m.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(y===null||y.length<2)return-1;const _=parseInt(y[1],10);return _!=_?-1:_}(arguments[0]),c=function(m){let y=65536;return r.browser==="firefox"&&(y=r.version<57?m===-1?16384:2147483637:r.version<60?r.version===57?65535:65536:2147483637),y}(s),u=function(m,y){let _=65536;r.browser==="firefox"&&r.version===57&&(_=65535);const S=oh.matchPrefix(m.sdp,"a=max-message-size:");return S.length>0?_=parseInt(S[0].substr(19),10):r.browser==="firefox"&&y!==-1&&(_=2147483637),_}(arguments[0],s);let h;h=c===0&&u===0?Number.POSITIVE_INFINITY:c===0||u===0?Math.max(c,u):Math.min(c,u);const f={};Object.defineProperty(f,"maxMessageSize",{get:()=>h}),this._sctp=f}return i.apply(this,arguments)}}function E_(n){if(!n.RTCPeerConnection||!("createDataChannel"in n.RTCPeerConnection.prototype))return;function r(s,c){const u=s.send;s.send=function(){const h=arguments[0],f=h.length||h.size||h.byteLength;if(s.readyState==="open"&&c.sctp&&f>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return u.apply(s,arguments)}}const i=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const s=i.apply(this,arguments);return r(s,this),s},_u(n,"datachannel",s=>(r(s.channel,s.target),s))}function t0(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const r=n.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=r[i];r[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const u=c.target;if(u._lastConnectionState!==u.connectionState){u._lastConnectionState=u.connectionState;const h=new Event("connectionstatechange",c);u.dispatchEvent(h)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function n0(n,r){if(!n.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r.version>=605)return;const i=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const c=s.sdp.split(`
`).filter(u=>Hr(u).call(u)!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&s instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:s.type,sdp:c}):s.sdp=c}return i.apply(this,arguments)}}function S_(n,r){if(!n.RTCPeerConnection||!n.RTCPeerConnection.prototype)return;const i=n.RTCPeerConnection.prototype.addIceCandidate;i&&i.length!==0&&(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Ie.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Ie.resolve())})}function b_(n,r){if(!n.RTCPeerConnection||!n.RTCPeerConnection.prototype)return;const i=n.RTCPeerConnection.prototype.setLocalDescription;i&&i.length!==0&&(n.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return i.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer"}return s.sdp||s.type!=="offer"&&s.type!=="answer"?i.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>i.apply(this,[c]))})}var Kce=Object.freeze({__proto__:null,removeExtmapAllowMixed:n0,shimAddIceCandidateNullOrEmpty:S_,shimConnectionState:t0,shimMaxMessageSize:__,shimParameterlessSetLocalDescription:b_,shimRTCIceCandidate:v_,shimRTCIceCandidateRelayProtocol:e0,shimSendThrowTypeError:E_});(function(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=T2,s=function(u){const h={browser:null,version:null};if(u===void 0||!u.navigator)return h.browser="Not a browser.",h;const{navigator:f}=u;if(f.mozGetUserMedia)h.browser="firefox",h.version=y_(f.userAgent,/Firefox\/(\d+)\./,1);else if(f.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)h.browser="chrome",h.version=y_(f.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!u.RTCPeerConnection||!f.userAgent.match(/AppleWebKit\/(\d+)\./))return h.browser="Not a supported browser.",h;h.browser="safari",h.version=y_(f.userAgent,/AppleWebKit\/(\d+)\./,1),h.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype}return h}(n),c={browserDetails:s,commonShim:Kce,extractVersion:y_,disableLog:xce,disableWarnings:Dce,sdp:zce};switch(s.browser){case"chrome":if(!U2||!YR||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),c;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),c;i("adapter.js shimming chrome."),c.browserShim=U2,S_(n,s),b_(n),A2(n,s),I2(n),YR(n,s),N2(n),k2(n,s),P2(n),x2(n),D2(n),M2(n,s),v_(n),e0(n),t0(n),__(n,s),E_(n),n0(n,s);break;case"firefox":if(!q2||!XR||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),c;i("adapter.js shimming firefox."),c.browserShim=q2,S_(n,s),b_(n),j2(n,s),XR(n,s),V2(n),W2(n),B2(n),F2(n),G2(n),$2(n),H2(n),z2(n),K2(n),v_(n),t0(n),__(n,s),E_(n);break;case"safari":if(!iU||!r.shimSafari)return i("Safari shim is not included in this adapter release."),c;i("adapter.js shimming safari."),c.browserShim=iU,S_(n,s),b_(n),eU(n),nU(n),J2(n),Y2(n),X2(n),tU(n),Q2(n),rU(n),v_(n),e0(n),__(n,s),E_(n),n0(n,s);break;default:i("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var uU=$s,qce=TypeError,dU=ea.match(/firefox\/(\d+)/i),Yce=!!dU&&+dU[1],Xce=/MSIE|Trident/.test(ea),hU=ea.match(/AppleWebKit\/(\d+)\./),Jce=!!hU&&+hU[1],Qce=kt,fU=b,Zce=Vr,ele=cs,pU=Vc,tle=function(n,r){if(!delete n[r])throw new qce("Cannot delete property "+uU(r)+" of "+uU(n))},mU=ta,r0=d,nle=SM,rle=Av,gU=Yce,ile=Xce,yU=ss,vU=Jce,zc=[],_U=fU(zc.sort),ale=fU(zc.push),ole=r0(function(){zc.sort(void 0)}),sle=r0(function(){zc.sort(null)}),cle=rle("sort"),EU=!r0(function(){if(yU)return yU<70;if(!(gU&&gU>3)){if(ile)return!0;if(vU)return vU<603;var n,r,i,s,c="";for(n=65;n<76;n++){switch(r=String.fromCharCode(n),n){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(s=0;s<47;s++)zc.push({k:r+s,v:i})}for(zc.sort(function(u,h){return h.v-u.v}),s=0;s<zc.length;s++)r=zc[s].k.charAt(0),c.charAt(c.length-1)!==r&&(c+=r);return c!=="DGBEFHACIJK"}});Qce({target:"Array",proto:!0,forced:ole||!sle||!cle||!EU},{sort:function(n){n!==void 0&&Zce(n);var r=ele(this);if(EU)return n===void 0?_U(r):_U(r,n);var i,s,c=[],u=pU(r);for(s=0;s<u;s++)s in r&&ale(c,r[s]);for(nle(c,function(h){return function(f,m){return m===void 0?-1:f===void 0?1:h!==void 0?+h(f,m)||0:mU(f)>mU(m)?1:-1}}(n)),i=pU(c),s=0;s<i;)r[s]=c[s++];for(;s<u;)tle(r,s++);return r}});var lle=za("Array","sort"),ule=R,dle=lle,i0=Array.prototype,hle=function(n){var r=n.sort;return n===i0||ule(i0,n)&&r===i0.sort?dle:r},om=l(hle),a0=P;kt({global:!0,forced:a0.globalThis!==a0},{globalThis:a0});var SU=l(P),o0={exports:{}};(function(n,r){(function(i,s){var c="function",u="undefined",h="object",f="string",m="major",y="model",_="name",S="type",w="vendor",O="version",W="architecture",k="console",j="mobile",H="tablet",K="smarttv",Q="wearable",ie="embedded",re="Amazon",te="Apple",he="ASUS",Se="BlackBerry",Ne="Browser",ke="Chrome",pt="Firefox",mt="Google",Xt="Huawei",An="LG",_n="Microsoft",Ei="Motorola",pe="Opera",we="Samsung",We="Sharp",ge="Sony",I="Xiaomi",X="Zebra",J="Facebook",Te="Chromium OS",it="Mac OS",Ft=function(Hn){for(var ar={},an=0;an<Hn.length;an++)ar[Hn[an].toUpperCase()]=Hn[an];return ar},ir=function(Hn,ar){return typeof Hn===f&&Di(ar).indexOf(Di(Hn))!==-1},Di=function(Hn){return Hn.toLowerCase()},uc=function(Hn,ar){if(typeof Hn===f)return Hn=Hn.replace(/^\s\s*/,""),typeof ar===u?Hn:Hn.substring(0,350)},Yu=function(Hn,ar){for(var an,Ki,Is,In,At,Li,pl=0;pl<ar.length&&!At;){var Ho=ar[pl],KW=ar[pl+1];for(an=Ki=0;an<Ho.length&&!At&&Ho[an];)if(At=Ho[an++].exec(Hn))for(Is=0;Is<KW.length;Is++)Li=At[++Ki],typeof(In=KW[Is])===h&&In.length>0?In.length===2?typeof In[1]==c?this[In[0]]=In[1].call(this,Li):this[In[0]]=In[1]:In.length===3?typeof In[1]!==c||In[1].exec&&In[1].test?this[In[0]]=Li?Li.replace(In[1],In[2]):s:this[In[0]]=Li?In[1].call(this,Li,In[2]):s:In.length===4&&(this[In[0]]=Li?In[3].call(this,Li.replace(In[1],In[2])):s):this[In]=Li||s;pl+=2}},cg=function(Hn,ar){for(var an in ar)if(typeof ar[an]===h&&ar[an].length>0){for(var Ki=0;Ki<ar[an].length;Ki++)if(ir(ar[an][Ki],Hn))return an==="?"?s:an}else if(ir(ar[an],Hn))return an==="?"?s:an;return Hn},pS={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},mS={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[O,[_,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[O,[_,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[_,O],[/opios[\/ ]+([\w\.]+)/i],[O,[_,pe+" Mini"]],[/\bopr\/([\w\.]+)/i],[O,[_,pe]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[_,O],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[O,[_,"UC"+Ne]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[O,[_,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[O,[_,"WeChat"]],[/konqueror\/([\w\.]+)/i],[O,[_,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[O,[_,"IE"]],[/yabrowser\/([\w\.]+)/i],[O,[_,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[_,/(.+)/,"$1 Secure "+Ne],O],[/\bfocus\/([\w\.]+)/i],[O,[_,pt+" Focus"]],[/\bopt\/([\w\.]+)/i],[O,[_,pe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[O,[_,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[O,[_,"Dolphin"]],[/coast\/([\w\.]+)/i],[O,[_,pe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[O,[_,"MIUI "+Ne]],[/fxios\/([-\w\.]+)/i],[O,[_,pt]],[/\bqihu|(qi?ho?o?|360)browser/i],[[_,"360 "+Ne]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[_,/(.+)/,"$1 "+Ne],O],[/(comodo_dragon)\/([\w\.]+)/i],[[_,/_/g," "],O],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[_,O],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[_],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[_,J],O],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[_,O],[/\bgsa\/([\w\.]+) .*safari\//i],[O,[_,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[O,[_,ke+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[_,ke+" WebView"],O],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[O,[_,"Android "+Ne]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[_,O],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[O,[_,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[O,_],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[_,[O,cg,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[_,O],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[_,"Netscape"],O],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[O,[_,pt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[_,O],[/(cobalt)\/([\w\.]+)/i],[_,[O,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[W,"amd64"]],[/(ia32(?=;))/i],[[W,Di]],[/((?:i[346]|x)86)[;\)]/i],[[W,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[W,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[W,"armhf"]],[/windows (ce|mobile); ppc;/i],[[W,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[W,/ower/,"",Di]],[/(sun4\w)[;\)]/i],[[W,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[W,Di]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[y,[w,we],[S,H]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[y,[w,we],[S,j]],[/\((ip(?:hone|od)[\w ]*);/i],[y,[w,te],[S,j]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[y,[w,te],[S,H]],[/(macintosh);/i],[y,[w,te]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[y,[w,We],[S,j]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[y,[w,Xt],[S,H]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[y,[w,Xt],[S,j]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[y,/_/g," "],[w,I],[S,j]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[y,/_/g," "],[w,I],[S,H]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[y,[w,"OPPO"],[S,j]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[y,[w,"Vivo"],[S,j]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[y,[w,"Realme"],[S,j]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[y,[w,Ei],[S,j]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[y,[w,Ei],[S,H]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[y,[w,An],[S,H]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[y,[w,An],[S,j]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[y,[w,"Lenovo"],[S,H]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[y,/_/g," "],[w,"Nokia"],[S,j]],[/(pixel c)\b/i],[y,[w,mt],[S,H]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[y,[w,mt],[S,j]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[y,[w,ge],[S,j]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[y,"Xperia Tablet"],[w,ge],[S,H]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[y,[w,"OnePlus"],[S,j]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[y,[w,re],[S,H]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[y,/(.+)/g,"Fire Phone $1"],[w,re],[S,j]],[/(playbook);[-\w\),; ]+(rim)/i],[y,w,[S,H]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[y,[w,Se],[S,j]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[y,[w,he],[S,H]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[y,[w,he],[S,j]],[/(nexus 9)/i],[y,[w,"HTC"],[S,H]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[w,[y,/_/g," "],[S,j]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[y,[w,"Acer"],[S,H]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[y,[w,"Meizu"],[S,j]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[w,y,[S,j]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[w,y,[S,H]],[/(surface duo)/i],[y,[w,_n],[S,H]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[y,[w,"Fairphone"],[S,j]],[/(u304aa)/i],[y,[w,"AT&T"],[S,j]],[/\bsie-(\w*)/i],[y,[w,"Siemens"],[S,j]],[/\b(rct\w+) b/i],[y,[w,"RCA"],[S,H]],[/\b(venue[\d ]{2,7}) b/i],[y,[w,"Dell"],[S,H]],[/\b(q(?:mv|ta)\w+) b/i],[y,[w,"Verizon"],[S,H]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[y,[w,"Barnes & Noble"],[S,H]],[/\b(tm\d{3}\w+) b/i],[y,[w,"NuVision"],[S,H]],[/\b(k88) b/i],[y,[w,"ZTE"],[S,H]],[/\b(nx\d{3}j) b/i],[y,[w,"ZTE"],[S,j]],[/\b(gen\d{3}) b.+49h/i],[y,[w,"Swiss"],[S,j]],[/\b(zur\d{3}) b/i],[y,[w,"Swiss"],[S,H]],[/\b((zeki)?tb.*\b) b/i],[y,[w,"Zeki"],[S,H]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[w,"Dragon Touch"],y,[S,H]],[/\b(ns-?\w{0,9}) b/i],[y,[w,"Insignia"],[S,H]],[/\b((nxa|next)-?\w{0,9}) b/i],[y,[w,"NextBook"],[S,H]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[w,"Voice"],y,[S,j]],[/\b(lvtel\-)?(v1[12]) b/i],[[w,"LvTel"],y,[S,j]],[/\b(ph-1) /i],[y,[w,"Essential"],[S,j]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[y,[w,"Envizen"],[S,H]],[/\b(trio[-\w\. ]+) b/i],[y,[w,"MachSpeed"],[S,H]],[/\btu_(1491) b/i],[y,[w,"Rotor"],[S,H]],[/(shield[\w ]+) b/i],[y,[w,"Nvidia"],[S,H]],[/(sprint) (\w+)/i],[w,y,[S,j]],[/(kin\.[onetw]{3})/i],[[y,/\./g," "],[w,_n],[S,j]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[y,[w,X],[S,H]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[y,[w,X],[S,j]],[/smart-tv.+(samsung)/i],[w,[S,K]],[/hbbtv.+maple;(\d+)/i],[[y,/^/,"SmartTV"],[w,we],[S,K]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[w,An],[S,K]],[/(apple) ?tv/i],[w,[y,te+" TV"],[S,K]],[/crkey/i],[[y,ke+"cast"],[w,mt],[S,K]],[/droid.+aft(\w)( bui|\))/i],[y,[w,re],[S,K]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[y,[w,We],[S,K]],[/(bravia[\w ]+)( bui|\))/i],[y,[w,ge],[S,K]],[/(mitv-\w{5}) bui/i],[y,[w,I],[S,K]],[/Hbbtv.*(technisat) (.*);/i],[w,y,[S,K]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[w,uc],[y,uc],[S,K]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[S,K]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[w,y,[S,k]],[/droid.+; (shield) bui/i],[y,[w,"Nvidia"],[S,k]],[/(playstation [345portablevi]+)/i],[y,[w,ge],[S,k]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[y,[w,_n],[S,k]],[/((pebble))app/i],[w,y,[S,Q]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[y,[w,te],[S,Q]],[/droid.+; (glass) \d/i],[y,[w,mt],[S,Q]],[/droid.+; (wt63?0{2,3})\)/i],[y,[w,X],[S,Q]],[/(quest( 2| pro)?)/i],[y,[w,J],[S,Q]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[w,[S,ie]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[y,[S,j]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[y,[S,H]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[S,H]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[S,j]],[/(android[-\w\. ]{0,9});.+buil/i],[y,[w,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[O,[_,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[O,[_,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[_,O],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[O,_]],os:[[/microsoft (windows) (vista|xp)/i],[_,O],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[_,[O,cg,pS]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[_,"Windows"],[O,cg,pS]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[O,/_/g,"."],[_,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[_,it],[O,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[O,_],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[_,O],[/\(bb(10);/i],[O,[_,Se]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[O,[_,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[O,[_,pt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[O,[_,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[O,[_,"watchOS"]],[/crkey\/([\d\.]+)/i],[O,[_,ke+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[_,Te],O],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[_,O],[/(sunos) ?([\w\.\d]*)/i],[[_,"Solaris"],O],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[_,O]]},Da=function(Hn,ar){if(typeof Hn===h&&(ar=Hn,Hn=s),!(this instanceof Da))return new Da(Hn,ar).getResult();var an=typeof i!==u&&i.navigator?i.navigator:s,Ki=Hn||(an&&an.userAgent?an.userAgent:""),Is=an&&an.userAgentData?an.userAgentData:s,In=ar?function(At,Li){var pl={};for(var Ho in At)Li[Ho]&&Li[Ho].length%2==0?pl[Ho]=Li[Ho].concat(At[Ho]):pl[Ho]=At[Ho];return pl}(mS,ar):mS;return this.getBrowser=function(){var At={};return At[_]=s,At[O]=s,Yu.call(At,Ki,In.browser),At[m]=function(Li){return typeof Li===f?Li.replace(/[^\d\.]/g,"").split(".")[0]:s}(At[O]),an&&an.brave&&typeof an.brave.isBrave==c&&(At[_]="Brave"),At},this.getCPU=function(){var At={};return At[W]=s,Yu.call(At,Ki,In.cpu),At},this.getDevice=function(){var At={};return At[w]=s,At[y]=s,At[S]=s,Yu.call(At,Ki,In.device),!At[S]&&Is&&Is.mobile&&(At[S]=j),At[y]=="Macintosh"&&an&&typeof an.standalone!==u&&an.maxTouchPoints&&an.maxTouchPoints>2&&(At[y]="iPad",At[S]=H),At},this.getEngine=function(){var At={};return At[_]=s,At[O]=s,Yu.call(At,Ki,In.engine),At},this.getOS=function(){var At={};return At[_]=s,At[O]=s,Yu.call(At,Ki,In.os),!At[_]&&Is&&Is.platform!="Unknown"&&(At[_]=Is.platform.replace(/chrome os/i,Te).replace(/macos/i,it)),At},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ki},this.setUA=function(At){return Ki=typeof At===f&&At.length>350?uc(At,350):At,this},this.setUA(Ki),this};Da.VERSION="0.7.34",Da.BROWSER=Ft([_,O,m]),Da.CPU=Ft([W]),Da.DEVICE=Ft([y,w,S,k,j,K,H,Q,ie]),Da.ENGINE=Da.OS=Ft([_,O]),n.exports&&(r=n.exports=Da),r.UAParser=Da;var fl=typeof i!==u&&(i.jQuery||i.Zepto);if(fl&&!fl.ua){var Xu=new Da;fl.ua=Xu.getResult(),fl.ua.get=function(){return Xu.getUA()},fl.ua.set=function(Hn){Xu.setUA(Hn);var ar=Xu.getResult();for(var an in ar)fl.ua[an]=ar[an]}}})(typeof window=="object"?window:o)})(o0,o0.exports);var fle=l(o0.exports),ple=Hs,mle=Dr,gle=He,yle=du,vle=Fn("iterator"),_le=Object,Ele=function(n){if(gle(n))return!1;var r=_le(n);return r[vle]!==void 0||"@@iterator"in r||mle(yle,ple(r))},Sle=l(Ele),bU=Yv.clear;kt({global:!0,bind:!0,enumerable:!0,forced:P.clearImmediate!==bU},{clearImmediate:bU});var TU=P,ble=B,Tle=ce,wle=fC,Cle=ea,Rle=Fc,Ole=pu,Ale=TU.Function,Ile=/MSIE .\./.test(Cle)||wle==="BUN"&&function(){var n=TU.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),Nle=kt,wU=P,CU=Yv.set,Ple=function(n,r){var i=1;return Ile?function(s,c){var u=Ole(arguments.length,1)>i,h=Tle(s)?s:Ale(s),f=u?Rle(arguments,i):[],m=u?function(){ble(h,this,f)}:h;return n(m)}:n},RU=wU.setImmediate?Ple(CU):CU;Nle({global:!0,bind:!0,enumerable:!0,forced:wU.setImmediate!==RU},{setImmediate:RU});var OU=l(er.setImmediate),xle=P,Dle=jk,Lle=Vr,kle=pu,Mle=ae;kt({global:!0,enumerable:!0,dontCallGetSet:!0,forced:d(function(){return Mle&&Object.getOwnPropertyDescriptor(xle,"queueMicrotask").value.length!==1})},{queueMicrotask:function(n){kle(arguments.length,1),Dle(Lle(n))}});var AU=l(er.queueMicrotask);function IU(n,r){return function(){return n.apply(r,arguments)}}const{toString:Ule}=Object.prototype,{getPrototypeOf:s0}=Object,T_=(c0=Object.create(null),n=>{const r=Ule.call(n);return c0[r]||(c0[r]=r.slice(8,-1).toLowerCase())});var c0;const xo=n=>(n=n.toLowerCase(),r=>T_(r)===n),w_=n=>r=>typeof r===n,{isArray:sh}=Array,sm=w_("undefined"),NU=xo("ArrayBuffer"),jle=w_("string"),Ta=w_("function"),PU=w_("number"),C_=n=>n!==null&&typeof n=="object",R_=n=>{if(T_(n)!=="object")return!1;const r=s0(n);return!(r!==null&&r!==Object.prototype&&Object.getPrototypeOf(r)!==null||Symbol.toStringTag in n||Sle(n))},Vle=xo("Date"),Ble=xo("File"),Fle=xo("Blob"),Wle=xo("FileList"),Gle=xo("URLSearchParams"),[$le,Hle,zle,Kle]=["ReadableStream","Request","Response","Headers"].map(xo);function cm(n,r){let i,s,{allOwnKeys:c=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n!=null)if(typeof n!="object"&&(n=[n]),sh(n))for(i=0,s=n.length;i<s;i++)r.call(null,n[i],i,n);else{const u=c?Object.getOwnPropertyNames(n):Object.keys(n),h=u.length;let f;for(i=0;i<h;i++)f=u[i],r.call(null,n[f],f,n)}}function xU(n,r){r=r.toLowerCase();const i=Object.keys(n);let s,c=i.length;for(;c-- >0;)if(s=i[c],r===s.toLowerCase())return s;return null}const Eu=SU!==void 0?SU:typeof self<"u"?self:typeof window<"u"?window:Al,DU=n=>!sm(n)&&n!==Eu,qle=(l0=typeof Uint8Array<"u"&&s0(Uint8Array),n=>l0&&n instanceof l0);var l0;const Yle=xo("HTMLFormElement"),LU=(n=>{let{hasOwnProperty:r}=n;return(i,s)=>r.call(i,s)})(Object.prototype),Xle=xo("RegExp"),kU=(n,r)=>{const i=Object.getOwnPropertyDescriptors(n),s={};cm(i,(c,u)=>{let h;(h=r(c,u,n))!==!1&&(s[u]=h||c)}),Object.defineProperties(n,s)},u0="abcdefghijklmnopqrstuvwxyz",MU="0123456789",UU={DIGIT:MU,ALPHA:u0,ALPHA_DIGIT:u0+u0.toUpperCase()+MU},Jle=xo("AsyncFunction"),jU=(VU=typeof OU=="function",BU=Ta(Eu.postMessage),VU?OU:BU?(d0="axios@".concat(Math.random()),O_=[],Eu.addEventListener("message",n=>{let{source:r,data:i}=n;r===Eu&&i===d0&&O_.length&&O_.shift()()},!1),n=>{O_.push(n),Eu.postMessage(d0,"*")}):n=>setTimeout(n));var VU,BU,d0,O_;const Qle=AU!==void 0?AU.bind(Eu):typeof process<"u"&&process.nextTick||jU;var Ae={isArray:sh,isArrayBuffer:NU,isBuffer:function(n){return n!==null&&!sm(n)&&n.constructor!==null&&!sm(n.constructor)&&Ta(n.constructor.isBuffer)&&n.constructor.isBuffer(n)},isFormData:n=>{let r;return n&&(typeof FormData=="function"&&n instanceof FormData||Ta(n.append)&&((r=T_(n))==="formdata"||r==="object"&&Ta(n.toString)&&n.toString()==="[object FormData]"))},isArrayBufferView:function(n){let r;return r=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer&&NU(n.buffer),r},isString:jle,isNumber:PU,isBoolean:n=>n===!0||n===!1,isObject:C_,isPlainObject:R_,isReadableStream:$le,isRequest:Hle,isResponse:zle,isHeaders:Kle,isUndefined:sm,isDate:Vle,isFile:Ble,isBlob:Fle,isRegExp:Xle,isFunction:Ta,isStream:n=>C_(n)&&Ta(n.pipe),isURLSearchParams:Gle,isTypedArray:qle,isFileList:Wle,forEach:cm,merge:function n(){const{caseless:r}=DU(this)&&this||{},i={},s=(c,u)=>{const h=r&&xU(i,u)||u;R_(i[h])&&R_(c)?i[h]=n(i[h],c):R_(c)?i[h]=n({},c):sh(c)?i[h]=c.slice():i[h]=c};for(let c=0,u=arguments.length;c<u;c++)arguments[c]&&cm(arguments[c],s);return i},extend:function(n,r,i){let{allOwnKeys:s}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return cm(r,(c,u)=>{i&&Ta(c)?n[u]=IU(c,i):n[u]=c},{allOwnKeys:s}),n},trim:n=>Hr(n)?Hr(n).call(n):n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),inherits:(n,r,i,s)=>{n.prototype=Object.create(r.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:r.prototype}),i&&Object.assign(n.prototype,i)},toFlatObject:(n,r,i,s)=>{let c,u,h;const f={};if(r=r||{},n==null)return r;do{for(c=Object.getOwnPropertyNames(n),u=c.length;u-- >0;)h=c[u],s&&!s(h,n,r)||f[h]||(r[h]=n[h],f[h]=!0);n=i!==!1&&s0(n)}while(n&&(!i||i(n,r))&&n!==Object.prototype);return r},kindOf:T_,kindOfTest:xo,endsWith:(n,r,i)=>{n=String(n),(i===void 0||i>n.length)&&(i=n.length),i-=r.length;const s=n.indexOf(r,i);return s!==-1&&s===i},toArray:n=>{if(!n)return null;if(sh(n))return n;let r=n.length;if(!PU(r))return null;const i=new Array(r);for(;r-- >0;)i[r]=n[r];return i},forEachEntry:(n,r)=>{const i=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=i.next())&&!s.done;){const c=s.value;r.call(n,c[0],c[1])}},matchAll:(n,r)=>{let i;const s=[];for(;(i=n.exec(r))!==null;)s.push(i);return s},isHTMLForm:Yle,hasOwnProperty:LU,hasOwnProp:LU,reduceDescriptors:kU,freezeMethods:n=>{kU(n,(r,i)=>{if(Ta(n)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const s=n[i];Ta(s)&&(r.enumerable=!1,"writable"in r?r.writable=!1:r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))})},toObjectSet:(n,r)=>{const i={},s=c=>{c.forEach(u=>{i[u]=!0})};return sh(n)?s(n):s(String(n).split(r)),i},toCamelCase:n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,s){return i.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(n,r)=>n!=null&&Number.isFinite(n=+n)?n:r,findKey:xU,global:Eu,isContextDefined:DU,ALPHABET:UU,generateString:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:UU.ALPHA_DIGIT,i="";const{length:s}=r;for(;n--;)i+=r[Math.random()*s|0];return i},isSpecCompliantForm:function(n){return!!(n&&Ta(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])},toJSONObject:n=>{const r=new Array(10),i=(s,c)=>{if(C_(s)){if(r.indexOf(s)>=0)return;if(!("toJSON"in s)){r[c]=s;const u=sh(s)?[]:{};return cm(s,(h,f)=>{const m=i(h,c+1);!sm(m)&&(u[f]=m)}),r[c]=void 0,u}}return s};return i(n,0)},isAsyncFn:Jle,isThenable:n=>n&&(C_(n)||Ta(n))&&Ta(n.then)&&Ta(n.catch),setImmediate:jU,asap:Qle};function Vt(n,r,i,s,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",r&&(this.code=r),i&&(this.config=i),s&&(this.request=s),c&&(this.response=c,this.status=c.status?c.status:null)}Ae.inherits(Vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});const FU=Vt.prototype,WU={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{WU[n]={value:n}}),Object.defineProperties(Vt,WU),Object.defineProperty(FU,"isAxiosError",{value:!0}),Vt.from=(n,r,i,s,c,u)=>{const h=Object.create(FU);return Ae.toFlatObject(n,h,function(f){return f!==Error.prototype},f=>f!=="isAxiosError"),Vt.call(h,n.message,r,i,s,c),h.cause=n,h.name=n.name,u&&Object.assign(h,u),h};function h0(n){return Ae.isPlainObject(n)||Ae.isArray(n)}function GU(n){return Ae.endsWith(n,"[]")?n.slice(0,-2):n}function $U(n,r,i){return n?n.concat(r).map(function(s,c){return s=GU(s),!i&&c?"["+s+"]":s}).join(i?".":""):r}const Zle=Ae.toFlatObject(Ae,{},null,function(n){return/^is[A-Z]/.test(n)});function A_(n,r,i){if(!Ae.isObject(n))throw new TypeError("target must be an object");r=r||new FormData;const s=(i=Ae.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,O){return!Ae.isUndefined(O[w])})).metaTokens,c=i.visitor||y,u=i.dots,h=i.indexes,f=(i.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(r);if(!Ae.isFunction(c))throw new TypeError("visitor must be a function");function m(w){if(w===null)return"";if(Ae.isDate(w))return w.toISOString();if(!f&&Ae.isBlob(w))throw new Vt("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(w)||Ae.isTypedArray(w)?f&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function y(w,O,W){let k=w;if(w&&!W&&typeof w=="object"){if(Ae.endsWith(O,"{}"))O=s?O:O.slice(0,-2),w=JSON.stringify(w);else if(Ae.isArray(w)&&function(j){return Ae.isArray(j)&&!j.some(h0)}(w)||(Ae.isFileList(w)||Ae.endsWith(O,"[]"))&&(k=Ae.toArray(w)))return O=GU(O),k.forEach(function(j,H){!Ae.isUndefined(j)&&j!==null&&r.append(h===!0?$U([O],H,u):h===null?O:O+"[]",m(j))}),!1}return!!h0(w)||(r.append($U(W,O,u),m(w)),!1)}const _=[],S=Object.assign(Zle,{defaultVisitor:y,convertValue:m,isVisitable:h0});if(!Ae.isObject(n))throw new TypeError("data must be an object");return function w(O,W){if(!Ae.isUndefined(O)){if(_.indexOf(O)!==-1)throw Error("Circular reference detected in "+W.join("."));_.push(O),Ae.forEach(O,function(k,j){(!(Ae.isUndefined(k)||k===null)&&c.call(r,k,Ae.isString(j)?Hr(j).call(j):j,W,S))===!0&&w(k,W?W.concat(j):[j])}),_.pop()}}(n),r}function HU(n){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return r[i]})}function f0(n,r){this._pairs=[],n&&A_(n,this,r)}const zU=f0.prototype;function eue(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function KU(n,r,i){if(!r)return n;const s=i&&i.encode||eue;Ae.isFunction(i)&&(i={serialize:i});const c=i&&i.serialize;let u;if(u=c?c(r,i):Ae.isURLSearchParams(r)?r.toString():new f0(r,i).toString(s),u){const h=n.indexOf("#");h!==-1&&(n=n.slice(0,h)),n+=(n.indexOf("?")===-1?"?":"&")+u}return n}zU.append=function(n,r){this._pairs.push([n,r])},zU.toString=function(n){const r=n?function(i){return n.call(this,i,HU)}:HU;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};var qU=class{constructor(){this.handlers=[]}use(n,r,i){return this.handlers.push({fulfilled:n,rejected:r,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ae.forEach(this.handlers,function(r){r!==null&&n(r)})}},YU={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},XU={exports:{}},tue=kt,nue=ae,JU=Ha.f;tue({target:"Object",stat:!0,forced:Object.defineProperty!==JU,sham:!nue},{defineProperty:JU});var QU=er.Object,rue=XU.exports=function(n,r,i){return QU.defineProperty(n,r,i)};QU.defineProperty.sham&&(rue.sham=!0);var ZU=l(XU.exports),iue=TypeError,ej=Fp,aue=qv,oue=Bn,sue=Fn("species"),tj=Array,cue=function(n){var r;return ej(n)&&(r=n.constructor,(aue(r)&&(r===tj||ej(r.prototype))||oue(r)&&(r=r[sue])===null)&&(r=void 0)),r===void 0?tj:r},nj=function(n,r){return new(cue(n))(r===0?0:r)},lue=d,uue=ss,due=Fn("species"),rj=function(n){return uue>=51||!lue(function(){var r=[];return(r.constructor={})[due]=function(){return{foo:1}},r[n](Boolean).foo!==1})},hue=kt,fue=d,pue=Fp,mue=Bn,gue=cs,yue=Vc,ij=function(n){if(n>9007199254740991)throw iue("Maximum allowed index exceeded");return n},aj=CR,vue=nj,_ue=rj,Eue=ss,oj=Fn("isConcatSpreadable"),Sue=Eue>=51||!fue(function(){var n=[];return n[oj]=!1,n.concat()[0]!==n}),bue=function(n){if(!mue(n))return!1;var r=n[oj];return r!==void 0?!!r:pue(n)};hue({target:"Array",proto:!0,arity:1,forced:!Sue||!_ue("concat")},{concat:function(n){var r,i,s,c,u,h=gue(this),f=vue(h,0),m=0;for(r=-1,s=arguments.length;r<s;r++)if(bue(u=r===-1?h:arguments[r]))for(c=yue(u),ij(m+c),i=0;i<c;i++,m++)i in u&&aj(f,m,u[i]);else ij(m+1),aj(f,m++,u);return f.length=m,f}});var sj={},Tue=q,wue=Tn,cj=xv.f,Cue=Fc,lj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];sj.f=function(n){return lj&&Tue(n)==="Window"?function(r){try{return cj(r)}catch{return Cue(lj)}}(n):cj(wue(n))};var ch={},Rue=Fn;ch.f=Rue;var uj=er,Oue=Dr,Aue=ch,Iue=Ha.f,yr=function(n){var r=uj.Symbol||(uj.Symbol={});Oue(r,n)||Iue(r,n,{value:Aue.f(n)})},Nue=_e,Pue=gr,xue=Fn,Due=Bc,dj=function(){var n=Pue("Symbol"),r=n&&n.prototype,i=r&&r.valueOf,s=xue("toPrimitive");r&&!r[s]&&Due(r,s,function(c){return Nue(i,this)},{arity:1})},Lue=jc,kue=ze,Mue=cs,Uue=Vc,jue=nj,hj=b([].push),Kc=function(n){var r=n===1,i=n===2,s=n===3,c=n===4,u=n===6,h=n===7,f=n===5||u;return function(m,y,_,S){for(var w,O,W=Mue(m),k=kue(W),j=Uue(k),H=Lue(y,_),K=0,Q=S||jue,ie=r?Q(m,j):i||h?Q(m,0):void 0;j>K;K++)if((f||K in k)&&(O=H(w=k[K],K,W),n))if(r)ie[K]=O;else if(O)switch(n){case 3:return!0;case 5:return w;case 6:return K;case 2:hj(ie,w)}else switch(n){case 4:return!1;case 7:hj(ie,w)}return u?-1:s||c?c:ie}},fj={forEach:Kc(0),map:Kc(1),filter:Kc(2),some:Kc(3),every:Kc(4),find:Kc(5),findIndex:Kc(6),filterReject:Kc(7)},I_=kt,lm=P,p0=_e,Vue=b,lh=ae,uh=Gs,Bue=d,ni=Dr,Fue=R,m0=Wi,N_=Tn,g0=eC,Wue=ta,y0=nt,dh=Gp,pj=Lv,Gue=xv,mj=sj,$ue=Wp,gj=be,yj=Ha,Hue=EC,vj=ue,_j=Bc,zue=Kv,v0=Vd,Ej=Dv,Sj=Qw,Kue=Fn,que=ch,Yue=yr,Xue=dj,Jue=zs,bj=fu,P_=fj.forEach,ra=Pv("hidden"),x_="Symbol",um="prototype",Que=bj.set,Tj=bj.getterFor(x_),Do=Object[um],Su=lm.Symbol,D_=Su&&Su[um],Zue=lm.RangeError,ede=lm.TypeError,_0=lm.QObject,wj=gj.f,bu=yj.f,Cj=mj.f,tde=vj.f,Rj=Vue([].push),Ys=v0("symbols"),dm=v0("op-symbols"),nde=v0("wks"),E0=!_0||!_0[um]||!_0[um].findChild,Oj=function(n,r,i){var s=wj(Do,r);s&&delete Do[r],bu(n,r,i),s&&n!==Do&&bu(Do,r,s)},S0=lh&&Bue(function(){return dh(bu({},"a",{get:function(){return bu(this,"a",{value:7}).a}})).a!==7})?Oj:bu,b0=function(n,r){var i=Ys[n]=dh(D_);return Que(i,{type:x_,tag:n,description:r}),lh||(i.description=r),i},L_=function(n,r,i){n===Do&&L_(dm,r,i),m0(n);var s=g0(r);return m0(i),ni(Ys,s)?(i.enumerable?(ni(n,ra)&&n[ra][s]&&(n[ra][s]=!1),i=dh(i,{enumerable:y0(0,!1)})):(ni(n,ra)||bu(n,ra,y0(1,dh(null))),n[ra][s]=!0),S0(n,s,i)):bu(n,s,i)},T0=function(n,r){m0(n);var i=N_(r),s=pj(i).concat(Pj(i));return P_(s,function(c){lh&&!p0(Aj,i,c)||L_(n,c,i[c])}),n},Aj=function(n){var r=g0(n),i=p0(tde,this,r);return!(this===Do&&ni(Ys,r)&&!ni(dm,r))&&(!(i||!ni(this,r)||!ni(Ys,r)||ni(this,ra)&&this[ra][r])||i)},Ij=function(n,r){var i=N_(n),s=g0(r);if(i!==Do||!ni(Ys,s)||ni(dm,s)){var c=wj(i,s);return!c||!ni(Ys,s)||ni(i,ra)&&i[ra][s]||(c.enumerable=!0),c}},Nj=function(n){var r=Cj(N_(n)),i=[];return P_(r,function(s){ni(Ys,s)||ni(Ej,s)||Rj(i,s)}),i},Pj=function(n){var r=n===Do,i=Cj(r?dm:N_(n)),s=[];return P_(i,function(c){!ni(Ys,c)||r&&!ni(Do,c)||Rj(s,Ys[c])}),s};uh||(Su=function(){if(Fue(D_,this))throw new ede("Symbol is not a constructor");var n=arguments.length&&arguments[0]!==void 0?Wue(arguments[0]):void 0,r=Sj(n),i=function(s){var c=this===void 0?lm:this;c===Do&&p0(i,dm,s),ni(c,ra)&&ni(c[ra],r)&&(c[ra][r]=!1);var u=y0(1,s);try{S0(c,r,u)}catch(h){if(!(h instanceof Zue))throw h;Oj(c,r,u)}};return lh&&E0&&S0(Do,r,{configurable:!0,set:i}),b0(r,n)},_j(D_=Su[um],"toString",function(){return Tj(this).tag}),_j(Su,"withoutSetter",function(n){return b0(Sj(n),n)}),vj.f=Aj,yj.f=L_,Hue.f=T0,gj.f=Ij,Gue.f=mj.f=Nj,$ue.f=Pj,que.f=function(n){return b0(Kue(n),n)},lh&&zue(D_,"description",{configurable:!0,get:function(){return Tj(this).description}})),I_({global:!0,constructor:!0,wrap:!0,forced:!uh,sham:!uh},{Symbol:Su}),P_(pj(nde),function(n){Yue(n)}),I_({target:x_,stat:!0,forced:!uh},{useSetter:function(){E0=!0},useSimple:function(){E0=!1}}),I_({target:"Object",stat:!0,forced:!uh,sham:!lh},{create:function(n,r){return r===void 0?dh(n):T0(dh(n),r)},defineProperty:L_,defineProperties:T0,getOwnPropertyDescriptor:Ij}),I_({target:"Object",stat:!0,forced:!uh},{getOwnPropertyNames:Nj}),Xue(),Jue(Su,x_),Ej[ra]=!0;var xj=Gs&&!!Symbol.for&&!!Symbol.keyFor,rde=kt,ide=gr,ade=Dr,ode=ta,Dj=Vd,sde=xj,w0=Dj("string-to-symbol-registry"),cde=Dj("symbol-to-string-registry");rde({target:"Symbol",stat:!0,forced:!sde},{for:function(n){var r=ode(n);if(ade(w0,r))return w0[r];var i=ide("Symbol")(r);return w0[r]=i,cde[i]=r,i}});var lde=kt,ude=Dr,dde=Uc,hde=$s,fde=xj,Lj=Vd("symbol-to-string-registry");lde({target:"Symbol",stat:!0,forced:!fde},{keyFor:function(n){if(!dde(n))throw new TypeError(hde(n)+" is not a symbol");if(ude(Lj,n))return Lj[n]}});var kj=Fp,pde=ce,Mj=q,mde=ta,Uj=b([].push),gde=kt,jj=gr,Vj=B,yde=_e,hm=b,Bj=d,Fj=ce,Wj=Uc,Gj=Fc,vde=function(n){if(pde(n))return n;if(kj(n)){for(var r=n.length,i=[],s=0;s<r;s++){var c=n[s];typeof c=="string"?Uj(i,c):typeof c!="number"&&Mj(c)!=="Number"&&Mj(c)!=="String"||Uj(i,mde(c))}var u=i.length,h=!0;return function(f,m){if(h)return h=!1,m;if(kj(this))return m;for(var y=0;y<u;y++)if(i[y]===f)return m}}},_de=Gs,Ede=String,qc=jj("JSON","stringify"),k_=hm(/./.exec),$j=hm("".charAt),Sde=hm("".charCodeAt),bde=hm("".replace),Tde=hm(1 .toString),wde=/[\uD800-\uDFFF]/g,Hj=/^[\uD800-\uDBFF]$/,zj=/^[\uDC00-\uDFFF]$/,Kj=!_de||Bj(function(){var n=jj("Symbol")("stringify detection");return qc([n])!=="[null]"||qc({a:n})!=="{}"||qc(Object(n))!=="{}"}),qj=Bj(function(){return qc("\uDF06\uD834")!=='"\\udf06\\ud834"'||qc("\uDEAD")!=='"\\udead"'}),Cde=function(n,r){var i=Gj(arguments),s=vde(r);if(Fj(s)||n!==void 0&&!Wj(n))return i[1]=function(c,u){if(Fj(s)&&(u=yde(s,this,Ede(c),u)),!Wj(u))return u},Vj(qc,null,i)},Rde=function(n,r,i){var s=$j(i,r-1),c=$j(i,r+1);return k_(Hj,n)&&!k_(zj,c)||k_(zj,n)&&!k_(Hj,s)?"\\u"+Tde(Sde(n,0),16):n};qc&&gde({target:"JSON",stat:!0,arity:3,forced:Kj||qj},{stringify:function(n,r,i){var s=Gj(arguments),c=Vj(Kj?Cde:qc,null,s);return qj&&typeof c=="string"?bde(c,wde,Rde):c}});var Yj=Wp,Ode=cs;kt({target:"Object",stat:!0,forced:!Gs||d(function(){Yj.f(1)})},{getOwnPropertySymbols:function(n){var r=Yj.f;return r?r(Ode(n)):[]}}),yr("asyncIterator"),yr("hasInstance"),yr("isConcatSpreadable"),yr("iterator"),yr("match"),yr("matchAll"),yr("replace"),yr("search"),yr("species"),yr("split");var Ade=dj;yr("toPrimitive"),Ade();var Ide=gr,Nde=zs;yr("toStringTag"),Nde(Ide("Symbol"),"Symbol"),yr("unscopables"),zs(P.JSON,"JSON",!0);var Pde=er.Symbol,xde=Fn,Dde=Ha.f,Xj=xde("metadata"),Jj=Function.prototype;Jj[Xj]===void 0&&Dde(Jj,Xj,{value:null}),yr("asyncDispose"),yr("dispose"),yr("metadata");var Lde=Pde,kde=b,C0=gr("Symbol"),Mde=C0.keyFor,Ude=kde(C0.prototype.valueOf),Qj=C0.isRegisteredSymbol||function(n){try{return Mde(Ude(n))!==void 0}catch{return!1}};kt({target:"Symbol",stat:!0},{isRegisteredSymbol:Qj});for(var jde=Vd,Zj=gr,Vde=b,Bde=Uc,Fde=Fn,M_=Zj("Symbol"),eV=M_.isWellKnownSymbol,tV=Zj("Object","getOwnPropertyNames"),Wde=Vde(M_.prototype.valueOf),nV=jde("wks"),R0=0,rV=tV(M_),Gde=rV.length;R0<Gde;R0++)try{var iV=rV[R0];Bde(M_[iV])&&Fde(iV)}catch{}var aV=function(n){if(eV&&eV(n))return!0;try{for(var r=Wde(n),i=0,s=tV(nV),c=s.length;i<c;i++)if(nV[s[i]]==r)return!0}catch{}return!1};kt({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:aV}),yr("customMatcher"),yr("observable"),kt({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Qj}),kt({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:aV}),yr("matcher"),yr("metadataKey"),yr("patternMatch"),yr("replaceAll");var hh=l(Lde),oV=l(ch.f("iterator"));function fm(n){return fm=typeof hh=="function"&&typeof oV=="symbol"?function(r){return typeof r}:function(r){return r&&typeof hh=="function"&&r.constructor===hh&&r!==hh.prototype?"symbol":typeof r},fm(n)}var $de=l(ch.f("toPrimitive"));function Hde(n){var r=function(i,s){if(fm(i)!=="object"||i===null)return i;var c=i[$de];if(c!==void 0){var u=c.call(i,s||"default");if(fm(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}(n,"string");return fm(r)==="symbol"?r:String(r)}function F(n,r,i){return(r=Hde(r))in n?ZU(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}var sV=l(Ese),zde={isBrowser:!0,classes:{URLSearchParams:sV!==void 0?sV:f0,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const O0=typeof window<"u"&&typeof document<"u",A0=typeof navigator=="object"&&navigator||void 0,Kde=O0&&(!A0||["ReactNative","NativeScript","NS"].indexOf(A0.product)<0),qde=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Yde=O0&&window.location.href||"http://localhost";function cV(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function lV(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?cV(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):cV(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}var Oi=lV(lV({},Object.freeze({__proto__:null,hasBrowserEnv:O0,hasStandardBrowserEnv:Kde,hasStandardBrowserWebWorkerEnv:qde,navigator:A0,origin:Yde})),zde),Xde=Wi,Jde=_e,Qde=Dr,Zde=R,ehe=function(){var n=Xde(this),r="";return n.hasIndices&&(r+="d"),n.global&&(r+="g"),n.ignoreCase&&(r+="i"),n.multiline&&(r+="m"),n.dotAll&&(r+="s"),n.unicode&&(r+="u"),n.unicodeSets&&(r+="v"),n.sticky&&(r+="y"),r},uV=RegExp.prototype,dV=function(n){var r=n.flags;return r!==void 0||"flags"in uV||Qde(n,"flags")||!Zde(uV,n)?r:Jde(ehe,n)},the=fR.charAt,hV=_e,nhe=Wi,rhe=ce,ihe=q,ahe=/./.exec,ohe=TypeError,she=kt,fV=_e,pV=le,che=LC,U_=Hv,mV=zt,gV=fL,pm=ta,lhe=Wi,uhe=He,dhe=q,hhe=mL,yV=dV,fhe=Cv,phe=d,mhe=BC,ghe=function(n,r,i){return r+(i?the(n,r).length:1)},yhe=function(n,r){var i=n.exec;if(rhe(i)){var s=hV(i,n,r);return s!==null&&nhe(s),s}if(ihe(n)==="RegExp")return hV(ahe,n,r);throw new ohe("RegExp#exec called on incompatible receiver")},vV=fu,vhe=Fn("matchAll"),_V="RegExp String",EV=_V+" Iterator",_he=vV.set,Ehe=vV.getterFor(EV),She=TypeError,I0=pV("".indexOf),j_=pV("".matchAll),N0=!!j_&&!phe(function(){j_("a",/./)}),bhe=che(function(n,r,i,s){_he(this,{type:EV,regexp:n,string:r,global:i,unicode:s,done:!1})},_V,function(){var n=Ehe(this);if(n.done)return U_(void 0,!0);var r=n.regexp,i=n.string,s=yhe(r,i);return s===null?(n.done=!0,U_(void 0,!0)):n.global?(pm(s[0])===""&&(r.lastIndex=ghe(i,gV(r.lastIndex),n.unicode)),U_(s,!1)):(n.done=!0,U_(s,!1))}),SV=function(n){var r,i,s,c=lhe(this),u=pm(n),h=mhe(c,RegExp),f=pm(yV(c));return r=new h(h===RegExp?c.source:c,f),i=!!~I0(f,"g"),s=!!~I0(f,"u"),r.lastIndex=gV(c.lastIndex),new bhe(r,u,i,s)};she({target:"String",proto:!0,forced:N0},{matchAll:function(n){var r,i,s,c,u=mV(this);if(uhe(n)){if(N0)return j_(u,n)}else{if(hhe(n)&&(r=pm(mV(yV(n))),!~I0(r,"g")))throw new She("`.matchAll` does not allow non-global regexes");if(N0)return j_(u,n);if((s=fhe(n,vhe))===void 0&&dhe(n)==="RegExp"&&(s=SV),s)return fV(s,n,u)}return i=pm(u),c=new RegExp(n,"g"),fV(SV,c,i)}});var The=za("String","matchAll"),whe=R,Che=The,P0=String.prototype,Rhe=function(n){var r=n.matchAll;return typeof n=="string"||n===P0||whe(P0,n)&&r===P0.matchAll?Che:r},Ohe=l(Rhe);function bV(n){function r(i,s,c,u){let h=i[u++];if(h==="__proto__")return!0;const f=Number.isFinite(+h),m=u>=i.length;return h=!h&&Ae.isArray(c)?c.length:h,m?(Ae.hasOwnProp(c,h)?c[h]=[c[h],s]:c[h]=s,!f):(c[h]&&Ae.isObject(c[h])||(c[h]=[]),r(i,s,c[h],u)&&Ae.isArray(c[h])&&(c[h]=function(y){const _={},S=Object.keys(y);let w;const O=S.length;let W;for(w=0;w<O;w++)W=S[w],_[W]=y[W];return _}(c[h])),!f)}if(Ae.isFormData(n)&&Ae.isFunction(n.entries)){const i={};return Ae.forEachEntry(n,(s,c)=>{r(function(u){return Ohe(Ae).call(Ae,/\w+|\[(\w*)]/g,u).map(h=>h[0]==="[]"?"":h[1]||h[0])}(s),c,i,0)}),i}return null}const x0={transitional:YU,adapter:["xhr","http","fetch"],transformRequest:[function(n,r){const i=r.getContentType()||"",s=i.indexOf("application/json")>-1,c=Ae.isObject(n);if(c&&Ae.isHTMLForm(n)&&(n=new FormData(n)),Ae.isFormData(n))return s?JSON.stringify(bV(n)):n;if(Ae.isArrayBuffer(n)||Ae.isBuffer(n)||Ae.isStream(n)||Ae.isFile(n)||Ae.isBlob(n)||Ae.isReadableStream(n))return n;if(Ae.isArrayBufferView(n))return n.buffer;if(Ae.isURLSearchParams(n))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let u;if(c){if(i.indexOf("application/x-www-form-urlencoded")>-1)return function(h,f){return A_(h,new Oi.classes.URLSearchParams,Object.assign({visitor:function(m,y,_,S){return Oi.isNode&&Ae.isBuffer(m)?(this.append(y,m.toString("base64")),!1):S.defaultVisitor.apply(this,arguments)}},f))}(n,this.formSerializer).toString();if((u=Ae.isFileList(n))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return A_(u?{"files[]":n}:n,h&&new h,this.formSerializer)}}return c||s?(r.setContentType("application/json",!1),function(h,f,m){if(Ae.isString(h))try{return(f||JSON.parse)(h),Hr(Ae).call(Ae,h)}catch(y){if(y.name!=="SyntaxError")throw y}return(0,JSON.stringify)(h)}(n)):n}],transformResponse:[function(n){const r=this.transitional||x0.transitional,i=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Ae.isResponse(n)||Ae.isReadableStream(n))return n;if(n&&Ae.isString(n)&&(i&&!this.responseType||s)){const c=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(n)}catch(u){if(c)throw u.name==="SyntaxError"?Vt.from(u,Vt.ERR_BAD_RESPONSE,this,null,this.response):u}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Oi.classes.FormData,Blob:Oi.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],n=>{x0.headers[n]={}});var D0=x0;const Ahe=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TV=Symbol("internals");function mm(n){var r;return n&&Hr(r=String(n)).call(r).toLowerCase()}function V_(n){return n===!1||n==null?n:Ae.isArray(n)?n.map(V_):String(n)}function L0(n,r,i,s,c){return Ae.isFunction(s)?s.call(this,r,i):(c&&(r=i),Ae.isString(r)?Ae.isString(s)?r.indexOf(s)!==-1:Ae.isRegExp(s)?s.test(r):void 0:void 0)}class B_{constructor(r){r&&this.set(r)}set(r,i,s){const c=this;function u(m,y,_){const S=mm(y);if(!S)throw new Error("header name must be a non-empty string");const w=Ae.findKey(c,S);(!w||c[w]===void 0||_===!0||_===void 0&&c[w]!==!1)&&(c[w||y]=V_(m))}const h=(m,y)=>Ae.forEach(m,(_,S)=>u(_,S,y));if(Ae.isPlainObject(r)||r instanceof this.constructor)h(r,i);else if(Ae.isString(r)&&(r=Hr(r).call(r))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Hr(f=r).call(f)))h((m=>{const y={};let _,S,w;return m&&m.split(`
`).forEach(function(O){var W,k;w=O.indexOf(":"),_=Hr(W=O.substring(0,w)).call(W).toLowerCase(),S=Hr(k=O.substring(w+1)).call(k),!_||y[_]&&Ahe[_]||(_==="set-cookie"?y[_]?y[_].push(S):y[_]=[S]:y[_]=y[_]?y[_]+", "+S:S)}),y})(r),i);else if(Ae.isHeaders(r))for(const[m,y]of r.entries())u(y,m,s);else r!=null&&u(i,r,s);var f;return this}get(r,i){if(r=mm(r)){const s=Ae.findKey(this,r);if(s){const c=this[s];if(!i)return c;if(i===!0)return function(u){const h=Object.create(null),f=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let m;for(;m=f.exec(u);)h[m[1]]=m[2];return h}(c);if(Ae.isFunction(i))return i.call(this,c,s);if(Ae.isRegExp(i))return i.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,i){if(r=mm(r)){const s=Ae.findKey(this,r);return!(!s||this[s]===void 0||i&&!L0(0,this[s],s,i))}return!1}delete(r,i){const s=this;let c=!1;function u(h){if(h=mm(h)){const f=Ae.findKey(s,h);!f||i&&!L0(0,s[f],f,i)||(delete s[f],c=!0)}}return Ae.isArray(r)?r.forEach(u):u(r),c}clear(r){const i=Object.keys(this);let s=i.length,c=!1;for(;s--;){const u=i[s];r&&!L0(0,this[u],u,r,!0)||(delete this[u],c=!0)}return c}normalize(r){const i=this,s={};return Ae.forEach(this,(c,u)=>{var h;const f=Ae.findKey(s,u);if(f)return i[f]=V_(c),void delete i[u];const m=r?function(y){return Hr(y).call(y).toLowerCase().replace(/([a-z\d])(\w*)/g,(_,S,w)=>S.toUpperCase()+w)}(u):Hr(h=String(u)).call(h);m!==u&&delete i[u],i[m]=V_(c),s[m]=!0}),this}concat(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return this.constructor.concat(this,...i)}toJSON(r){const i=Object.create(null);return Ae.forEach(this,(s,c)=>{s!=null&&s!==!1&&(i[c]=r&&Ae.isArray(s)?s.join(", "):s)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(r=>{let[i,s]=r;return i+": "+s}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r){const i=new this(r);for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return c.forEach(h=>i.set(h)),i}static accessor(r){const i=(this[TV]=this[TV]={accessors:{}}).accessors,s=this.prototype;function c(u){const h=mm(u);i[h]||(function(f,m){const y=Ae.toCamelCase(" "+m);["get","set","has"].forEach(_=>{Object.defineProperty(f,_+y,{value:function(S,w,O){return this[_].call(this,m,S,w,O)},configurable:!0})})}(s,u),i[h]=!0)}return Ae.isArray(r)?r.forEach(c):c(r),this}}B_.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ae.reduceDescriptors(B_.prototype,(n,r)=>{let{value:i}=n,s=r[0].toUpperCase()+r.slice(1);return{get:()=>i,set(c){this[s]=c}}}),Ae.freezeMethods(B_);var Lo=B_;function k0(n,r){const i=this||D0,s=r||i,c=Lo.from(s.headers);let u=s.data;return Ae.forEach(n,function(h){u=h.call(i,u,c.normalize(),r?r.status:void 0)}),c.normalize(),u}function wV(n){return!(!n||!n.__CANCEL__)}function fh(n,r,i){Vt.call(this,n??"canceled",Vt.ERR_CANCELED,r,i),this.name="CanceledError"}function CV(n,r,i){const s=i.config.validateStatus;i.status&&s&&!s(i.status)?r(new Vt("Request failed with status code "+i.status,[Vt.ERR_BAD_REQUEST,Vt.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):n(i)}Ae.inherits(fh,Vt,{__CANCEL__:!0});const F_=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=0;const c=function(u,h){u=u||10;const f=new Array(u),m=new Array(u);let y,_=0,S=0;return h=h!==void 0?h:1e3,function(w){const O=Date.now(),W=m[S];y||(y=O),f[_]=w,m[_]=O;let k=S,j=0;for(;k!==_;)j+=f[k++],k%=u;if(_=(_+1)%u,_===S&&(S=(S+1)%u),O-y<h)return;const H=W&&O-W;return H?Math.round(1e3*j/H):void 0}}(50,250);return function(u,h){let f,m,y=0,_=1e3/h;const S=function(w){y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),f=null,m&&(clearTimeout(m),m=null),u.apply(null,w)};return[function(){const w=Date.now(),O=w-y;for(var W=arguments.length,k=new Array(W),j=0;j<W;j++)k[j]=arguments[j];O>=_?S(k,w):(f=k,m||(m=setTimeout(()=>{m=null,S(f)},_-O)))},()=>f&&S(f)]}(u=>{const h=u.loaded,f=u.lengthComputable?u.total:void 0,m=h-s,y=c(m);s=h,n({loaded:h,total:f,progress:f?h/f:void 0,bytes:m,rate:y||void 0,estimated:y&&f&&h<=f?(f-h)/y:void 0,event:u,lengthComputable:f!=null,[r?"download":"upload"]:!0})},i)},RV=(n,r)=>{const i=n!=null;return[s=>r[0]({lengthComputable:i,total:n,loaded:s}),r[1]]},OV=n=>function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ae.asap(()=>n(...i))};var Ihe=Oi.hasStandardBrowserEnv?((n,r)=>i=>(i=new g_(i,Oi.origin),n.protocol===i.protocol&&n.host===i.host&&(r||n.port===i.port)))(new g_(Oi.origin),Oi.navigator&&/(msie|trident)/i.test(Oi.navigator.userAgent)):()=>!0,Nhe=Oi.hasStandardBrowserEnv?{write(n,r,i,s,c,u){const h=[n+"="+encodeURIComponent(r)];Ae.isNumber(i)&&h.push("expires="+new Date(i).toGMTString()),Ae.isString(s)&&h.push("path="+s),Ae.isString(c)&&h.push("domain="+c),u===!0&&h.push("secure"),document.cookie=h.join("; ")},read(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function AV(n,r){return n&&!function(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}(r)?function(i,s){return s?i.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):i}(n,r):r}function IV(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}const NV=n=>n instanceof Lo?function(r){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?IV(Object(s),!0).forEach(function(c){F(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):IV(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}({},n):n;function Tu(n,r){r=r||{};const i={};function s(y,_,S,w){return Ae.isPlainObject(y)&&Ae.isPlainObject(_)?Ae.merge.call({caseless:w},y,_):Ae.isPlainObject(_)?Ae.merge({},_):Ae.isArray(_)?_.slice():_}function c(y,_,S,w){return Ae.isUndefined(_)?Ae.isUndefined(y)?void 0:s(void 0,y,0,w):s(y,_,0,w)}function u(y,_){if(!Ae.isUndefined(_))return s(void 0,_)}function h(y,_){return Ae.isUndefined(_)?Ae.isUndefined(y)?void 0:s(void 0,y):s(void 0,_)}function f(y,_,S){return S in r?s(y,_):S in n?s(void 0,y):void 0}const m={url:u,method:u,data:u,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:f,headers:(y,_,S)=>c(NV(y),NV(_),0,!0)};return Ae.forEach(Object.keys(Object.assign({},n,r)),function(y){const _=m[y]||c,S=_(n[y],r[y],y);Ae.isUndefined(S)&&_!==f||(i[y]=S)}),i}var PV=n=>{const r=Tu({},n);let i,{data:s,withXSRFToken:c,xsrfHeaderName:u,xsrfCookieName:h,headers:f,auth:m}=r;if(r.headers=f=Lo.from(f),r.url=KU(AV(r.baseURL,r.url),n.params,n.paramsSerializer),m&&f.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),Ae.isFormData(s)){if(Oi.hasStandardBrowserEnv||Oi.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if((i=f.getContentType())!==!1){const[y,..._]=i?i.split(";").map(S=>Hr(S).call(S)).filter(Boolean):[];f.setContentType([y||"multipart/form-data",..._].join("; "))}}if(Oi.hasStandardBrowserEnv&&(c&&Ae.isFunction(c)&&(c=c(r)),c||c!==!1&&Ihe(r.url))){const y=u&&h&&Nhe.read(h);y&&f.set(u,y)}return r},Phe=typeof XMLHttpRequest<"u"&&function(n){return new Ie(function(r,i){const s=PV(n);let c=s.data;const u=Lo.from(s.headers).normalize();let h,f,m,y,_,{responseType:S,onUploadProgress:w,onDownloadProgress:O}=s;function W(){y&&y(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let k=new XMLHttpRequest;function j(){if(!k)return;const K=Lo.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders());CV(function(Q){r(Q),W()},function(Q){i(Q),W()},{data:S&&S!=="text"&&S!=="json"?k.response:k.responseText,status:k.status,statusText:k.statusText,headers:K,config:n,request:k}),k=null}k.open(s.method.toUpperCase(),s.url,!0),k.timeout=s.timeout,"onloadend"in k?k.onloadend=j:k.onreadystatechange=function(){k&&k.readyState===4&&(k.status!==0||k.responseURL&&k.responseURL.indexOf("file:")===0)&&setTimeout(j)},k.onabort=function(){k&&(i(new Vt("Request aborted",Vt.ECONNABORTED,n,k)),k=null)},k.onerror=function(){i(new Vt("Network Error",Vt.ERR_NETWORK,n,k)),k=null},k.ontimeout=function(){let K=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const Q=s.transitional||YU;s.timeoutErrorMessage&&(K=s.timeoutErrorMessage),i(new Vt(K,Q.clarifyTimeoutError?Vt.ETIMEDOUT:Vt.ECONNABORTED,n,k)),k=null},c===void 0&&u.setContentType(null),"setRequestHeader"in k&&Ae.forEach(u.toJSON(),function(K,Q){k.setRequestHeader(Q,K)}),Ae.isUndefined(s.withCredentials)||(k.withCredentials=!!s.withCredentials),S&&S!=="json"&&(k.responseType=s.responseType),O&&([m,_]=F_(O,!0),k.addEventListener("progress",m)),w&&k.upload&&([f,y]=F_(w),k.upload.addEventListener("progress",f),k.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(h=K=>{k&&(i(!K||K.type?new fh(null,n,k):K),k.abort(),k=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const H=function(K){const Q=/^([-+\w]{1,25})(:?\/\/|:)/.exec(K);return Q&&Q[1]||""}(s.url);H&&Oi.protocols.indexOf(H)===-1?i(new Vt("Unsupported protocol "+H+":",Vt.ERR_BAD_REQUEST,n)):k.send(c||null)})},xhe=(n,r)=>{const{length:i}=n=n?n.filter(Boolean):[];if(r||i){let s,c=new AbortController;const u=function(y){if(!s){s=!0,f();const _=y instanceof Error?y:this.reason;c.abort(_ instanceof Vt?_:new fh(_ instanceof Error?_.message:_))}};let h=r&&setTimeout(()=>{h=null,u(new Vt("timeout ".concat(r," of ms exceeded"),Vt.ETIMEDOUT))},r);const f=()=>{n&&(h&&clearTimeout(h),h=null,n.forEach(y=>{y.unsubscribe?y.unsubscribe(u):y.removeEventListener("abort",u)}),n=null)};n.forEach(y=>y.addEventListener("abort",u));const{signal:m}=c;return m.unsubscribe=()=>Ae.asap(f),m}},M0=l(yM),xV=ch.f("asyncIterator"),Dhe=l(xV);function U0(n,r){this.v=n,this.k=r}function gm(n){var r,i;function s(u,h){try{var f=n[u](h),m=f.value,y=m instanceof U0;M0.resolve(y?m.v:m).then(function(_){if(y){var S=u==="return"?"return":"next";if(!m.k||_.done)return s(S,_);_=n[S](_).value}c(f.done?"return":"normal",_)},function(_){s("throw",_)})}catch(_){c("throw",_)}}function c(u,h){switch(u){case"return":r.resolve({value:h,done:!0});break;case"throw":r.reject(h);break;default:r.resolve({value:h,done:!1})}(r=r.next)?s(r.key,r.arg):i=null}this._invoke=function(u,h){return new M0(function(f,m){var y={key:u,arg:h,resolve:f,reject:m,next:null};i?i=i.next=y:(r=i=y,s(u,h))})},typeof n.return!="function"&&(this.return=void 0)}function wa(n){return function(){return new gm(n.apply(this,arguments))}}function vt(n){return new U0(n,0)}function W_(n){var r={},i=!1;function s(c,u){return i=!0,{done:!1,value:new U0(u=new M0(function(h){h(n[c](u))}),1)}}return r[hh!==void 0&&oV||"@@iterator"]=function(){return this},r.next=function(c){return i?(i=!1,c):s("next",c)},typeof n.throw=="function"&&(r.throw=function(c){if(i)throw i=!1,c;return s("throw",c)}),typeof n.return=="function"&&(r.return=function(c){return i?(i=!1,c):s("return",c)}),r}gm.prototype[typeof hh=="function"&&Dhe||"@@asyncIterator"]=function(){return this},gm.prototype.next=function(n){return this._invoke("next",n)},gm.prototype.throw=function(n){return this._invoke("throw",n)},gm.prototype.return=function(n){return this._invoke("return",n)};var j0=l(xV);function V0(n){var r,i,s,c=2;for(typeof Symbol<"u"&&(i=j0,s=Symbol.iterator);c--;){if(i&&(r=n[i])!=null)return r.call(n);if(s&&(r=n[s])!=null)return new G_(r.call(n));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function G_(n){function r(i){if(Object(i)!==i)return Ie.reject(new TypeError(i+" is not an object."));var s=i.done;return Ie.resolve(i.value).then(function(c){return{value:c,done:s}})}return G_=function(i){this.s=i,this.n=i.next},G_.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(i){var s=this.s.return;return s===void 0?Ie.resolve({value:i,done:!0}):r(s.apply(this.s,arguments))},throw:function(i){var s=this.s.return;return s===void 0?Ie.reject(i):r(s.apply(this.s,arguments))}},new G_(n)}const Lhe=function*(n,r){let i=n.byteLength;if(!r||i<r)return void(yield n);let s,c=0;for(;c<i;)s=c+r,yield n.slice(c,s),c=s},khe=function(){var n=wa(function*(r,i){var s,c=!1,u=!1;try{for(var h,f=V0(Mhe(r));c=!(h=yield vt(f.next())).done;c=!1){const m=h.value;yield*W_(V0(Lhe(m,i)))}}catch(m){u=!0,s=m}finally{try{c&&f.return!=null&&(yield vt(f.return()))}finally{if(u)throw s}}});return function(r,i){return n.apply(this,arguments)}}(),Mhe=function(){var n=wa(function*(r){if(r[j0])return void(yield*W_(V0(r)));const i=r.getReader();try{for(;;){const{done:s,value:c}=yield vt(i.read());if(s)break;yield c}}finally{yield vt(i.cancel())}});return function(r){return n.apply(this,arguments)}}(),DV=(n,r,i,s)=>{const c=khe(n,r);let u,h=0,f=m=>{u||(u=!0,s&&s(m))};return new ReadableStream({async pull(m){try{const{done:y,value:_}=await c.next();if(y)return f(),void m.close();let S=_.byteLength;if(i){let w=h+=S;i(w)}m.enqueue(new Uint8Array(_))}catch(y){throw f(y),y}},cancel:m=>(f(m),c.return())},{highWaterMark:2})};function LV(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function kV(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?LV(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):LV(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const $_=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",MV=$_&&typeof ReadableStream=="function",Uhe=$_&&(typeof TextEncoder=="function"?(UV=new TextEncoder,n=>UV.encode(n)):async n=>new Uint8Array(await new Response(n).arrayBuffer()));var UV;const jV=function(n){try{for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return!!n(...i)}catch{return!1}},jhe=MV&&jV(()=>{let n=!1;const r=new Request(Oi.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!r}),B0=MV&&jV(()=>Ae.isReadableStream(new Response("").body)),H_={stream:B0&&(n=>n.body)};var VV;$_&&(VV=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!H_[n]&&(H_[n]=Ae.isFunction(VV[n])?r=>r[n]():(r,i)=>{throw new Vt("Response type '".concat(n,"' is not supported"),Vt.ERR_NOT_SUPPORT,i)})}));const Vhe=async(n,r)=>{const i=Ae.toFiniteNumber(n.getContentLength());return i??(async s=>s==null?0:Ae.isBlob(s)?s.size:Ae.isSpecCompliantForm(s)?(await new Request(Oi.origin,{method:"POST",body:s}).arrayBuffer()).byteLength:Ae.isArrayBufferView(s)||Ae.isArrayBuffer(s)?s.byteLength:(Ae.isURLSearchParams(s)&&(s+=""),Ae.isString(s)?(await Uhe(s)).byteLength:void 0))(r)};var Bhe=$_&&(async n=>{let{url:r,method:i,data:s,signal:c,cancelToken:u,timeout:h,onDownloadProgress:f,onUploadProgress:m,responseType:y,headers:_,withCredentials:S="same-origin",fetchOptions:w}=PV(n);y=y?(y+"").toLowerCase():"text";let O,W=xhe([c,u&&u.toAbortSignal()],h);const k=W&&W.unsubscribe&&(()=>{W.unsubscribe()});let j;try{if(m&&jhe&&i!=="get"&&i!=="head"&&(j=await Vhe(_,s))!==0){let re,te=new Request(r,{method:"POST",body:s,duplex:"half"});if(Ae.isFormData(s)&&(re=te.headers.get("content-type"))&&_.setContentType(re),te.body){const[he,Se]=RV(j,F_(OV(m)));s=DV(te.body,65536,he,Se)}}Ae.isString(S)||(S=S?"include":"omit");const H="credentials"in Request.prototype;O=new Request(r,kV(kV({},w),{},{signal:W,method:i.toUpperCase(),headers:_.normalize().toJSON(),body:s,duplex:"half",credentials:H?S:void 0}));let K=await fetch(O);const Q=B0&&(y==="stream"||y==="response");if(B0&&(f||Q&&k)){const re={};["status","statusText","headers"].forEach(Ne=>{re[Ne]=K[Ne]});const te=Ae.toFiniteNumber(K.headers.get("content-length")),[he,Se]=f&&RV(te,F_(OV(f),!0))||[];K=new Response(DV(K.body,65536,he,()=>{Se&&Se(),k&&k()}),re)}y=y||"text";let ie=await H_[Ae.findKey(H_,y)||"text"](K,n);return!Q&&k&&k(),await new Ie((re,te)=>{CV(re,te,{data:ie,headers:Lo.from(K.headers),status:K.status,statusText:K.statusText,config:n,request:O})})}catch(H){throw k&&k(),H&&H.name==="TypeError"&&/fetch/i.test(H.message)?Object.assign(new Vt("Network Error",Vt.ERR_NETWORK,n,O),{cause:H.cause||H}):Vt.from(H,H&&H.code,n,O)}});const BV={http:null,xhr:Phe,fetch:Bhe};Ae.forEach(BV,(n,r)=>{if(n){try{Object.defineProperty(n,"name",{value:r})}catch{}Object.defineProperty(n,"adapterName",{value:r})}});const FV=n=>"- ".concat(n),Fhe=n=>Ae.isFunction(n)||n===null||n===!1;var WV=n=>{n=Ae.isArray(n)?n:[n];const{length:r}=n;let i,s;const c={};for(let u=0;u<r;u++){let h;if(i=n[u],s=i,!Fhe(i)&&(s=BV[(h=String(i)).toLowerCase()],s===void 0))throw new Vt("Unknown adapter '".concat(h,"'"));if(s)break;c[h||"#"+u]=s}if(!s){const u=Object.entries(c).map(h=>{let[f,m]=h;return"adapter ".concat(f," ")+(m===!1?"is not supported by the environment":"is not available in the build")});throw new Vt("There is no suitable adapter to dispatch the request "+(r?u.length>1?`since :
`+u.map(FV).join(`
`):" "+FV(u[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s};function F0(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new fh(null,n)}function GV(n){return F0(n),n.headers=Lo.from(n.headers),n.data=k0.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),WV(n.adapter||D0.adapter)(n).then(function(r){return F0(n),r.data=k0.call(n,n.transformResponse,r),r.headers=Lo.from(r.headers),r},function(r){return wV(r)||(F0(n),r&&r.response&&(r.response.data=k0.call(n,n.transformResponse,r.response),r.response.headers=Lo.from(r.response.headers))),Ie.reject(r)})}const Whe="1.7.9",z_={};["object","boolean","number","function","string","symbol"].forEach((n,r)=>{z_[n]=function(i){return typeof i===n||"a"+(r<1?"n ":" ")+n}});const $V={};z_.transitional=function(n,r,i){function s(c,u){return"[Axios v1.7.9] Transitional option '"+c+"'"+u+(i?". "+i:"")}return(c,u,h)=>{if(n===!1)throw new Vt(s(u," has been removed"+(r?" in "+r:"")),Vt.ERR_DEPRECATED);return r&&!$V[u]&&($V[u]=!0,console.warn(s(u," has been deprecated since v"+r+" and will be removed in the near future"))),!n||n(c,u,h)}},z_.spelling=function(n){return(r,i)=>(console.warn("".concat(i," is likely a misspelling of ").concat(n)),!0)};var K_={assertOptions:function(n,r,i){if(typeof n!="object")throw new Vt("options must be an object",Vt.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let c=s.length;for(;c-- >0;){const u=s[c],h=r[u];if(h){const f=n[u],m=f===void 0||h(f,u,n);if(m!==!0)throw new Vt("option "+u+" must be "+m,Vt.ERR_BAD_OPTION_VALUE)}else if(i!==!0)throw new Vt("Unknown option "+u,Vt.ERR_BAD_OPTION)}},validators:z_};const hs=K_.validators;let q_=class{constructor(n){this.defaults=n,this.interceptors={request:new qU,response:new qU}}async request(n,r){try{return await this._request(n,r)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const c=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?c&&!String(i.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+c):i.stack=c}catch{}}throw i}}_request(n,r){typeof n=="string"?(r=r||{}).url=n:r=n||{},r=Tu(this.defaults,r);const{transitional:i,paramsSerializer:s,headers:c}=r;i!==void 0&&K_.assertOptions(i,{silentJSONParsing:hs.transitional(hs.boolean),forcedJSONParsing:hs.transitional(hs.boolean),clarifyTimeoutError:hs.transitional(hs.boolean)},!1),s!=null&&(Ae.isFunction(s)?r.paramsSerializer={serialize:s}:K_.assertOptions(s,{encode:hs.function,serialize:hs.function},!0)),K_.assertOptions(r,{baseUrl:hs.spelling("baseURL"),withXsrfToken:hs.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let u=c&&Ae.merge(c.common,c[r.method]);c&&Ae.forEach(["delete","get","head","post","put","patch","common"],O=>{delete c[O]}),r.headers=Lo.concat(u,c);const h=[];let f=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(r)===!1||(f=f&&O.synchronous,h.unshift(O.fulfilled,O.rejected))});const m=[];let y;this.interceptors.response.forEach(function(O){m.push(O.fulfilled,O.rejected)});let _,S=0;if(!f){const O=[GV.bind(this),void 0];for(O.unshift.apply(O,h),O.push.apply(O,m),_=O.length,y=Ie.resolve(r);S<_;)y=y.then(O[S++],O[S++]);return y}_=h.length;let w=r;for(S=0;S<_;){const O=h[S++],W=h[S++];try{w=O(w)}catch(k){W.call(this,k);break}}try{y=GV.call(this,w)}catch(O){return Ie.reject(O)}for(S=0,_=m.length;S<_;)y=y.then(m[S++],m[S++]);return y}getUri(n){return KU(AV((n=Tu(this.defaults,n)).baseURL,n.url),n.params,n.paramsSerializer)}};Ae.forEach(["delete","get","head","options"],function(n){q_.prototype[n]=function(r,i){return this.request(Tu(i||{},{method:n,url:r,data:(i||{}).data}))}}),Ae.forEach(["post","put","patch"],function(n){function r(i){return function(s,c,u){return this.request(Tu(u||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:c}))}}q_.prototype[n]=r(),q_.prototype[n+"Form"]=r(!0)});var Y_=q_;class W0{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Ie(function(c){i=c});const s=this;this.promise.then(c=>{if(!s._listeners)return;let u=s._listeners.length;for(;u-- >0;)s._listeners[u](c);s._listeners=null}),this.promise.then=c=>{let u;const h=new Ie(f=>{s.subscribe(f),u=f}).then(c);return h.cancel=function(){s.unsubscribe(u)},h},r(function(c,u,h){s.reason||(s.reason=new fh(c,u,h),i(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){this.reason?r(this.reason):this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const i=this._listeners.indexOf(r);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const r=new AbortController,i=s=>{r.abort(s)};return this.subscribe(i),r.signal.unsubscribe=()=>this.unsubscribe(i),r.signal}static source(){let r;return{token:new W0(function(s){r=s}),cancel:r}}}var Ghe=W0;const G0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(G0).forEach(n=>{let[r,i]=n;G0[i]=r});var $he=G0;const Br=function n(r){const i=new Y_(r),s=IU(Y_.prototype.request,i);return Ae.extend(s,Y_.prototype,i,{allOwnKeys:!0}),Ae.extend(s,i,null,{allOwnKeys:!0}),s.create=function(c){return n(Tu(r,c))},s}(D0);Br.Axios=Y_,Br.CanceledError=fh,Br.CancelToken=Ghe,Br.isCancel=wV,Br.VERSION=Whe,Br.toFormData=A_,Br.AxiosError=Vt,Br.Cancel=Br.CanceledError,Br.all=function(n){return Ie.all(n)},Br.spread=function(n){return function(r){return n.apply(null,r)}},Br.isAxiosError=function(n){return Ae.isObject(n)&&n.isAxiosError===!0},Br.mergeConfig=Tu,Br.AxiosHeaders=Lo,Br.formToJSON=n=>bV(Ae.isHTMLForm(n)?new FormData(n):n),Br.getAdapter=WV,Br.HttpStatusCode=$he,Br.default=Br;var mi=Br;const Hhe=()=>{};function ym(){const n={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Hhe};return n.promise=new Ie((r,i)=>{n.resolve=s=>{n.isFinished||(n.isResolved=!0,n.isFinished=!0,r(s),n.value=s)},n.reject=s=>{n.isFinished||(n.isRejected=!0,n.isFinished=!0,i(s))}}),n}const X_=new Map,J_=new Map,fs=new Map;let tr=function(n){return n.WIN_10="Windows 10",n.WIN_81="Windows 8.1",n.WIN_8="Windows 8",n.WIN_7="Windows 7",n.WIN_VISTA="Windows Vista",n.WIN_SERVER_2003="Windows Server 2003",n.WIN_XP="Windows XP",n.WIN_2000="Windows 2000",n.ANDROID="Android",n.HARMONY_OS="HarmonyOS",n.OPEN_BSD="Open BSD",n.SUN_OS="Sun OS",n.LINUX="Linux",n.IOS="iOS",n.MAC_OS="Mac OS",n.CHROMIUM_OS="Chromium OS",n.QNX="QNX",n.UNIX="UNIX",n.BEOS="BeOS",n.OS_2="OS/2",n.SEARCH_BOT="Search Bot",n}({}),Nt=function(n){return n.CHROME="Chrome",n.SAFARI="Safari",n.EDGE="Edge",n.FIREFOX="Firefox",n.OPERA="OPR",n.QQ="QQBrowser",n.WECHAT="MicroMessenger",n}({});const HV=new fle;let ko=HV.getResult(),$0=null;function St(n){if(!$0){ko=HV.getResult();const r=function(f){if(f.engine.name==="Blink"&&f.browser.name!=="WeChat")return Nt.CHROME;switch(f.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Nt.CHROME;case"Safari":case"Mobile Safari":return Nt.SAFARI;case"Edge":return Nt.EDGE;case"Firefox":return Nt.FIREFOX;case"QQ":case"QQBrowser":return Nt.QQ;case"Opera":return Nt.OPERA;case"WeChat":return Nt.WECHAT;default:return f.browser.name||""}}(ko),i=zV(ko),s=function(f){return f.os.name==="Windows"?f.os.version?f.os.name+" "+f.os.version:f.os.name:f.os.name||""}(ko),c=ko.os.version,u=zV(ko,!1),h=ko.device.type;if(!(r&&i&&s&&c))return{name:r,version:i,os:s,osVersion:c,browserVersion:u,deviceType:h};$0={name:r,version:i,os:s,osVersion:c,browserVersion:u,deviceType:h}}return $0}function zV(n){let r,i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return r=n.engine.name==="Blink"?n.engine.version||"":n.browser.version||"",i?r.split(".")[0]:r}function Q_(){return St().os}function KV(){const n=St();return"".concat(n.os," ").concat(n.osVersion)}function Z_(){const n=St();return!!(ko.engine.name==="WebKit"&&n.os===tr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&n.name!==Nt.SAFARI||ri()&&n.name!==Nt.SAFARI)}function Xs(){return St().name===Nt.CHROME}function Cr(){return St().name===Nt.SAFARI}function qV(){return St().name===Nt.EDGE}function gn(){return St().name===Nt.FIREFOX}function ri(){return St().os===tr.IOS}function ph(n){const r=St();return!(r.name!==Nt.CHROME||!r.osVersion)&&Number(r.version)>=n}function YV(n){const r=St();return!(r.name!==Nt.CHROME||!r.osVersion)&&Number(r.version)<n}function H0(n,r,i){const s=St();return!(s.name!==n||!s.osVersion)&&(i?Number(s.version)>=r&&Number(s.version)<=i:Number(s.version)===r)}function z0(n){const r=St();return!(r.name!==Nt.EDGE||!r.osVersion)&&Number(r.version)>=n}function XV(n){const r=St();return!(r.name!==Nt.SAFARI||!r.osVersion)&&Number(r.version)>=n}function JV(n,r,i){const s=St();if(s.os!==tr.IOS||!s.osVersion)return!1;const c=s.osVersion.split(".");return i?r&&Number(c[0])===n&&Number(c[1])<r||Number(c[0])<n:r?Number(c[0])===n&&Number(c[1])<=r||Number(c[0])<n:Number(c[0])<=n}function QV(n,r,i){const s=St();if(s.name!==Nt.SAFARI||!s.osVersion||!s.browserVersion)return!1;const c=s.browserVersion.split(".");return i?r&&Number(c[0])===n&&Number(c[1])<r||Number(c[0])<n:r?Number(c[0])===n&&Number(c[1])<=r||Number(c[0])<n:Number(c[0])<=n}function K0(n){const r=St();return!(r.name!==Nt.OPERA||!r.osVersion)&&Number(r.version)>=n}function ZV(){const n=St();if(n.os!==tr.IOS||!n.osVersion)return!1;const r=n.osVersion.split(".");return Number(r[0])<14||Number(r[0])===14&&Number(r[1])<=6}function mh(){const n=St();if(n.os!==tr.IOS||!n.osVersion)return!1;const r=n.osVersion.split(".");return Number(r[0])===15}function q0(){const n=St();if(n.os!==tr.IOS||!n.osVersion)return!1;const r=n.osVersion.split(".");return Number(r[0])===16}function eB(){const n=St();if(n.os!==tr.IOS||!n.osVersion)return!1;const r=n.osVersion.split(".");return Number(r[0])===15&&Number(r[1])>=1}function Za(){return Cr()&&navigator.maxTouchPoints>0}function tB(){return St().name===Nt.WECHAT}function nB(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Y0(){const n=Q_();return function(){const{deviceType:r}=St();return r==="mobile"||r==="tablet"}()||n===tr.ANDROID||n===tr.IOS||n===tr.HARMONY_OS}function Js(){const n=St();return n.name!==Nt.EDGE&&n.name!==Nt.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function eE(){return Q_()===tr.ANDROID}function vm(){const n=St();return eE()&&(n.name===Nt.CHROME||n.name===Nt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function rt(n,r,i){return(r=function(s){var c=function(u){if(typeof u!="object"||!u)return u;var h=u[Symbol.toPrimitive];if(h!==void 0){var f=h.call(u,"string");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(s);return typeof c=="symbol"?c:c+""}(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}function rB(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Me(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?rB(Object(i),!0).forEach(function(s){rt(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):rB(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let $=function(n){return n.UNEXPECTED_ERROR="UNEXPECTED_ERROR",n.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",n.TIMEOUT="TIMEOUT",n.INVALID_PARAMS="INVALID_PARAMS",n.NOT_READABLE="NOT_READABLE",n.NOT_SUPPORTED="NOT_SUPPORTED",n.INVALID_OPERATION="INVALID_OPERATION",n.OPERATION_ABORTED="OPERATION_ABORTED",n.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",n.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",n.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",n.DATACHANNEL_FAILED="DATACHANNEL_FAILED",n.NETWORK_ERROR="NETWORK_ERROR",n.NETWORK_TIMEOUT="NETWORK_TIMEOUT",n.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",n.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",n.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",n.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",n.ELECTRON_IS_NULL="ELECTRON_IS_NULL",n.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",n.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",n.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",n.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",n.PERMISSION_DENIED="PERMISSION_DENIED",n.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",n.TRACK_IS_DISABLED="TRACK_IS_DISABLED",n.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",n.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",n.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",n.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",n.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",n.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",n.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",n.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",n.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",n.UID_CONFLICT="UID_CONFLICT",n.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",n.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",n.TOKEN_EXPIRE="TOKEN_EXPIRE",n.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",n.INVALID_TRACK="INVALID_TRACK",n.SENDER_NOT_FOUND="SENDER_NOT_FOUND",n.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",n.SET_ANSWER_FAILED="SET_ANSWER_FAILED",n.ICE_FAILED="ICE_FAILED",n.PC_CLOSED="PC_CLOSED",n.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",n.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",n.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",n.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",n.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",n.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",n.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",n.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",n.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",n.INVALID_REMOTE_USER="INVALID_REMOTE_USER",n.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",n.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",n.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",n.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",n.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",n.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",n.WS_ABORT="WS_ABORT",n.WS_DISCONNECT="WS_DISCONNECT",n.WS_ERR="WS_ERR",n.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",n.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",n.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",n.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",n.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",n.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",n.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",n.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",n.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",n.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",n.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",n.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",n.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",n.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",n.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",n.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",n.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",n.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",n.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",n.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",n.INVALID_PLUGIN="INVALID_PLUGIN",n.DISCONNECT_P2P="DISCONNECT_P2P",n.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",n.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",n.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",n.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",n.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",n.PROHIBITED_OPERATION="PROHIBITED_OPERATION",n.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",n.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",n}({});class de extends Error{constructor(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(i),rt(this,"code",void 0),rt(this,"message",void 0),rt(this,"data",void 0),rt(this,"name","AgoraRTCException"),this.code=r,this.message="AgoraRTCError ".concat(this.code,": ").concat(i),this.data=s}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",i=arguments.length>1?arguments[1]:void 0;return r==="error"&&(i||console).error(this.toString()),r==="warning"&&(i||console).warn(this.toString()),this}throw(r){throw this.print("error",r),this}}function Qs(n,r){if(typeof n!="boolean")throw new de($.INVALID_PARAMS,"Invalid ".concat(r,": The value is of the boolean type."))}function Jn(n,r,i){if(!Oe(i).call(i,n))throw new de($.INVALID_PARAMS,"".concat(r," can only be set as ").concat(JSON.stringify(i)))}function Bt(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(n<i||n>s||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(c){return typeof c=="number"&&c%1==0}(n))throw new de($.INVALID_PARAMS,"invalid ".concat(r,": the value range is [").concat(i,", ").concat(s,"]. integer only"))}function X0(n,r){if(typeof n!="number"){if(!(n.min||n.max||n.ideal||n.exact))throw new de($.INVALID_PARAMS,"".concat(r," is not a valid ConstrainLong"));n.min!==void 0&&Bt(n.min,"".concat(r,".min"),0,1/0),n.max!==void 0&&Bt(n.max,"".concat(r,".max"),1,1/0),n.exact!==void 0&&Bt(n.exact,"".concat(r,".exact"),1,1/0),n.ideal!==void 0&&Bt(n.ideal,"".concat(r,".ideal"),1,1/0)}else Bt(n,r,1,1/0)}function vr(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,c=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(n==null)throw new de($.INVALID_PARAMS,"".concat(r||"param"," cannot be empty"));if(!iB(n,i,s,c))throw new de($.INVALID_PARAMS,"Invalid ".concat(r||"string param",": Length of the string: [").concat(i,",").concat(s,"].").concat(c?" ASCII characters only.":""))}function Zs(n,r){if(!Array.isArray(n))throw new de($.INVALID_PARAMS,"".concat(r," should be an array"))}function hn(n){return n==null}function iB(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof n=="string"&&n.length<=i&&n.length>=r&&(!s||function(c){if(typeof c!="string")return!1;for(let u=0;u<c.length;u+=1){const h=c.charCodeAt(u);if(h<0||h>255)return!1}return!0}(n))}var _m=function(n){return n.COVERED="COVERED",n.POSITION="POSITION",n.SIZE="SIZE",n.STYLE="STYLE",n}(_m||{}),J0=function(n){return n.UNMOUNTED="UNMOUNTED",n.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",n}(J0||{});const aB=new class{constructor(){rt(this,"_clientSize",null),rt(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),rt(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),rt(this,"getStyle",n=>window.getComputedStyle(n,null)),rt(this,"checkCssVisibleProperty",n=>{var r;let i=!0;const s=this.getStyle(n),{display:c,visibility:u,opacity:h,filter:f}=s;return(c==="none"||Oe(r=["hidden","collapse"]).call(r,u)||Number(h)<.1)&&(i=!1),!!i&&(f&&f.split(" ").filter(m=>{var y;const _=m.split("(")[0];return Oe(y=["brightness","blur","opacity"]).call(y,_)}).map(m=>{const[y,_]=m.split(/\(|\)/);return[y,Number(_.match(/^[0-9\.]+/))]}).forEach(m=>{const[y,_]=m;switch(y){case"brightness":(_<.1||_>3)&&(i=!1);break;case"blur":_>3&&(i=!1);break;case"opacity":_<.1&&(i=!1)}}),i)}),rt(this,"checkPropertyUpToAllParentNodes",(n,r)=>{let i=!0,s=!0;const c=h=>r(h);let u=n;for(;u&&s;)c(u)||(i=!1,s=!1),u=u.parentElement,u||(s=!1);return i}),rt(this,"checkActualCssVisibleIncludeInherit",n=>this.checkPropertyUpToAllParentNodes(n,this.checkCssVisibleProperty)),rt(this,"getSizeAboutClient",n=>{const{width:r,height:i,left:s,right:c,top:u,bottom:h}=n.getBoundingClientRect(),f=this.getClientWidth(),m=this.getClientHeight();return{width:r,height:i,left:s,right:c,top:u,bottom:h,clientWidth:f,clientHeight:m,clientMin:Math.min(f,m)}}),rt(this,"checkActualSize",()=>{const{width:n,height:r,clientMin:i}=this._clientSize;return this.checkSizeIsVisible(n,r,i)}),rt(this,"elementFromPoint",(n,r)=>document.elementFromPoint?document.elementFromPoint(n,r):null),rt(this,"checkCoverForAPoint",(n,r,i)=>{const s=this.elementFromPoint(n,r);return s!==null&&s!==i}),rt(this,"getPointPositionList",()=>{const{width:n,height:r,left:i,top:s}=this._clientSize,c=n/6,u=r/6,h=[],f=10**6;for(let m=0;m<5;m++)for(let y=0;y<5;y++){const _=(i*f+(m===0?.1:m===4?(c*m*f-1e5)/f:c*m)*f)/f,S=(s*f+(y===0?.1:y===4?(u*y*f-1e5)/f:u*y)*f)/f;h.push({x:_,y:S})}return[...h]}),rt(this,"checkElementCover",n=>this.getPointPositionList().map(r=>this.checkCoverForAPoint(r.x,r.y,n)).filter(r=>!!r).length>6),rt(this,"checkSizeIsVisible",(n,r,i)=>(n>50||i/n<=10)&&(r>50||i/r<=10)),rt(this,"checkSizeOfPartInClient",()=>{const{left:n,right:r,top:i,bottom:s,clientHeight:c,clientWidth:u,clientMin:h}=this._clientSize;let f,m,y,_;if(n<0)f=0;else{if(!(n<u))return!1;f=n}if(r<0)return!1;if(m=r<u?r:u,i<0)y=0;else{if(!(i<c))return!1;y=i}if(s<0)return!1;_=s<c?s:c;const S=m-f,w=_-y;return this.checkSizeIsVisible(S,w,h)}),rt(this,"returnHiddenResult",n=>(this._clientSize=null,{visible:!1,reason:n})),rt(this,"checkOneElementVisible",n=>{if(n instanceof HTMLElement){if(this.checkElementIsMountedOnDom(n)){if(this.checkActualCssVisibleIncludeInherit(n)){if(this._clientSize=this.getSizeAboutClient(n),this.checkElementCover(n))return this.returnHiddenResult(_m.COVERED);{const r=this.checkActualSize(),i=this.checkSizeOfPartInClient();return r&&!i?this.returnHiddenResult(_m.POSITION):r?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(_m.SIZE)}}return this.returnHiddenResult(_m.STYLE)}return this.returnHiddenResult(J0.UNMOUNTED)}return this.returnHiddenResult(J0.INVALID_HTML_ELEMENT)}),rt(this,"checkElementIsMountedOnDom",n=>this.checkPropertyUpToAllParentNodes(n,r=>r.nodeName.toUpperCase()!=="HTML"?r.parentElement!==null:!!document.documentElement))}};function Q0(n){return new TextEncoder().encode(n)}const oB=function(n,r){const i=new Uint8Array(n.byteLength+r.byteLength);return i.set(new Uint8Array(n),0),i.set(new Uint8Array(r),n.byteLength),i},Z0=async n=>function(r,i){let s="";return new Uint8Array(r).forEach(c=>{s+=c.toString(i).padStart(2,"0")}),s}(await crypto.subtle.digest("SHA-256",Q0(n)),16);let ln=class{constructor(){rt(this,"_events",{}),rt(this,"addListener",this.on)}getListeners(n){return this._events[n]?this._events[n].map(r=>r.listener):[]}on(n,r){this._events[n]||(this._events[n]=[]);const i=this._events[n];this._indexOfListener(i,r)===-1&&i.push({listener:r,once:!1})}once(n,r){this._events[n]||(this._events[n]=[]);const i=this._events[n];this._indexOfListener(i,r)===-1&&i.push({listener:r,once:!0})}off(n,r){if(!this._events[n])return;const i=this._events[n],s=this._indexOfListener(i,r);s!==-1&&i.splice(s,1),this._events[n].length===0&&delete this._events[n]}removeAllListeners(n){n?delete this._events[n]:this._events={}}emit(n){this._events[n]||(this._events[n]=[]);const r=this._events[n].map(u=>u);for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];for(let u=0;u<r.length;u+=1){const h=r[u];h.once&&this.off(n,h.listener),h.listener.apply(this,s||[])}}safeEmit(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];[...this._events[n]||[]].forEach(c=>{c.once&&this.off(n,c.listener);try{c.listener.apply(this,i)}catch(u){console.error("safeEmit event:".concat(n," error ").concat(u==null?void 0:u.toString()))}})}_indexOfListener(n,r){let i=n.length;for(;i--;)if(n[i].listener===r)return i;return-1}},Em=null;function sB(){if(Em)return Em;if(window.electron)return Em=window.electron;if(!window.require)return null;try{return Em=window.require("electron"),Em}catch{return null}}let Wn=function(n){return n.CREATE_CLIENT="createClient",n.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",n.SET_AREA="setArea",n.PRELOAD="PRELOAD",n.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",n.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",n.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",n.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",n.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",n.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",n.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",n.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",n.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",n.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",n.START_PROXY_SERVER="Client.startProxyServer",n.STOP_PROXY_SERVER="Client.stopProxyServer",n.SET_PROXY_SERVER="Client.setProxyServer",n.SET_TURN_SERVER="Client.setTurnServer",n.SET_CLIENT_ROLE="Client.setClientRole",n.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",n.ENABLE_DUAL_STREAM="Client.enableDualStream",n.DISABLE_DUAL_STREAM="Client.disableDualStream",n.JOIN="Client.join",n.LEAVE="Client.leave",n.PUBLISH="Client.publish",n.UNPUBLISH="Client.unpublish",n.SUBSCRIBE="Client.subscribe",n.MASS_SUBSCRIBE="Client.massSubscribe",n.MASS_UNSUBSCRIBE="Client.massUnsubscribe",n.UNSUBSCRIBE="Client.unsubscribe",n.RENEW_TOKEN="Client.renewToken",n.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",n.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",n.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",n.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",n.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",n.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",n.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",n.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",n.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",n.START_LIVE_STREAMING="Client.startLiveStreaming",n.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",n.STOP_LIVE_STREAMING="Client.stopLiveStreaming",n.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",n.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",n.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",n.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",n.SET_CONFIG_DISTRIBUTE="_configDistribute",n.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",n.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",n.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",n.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",n.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",n.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",n.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",n.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",n.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",n.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",n.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",n.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",n.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",n.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",n.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",n.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",n.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",n.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",n.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",n.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",n.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",n.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",n.STREAM_TYPE_CHANGE="streamTypeChange",n.CONNECTION_STATE_CHANGE="connectionStateChange",n.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",n.IMAGE_MODERATION_UPLOAD="imageModerationUpload",n.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",n}({}),fn=function(n){return n.TRACER="tracer",n}({});function cB(n){return Bt(n.timeout,"config.timeout",0,1e5),Bt(n.timeoutFactor,"config.timeoutFactor",0,100,!1),Bt(n.maxRetryCount,"config.maxRetryConfig",0,1/0),Bt(n.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let zhe=function(n){return n[n.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",n[n.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",n[n.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",n}({}),Pt=function(n){return n.LEAVE="LEAVE",n.NETWORK_ERROR="NETWORK_ERROR",n.SERVER_ERROR="SERVER_ERROR",n.UID_BANNED="UID_BANNED",n.FALLBACK="FALLBACK",n.IP_BANNED="IP_BANNED",n.CHANNEL_BANNED="CHANNEL_BANNED",n.LICENSE_MISSING="LICENSE_MISSING",n.LICENSE_EXPIRED="LICENSE_EXPIRED",n.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",n.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",n.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",n.LICENSE_ILLEGAL="LICENSE_ILLEGAL",n.TOKEN_EXPIRE="TOKEN_EXPIRE",n}({});function Sm(n){if(!Array.isArray(n)||n.length<1)return!1;try{n.forEach(r=>{if(!r.urls)throw Error()})}catch{return!1}return!0}function lB(n){return vr(n.turnServerURL,"turnServerURL"),vr(n.username,"username"),vr(n.password,"password"),n.udpport&&Bt(n.udpport,"udpport",1,99999,!0),n.forceturn&&Qs(n.forceturn,"forceturn"),n.security&&Qs(n.security,"security"),n.tcpport&&Bt(n.tcpport,"tcpport",1,99999,!0),!0}function eO(n){return n.level!==void 0&&Jn(n.level,"level",[1,2,3]),n.delay!==void 0&&Bt(n.delay,"delay",0,3e3,!0),!0}let dt=function(n){return n.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",n.AUDIO_METADATA="audio-metadata",n.CONNECTION_STATE_CHANGE="connection-state-change",n.MEDIA_RECONNECT_START="media-reconnect-start",n.MEDIA_RECONNECT_END="media-reconnect-end",n.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",n.USER_JOINED="user-joined",n.USER_LEAVED="user-left",n.USER_PUBLISHED="user-published",n.USER_UNPUBLISHED="user-unpublished",n.USER_INFO_UPDATED="user-info-updated",n.CLIENT_BANNED="client-banned",n.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",n.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",n.VOLUME_INDICATOR="volume-indicator",n.CRYPT_ERROR="crypt-error",n.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",n.NETWORK_QUALITY="network-quality",n.STREAM_TYPE_CHANGED="stream-type-changed",n.STREAM_FALLBACK="stream-fallback",n.RECEIVE_METADATA="receive-metadata",n.STREAM_MESSAGE="stream-message",n.LIVE_STREAMING_ERROR="live-streaming-error",n.LIVE_STREAMING_WARNING="live-streaming-warning",n.EXCEPTION="exception",n.ERROR="error",n.P2P_LOST="p2p_lost",n.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",n.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",n.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",n.PUBLISHED_USER_LIST="published-user-list",n.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",n.CONTENT_INSPECT_ERROR="content-inspect-error",n.CONTENT_INSPECT_RESULT="content-inspect-result",n.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",n}({}),Rr=function(n){return n.NETWORK_ERROR="NETWORK_ERROR",n.SERVER_ERROR="SERVER_ERROR",n.MULTI_IP="MULTI_IP",n.TIMEOUT="TIMEOUT",n.OFFLINE="OFFLINE",n.LEAVE="LEAVE",n.P2P_FAILED="P2P_FAILED",n.FALLBACK="FALLBACK",n.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",n}({}),Hi=function(n){return n.ONLINE="ONLINE",n.OFFLINE="OFFLINE",n}({}),gh=function(n){return n.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",n.ONLINE="ONLINE",n.OFFLINE="OFFLINE",n}({});function Or(n,r){for(var i=arguments.length,s=new Array(i>2?i-2:0),c=2;c<i;c++)s[c-2]=arguments[c];return n.getListeners(r).length===0?Ie.reject(new de($.UNEXPECTED_ERROR,"can not emit promise")):new Ie((u,h)=>{n.emit(r,...s,u,h)})}function Kt(n,r){if(n.getListeners(r).length===0)return Ie.resolve();for(var i=arguments.length,s=new Array(i>2?i-2:0),c=2;c<i;c++)s[c-2]=arguments[c];return Or(n,r,...s)}function ia(n,r){if(n.getListeners(r).length===0)return null;for(var i=arguments.length,s=new Array(i>2?i-2:0),c=2;c<i;c++)s[c-2]=arguments[c];return bm(n,r,...s)}function bm(n,r){let i=null,s=null;for(var c=arguments.length,u=new Array(c>2?c-2:0),h=2;h<c;h++)u[h-2]=arguments[h];if(n.emit(r,...u,f=>{i=f},f=>{s=f}),s!==null)throw s;if(i===null)throw new de($.UNEXPECTED_ERROR,"handler is not sync");return i}const xn=new class extends ln{set networkState(n){this.emit(gh.NETWORK_STATE_CHANGE,n,this._networkState),n===Hi.ONLINE?this.emit(gh.ONLINE):n===Hi.OFFLINE&&(this.onlineWaiter=new Ie(r=>{this.once(gh.ONLINE,()=>{this.onlineWaiter=void 0,r(Hi.ONLINE)})}),this.emit(gh.OFFLINE)),this._networkState=n}get networkState(){return this._networkState}get isOnline(){return this._networkState===Hi.ONLINE}constructor(){super(),rt(this,"_moduleName","network-indicator"),rt(this,"_networkState",Hi.ONLINE),rt(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Hi.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Hi.OFFLINE})}};function tE(n,r){const i=n.indexOf(r);i!==-1&&n.splice(i,1)}function yh(n){const r=[];return n.forEach(i=>{r.indexOf(i)===-1&&r.push(i)}),r}function nE(n){Ie!==void 0?Ie.resolve().then(n):setTimeout(n,0)}function yn(n){return JSON.parse(JSON.stringify(n))}function wu(n){try{return yn(n)}catch{return n}}const uB={};function Yc(n,r){uB[r]||(uB[r]=!0,n())}function Cu(n){const r=window.atob(n),i=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s+=1)i[s]=r.charCodeAt(s);return i}function Xc(n){let r="";for(let i=0;i<n.length;i+=1)r+=String.fromCharCode(n[i]);return window.btoa(r)}function dB(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=new TextEncoder().encode(n);if(i.length>r)i=i.slice(0,r);else if(i.length<r){const s=new Uint8Array(r);s.set(i),i=s}return i}function hB(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=Ao(r).call(r,(h,f)=>h+f.length,0),c=new Uint8Array(new ArrayBuffer(s));let u=0;return r.forEach(h=>{c.set(h,u),u+=h.length}),c}function ps(n){return window.TextEncoder?new TextEncoder().encode(n).length:n.length}function fB(n){let r=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&n.realFormData&&(n=n.realFormData),n.forEach(i=>{r+=typeof i=="string"?ps(i):i.size}),r+138}function Khe(n){const r=new de($.TIMEOUT,"timeout");return new Ie((i,s)=>{window.setTimeout(()=>s(r),n)})}function _r(n){return new Ie(r=>{window.setTimeout(r,n)})}function qt(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,r=arguments.length>1?arguments[1]:void 0;const i=Math.random().toString(16).substr(2,n).toLowerCase();return i.length===n?"".concat(r).concat(i):"".concat(r).concat(i)+qt(n-i.length,"")}function Ru(){return qt(32,"").toUpperCase()}const rE=()=>{},pB=new class{constructor(){rt(this,"fnMap",new Map)}throttleByKey(n,r,i,s){for(var c=arguments.length,u=new Array(c>4?c-4:0),h=4;h<c;h++)u[h-4]=arguments[h];if(this.fnMap.has(r)){const f=this.fnMap.get(r);if(f.threshold!==i){f.fn(...f.args),clearTimeout(f.timer);const m=window.setTimeout(()=>{const y=this.fnMap.get(r);y&&y.fn(...y.args),this.fnMap.delete(r)},i);this.fnMap.set(r,{fn:n,threshold:i,timer:m,args:u,skipFn:s})}else f.skipFn&&f.skipFn(...f.args),this.fnMap.set(r,Me(Me({},f),{},{fn:n,args:u,skipFn:s}))}else{const f=window.setTimeout(()=>{const m=this.fnMap.get(r);m&&m.fn(...m.args),this.fnMap.delete(r)},i);this.fnMap.set(r,{fn:n,threshold:i,timer:f,args:u,skipFn:s})}}},mB=pB.throttleByKey.bind(pB);function gB(n){return typeof n=="object"&&n!==null&&!(n instanceof RegExp)}function tO(n,r){if(!gB(n)||!gB(r)||Array.isArray(n)&&!Array.isArray(r)||!Array.isArray(n)&&Array.isArray(r))return r;if(Array.isArray(r)&&Array.isArray(n)){const i=[...n];for(let s=0;s<r.length;s++)i[s]=tO(n[s],r[s]);return i}{const i=Me({},n);for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(Object.prototype.hasOwnProperty.call(n,s)?i[s]=tO(n[s],r[s]):i[s]=r[s]);return i}}function yB(n,r){let i=[0];if(i=new Array(r).fill(0),n===0)return i;let s=0;for(;n>0&&(i[s]=255&n,n>>=8,s++,s!==r););return i}function nO(n){return typeof n=="number"?n:n.exact||n.ideal||n.max||n.min||0}function vB(n){const r="0123456789abcdef";function i(Q){let ie,re="";for(ie=0;ie<=3;ie++)re+=r.charAt(Q>>8*ie+4&15)+r.charAt(Q>>8*ie&15);return re}function s(Q,ie){const re=(65535&Q)+(65535&ie);return(Q>>16)+(ie>>16)+(re>>16)<<16|65535&re}function c(Q,ie,re,te,he,Se){return s(function(Ne,ke){return Ne<<ke|Ne>>>32-ke}(s(s(ie,Q),s(te,Se)),he),re)}function u(Q,ie,re,te,he,Se,Ne){return c(ie&re|~ie&te,Q,ie,he,Se,Ne)}function h(Q,ie,re,te,he,Se,Ne){return c(ie&te|re&~te,Q,ie,he,Se,Ne)}function f(Q,ie,re,te,he,Se,Ne){return c(ie^re^te,Q,ie,he,Se,Ne)}function m(Q,ie,re,te,he,Se,Ne){return c(re^(ie|~te),Q,ie,he,Se,Ne)}const y=function(Q){let ie;const re=1+(Q.length+8>>6),te=new Array(16*re);for(ie=0;ie<16*re;ie++)te[ie]=0;for(ie=0;ie<Q.length;ie++)te[ie>>2]|=Q.charCodeAt(ie)<<ie%4*8;return te[ie>>2]|=128<<ie%4*8,te[16*re-2]=8*Q.length,te}(n);let _,S,w,O,W,k=1732584193,j=-271733879,H=-1732584194,K=271733878;for(_=0;_<y.length;_+=16)S=k,w=j,O=H,W=K,k=u(k,j,H,K,y[_+0],7,-680876936),K=u(K,k,j,H,y[_+1],12,-389564586),H=u(H,K,k,j,y[_+2],17,606105819),j=u(j,H,K,k,y[_+3],22,-1044525330),k=u(k,j,H,K,y[_+4],7,-176418897),K=u(K,k,j,H,y[_+5],12,1200080426),H=u(H,K,k,j,y[_+6],17,-1473231341),j=u(j,H,K,k,y[_+7],22,-45705983),k=u(k,j,H,K,y[_+8],7,1770035416),K=u(K,k,j,H,y[_+9],12,-1958414417),H=u(H,K,k,j,y[_+10],17,-42063),j=u(j,H,K,k,y[_+11],22,-1990404162),k=u(k,j,H,K,y[_+12],7,1804603682),K=u(K,k,j,H,y[_+13],12,-40341101),H=u(H,K,k,j,y[_+14],17,-1502002290),j=u(j,H,K,k,y[_+15],22,1236535329),k=h(k,j,H,K,y[_+1],5,-165796510),K=h(K,k,j,H,y[_+6],9,-1069501632),H=h(H,K,k,j,y[_+11],14,643717713),j=h(j,H,K,k,y[_+0],20,-373897302),k=h(k,j,H,K,y[_+5],5,-701558691),K=h(K,k,j,H,y[_+10],9,38016083),H=h(H,K,k,j,y[_+15],14,-660478335),j=h(j,H,K,k,y[_+4],20,-405537848),k=h(k,j,H,K,y[_+9],5,568446438),K=h(K,k,j,H,y[_+14],9,-1019803690),H=h(H,K,k,j,y[_+3],14,-187363961),j=h(j,H,K,k,y[_+8],20,1163531501),k=h(k,j,H,K,y[_+13],5,-1444681467),K=h(K,k,j,H,y[_+2],9,-51403784),H=h(H,K,k,j,y[_+7],14,1735328473),j=h(j,H,K,k,y[_+12],20,-1926607734),k=f(k,j,H,K,y[_+5],4,-378558),K=f(K,k,j,H,y[_+8],11,-2022574463),H=f(H,K,k,j,y[_+11],16,1839030562),j=f(j,H,K,k,y[_+14],23,-35309556),k=f(k,j,H,K,y[_+1],4,-1530992060),K=f(K,k,j,H,y[_+4],11,1272893353),H=f(H,K,k,j,y[_+7],16,-155497632),j=f(j,H,K,k,y[_+10],23,-1094730640),k=f(k,j,H,K,y[_+13],4,681279174),K=f(K,k,j,H,y[_+0],11,-358537222),H=f(H,K,k,j,y[_+3],16,-722521979),j=f(j,H,K,k,y[_+6],23,76029189),k=f(k,j,H,K,y[_+9],4,-640364487),K=f(K,k,j,H,y[_+12],11,-421815835),H=f(H,K,k,j,y[_+15],16,530742520),j=f(j,H,K,k,y[_+2],23,-995338651),k=m(k,j,H,K,y[_+0],6,-198630844),K=m(K,k,j,H,y[_+7],10,1126891415),H=m(H,K,k,j,y[_+14],15,-1416354905),j=m(j,H,K,k,y[_+5],21,-57434055),k=m(k,j,H,K,y[_+12],6,1700485571),K=m(K,k,j,H,y[_+3],10,-1894986606),H=m(H,K,k,j,y[_+10],15,-1051523),j=m(j,H,K,k,y[_+1],21,-2054922799),k=m(k,j,H,K,y[_+8],6,1873313359),K=m(K,k,j,H,y[_+15],10,-30611744),H=m(H,K,k,j,y[_+6],15,-1560198380),j=m(j,H,K,k,y[_+13],21,1309151649),k=m(k,j,H,K,y[_+4],6,-145523070),K=m(K,k,j,H,y[_+11],10,-1120210379),H=m(H,K,k,j,y[_+2],15,718787259),j=m(j,H,K,k,y[_+9],21,-343485551),k=s(k,S),j=s(j,w),H=s(H,O),K=s(K,W);return i(k)+i(j)+i(H)+i(K)}let qhe=1,_B=console,Lr=class{static setLogger(n){_B=n}constructor(n,r){rt(this,"id",void 0),rt(this,"lockingPromise",Ie.resolve()),rt(this,"locks",0),rt(this,"name",""),rt(this,"lockId",void 0),this.lockId=qhe++,n&&(this.name=n),r&&(this.id=r),this.logger("created")}logger(n,r){const i=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),s=n==="created"?"is ".concat(n,"."):"is ".concat(n,", current queue ").concat(this.locks,". ").concat(r??"");_B.debug("".concat(i," ").concat(s))}setId(n){this.id=n}get isLocked(){return this.locks>0}lock(n){let r;this.locks+=1,this.logger("locked",n);const i=new Ie(c=>{r=()=>{this.locks-=1,this.logger("unlocked",n),c()}}),s=this.lockingPromise.then(()=>r);return this.lockingPromise=this.lockingPromise.then(()=>i),s}};function vh(n,r){return function(i,s,c){const u=c.value;if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return c.value=async function(){const h=this[r];if(!h)throw new Error("mutex property key ".concat(r," doesn't exist on ").concat(n));const f=await h.lock("From ".concat(n,".").concat(s));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await u.apply(this,y)}finally{f()}},c}}const Gn={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function rO(n,r){const i=Math.floor(r.timeout*Math.pow(r.timeoutFactor,n));return Math.min(r.maxRetryTimeout,i)}function Mo(n,r,i,s){const c=Object.assign({},Gn,s);let u=c.timeout;const h=async()=>{await function(y){return new Ie(_=>{window.setTimeout(_,y)})}(u),u*=c.timeoutFactor,u=Math.min(c.maxRetryTimeout,u)};let f=!1;const m=new Ie(async(y,_)=>{r=r||(()=>!1),i=i||(()=>!0);for(let S=0;S<c.maxRetryCount;S+=1){if(f)return _(new de($.OPERATION_ABORTED));try{const w=await n();if(!r(w,S)||S+1===c.maxRetryCount)return y(w);await h()}catch(w){if(!i(w,S)||S+1===c.maxRetryCount)return _(w);await h()}}});return m.cancel=()=>f=!0,m}let iE,EB=class{constructor(n){rt(this,"input",[]),rt(this,"size",void 0),this.size=n}add(n){this.input.push(n),this.input.length>this.size&&this.input.splice(0,1)}mean(){var n;return this.input.length===0?0:Ao(n=this.input).call(n,(r,i)=>r+i)/this.input.length}},aE=0,iO=0;function aO(n,r,i,s){return new Ie((c,u)=>{r.responseType=r.responseType||"json",r.data&&!i?(r.data=JSON.stringify(r.data),aE+=ps(r.data)):i&&(r.data.size?aE+=r.data.size:r.data instanceof FormData?aE+=fB(r.data):aE+=ps(JSON.stringify(r.data))),r.headers=r.headers||{},r.headers["Content-Type"]=r.headers["Content-Type"]||"application/json",r.method="POST",r.url=n,mi.request(r).then(h=>{typeof h.data=="string"?iO+=ps(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?iO+=h.data.byteLength:iO+=ps(JSON.stringify(h.data)),c(h.data)}).catch(h=>{mi.isCancel(h)?u(new de($.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new de($.NETWORK_TIMEOUT,h.message)):h.response?u(new de($.NETWORK_RESPONSE_ERROR,h.response.status)):u(new de($.NETWORK_ERROR,h.message))})})}async function Yhe(n,r){const i=new Blob([r.data],{type:"buffer"});return await aO(n,Me(Me({},r),{},{data:i,headers:{"Content-Type":"application/octet-stream"}}),!0)}const SB=()=>window.isSecureContext!==void 0;function eo(n){if(Array.isArray(n))return n.map(i=>i);if(!bB(n))return n;const r={};for(const i in n){const s=n[i];bB(s)||Array.isArray(s)?r[i]=eo(s):r[i]=s}return r}function bB(n){return!(typeof n!="object"||Array.isArray(n)||!n)}let oO=class{constructor(n){rt(this,"input",[]),rt(this,"size",void 0),this.size=n}add(n){this.input.push(n),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const ms={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},Tm={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:ms,remoteCandidate:ms},updateInterval:0},TB={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},wB={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},CB={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},RB={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};let sO=class{constructor(n,r){rt(this,"onFirstVideoReceived",void 0),rt(this,"onFirstVideoDecoded",void 0),rt(this,"onFirstAudioReceived",void 0),rt(this,"onFirstVideoDecodedTimeout",void 0),rt(this,"onFirstAudioDecoded",void 0),rt(this,"onSelectedLocalCandidateChanged",void 0),rt(this,"onSelectedRemoteCandidateChanged",void 0),rt(this,"videoIsReady",!1),rt(this,"videoIsReady2",{}),rt(this,"pc",void 0),rt(this,"options",void 0),rt(this,"intervalTimer",void 0),rt(this,"stats",eo(Tm)),rt(this,"isFirstVideoReceived",{}),rt(this,"isFirstVideoDecoded",{}),rt(this,"isFirstAudioReceived",{}),rt(this,"isFirstAudioDecoded",{}),rt(this,"isFirstVideoDecodedTimeout",{}),rt(this,"lossRateWindowStats",[]),this.pc=n,this.options=r,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new Ie(n=>{n({local:Me({},ms),remote:Me({},ms)})})}setVideoIsReady(n){this.videoIsReady=n}setVideoIsReady2(n,r){this.videoIsReady2[n]=r}getVideoIsReady(n){return this.videoIsReady2[n]||!1}setIsFirstAudioDecoded(n){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(n){this.lossRateWindowStats.push(n),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const r=this.lossRateWindowStats.length,i=["videoSend","audioSend","videoRecv","audioRecv"];let s=0,c=0,u=0,h=0;for(const f of i)n[f].forEach((m,y)=>{if(!this.lossRateWindowStats[r-1][f][y]||!this.lossRateWindowStats[0][f][y])return;const _=this.lossRateWindowStats[r-1][f][y].packets-this.lossRateWindowStats[0][f][y].packets,S=this.lossRateWindowStats[r-1][f][y].packetsLost-this.lossRateWindowStats[0][f][y].packetsLost;f==="videoSend"||f==="audioSend"?(s+=_,u+=S):(c+=_,h+=S),Number.isNaN(_)||Number.isNaN(_)?m.packetLostRate=0:m.packetLostRate=_<=0||S<=0?0:S/(_+S)});n.sendPacketLossRate=s<=0||u<=0?0:u/(s+u),n.recvPacketLossRate=c<=0||h<=0?0:h/(c+h)}},Xhe=class extends sO{constructor(){super(...arguments),rt(this,"_stats",Tm),rt(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const n=await this._getStats(),r=this.statsResponsesToObjects(n);this._stats=eo(Tm);const i=r.filter(c=>c.type==="ssrc");this.processSSRCStats(i);const s=r.find(c=>c.type==="VideoBwe");s&&this.processBandwidthStats(s),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(n){this._stats.bitrate={actualEncoded:Number(n.googActualEncBitrate),targetEncoded:Number(n.googTargetEncBitrate),retransmit:Number(n.googRetransmitBitrate),transmit:Number(n.googTransmitBitrate)},this._stats.sendBandwidth=Number(n.googAvailableSendBandwidth)}processSSRCStats(n){n.forEach(r=>{var i;const s=Oe(i=r.id).call(i,"send");switch("".concat(r.mediaType,"_").concat(s?"send":"recv")){case"video_send":{const c=eo(wB);c.codec=r.googCodecName,c.adaptionChangeReason="none",r.googCpuLimitedResolution&&(c.adaptionChangeReason="cpu"),r.googBandwidthLimitedResolution&&(c.adaptionChangeReason="bandwidth"),c.avgEncodeMs=Number(r.googAvgEncodeMs),c.inputFrame={width:Number(r.googFrameWidthInput)||Number(r.googFrameWidthSent),height:Number(r.googFrameHeightInput)||Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},c.sentFrame={width:Number(r.googFrameWidthSent),height:Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},c.firsCount=Number(r.googFirReceived),c.nacksCount=Number(r.googNacksReceived),c.plisCount=Number(r.googPlisReceived),c.frameCount=Number(r.framesEncoded),c.bytes=Number(r.bytesSent),c.packets=Number(r.packetsSent),c.packetsLost=Number(r.packetsLost),c.ssrc=Number(r.ssrc),c.rttMs=Number(r.googRtt||0),this._stats.videoSend.push(c),this._stats.rtt=c.rttMs;break}case"video_recv":{const c=eo(TB),u=this.lastDecodeVideoReceiverStats.get(Number(r.ssrc));if(c.codec=r.googCodecName,c.targetDelayMs=Number(r.googTargetDelayMs),c.renderDelayMs=Number(r.googRenderDelayMs),c.currentDelayMs=Number(r.googCurrentDelayMs),c.minPlayoutDelayMs=Number(r.googMinPlayoutDelayMs),c.decodeMs=Number(r.googDecodeMs),c.maxDecodeMs=Number(r.googMaxDecodeMs),c.receivedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateReceived)},c.decodedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateDecoded)},c.decodeFrameRate=Number(r.googFrameRateDecoded),c.outputFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateOutput)},c.jitterBufferMs=Number(r.googJitterBufferMs),c.firsCount=Number(r.googFirsSent),c.nacksCount=Number(r.googNacksSent),c.plisCount=Number(r.googPlisSent),c.framesDecodeCount=Number(r.framesDecoded),c.bytes=Number(r.bytesReceived),c.packets=Number(r.packetsReceived),c.packetsLost=Number(r.packetsLost),c.ssrc=Number(r.ssrc),c.packets>0&&!this.isFirstVideoReceived[c.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(c.ssrc),this.isFirstVideoReceived[c.ssrc]=!0),c.framesDecodeCount>0&&!this.isFirstVideoDecoded[c.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(c.ssrc,c.decodedFrame.width,c.decodedFrame.height),this.isFirstVideoDecoded[c.ssrc]=!0),u){const h=u.stats,f=Date.now()-u.lts;c.framesDecodeFreezeTime=h.framesDecodeFreezeTime,c.framesDecodeInterval=h.framesDecodeInterval,c.framesDecodeCount>h.framesDecodeCount&&this.isFirstVideoDecoded[c.ssrc]?(u.lts=Date.now(),c.framesDecodeInterval=f,c.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc,10))?c.framesDecodeFreezeTime+=c.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):c.framesDecodeCount<u.stats.framesDecodeCount&&(c.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(c.ssrc,{stats:Me({},c),lts:Date.now()}),this._stats.videoRecv.push(c);break}case"audio_recv":{const c=eo(RB);c.codec=r.googCodecName,c.outputLevel=Math.abs(Number(r.audioOutputLevel))/32767,c.decodingCNG=Number(r.googDecodingCNG),c.decodingCTN=Number(r.googDecodingCTN),c.decodingCTSG=Number(r.googDecodingCTSG),c.decodingNormal=Number(r.googDecodingNormal),c.decodingPLC=Number(r.googDecodingPLC),c.decodingPLCCNG=Number(r.googDecodingPLCCNG),c.expandRate=Number(r.googExpandRate),c.accelerateRate=Number(r.googAccelerateRate),c.preemptiveExpandRate=Number(r.googPreemptiveExpandRate),c.secondaryDecodedRate=Number(r.googSecondaryDecodedRate),c.speechExpandRate=Number(r.googSpeechExpandRate),c.preferredJitterBufferMs=Number(r.googPreferredJitterBufferMs),c.jitterBufferMs=Number(r.googJitterBufferMs),c.jitterMs=Number(r.googJitterReceived),c.bytes=Number(r.bytesReceived),c.packets=Number(r.packetsReceived),c.packetsLost=Number(r.packetsLost),c.ssrc=Number(r.ssrc),c.receivedFrames=Number(r.googDecodingCTN)||Number(r.packetsReceived),c.droppedFrames=Number(r.googDecodingPLC)+Number(r.googDecodingPLCCNG)||Number(r.packetsLost),c.receivedFrames>0&&!this.isFirstAudioReceived[c.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(c.ssrc),this.isFirstAudioReceived[c.ssrc]=!0),c.decodingNormal>0&&!this.isFirstAudioDecoded[c.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(c.ssrc),this.isFirstAudioDecoded[c.ssrc]=!0),this._stats.audioRecv.push(c);break}case"audio_send":{const c=eo(CB);c.codec=r.googCodecName,c.inputLevel=Math.abs(Number(r.audioInputLevel))/32767,c.aecReturnLoss=Number(r.googEchoCancellationReturnLoss||0),c.aecReturnLossEnhancement=Number(r.googEchoCancellationReturnLossEnhancement||0),c.residualEchoLikelihood=Number(r.googResidualEchoLikelihood||0),c.residualEchoLikelihoodRecentMax=Number(r.googResidualEchoLikelihoodRecentMax||0),c.bytes=Number(r.bytesSent),c.packets=Number(r.packetsSent),c.packetsLost=Number(r.packetsLost),c.ssrc=Number(r.ssrc),c.rttMs=Number(r.googRtt||0),this._stats.rtt=c.rttMs,this._stats.audioSend.push(c);break}}})}_getStats(){return new Ie((n,r)=>{this.pc.getStats(n,r)})}statsResponsesToObjects(n){const r=[];return n.result().forEach(i=>{const s={id:i.id,timestamp:i.timestamp.valueOf().toString(),type:i.type};i.names().forEach(c=>{s[c]=i.stat(c)}),r.push(s)}),r}},wm=function(n){return n.BANDWIDTH="bandwidth",n.CPU="cpu",n.NONE="none",n.OTHER="other",n}({}),oE=function(n){return n.L1T1="L1T1",n.L1T2="L1T2",n.L1T3="L1T3",n.L1T3_KEY="L1T3_KEY",n.L2T1_KEY="L2T1_KEY",n.L2T2_KEY="L2T2_KEY",n.L2T3_KEY="L2T3_KEY",n.L3T1_KEY="L3T1_KEY",n.L3T2_KEY="L3T2_KEY",n.L3T3_KEY="L3T3_KEY",n}({}),cO=function(n){return n[n.new=0]="new",n[n.connecting=1]="connecting",n[n.connected=2]="connected",n[n.disconnected=3]="disconnected",n[n.failed=4]="failed",n[n.closed=5]="closed",n}({}),aa=function(n){return n.CERTIFICATE="certificate",n.CODEC="codec",n.CANDIDATE_PAIR="candidate-pair",n.LOCAL_CANDIDATE="local-candidate",n.REMOTE_CANDIDATE="remote-candidate",n.INBOUND="inbound-rtp",n.TRACK="track",n.OUTBOUND="outbound-rtp",n.PC="peer-connection",n.REMOTE_INBOUND="remote-inbound-rtp",n.REMOTE_OUTBOUND="remote-outbound-rtp",n.TRANSPORT="transport",n.CSRC="csrc",n.DATA_CHANNEL="data-channel",n.STREAM="stream",n.SENDER="sender",n.RECEIVER="receiver",n}({});var _h=function(n){return n[n.kNone=1]="kNone",n[n.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",n[n.kBytesToBits=8]="kBytesToBits",n}(_h||{});function Cm(n,r,i,s){let c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:_h.kNone;if(!r)return;const u=Number(r[i]);if(typeof u!="number")return;const h=Number(r[s]);if(typeof h!="number")return;if(!n)return h?u/h*c:void 0;const f=Number(n[i]);if(typeof f!="number")return;const m=Number(n[s]);if(typeof m!="number")return;const y=h-m;return y?(u-f)/y*c:void 0}let OB=class extends sO{constructor(){super(...arguments),rt(this,"_stats",Tm),rt(this,"report",void 0),rt(this,"lastDecodeVideoReceiverStats",new Map),rt(this,"lastVideoFramesRecv",new Map),rt(this,"lastVideoFramesSent",new Map),rt(this,"lastVideoFramesDecode",new Map),rt(this,"lastVideoFramesOutput",new Map),rt(this,"lastVideoJBDelay",new Map),rt(this,"lastAudioJBDelay",new Map),rt(this,"mediaBytesSent",new Map),rt(this,"mediaBytesRetransmit",new Map),rt(this,"mediaBytesTargetEncode",new Map),rt(this,"lastDecodeAudioReceiverStats",new Map),rt(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=eo(Tm),this.report.forEach(n=>{switch(n.type){case aa.OUTBOUND:case aa.INBOUND:{const r=n.mediaType||n.kind,i=!r&&"frameWidth"in n,s=!r&&!("frameWidth"in n);n.type===aa.OUTBOUND?r==="audio"||s?this.processAudioOutboundStats(n):(r==="video"||i)&&this.processVideoOutboundStats(n):n.type===aa.INBOUND&&(r==="audio"||s?this.processAudioInboundStats(n):(r==="video"||i)&&this.processVideoInboundStats(n));break}case aa.TRANSPORT:{const r=this.report.get(n.selectedCandidatePairId);r&&this.processCandidatePairStats(r);break}case aa.CANDIDATE_PAIR:n.selected&&this.processCandidatePairStats(n)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const n=await this.pc.getStats(),r={local:Me({},ms),remote:Me({},ms)};return n.forEach(i=>{let s;if(i.type===aa.TRANSPORT&&(s=n.get(i.selectedCandidatePairId)),i.type===aa.CANDIDATE_PAIR&&i.selected&&(s=i),s){const c=(u,h)=>{u.type=h.type,u.id=h.id,h.address&&(u.address=h.address),h.candidateType&&(u.candidateType=h.candidateType),h.port&&(u.port=h.port),h.priority&&(u.priority=h.priority),h.protocol&&(u.protocol=h.protocol),h.relayProtocol&&(u.relayProtocol=h.relayProtocol)};if(s.localCandidateId){const u=n.get(s.localCandidateId);u&&c(r.local,u)}if(s.remoteCandidateId){const u=n.get(s.remoteCandidateId);u&&c(r.remote,u)}}}),r}processCandidatePairStats(n){if(this._stats.sendBandwidth=n.availableOutgoingBitrate||0,n.currentRoundTripTime&&(this._stats.rtt=1e3*n.currentRoundTripTime),this._stats.videoSend.forEach(r=>{n.currentRoundTripTime&&(r.rttMs=1e3*n.currentRoundTripTime)}),this._stats.audioSend.forEach(r=>{n.currentRoundTripTime&&(r.rttMs=1e3*n.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=n.id,n.localCandidateId){const r=this.report.get(n.localCandidateId);r&&this.processCandidateStats(r)}if(n.remoteCandidateId){const r=this.report.get(n.remoteCandidateId);r&&this.processCandidateStats(r)}}processCandidateStats(n){let r;n.type===aa.LOCAL_CANDIDATE&&(r=this._stats.selectedCandidatePair.localCandidate),n.type===aa.REMOTE_CANDIDATE&&(r=this._stats.selectedCandidatePair.remoteCandidate),r&&(r.type=n.type,r.id=n.id,n.address&&(r.address=n.address),n.candidateType&&(r.candidateType=n.candidateType),n.port&&(r.port=n.port),n.priority&&(r.priority=n.priority),n.protocol&&(r.protocol=n.protocol),n.relayProtocol&&(r.relayProtocol=n.relayProtocol),n.type===aa.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==r.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Me({},r),Me({},this.stats.selectedCandidatePair.localCandidate)),n.type===aa.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==r.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Me({},r),Me({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(n){let r=this._stats.audioRecv.find(s=>s.ssrc===n.ssrc);r||(r=eo(RB),this._stats.audioRecv.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsReceived,r.packetsLost=n.packetsLost,r.packetsDiscarded=n.packetsDiscarded,r.bytes=n.bytesReceived,r.jitterMs=1e3*n.jitter,r.retransmittedBytesReceived=n.retransmittedBytesReceived,r.retransmittedPacketsReceived=n.retransmittedPacketsReceived,r.totalProcessingDelay=n.totalProcessingDelay,r.jitterBufferEmittedCount=n.jitterBufferEmittedCount;const i=this.lastDecodeAudioReceiverStats.get(r.ssrc);r.avgProcessingDelayMs=Cm(i,r,"totalProcessingDelay","jitterBufferEmittedCount",_h.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(n,n.trackId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),r.receivedFrames||(r.receivedFrames=n.packetsReceived),r.droppedFrames||(r.droppedFrames=n.packetsLost),r.receivedFrames>0&&!this.isFirstAudioReceived[r.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(r.ssrc),this.isFirstAudioReceived[r.ssrc]=!0),r.outputLevel&&r.outputLevel>0&&!this.isFirstAudioDecoded[r.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(r.ssrc),this.isFirstAudioDecoded[r.ssrc]=!0),typeof n.concealedSamples=="number"&&(r.concealedSamples=n.concealedSamples),this.lastDecodeAudioReceiverStats.set(r.ssrc,Me({},r))}processVideoInboundStats(n){let r=this._stats.videoRecv.find(h=>h.ssrc===n.ssrc);r||(r=eo(TB),this._stats.videoRecv.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsReceived,r.packetsLost=n.packetsLost,r.bytes=n.bytesReceived,r.firsCount=n.firCount,r.nacksCount=n.nackCount,r.plisCount=n.pliCount,r.framesDecodeCount=n.framesDecoded,r.framesDroppedCount=n.framesDropped,r.totalInterFrameDelay=n.totalInterFrameDelay,r.totalSquaredInterFrameDelay=n.totalSquaredInterFrameDelay,r.totalFreezesDuration=n.totalFreezesDuration,r.totalProcessingDelay=n.totalProcessingDelay,r.packetsDiscarded=n.packetsDiscarded,r.framesAssembledFromMultiplePackets=n.framesAssembledFromMultiplePackets,r.totalAssemblyTime=n.totalAssemblyTime,r.keyFramesDecoded=n.keyFramesDecoded,r.retransmittedBytesReceived=n.retransmittedBytesReceived,r.retransmittedPacketsReceived=n.retransmittedPacketsReceived;const i=this.lastDecodeVideoReceiverStats.get(r.ssrc),s=this.lastVideoFramesDecode.get(r.ssrc),c=this.lastVideoFramesOutput.get(r.ssrc),u=Date.now();if(r.framesDecodeCount>0&&!this.isFirstVideoDecoded[r.ssrc]){const h=r.decodedFrame?r.decodedFrame.width:0,f=r.decodedFrame?r.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(r.ssrc,h,f),this.isFirstVideoDecoded[r.ssrc]=!0}if(i){const h=i.stats,f=u-i.lts;r.framesDecodeFreezeTime=h.framesDecodeFreezeTime,r.framesDecodeInterval=h.framesDecodeInterval,!this.isFirstVideoDecoded[r.ssrc]&&f>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[r.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(r.ssrc),this.isFirstVideoDecodedTimeout[r.ssrc]=!0),r.framesDecodeCount>h.framesDecodeCount&&this.isFirstVideoDecoded[r.ssrc]?(i.lts=Date.now(),r.framesDecodeInterval=f,r.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc))?r.framesDecodeFreezeTime+=r.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):r.framesDecodeCount<h.framesDecodeCount&&(r.framesDecodeInterval=0),n.framesDecoded&&n.qpSum&&(i.stats.framesDecodeCount>n.framesDecoded?r.qpSumPerFrame=n.qpSum/n.framesDecoded:r.qpSumPerFrame=(n.qpSum-i.qpSum)/(n.framesDecoded-i.stats.framesDecodeCount))}n.totalDecodeTime&&(r.decodeMs=1e3*n.totalDecodeTime,r.avgDecodeMs=Cm(i==null?void 0:i.stats,r,"decodeMs","framesDecodeCount")),r.avgProcessingDelayMs=Cm(i==null?void 0:i.stats,r,"totalProcessingDelay","framesDecodeCount",_h.kMillisecondsFromSeconds),r.avgFramesAssembledFromMultiplePacketsMs=Cm(i==null?void 0:i.stats,r,"totalAssemblyTime","framesAssembledFromMultiplePackets",_h.kMillisecondsFromSeconds),r.avgInterFrameDelayMs=Cm(i==null?void 0:i.stats,r,"totalInterFrameDelay","framesDecodeCount",_h.kMillisecondsFromSeconds),s&&u-s.lts>=800?(r.decodeFrameRate=Math.round((r.framesDecodeCount-s.count)/((u-s.lts)/1e3)),this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:r.decodeFrameRate})):s?r.decodeFrameRate=s.rate:this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:0}),r.framesDroppedCount&&n.framesReceived&&(c&&u-c.lts>=800?(r.outputFrameRate=Math.round((n.framesReceived-r.framesDroppedCount-c.count)/((u-c.lts)/1e3)),this.lastVideoFramesOutput.set(r.ssrc,{count:n.framesReceived-r.framesDroppedCount,lts:u,rate:Math.max(r.outputFrameRate,0)})):c?r.outputFrameRate=c.rate:this.lastVideoFramesOutput.set(r.ssrc,{count:n.framesReceived-r.framesDroppedCount,lts:u,rate:0})),this.processVideoTrackReceiverStats(n,n.trackId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),n.framerateMean&&(r.framesRateFirefox=n.framerateMean),r.packets>0&&!this.isFirstVideoReceived[r.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(r.ssrc),this.isFirstVideoReceived[r.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(r.ssrc,{stats:Me({},r),lts:i?i.lts:Date.now(),qpSum:n.qpSum})}processVideoOutboundStats(n){let r=this._stats.videoSend.find(s=>s.ssrc===n.ssrc);r||(r=eo(wB),this._stats.videoSend.push(r));const i=this.mediaBytesSent.get(n.ssrc);if(i)i.add(n.bytesSent);else{const s=new oO(10);s.add(n.bytesSent),this.mediaBytesSent.set(n.ssrc,s)}if(n.retransmittedBytesSent!==void 0){const s=this.mediaBytesRetransmit.get(n.ssrc);if(s)s.add(n.retransmittedBytesSent);else{const c=new oO(10);c.add(n.retransmittedBytesSent),this.mediaBytesRetransmit.set(n.ssrc,c)}}if(n.totalEncodedBytesTarget){const s=this.mediaBytesTargetEncode.get(n.ssrc);if(s)s.add(n.totalEncodedBytesTarget);else{const c=new oO(10);c.add(n.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(n.ssrc,c)}}if(r.ssrc=n.ssrc,r.bytes=n.bytesSent,r.packets=n.packetsSent,r.firsCount=n.firCount,r.nacksCount=n.nackCount,r.plisCount=n.pliCount,r.frameCount=n.framesEncoded,r.adaptionChangeReason=n.qualityLimitationReason,r.scalabilityMode=n.scalabilityMode,r.retransmittedBytesSent=n.retransmittedBytesSent,r.retransmittedPacketsSent=n.retransmittedPacketsSent,r.hugeFramesSent=n.hugeFramesSent,r.keyFramesEncoded=n.keyFramesEncoded,n.totalEncodeTime&&n.framesEncoded){const s=this.lastEncoderMs.get(n.ssrc);if(!s||s.lastFrameCount>n.framesEncoded)r.avgEncodeMs=1e3*n.totalEncodeTime/n.framesEncoded;else{const c=n.framesEncoded-s.lastFrameCount,u=n.totalEncodeTime-s.lastEncoderTime;r.avgEncodeMs=1e3*u/c}}if(n.framesEncoded&&n.qpSum){const s=this.lastEncoderMs.get(n.ssrc);!s||s.lastFrameCount>n.framesEncoded?r.qpSumPerFrame=n.qpSum/n.framesEncoded:r.qpSumPerFrame=(n.qpSum-s.lastQpSum)/(n.framesEncoded-s.lastFrameCount)}if(this.lastEncoderMs.set(n.ssrc,{lastFrameCount:n.framesEncoded,lastEncoderTime:n.totalEncodeTime,lastQpSum:n.qpSum,lts:Date.now()}),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),n.mediaSourceId&&this.processVideoMediaSource(n.mediaSourceId,r),this.processVideoTrackSenderStats(n,n.trackId,r),n.remoteId)this.processRemoteInboundStats(n.remoteId,r);else{const s=this.findRemoteStatsId(n.ssrc,aa.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,r)}}processAudioOutboundStats(n){let r=this._stats.audioSend.find(i=>i.ssrc===n.ssrc);if(r||(r=eo(CB),this._stats.audioSend.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsSent,r.bytes=n.bytesSent,r.retransmittedBytesSent=n.retransmittedBytesSent,r.retransmittedPacketsSent=n.retransmittedPacketsSent,n.mediaSourceId&&this.processAudioMediaSource(n.mediaSourceId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),this.processAudioTrackSenderStats(n,n.trackId,r),n.remoteId)this.processRemoteInboundStats(n.remoteId,r);else{const i=this.findRemoteStatsId(n.ssrc,aa.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,r)}}findRemoteStatsId(n,r){var i;const s=Array.from(na(i=this.report).call(i)).find(c=>c.type===r&&c.ssrc===n);return s?s.id:null}processVideoMediaSource(n,r){const i=this.report.get(n);i&&i.width&&i.height&&i.framesPerSecond&&(r.inputFrame={width:i.width,height:i.height,frameRate:i.framesPerSecond})}processAudioMediaSource(n,r){const i=this.report.get(n);i&&(r.inputLevel=i.audioLevel)}processVideoTrackSenderStats(n,r,i){var s,c,u,h;const f=r?this.report.get(r):void 0,m=(s=f==null?void 0:f.framesSent)!==null&&s!==void 0?s:n.framesSent;if(typeof m!="number")return;let y=(c=f==null?void 0:f.frameWidth)!==null&&c!==void 0?c:n.frameWidth,_=(u=f==null?void 0:f.frameHeight)!==null&&u!==void 0?u:n.frameHeight,S=(h=f==null?void 0:f.framesPerSecond)!==null&&h!==void 0?h:n.framesPerSecond;if(typeof y=="number"&&typeof _=="number"||(y=0,_=0),S==null){const w=Date.now(),O=this.lastVideoFramesSent.get(i.ssrc);O&&w-O.lts>=800?(S=Math.round((m-O.count)/((w-O.lts)/1e3)),this.lastVideoFramesSent.set(i.ssrc,{count:m,lts:w,rate:S})):O?S=O.rate:this.lastVideoFramesSent.set(i.ssrc,{count:m,lts:w,rate:0})}i.sentFrame={width:y,height:_,frameRate:Math.max(0,S)}}processVideoTrackReceiverStats(n,r,i){var s,c,u,h,f;const m=r?this.report.get(r):void 0,y=(s=m==null?void 0:m.framesReceived)!==null&&s!==void 0?s:n.framesReceived,_=(c=m==null?void 0:m.frameWidth)!==null&&c!==void 0?c:n.frameWidth,S=(u=m==null?void 0:m.frameHeight)!==null&&u!==void 0?u:n.frameHeight,w=(h=m==null?void 0:m.jitterBufferDelay)!==null&&h!==void 0?h:n.jitterBufferDelay,O=(f=m==null?void 0:m.jitterBufferEmittedCount)!==null&&f!==void 0?f:n.jitterBufferEmittedCount;if(typeof y=="number"){const W=this.lastVideoFramesRecv.get(i.ssrc),k=Date.now();i.framesReceivedCount=y;let j=0;W&&k-W.lts>=800?(j=Math.round((y-W.count)/((k-W.lts)/1e3)),this.lastVideoFramesRecv.set(i.ssrc,{count:y,lts:k,rate:j})):W?j=W.rate:this.lastVideoFramesRecv.set(i.ssrc,{count:y,lts:k,rate:0}),i.receivedFrame={width:_||0,height:S||0,frameRate:j||0},i.decodedFrame={width:_||0,height:S||0,frameRate:i.decodeFrameRate||0},i.outputFrame={width:_||0,height:S||0,frameRate:i.outputFrameRate||i.decodeFrameRate||0}}if(w&&O){const W=this.lastVideoJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let k=W.jitterBufferMs;const j=O-W.jitterBufferEmittedCount;j>0&&(k=1e3*(w-W.jitterBufferDelay)/j),i.jitterBufferMs=k,i.currentDelayMs=Math.round(k),this.lastVideoJBDelay.set(i.ssrc,{jitterBufferDelay:w,jitterBufferEmittedCount:O,jitterBufferMs:i.currentDelayMs})}}processAudioTrackSenderStats(n,r,i){var s,c,u,h;const f=r?this.report.get(r):void 0,m=(s=(c=f==null?void 0:f.echoReturnLoss)!==null&&c!==void 0?c:n.echoReturnLoss)!==null&&s!==void 0?s:0,y=(u=(h=f==null?void 0:f.echoReturnLossEnhancement)!==null&&h!==void 0?h:n.echoReturnLossEnhancement)!==null&&u!==void 0?u:0;i.aecReturnLoss=m,i.aecReturnLossEnhancement=y}processAudioTrackReceiverStats(n,r,i){var s,c,u,h,f,m,y;const _=r?this.report.get(r):void 0,S=(s=_==null?void 0:_.removedSamplesForAcceleration)!==null&&s!==void 0?s:n.removedSamplesForAcceleration,w=(c=_==null?void 0:_.totalSamplesReceived)!==null&&c!==void 0?c:n.totalSamplesReceived,O=(u=_==null?void 0:_.jitterBufferDelay)!==null&&u!==void 0?u:n.jitterBufferDelay,W=(h=_==null?void 0:_.jitterBufferEmittedCount)!==null&&h!==void 0?h:n.jitterBufferEmittedCount,k=(f=_==null?void 0:_.audioLevel)!==null&&f!==void 0?f:n==null?void 0:n.audioLevel,j=(m=_==null?void 0:_.totalSamplesDuration)!==null&&m!==void 0?m:n==null?void 0:n.totalSamplesDuration,H=(y=_==null?void 0:_.concealedSamples)!==null&&y!==void 0?y:n.concealedSamples;if(S&&w&&(i.accelerateRate=S/w),O&&W){const Q=this.lastAudioJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let ie=Q.jitterBufferMs;const re=W-Q.jitterBufferEmittedCount;re>0&&(ie=1e3*(O-Q.jitterBufferDelay)/re),i.jitterBufferMs=Math.round(ie),this.lastAudioJBDelay.set(i.ssrc,{jitterBufferDelay:O,jitterBufferEmittedCount:W,jitterBufferMs:i.jitterBufferMs})}i.outputLevel=k;let K=1920;j&&w&&(K=w/j/50,i.receivedFrames=Math.round(w/K)),H&&(i.droppedFrames=Math.round(H/K))}processRemoteInboundStats(n,r){const i=this.report.get(n);i&&(r.packetsLost=i.packetsLost,i.roundTripTime&&(r.rttMs=1e3*i.roundTripTime),i.jitter&&(r.jitterMs=1e3*i.jitter),i.timestamp&&(r.timestamp=i.timestamp))}getCodecFromCodecStats(n){const r=this.report.get(n);if(!r)return"";const i=r.mimeType.match(/\/(.*)$/);return i&&i[1]?i[1]:""}updateSendBitrate(){let n=0,r=null,i=null;this.mediaBytesSent.forEach(c=>{n+=c.diffMean()}),this.mediaBytesRetransmit.forEach(c=>{r=r===null?c.diffMean():r+c.diffMean()}),this.mediaBytesTargetEncode.forEach(c=>{i=i===null?c.diffMean():i+c.diffMean()});const s=r!==null?n-r:n;this._stats.bitrate={actualEncoded:8*s/(this.options.updateInterval/1e3),transmit:8*n/(this.options.updateInterval/1e3)},r!==null&&(this._stats.bitrate.retransmit=8*r/(this.options.updateInterval/1e3)),i!==null&&(this._stats.bitrate.targetEncoded=8*i/(this.options.updateInterval/1e3))}},Jhe=class extends sO{updateStats(){return Ie.resolve()}};function lO(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const u=function(){const h=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return h&&h[0]?Number(h[0].split("/")[1]):null}();return u?u<76?new Xhe(n,{updateInterval:r,lossRateInterval:i,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new OB(n,{updateInterval:r,lossRateInterval:i,freezeRateLimit:s,firstVideoDecodedTimeout:c}):function(h){if(!window.RTCStatsReport)return!1;const f=h.getStats();return!!(f instanceof Ie||function(m){return!!m&&(typeof m=="object"||typeof m=="function")&&typeof m.then=="function"}(f))}(n)?new OB(n,{updateInterval:r,lossRateInterval:i,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new Jhe(n,{updateInterval:r,lossRateInterval:i,freezeRateLimit:s,firstVideoDecodedTimeout:c})}const AB="websdk_ng_install_id";function uO(){try{if(Y("INSTALL_ID"))return Y("INSTALL_ID");let n=window.localStorage.getItem(AB);return n||(n=Ru(),window.localStorage.setItem(AB,n)),Ut("INSTALL_ID",n),n}catch{return}}const Ca=function(n){if(n.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return n;const r=n.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(r&&r[1]&&r[2]){const i=r[1],s=r[2];return"".concat(i,".").concat(s)}return"4.0.0.999"}("4.23.1"),dO=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let Ou=function(n){return n.Default="default",n.Auto="auto",n.Relay="relay",n.SdRtn="sd-rtn",n}({});const Ar=function(){const n="us".concat("erna","me"),r="pa".concat("sswo","rd"),i=["t","s","t"];i.splice(1,0,"e");const s=i.join(""),c=[];for(let f=0;f<6;f++)c.push("1");const u=c.join(""),h={};return h[n]=s,h[r]=u,Object.assign(h,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Ar;const sE={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},hO={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},fO="v4.23.1-0-gea45199f-dirty(1/16/2025, 3:18:04 PM)",pO={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"]},un=Me(Me(Me({},pO),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:hO,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},sE),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""});function Ut(n,r,i){var s,c,u;Oe(s=Object.keys(un)).call(s,n)&&(!i&&Oe(c=Object.keys(Uo)).call(c,n)||(un[n]=r,n!=="ENABLE_VIDEO_SEI"&&n!=="ENABLE_AUDIO_TOPN"&&n!=="ENABLE_AUDIO_METADATA"||r!==!0||(un.ENABLE_ENCODED_TRANSFORM=!0),n==="USE_NEW_NETWORK_CONFIG"&&r&&(u=!!r,un.USE_NEW_NETWORK_CONFIG=u,u&&(un.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],un.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],un.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],un.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],un.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",un.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",un.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),n==="ENABLE_PRE_SUB"&&r&&(un.ENABLE_INSTANT_VIDEO=!0,un.ENABLE_PREALLOC_PC=!0),n==="ENABLE_SVC"&&r&&(un.ENABLE_AUT_CC=!0)))}function Y(n){return un[n]}dO||(un.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],un.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],un.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],un.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],un.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],un.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],un.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",un.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",un.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",un.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",un.AREAS=["NORTH_AMERICA","OVERSEA"]);let IB=function(n){return n[n.REALTIME=1]="REALTIME",n}({});const Uo={};var ht=function(n){return n.SET_SESSION_ID="SET_SESSION_ID",n.SET_P2P_ID="SET_P2P_id",n.SET_DC_ID="SET_DC_id",n.SET_UID="SET_UID",n.SET_INT_UID="SET_INT_UID",n.SET_PUB_ID="SET_PUB_ID",n.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",n.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",n.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",n.AVOID_JOIN_START="AVOID_JOIN_START",n.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",n.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",n.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",n.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",n.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",n.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",n.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",n.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",n.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",n.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",n.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",n.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",n.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",n.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",n.RESET_KEY_METRICS="RESET_KEY_METRICS",n.SET_USE_P2P="SET_USE_P2P",n.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",n}(ht||{});let Qhe=class{constructor(n,r,i,s){rt(this,"state",void 0),this.state={codec:n,audioCodec:r,mode:i,clientId:s,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:Ou.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(n){this.state=function(r,i){switch(i.type){case ht.SET_SESSION_ID:return Me(Me({},r),{},{sessionId:i.sessionId});case ht.SET_P2P_ID:return Me(Me({},r),{},{p2pId:i.p2pId});case ht.SET_UID:return Me(Me({},r),{},{uid:i.uid});case ht.SET_INT_UID:return Me(Me({},r),{},{intUid:i.intUid});case ht.SET_PUB_ID:return Me(Me({},r),{},{pubId:i.pubId});case ht.KEY_METRIC_CLIENT_CREATED:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{clientCreated:i.metric})});case ht.KEY_METRIC_JOIN_START:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{joinStart:i.metric})});case ht.AVOID_JOIN_START:return Me(Me({},r),{},{avoidJoinStart:i.avoidJoinStart});case ht.KEY_METRIC_JOIN_END:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{joinEnd:i.metric})});case ht.KEY_METRIC_REQUEST_AP_START:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{requestAPStart:i.metric})});case ht.KEY_METRIC_REQUEST_AP_END:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{requestAPEnd:i.metric})});case ht.KEY_METRIC_JOIN_GATEWAY_START:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{joinGatewayStart:i.metric})});case ht.KEY_METRIC_JOIN_GATEWAY_END:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{joinGatewayEnd:i.metric})});case ht.KEY_METRIC_PEER_CONNECTION_START:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{peerConnectionStart:i.metric})});case ht.KEY_METRIC_PEER_CONNECTION_END:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{peerConnectionEnd:i.metric})});case ht.KEY_METRIC_DESCRIPTION_START:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{descriptionStart:i.metric})});case ht.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{signalChannelOpen:i.metric})});case ht.KEY_METRIC_ICE_CONNECTION_END:return Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{iceConnectionEnd:i.metric})});case ht.KEY_METRIC_PUBLISH:{const s=r.keyMetrics.publish,c=s.findIndex(u=>u.trackId===i.metric.trackId);return c!==-1?(s[c]=Me(Me({},s[c]),i.metric),Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{publish:[...s]})})):Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{publish:[...r.keyMetrics.publish,i.metric]})})}case ht.KEY_METRIC_SUBSCRIBE:{const s=r.keyMetrics.subscribe,c=s.findIndex(u=>u.userId===i.metric.userId&&u.type===i.metric.type);return c!==-1?(s[c]=Me(Me({},s[c]),i.metric),Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{subscribe:[...s]})})):Me(Me({},r),{},{keyMetrics:Me(Me({},r.keyMetrics),{},{subscribe:[...r.keyMetrics.subscribe,i.metric]})})}case ht.SET_CLOUD_PROXY_SERVER_MODE:return r.cloudProxyServerMode=i.mode,r;case ht.RECORD_JOIN_CHANNEL_SERVICE:return typeof i.index!="number"?r.joinChannelServiceRecords=[...r.joinChannelServiceRecords,i.record]:(r.joinChannelServiceRecords[i.index]=Me(Me({},r.joinChannelServiceRecords[i.index]),i.record),r.joinChannelServiceRecords=[...r.joinChannelServiceRecords]),r;case ht.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return r.joinChannelServiceRecords=[],r;case ht.RESET_KEY_METRICS:return r.keyMetrics={publish:[],subscribe:[]},r;case ht.SET_USE_P2P:return Me(Me({},r),{},{useP2P:i.val});case ht.SET_TRANSPORT_TYPE:return Me(Me({},r),{},{p2pTransport:i.val});default:return r}}(this.state,n)}set sessionId(n){this.dispatch({type:ht.SET_SESSION_ID,sessionId:n})}get sessionId(){return this.state.sessionId}set cid(n){this.state.cid=n}get cid(){return this.state.cid}set codec(n){this.state.codec=n}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(n){this.dispatch({type:ht.SET_P2P_ID,p2pId:n})}get p2pId(){return this.state.p2pId}set dcId(n){this.dispatch({type:ht.SET_DC_ID,dcId:n})}get dcId(){return this.state.dcId}set uid(n){this.dispatch({type:ht.SET_UID,uid:n})}get uid(){return this.state.uid}set intUid(n){this.dispatch({type:ht.SET_INT_UID,intUid:n})}get intUid(){return this.state.intUid}set pubId(n){this.dispatch({type:ht.SET_PUB_ID,pubId:n})}get pubId(){return this.state.pubId}set cloudProxyServerMode(n){this.dispatch({type:ht.SET_CLOUD_PROXY_SERVER_MODE,mode:n})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(n){this.dispatch({type:ht.SET_USE_P2P,val:n})}get useP2P(){return this.state.useP2P}set p2pTransport(n){this.dispatch({type:ht.SET_TRANSPORT_TYPE,val:n})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(n){this.state.hasStartJoinChannel=n}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(n){this.state.isABTestSuccess=n}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:ht.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:ht.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:ht.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:ht.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:ht.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:ht.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:ht.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:ht.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:ht.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:ht.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:ht.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:ht.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(n,r,i,s){this.dispatch({type:ht.KEY_METRIC_PUBLISH,metric:Me(Me({trackId:n,type:r},i&&{publishStart:i}),s&&{publishEnd:s})})}subscribe(n,r,i,s,c,u,h){this.dispatch({type:ht.KEY_METRIC_SUBSCRIBE,metric:Me(Me(Me(Me(Me({userId:n,type:r},i&&{subscribeStart:i}),s&&{subscribeEnd:s}),c&&{firstFrame:c}),u&&{streamAdded:u}),h&&{firstDecoded:h})})}massSubscribe(n,r,i,s){n.forEach(c=>{this.dispatch({type:ht.KEY_METRIC_SUBSCRIBE,metric:Me(Me(Me({userId:c.userId,type:c.type},r&&{subscribeStart:r}),i&&{subscribeEnd:i}),s&&{firstFrame:s})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(n,r){n.service==="gateway"&&Array.isArray(n.urls)&&(n.urls=n.urls.map(i=>i.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof r!="number"?(this.dispatch({type:ht.RECORD_JOIN_CHANNEL_SERVICE,record:Me(Me({},n),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(r<0||r>=this.state.joinChannelServiceRecords.length||this.dispatch({type:ht.RECORD_JOIN_CHANNEL_SERVICE,record:n,index:r}),r)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:ht.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:ht.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(n){this.dispatch({type:ht.AVOID_JOIN_START,avoidJoinStart:n})}},cE=function(n){return n.h264="h264",n.h265="h265",n.vp8="vp8",n.vp9="vp9",n.av1="av1",n}({});(function(n){n.opus="opus",n.pcma="pcma",n.pcmu="pcmu",n.g722="g722"})({});let Zhe=0;var NB=(()=>{var n={8:(s,c,u)=>{u.r(c),u.d(c,{Parser:()=>Ne,Printer:()=>An,parse:()=>we,print:()=>We});const h=`
`,f="".concat("\r").concat(h),m=" ";let y;function _(ge){return ge>="0"&&ge<="9"}function S(ge){return ge>="!"&&ge<="~"}function w(ge){return S(ge)||ge>=""&&ge<=""}function O(ge){return ge==="!"||ge>="#"&&ge<="'"||ge>="*"&&ge<="+"||ge>="-"&&ge<="."||ge>="0"&&ge<="9"||ge>="A"&&ge<="Z"||ge>="^"&&ge<="~"}function W(ge){return ge>="1"&&ge<="9"}function k(ge){return ge>="A"&&ge<="Z"||ge>="a"&&ge<="z"}function j(ge){return ge==="d"||ge==="h"||ge==="m"||ge==="s"}function H(ge){return ge>""&&ge<"	"||ge>"\v"&&ge<"\f"||ge>""&&ge<""}function K(ge){return k(ge)||_(ge)||ge==="+"||ge==="/"}function Q(ge){return _(ge)||k(ge)||ge==="+"||ge==="/"||ge==="-"||ge==="_"}function ie(ge){return k(ge)||_(ge)||ge==="+"||ge==="/"}function re(ge,I){var X=Object.keys(ge);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(ge);I&&(J=J.filter(function(Te){return Object.getOwnPropertyDescriptor(ge,Te).enumerable})),X.push.apply(X,J)}return X}function te(ge){for(var I=1;I<arguments.length;I++){var X=arguments[I]!=null?arguments[I]:{};I%2?re(Object(X),!0).forEach(function(J){he(ge,J,X[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ge,Object.getOwnPropertyDescriptors(X)):re(Object(X)).forEach(function(J){Object.defineProperty(ge,J,Object.getOwnPropertyDescriptor(X,J))})}return ge}function he(ge,I,X){return I in ge?Object.defineProperty(ge,I,{value:X,enumerable:!0,configurable:!0,writable:!0}):ge[I]=X,ge}(function(ge){ge.VERSION="v",ge.ORIGIN="o",ge.SESSION_NAME="s",ge.INFORMATION="i",ge.URI="u",ge.EMAIL="e",ge.PHONE="p",ge.CONNECTION="c",ge.BANDWIDTH="b",ge.TIME="t",ge.REPEAT="r",ge.ZONE_ADJUSTMENTS="z",ge.KEY="k",ge.ATTRIBUTE="a",ge.MEDIA="m"})(y||(y={}));class Se{consumeText(I,X){let J=X;for(;J<I.length;){const Te=I[J];if(Te==="\0"||Te==="\r"||Te===h)break;J+=1}if(J-X==0)throw new Error("Invalid text, at ".concat(I));return J}consumeUnicastAddress(I,X,J){return this.consumeTill(I,X,m)}consumeOneOrMore(I,X,J){let Te=X;for(;J(I[Te]);)Te++;if(Te-X==0)throw new Error("Invalid rule at ".concat(X,"."));return Te}consumeSpace(I,X){if(I[X]===m)return X+1;throw new Error("Invalid space at ".concat(X,"."))}consumeIP4Address(I,X){let J=X;for(let Te=0;Te<4;Te++)if(J=this.consumeDecimalUChar(I,J),Te!==3){if(I[J]!==".")throw new Error("Invalid IP4 address.");J++}return J}consumeDecimalUChar(I,X){let J=X;for(let it=0;it<3&&_(I[J]);it++,J++);if(J-X==0)throw new Error("Invalid decimal uchar.");const Te=parseInt(I.slice(X,J));if(Te>=0&&Te<=255)return J;throw new Error("Invalid decimal uchar")}consumeIP6Address(I,X){let J=this.consumeHexpart(I,X);return I[J]===":"&&(J+=1,J=this.consumeIP4Address(I,J)),J}consumeHexpart(I,X){let J=X;if(I[J]===":"&&I[J+1]===":"){J+=2;try{J=this.consumeHexseq(I,J)}catch{}return J}if(J=this.consumeHexseq(I,J),I[J]===":"&&I[J+1]===":"){J+=2;try{J=this.consumeHexseq(I,J)}catch{}return J}return J}consumeHexseq(I,X){let J=X;for(;J=this.consumeHex4(I,J),I[J]===":"&&I[J+1]!==":";)J+=1;return J}consumeHex4(I,X){let J=0;for(;J<4;J++)if(!((Te=I[X+J])>="0"&&Te<="9"||Te>="a"&&Te<="f"||Te>="A"&&Te<="F")){if(J===0)throw new Error("Invalid hex 4");break}var Te;return X+J}consumeFQDN(I,X){let J=X;for(;_(I[J])||k(I[J])||I[J]==="-"||I[J]===".";)J+=1;if(J-X<4)throw new Error("Invalid FQDN");return J}consumeExtnAddr(I,X){return this.consumeOneOrMore(I,X,w)}consumeMulticastAddress(I,X,J){switch(J){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(I,X);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(I,X);default:try{return this.consumeFQDN(I,X)}catch{return this.consumeExtnAddr(I,X)}}}consumeIP6MulticastAddress(I,X){const J=this.consumeHexpart(I,X);return I[J]==="/"?this.consumeInteger(I,J+1):J}consumeIP4MulticastAddress(I,X){let J=X+3;const Te=I.slice(X,J),it=parseInt(Te);if(it<224||it>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Ft=0;Ft<3;Ft++){if(I[J]!==".")throw new Error("Invalid IP4 multicast address.");J+=1,J=this.consumeDecimalUChar(I,J)}return I[J]==="/"&&(J+=1),J=this.consumeTTL(I,J),I[J]==="/"&&(J=this.consumeInteger(I,J)),J}consumeInteger(I,X){if(!W(I[X]))throw new Error("Invalid integer.");for(X+=1;_(I[X]);)X+=1;return X}consumeTTL(I,X){if(I[X]==="0")return X+1;if(!W(I[X]))throw new Error("Invalid TTL.");X+=1;for(let J=0;J<2&&_(I[X]);J++)X+=1;return X}consumeToken(I,X){return this.consumeOneOrMore(I,X,O)}consumeTime(I,X){let J=X;if(I[J]==="0")return J+1;for(W(I[J])&&(J+=1);_(I[J]);)J++;if(J-X<10)throw new Error("Invalid time");return J}consumeAddress(I,X){return this.consumeTill(I,X,m)}consumeTypedTime(I,X){let J=X;return J=this.consumeOneOrMore(I,J,_),j(I[J])?J+1:J}consumeRepeatInterval(I,X){if(!W(I[X]))throw new Error("Invalid repeat interval");for(X+=1;_(I[X]);)X+=1;return j(I[X])&&(X+=1),X}consumePort(I,X){return this.consumeOneOrMore(I,X,_)}consume(I,X,J){for(let Te=0;Te<J.length;Te++){if(X+Te>=I.length)throw new Error("consume exceeding value length");if(I[X+Te]!==J[Te])throw new Error("consume ".concat(J," failed at ").concat(Te))}return X+J.length}consumeTill(I,X,J){let Te=X;for(;Te<I.length&&(typeof J!="string"||I[Te]!==J)&&(typeof J!="function"||!J(I[Te]));)Te++;return Te}}class Ne extends Se{constructor(){super(),he(this,"records",[]),he(this,"currentLine",0)}parse(I){const X=this.probeEOL(I);this.records=I.split(X).filter(Xu=>!!Hr(Xu).call(Xu)).map(this.parseLine),this.currentLine=0;const J=this.parseVersion(),Te=this.parseOrigin(),it=this.parseSessionName(),Ft=this.parseInformation(),ir=this.parseUri(),Di=this.parseEmail(),uc=this.parsePhone(),Yu=this.parseConnection(),cg=this.parseBandWidth(),pS=this.parseTimeFields(),mS=this.parseKey(),Da=this.parseSessionAttribute(),fl=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:J,origin:Te,sessionName:it,information:Ft,uri:ir,emails:Di,phones:uc,connection:Yu,bandwidths:cg,timeFields:pS,key:mS,attributes:Da,mediaDescriptions:fl}}getCurrentRecord(){const I=this.records[this.currentLine];if(!I)throw new Error("Record doesn't exit.");return I}probeEOL(I){for(let X=0;X<I.length;X++)if(I[X]===h)return I[X-1]==="\r"?f:h;throw new Error("Invalid newline character.")}parseLine(I,X){if(I.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const J=I[0];if(I[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:J,value:I.slice(2),line:X,cur:0}}parseSessionAttribute(){const I=new pt;for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==y.ATTRIBUTE)break;const J={attField:this.extractOneOrMore(X,Te=>O(Te)&&Te!==":"),_cur:0};X.value[X.cur]===":"&&(X.cur+=1,J.attValue=this.extractOneOrMore(X,H)),I.parse(J),this.currentLine++}return I.digest()}parseMediaAttributes(I){const X=new mt(I);for(;this.currentLine<this.records.length;){const J=this.getCurrentRecord();if(J.type!==y.ATTRIBUTE)break;const Te={attField:this.extractOneOrMore(J,it=>O(it)&&it!==":"),_cur:0};J.value[J.cur]===":"&&(J.cur+=1,Te.attValue=this.extractOneOrMore(J,H)),X.parse(Te),this.currentLine++}return X.digest()}parseKey(){const I=this.getCurrentRecord();if(I.type===y.KEY){if(I.value==="prompt"||I.value==="clear:"||I.value==="base64:"||I.value==="uri:")return I.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const I=this.getCurrentRecord();if(I.type===y.ZONE_ADJUSTMENTS){const X=[];for(;;)try{const J=this.extract(I,this.consumeTime);this.consumeSpaceForRecord(I);let Te=!1;I.value[I.cur]==="-"&&(Te=!0,I.cur+=1);const it=this.extract(I,this.consumeTypedTime);X.push({time:J,typedTime:it,back:Te})}catch{break}if(X.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,X}return[]}parseRepeat(){const I=[];for(;;){const X=this.getCurrentRecord();if(X.type!==y.REPEAT)break;{const J=this.extract(X,this.consumeRepeatInterval),Te=this.parseTypedTime(X);I.push({repeatInterval:J,typedTimes:Te}),this.currentLine++}}return I}parseTypedTime(I){const X=[];for(;;)try{this.consumeSpaceForRecord(I),X.push(this.extract(I,this.consumeTypedTime))}catch{break}if(X.length===0)throw new Error("Invalid typed time.");return X}parseTime(){const I=this.getCurrentRecord(),X=this.extract(I,this.consumeTime);this.consumeSpaceForRecord(I);const J=this.extract(I,this.consumeTime);return this.currentLine++,{startTime:X,stopTime:J}}parseBandWidth(){const I=[];for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==y.BANDWIDTH)break;{const J=this.extractOneOrMore(X,O);if(X.value[X.cur]!==":")throw new Error("Invalid bandwidth field.");X.cur++;const Te=this.extractOneOrMore(X,_);I.push({bwtype:J,bandwidth:Te}),this.currentLine++}}return I}parseVersion(){const I=this.getCurrentRecord();if(I.type!==y.VERSION)throw new Error("first sdp record must be version");const X=I.value.slice(0,this.consumeOneOrMore(I.value,0,_));if(X.length!==I.value.length)throw new Error('invalid proto version, "v='.concat(I.value,'"'));return this.currentLine++,X}parseOrigin(){const I=this.getCurrentRecord();if(I.type!==y.ORIGIN)throw new Error("second line of sdp must be origin");const X=this.extractOneOrMore(I,w);this.consumeSpaceForRecord(I);const J=this.extractOneOrMore(I,_);this.consumeSpaceForRecord(I);const Te=this.extractOneOrMore(I,_);this.consumeSpaceForRecord(I);const it=this.extractOneOrMore(I,O);this.consumeSpaceForRecord(I);const Ft=this.extractOneOrMore(I,O);this.consumeSpaceForRecord(I);const ir=this.extract(I,this.consumeUnicastAddress);return this.currentLine++,{username:X,sessId:J,sessVersion:Te,nettype:it,addrtype:Ft,unicastAddress:ir}}parseSessionName(){const I=this.getCurrentRecord();if(I.type===y.SESSION_NAME){const X=this.extract(I,this.consumeText);return this.currentLine++,X}}parseInformation(){const I=this.getCurrentRecord();if(I.type!==y.INFORMATION)return;const X=this.extract(I,this.consumeText);return this.currentLine++,X}parseUri(){const I=this.getCurrentRecord();if(I.type===y.URI)return this.currentLine++,I.value}parseEmail(){const I=[];for(;;){const X=this.getCurrentRecord();if(X.type!==y.EMAIL)break;I.push(X.value),this.currentLine++}return I}parsePhone(){const I=[];for(;;){const X=this.getCurrentRecord();if(X.type!==y.PHONE)break;I.push(X.value),this.currentLine++}return I}parseConnection(){const I=this.getCurrentRecord();if(I.type===y.CONNECTION){const X=this.extractOneOrMore(I,O);this.consumeSpaceForRecord(I);const J=this.extractOneOrMore(I,O);this.consumeSpaceForRecord(I);const Te=this.extract(I,this.consumeAddress);return this.currentLine++,{nettype:X,addrtype:J,address:Te}}}parseMedia(){const I=this.getCurrentRecord(),X=this.extract(I,this.consumeToken);this.consumeSpaceForRecord(I);let J=this.extract(I,this.consumePort);I.value[I.cur]==="/"&&(I.cur+=1,J+=this.extract(I,this.consumeInteger)),this.consumeSpaceForRecord(I);const Te=[];for(Te.push(this.extract(I,this.consumeToken));I.value[I.cur]==="/";)I.cur+=1,Te.push(this.extract(I,this.consumeToken));if(Te.length===0)throw new Error("Invalid proto");const it=this.parseFmt(I);return this.currentLine++,{mediaType:X,port:J,protos:Te,fmts:it}}parseTimeFields(){const I=[];for(;this.getCurrentRecord().type===y.TIME;){const X=this.parseTime(),J=this.parseRepeat(),Te=this.parseZone();I.push({time:X,repeats:J,zones:Te})}return I}parseMediaDescription(){const I=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.MEDIA;){const X=this.parseMedia(),J=this.parseInformation(),Te=this.parseConnections(),it=this.parseBandWidth(),Ft=this.parseKey(),ir=this.parseMediaAttributes(X);I.push({media:X,information:J,connections:Te,bandwidths:it,key:Ft,attributes:ir})}return I}parseConnections(){const I=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.CONNECTION;)I.push(this.parseConnection());return I}parseFmt(I){const X=[];for(;;)try{this.consumeSpaceForRecord(I),X.push(this.extract(I,this.consumeToken))}catch{break}if(X.length===0)throw new Error("Invalid fmts");return X}extract(I,X){for(var J=arguments.length,Te=new Array(J>2?J-2:0),it=2;it<J;it++)Te[it-2]=arguments[it];const Ft=X.call(this,I.value,I.cur,...Te),ir=I.value.slice(I.cur,Ft);return I.cur=Ft,ir}extractOneOrMore(I,X){const J=this.consumeOneOrMore(I.value,I.cur,X),Te=I.value.slice(I.cur,J);return I.cur=J,Te}consumeSpaceForRecord(I){if(I.value[I.cur]!==m)throw new Error("Invalid space at ".concat(I.cur,"."));I.cur+=1}}class ke extends Se{constructor(){super(...arguments),he(this,"attributes",void 0),he(this,"digested",!1)}extractOneOrMore(I,X,J){const Te=this.consumeOneOrMore(I.attValue,I._cur,X),it=I.attValue.slice(I._cur,Te),[Ft,ir]=J||[];if(typeof Ft=="number"&&it.length<Ft)throw new Error("error in length, should be more or equal than ".concat(Ft," characters."));if(typeof ir=="number"&&it.length>ir)throw new Error("error in length, should be less or equal than ".concat(ir," characters."));return I._cur=Te,it}consumeAttributeSpace(I){if(I.attValue[I._cur]!==m)throw new Error("Invalid space at ".concat(I._cur,"."));I._cur+=1}extract(I,X){if(!I.attValue)throw new Error("Nothing to extract from attValue.");for(var J=arguments.length,Te=new Array(J>2?J-2:0),it=2;it<J;it++)Te[it-2]=arguments[it];const Ft=X.call(this,I.attValue,I._cur,...Te),ir=I.attValue.slice(I._cur,Ft);return I._cur=Ft,ir}atEnd(I){if(!I.attValue)throw new Error;return I._cur>=I.attValue.length}peekChar(I){if(!I.attValue)throw new Error;return I.attValue[I._cur]}peek(I,X){if(!I.attValue)throw new Error;for(let J=0;J<X.length;J++)if(X[J]!==I.attValue[I._cur+J])return!1;return!0}parseIceUfrag(I){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(I,K,[4,256])}parseIcePwd(I){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(I,K,[22,256])}parseIceOptions(I){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const X=[];for(;!this.atEnd(I);){X.push(this.extractOneOrMore(I,K));try{this.consumeAttributeSpace(I)}catch(J){if(this.atEnd(I))break;throw J}}this.attributes.iceOptions=X}parseFingerprint(I){const X=this.extract(I,this.consumeToken);this.consumeAttributeSpace(I);const J=this.extract(I,this.consumeTill);this.attributes.fingerprints.push({hashFunction:X,fingerprint:J})}parseExtmap(I){const X=this.extractOneOrMore(I,_);let J;this.peekChar(I)==="/"&&(this.extract(I,this.consume,"/"),J=this.extract(I,this.consumeToken)),this.consumeAttributeSpace(I);const Te=this.extract(I,this.consumeTill,m),it=te(te({entry:parseInt(X,10)},J&&{direction:J}),{},{extensionName:Te});this.peekChar(I)===m&&(this.consumeAttributeSpace(I),it.extensionAttributes=this.extract(I,this.consumeTill)),this.attributes.extmaps.push(it)}parseSetup(I){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const X=this.extract(I,this.consumeTill);if(X!=="active"&&X!=="passive"&&X!=="actpass"&&X!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=X}}class pt extends ke{constructor(){super(...arguments),he(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(I){if(this.digested)throw new Error("already digested");try{switch(I.attField){case"group":this.parseGroup(I);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(I);break;case"ice-pwd":this.parseIcePwd(I);break;case"ice-options":this.parseIceOptions(I);break;case"fingerprint":this.parseFingerprint(I);break;case"setup":this.parseSetup(I);break;case"tls-id":this.parseTlsId(I);break;case"identity":this.parseIdentity(I);break;case"extmap":this.parseExtmap(I);break;case"msid-semantic":this.parseMsidSemantic(I);break;default:I.ignored=!0,this.attributes.unrecognized.push(I)}}catch(X){throw console.error("parsing session attribute ".concat(I.attField,' error, "a=').concat(I.attField,":").concat(I.attValue,'"')),X}if(!I.ignored&&I.attValue&&!this.atEnd(I))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(I){const X=this.extract(I,this.consumeToken),J=[];for(;!this.atEnd(I)&&this.peekChar(I)===m;)this.consumeAttributeSpace(I),J.push(this.extract(I,this.consumeToken));this.attributes.groups.push({semantic:X,identificationTag:J})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(I){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(I,Q)}parseIdentity(I){const X=this.extractOneOrMore(I,ie),J=[];for(;!this.atEnd(I)&&this.peekChar(I)===m;){this.consumeAttributeSpace(I);const Te=this.extract(I,this.consumeToken);this.extract(I,this.consume,"=");const it=this.extractOneOrMore(I,Ft=>Ft!==m&&H(Ft));J.push({name:Te,value:it})}this.attributes.identities.push({assertionValue:X,extensions:J})}parseMsidSemantic(I){this.peekChar(I)===m&&this.consumeAttributeSpace(I);const X={semantic:this.extract(I,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(I)}catch{break}if(this.peekChar(I)==="*"){this.extract(I,this.consume,"*"),X.applyForAll=!0;break}{const J=this.extract(I,this.consumeTill,m);X.identifierList.push(J)}}this.attributes.msidSemantic=X}}class mt extends ke{constructor(I){super(),he(this,"attributes",void 0),I.protos.indexOf("RTP")!==-1||I.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(I){if(this.digested)throw new Error("already digested");try{switch(I.attField){case"extmap":this.parseExtmap(I);break;case"setup":this.parseSetup(I);break;case"ice-ufrag":this.parseIceUfrag(I);break;case"ice-pwd":this.parseIcePwd(I);break;case"ice-options":this.parseIceOptions(I);break;case"candidate":this.parseCandidate(I);break;case"remote-candidate":this.parseRemoteCandidate(I);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(I);break;case"rtpmap":this.parseRtpmap(I);break;case"ptime":this.parsePtime(I);break;case"maxptime":this.parseMaxPtime(I);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(I);break;case"ssrc":this.parseSSRC(I);break;case"fmtp":this.parseFmtp(I);break;case"rtcp-fb":this.parseRtcpFb(I);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(I);break;case"mid":this.parseMid(I);break;case"msid":this.parseMsid(I);break;case"imageattr":this.parseImageAttr(I);break;case"rid":this.parseRid(I);break;case"simulcast":this.parseSimulcast(I);break;case"sctp-port":this.parseSctpPort(I);break;case"max-message-size":this.parseMaxMessageSize(I);break;case"ssrc-group":this.parseSSRCGroup(I);break;default:I.ignored=!0,this.attributes.unrecognized.push(I)}}catch(X){throw console.error("parsing media attribute ".concat(I.attField,' error, "a=').concat(I.attField,":").concat(I.attValue,'"')),X}if(!I.ignored&&I.attValue&&!this.atEnd(I))throw new Error("attribute parsing error")}parseCandidate(I){const X=this.extractOneOrMore(I,K,[1,32]);this.consumeAttributeSpace(I);const J=this.extractOneOrMore(I,_,[1,5]);this.consumeAttributeSpace(I);const Te=this.extract(I,this.consumeToken);this.consumeAttributeSpace(I);const it=this.extractOneOrMore(I,_,[1,10]);this.consumeAttributeSpace(I);const Ft=this.extract(I,this.consumeAddress);this.consumeAttributeSpace(I);const ir=this.extract(I,this.consumePort);this.consumeAttributeSpace(I),this.extract(I,this.consume,"typ"),this.consumeAttributeSpace(I);const Di={foundation:X,componentId:J,transport:Te,priority:it,connectionAddress:Ft,port:ir,type:this.extract(I,this.consumeToken),extension:{}};for(this.peek(I," raddr")&&(this.extract(I,this.consume," raddr"),this.consumeAttributeSpace(I),Di.relAddr=this.extract(I,this.consumeAddress)),this.peek(I," rport")&&(this.extract(I,this.consume," rport"),this.consumeAttributeSpace(I),Di.relPort=this.extract(I,this.consumePort));this.peekChar(I)===m;){this.consumeAttributeSpace(I);const uc=this.extract(I,this.consumeToken);this.consumeAttributeSpace(I),Di.extension[uc]=this.extractOneOrMore(I,S)}this.attributes.candidates.push(Di)}parseRemoteCandidate(I){const X=[];for(;;){const J=this.extractOneOrMore(I,_,[1,5]);this.consumeAttributeSpace(I);const Te=this.extract(I,this.consumeAddress);this.consumeAttributeSpace(I);const it=this.extract(I,this.consumePort);X.push({componentId:J,connectionAddress:Te,port:it});try{this.consumeAttributeSpace(I)}catch{break}}this.attributes.remoteCandidatesList.push(X)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(I){const X=this.extract(I,this.consumeToken);this.consumeAttributeSpace(I);const J=this.extract(I,this.consumeTill,"/");this.extract(I,this.consume,"/");const Te={encodingName:J,clockRate:this.extractOneOrMore(I,_)};this.atEnd(I)||this.peekChar(I)!=="/"||(this.extract(I,this.consume,"/"),Te.encodingParameters=parseInt(this.extract(I,this.consumeTill),10));const it=this.attributes.payloads.find(Ft=>Ft.payloadType===parseInt(X,10));it?it.rtpMap=Te:this.attributes.payloads.push({payloadType:parseInt(X,10),rtpMap:Te,rtcpFeedbacks:[]})}parsePtime(I){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(I,this.consumeTill)}parseMaxPtime(I){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(I,this.consumeTill)}parseDirection(I){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=I.attField}parseSSRC(I){const X=this.extractOneOrMore(I,_);this.consumeAttributeSpace(I);const J=this.extract(I,this.consumeTill,":");let Te;this.peekChar(I)===":"&&(this.extract(I,this.consume,":"),Te=this.extract(I,this.consumeTill));const it=this.attributes.ssrcs.find(Ft=>Ft.ssrcId===parseInt(X,10));it?it.attributes[J]=Te:this.attributes.ssrcs.push({ssrcId:parseInt(X,10),attributes:{[J]:Te}})}parseFmtp(I){const X=this.extract(I,this.consumeTill,m);this.consumeAttributeSpace(I);const J=this.extract(I,this.consumeTill),Te={};J.split(";").forEach(Ft=>{let[ir,Di]=Ft.split("=");ir=Hr(ir).call(ir);const uc=typeof Di=="string"?Hr(Di).call(Di):null;typeof ir=="string"&&ir.length>0&&(Te[ir]=uc)});const it=this.attributes.payloads.find(Ft=>Ft.payloadType===parseInt(X,10));it?it.fmtp={parameters:Te}:this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[],fmtp:{parameters:Te}})}parseFmtParameters(I){const X={},J=this.extract(I,this.consumeTill,"=");I._cur++;const Te=this.extract(I,this.consumeTill,";");for(X[J]=Te;I.attValue[I._cur]===";";){const it=this.extract(I,this.consumeTill,"=");I._cur++;const Ft=this.extract(I,this.consumeTill,";");X[it]=Ft}return X}parseRtcpFb(I){let X="";X=this.peekChar(I)==="*"?this.extract(I,this.consume,"*"):this.extract(I,this.consumeTill,m),this.consumeAttributeSpace(I);const J=this.extract(I,this.consumeTill,m);let Te;if(J==="trr-int")Te={type:J,interval:this.extract(I,this.consumeTill)};else{const it={type:J};this.peekChar(I)===m&&(this.consumeAttributeSpace(I),it.parameter=this.extract(I,this.consumeToken),this.peekChar(I)===m&&(it.additional=this.extract(I,this.consumeTill))),Te=it}if(X==="*")this.attributes.rtcpFeedbackWildcards.push(Te);else{const it=this.attributes.payloads.find(Ft=>Ft.payloadType===parseInt(X,10));it?it.rtcpFeedbacks.push(Te):this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[Te]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(I){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const X={port:this.extract(I,this.consumePort)};this.peekChar(I)===m&&(this.consumeAttributeSpace(I),X.netType=this.extractOneOrMore(I,O),this.consumeAttributeSpace(I),X.addressType=this.extractOneOrMore(I,O),this.consumeAttributeSpace(I),X.address=this.extract(I,this.consumeAddress)),this.attributes.rtcp=X}parseMsid(I){const X={id:this.extractOneOrMore(I,O,[1,64])};this.peekChar(I)===m&&(this.consumeAttributeSpace(I),X.appdata=this.extractOneOrMore(I,O,[1,64])),this.attributes.msids.push(X)}parseImageAttr(I){this.attributes.imageattr.push(I.attValue)}parseRid(I){const X=this.extractOneOrMore(I,Te=>k(Te)||_(Te)||Te==="_"||Te==="-");this.consumeAttributeSpace(I);const J={id:X,direction:this.extract(I,this.consumeToken),params:[]};if(this.peekChar(I)===m){if(this.consumeAttributeSpace(I),this.peek(I,"pt=")){this.extract(I,this.consume,"pt=");const Te=[];for(;;){const it=this.extract(I,this.consumeToken);Te.push(it);try{this.extract(I,this.consume,",")}catch{break}}J.payloads=Te,this.peekChar(I)===m&&this.extract(I,this.consume,m)}for(;;){const Te=this.extract(I,this.consumeToken);switch(Te){case"depend":{const it={type:Te,rids:this.extract(I,this.consume,"=").split(",")};J.params.push(it);break}default:{const it={type:Te};this.peekChar(I)==="="&&(this.extract(I,this.consume,"="),it.val=this.extract(I,this.consumeTill,";")),J.params.push(it)}}try{this.extract(I,this.consume,";")}catch{break}}}this.attributes.rids.push(J)}parseSimulcast(I){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=I.attValue,this.extract(I,this.consumeTill)}parseSctpPort(I){this.attributes.sctpPort=this.extractOneOrMore(I,_,[1,5])}parseMaxMessageSize(I){this.attributes.maxMessageSize=this.extractOneOrMore(I,_,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(I){this.attributes.mid=this.extract(I,this.consumeToken)}parseSSRCGroup(I){const X=this.extract(I,this.consumeToken),J=[];for(;;)try{this.consumeAttributeSpace(I);const Te=this.extract(I,this.consumeInteger);J.push(parseInt(Te,10))}catch{break}this.attributes.ssrcGroups.push({semantic:X,ssrcIds:J})}}function Xt(ge,I,X){return I in ge?Object.defineProperty(ge,I,{value:X,enumerable:!0,configurable:!0,writable:!0}):ge[I]=X,ge}class An{constructor(){Xt(this,"eol",f)}print(I,X){let J="";return X&&(this.eol=X),J+=this.printVersion(I.version),J+=this.printOrigin(I.origin),J+=this.printSessionName(I.sessionName),J+=this.printInformation(I.information),J+=this.printUri(I.uri),J+=this.printEmail(I.emails),J+=this.printPhone(I.phones),J+=this.printConnection(I.connection),J+=this.printBandwidth(I.bandwidths),J+=this.printTimeFields(I.timeFields),J+=this.printKey(I.key),J+=this.printSessionAttributes(I.attributes),J+=this.printMediaDescription(I.mediaDescriptions),J}printVersion(I){return"v=".concat(I).concat(this.eol)}printOrigin(I){return"o=".concat(I.username," ").concat(I.sessId," ").concat(I.sessVersion," ").concat(I.nettype," ").concat(I.addrtype," ").concat(I.unicastAddress).concat(this.eol)}printSessionName(I){return I?"s=".concat(I).concat(this.eol):""}printInformation(I){return I?"i=".concat(I).concat(this.eol):""}printUri(I){return I?"u=".concat(I).concat(this.eol):""}printEmail(I){let X="";for(const J of I)X+="e=".concat(J).concat(this.eol);return X}printPhone(I){let X="";for(const J of I)X+="e=".concat(J).concat(this.eol);return X}printConnection(I){return I?"c=".concat(I.nettype," ").concat(I.addrtype," ").concat(I.address).concat(this.eol):""}printBandwidth(I){let X="";for(const J of I)X+="b=".concat(J.bwtype,":").concat(J.bandwidth).concat(this.eol);return X}printTimeFields(I){let X="";for(const J of I){X+="t=".concat(J.time.startTime," ").concat(J.time.startTime).concat(this.eol);for(const Te of J.repeats)X+="r=".concat(Te.repeatInterval," ").concat(Te.typedTimes.join(" ")).concat(this.eol);J.zoneAdjustments&&(X+="z=",X+="z=".concat(J.zoneAdjustments.map(Te=>"".concat(Te.time," ").concat(Te.back?"-":""," ").concat(Te.typedTime)).join(" ")).concat(this.eol),X+=this.eol)}return X}printKey(I){return I?"k=".concat(I).concat(this.eol):""}printAttributes(I){let X="";for(const J of I)X+="a=".concat(J.attField).concat(J.attValue?":".concat(J.attValue):"").concat(this.eol);return X}printMediaDescription(I){let X="";for(const J of I)X+=this.printMedia(J.media),X+=this.printInformation(J.information),X+=this.printConnections(J.connections),X+=this.printBandwidth(J.bandwidths),X+=this.printKey(J.key),X+=this.printMediaAttributes(J);return X}printConnections(I){let X="";for(const J of I)X+=this.printConnection(J);return X}printMedia(I){return"m=".concat(I.mediaType," ").concat(I.port," ").concat(I.protos.join("/")," ").concat(I.fmts.join(" ")).concat(this.eol)}printSessionAttributes(I){return new Ei(this.eol).print(I)}printMediaAttributes(I){return new pe(this.eol).print(I)}}class _n{constructor(I){Xt(this,"eol",void 0),this.eol=I}printIceUfrag(I){return I===void 0?"":"a=ice-ufrag:".concat(I).concat(this.eol)}printIcePwd(I){return I===void 0?"":"a=ice-pwd:".concat(I).concat(this.eol)}printIceOptions(I){return I===void 0?"":"a=ice-options:".concat(I.join(m)).concat(this.eol)}printFingerprints(I){return I.length>0?I.map(X=>"a=fingerprint:".concat(X.hashFunction).concat(m).concat(X.fingerprint)).join(this.eol)+this.eol:""}printExtmap(I){return I.map(X=>"a=extmap:".concat(X.entry).concat(X.direction?"/".concat(X.direction):"").concat(m).concat(X.extensionName).concat(X.extensionAttributes?"".concat(m).concat(X.extensionAttributes):"").concat(this.eol)).join("")}printSetup(I){return I===void 0?"":"a=setup:".concat(I).concat(this.eol)}printUnrecognized(I){return I.map(X=>"a=".concat(X.attField).concat(X.attValue?":".concat(X.attValue):"").concat(this.eol)).join("")}}class Ei extends _n{print(I){let X="";return X+=this.printGroups(I.groups),X+=this.printMsidSemantic(I.msidSemantic),X+=this.printIceLite(I.iceLite),X+=this.printIceUfrag(I.iceUfrag),X+=this.printIcePwd(I.icePwd),X+=this.printIceOptions(I.iceOptions),X+=this.printFingerprints(I.fingerprints),X+=this.printSetup(I.setup),X+=this.printTlsId(I.tlsId),X+=this.printIdentity(I.identities),X+=this.printExtmap(I.extmaps),X+=this.printUnrecognized(I.unrecognized),X}printGroups(I){let X="";return I.length>0&&(X+=I.map(J=>"a=group:".concat(J.semantic).concat(J.identificationTag.map(Te=>"".concat(m).concat(Te)).join("")).concat(this.eol)).join("")),X}printIceLite(I){return I===void 0?"":"a=ice-lite"+this.eol}printTlsId(I){return I?"a=tls-id:".concat(I).concat(this.eol):""}printIdentity(I){return I.length===0?"":I.map(X=>"a=identity:".concat(X.assertionValue).concat(X.extensions.map(J=>"".concat(m).concat(J.name).concat(J.value?"=".concat(J.value):"")))).join(this.eol)+this.eol}printMsidSemantic(I){if(!I)return"";let X="a=msid-semantic:".concat(I.semantic);return I.applyForAll?X+="".concat(m,"*"):I.identifierList.length>0&&(X+=I.identifierList.map(J=>"".concat(m).concat(J))),X+this.eol}}class pe extends _n{print(I){const X=I.attributes;let J="";return J+=this.printRTCP(X.rtcp),J+=this.printIceUfrag(X.iceUfrag),J+=this.printIcePwd(X.icePwd),J+=this.printIceOptions(X.iceOptions),J+=this.printCandidates(X.candidates),J+=this.printRemoteCandidatesList(X.remoteCandidatesList),J+=this.printEndOfCandidates(X.endOfCandidates),J+=this.printFingerprints(X.fingerprints),J+=this.printSetup(X.setup),J+=this.printMid(X.mid),J+=this.printExtmap(X.extmaps),J+=this.printRTPRelated(X),J+=this.printPtime(X.ptime),J+=this.printMaxPtime(X.maxPtime),J+=this.printDirection(X.direction),J+=this.printSSRCGroups(X.ssrcGroups),J+=this.printSSRC(X.ssrcs),J+=this.printRTCPMux(X.rtcpMux),J+=this.printRTCPMuxOnly(X.rtcpMuxOnly),J+=this.printRTCPRsize(X.rtcpRsize),J+=this.printMSId(X.msids),J+=this.printImageattr(X.imageattr),J+=this.printRid(X.rids),J+=this.printSimulcast(X.simulcast),J+=this.printSCTPPort(X.sctpPort),J+=this.printMaxMessageSize(X.maxMessageSize),J+=this.printUnrecognized(X.unrecognized),J}printCandidates(I){return I.map(X=>"a=candidate:".concat(X.foundation).concat(m).concat(X.componentId).concat(m).concat(X.transport).concat(m).concat(X.priority).concat(m).concat(X.connectionAddress).concat(m).concat(X.port).concat(m,"typ").concat(m).concat(X.type).concat(X.relAddr?"".concat(m,"raddr").concat(m).concat(X.relAddr):"").concat(X.relPort?"".concat(m,"rport").concat(m).concat(X.relPort):"").concat(Object.keys(X.extension).map(J=>"".concat(m).concat(J).concat(m).concat(X.extension[J])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(I){return I.map(X=>"a=remote-candidates:".concat(X.join(m)).concat(this.eol)).join("")}printEndOfCandidates(I){return I===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(I){if(!I.payloads)return"";const X=I.payloads;let J="";J+=I.rtcpFeedbackWildcards.map(Te=>this.printRTCPFeedback("*",Te)).join("");for(const Te of X)J+=this.printRtpMap(Te.payloadType,Te.rtpMap),J+=this.printFmtp(Te.payloadType,Te.fmtp),J+=Te.rtcpFeedbacks.map(it=>this.printRTCPFeedback(Te.payloadType,it)).join("");return J}printFmtp(I,X){if(!X)return"";const J=Object.keys(X.parameters);return J.length===1&&X.parameters[J[0]]===null?"a=fmtp:".concat(I).concat(m).concat(J[0]).concat(this.eol):"a=fmtp:".concat(I).concat(m).concat(Object.keys(X.parameters).map(Te=>"".concat(Te,"=").concat(X.parameters[Te])).join(";")).concat(this.eol)}printRtpMap(I,X){return X?"a=rtpmap:".concat(I).concat(m).concat(X.encodingName,"/").concat(X.clockRate).concat(X.encodingParameters?"/".concat(X.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(I,X){let J="a=rtcp-fb:".concat(I).concat(m),Te=X;return Te.type==="trr-int"?J+="ttr-int".concat(m).concat(Te.interval):(J+="".concat(Te.type),Te.parameter&&(J+="".concat(m).concat(Te.parameter),Te.additional&&(J+="".concat(m).concat(Te.additional)))),J+this.eol}printPtime(I){return I===void 0?"":"a=ptime:".concat(I).concat(this.eol)}printMaxPtime(I){return I===void 0?"":"a=maxptime:".concat(I).concat(this.eol)}printDirection(I){return I===void 0?"":"a=".concat(I).concat(this.eol)}printSSRC(I){return I.map(X=>Object.keys(X.attributes).map(J=>"a=ssrc:".concat(X.ssrcId.toString(10)).concat(m).concat(J).concat(X.attributes[J]?":".concat(X.attributes[J]):"").concat(this.eol)).join("")).join("")}printRTCPMux(I){return I===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(I){return I===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(I){return I===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(I){if(I===void 0)return"";let X="a=rtcp:".concat(I.port);return I.netType&&(X+="".concat(m).concat(I.netType)),I.addressType&&(X+="".concat(m).concat(I.addressType)),I.address&&(X+="".concat(m).concat(I.address)),X+this.eol}printMSId(I){return I.map(X=>"a=msid:".concat(X.id).concat(X.appdata?"".concat(m).concat(X.appdata):"").concat(this.eol)).join("")}printImageattr(I){return I.map(X=>"a=imageattr:".concat(X).concat(this.eol)).join("")}printRid(I){return I.map(X=>{let J="a=rid:".concat(X.id).concat(m).concat(X.direction);return X.payloads&&(J+="".concat(m,"pt=").concat(X.payloads.join(","))),X.params.length>0&&(J+="".concat(m).concat(X.params.map(Te=>Te.type==="depend"?"depend=".concat(Te.rids.join(",")):"".concat(Te.type,"=").concat(Te.val)).join(";"))),J+this.eol}).join("")}printSimulcast(I){return I===void 0?"":"a=simulcast:".concat(I).concat(this.eol)}printSCTPPort(I){return I===void 0?"":"a=sctp-port:".concat(I).concat(this.eol)}printMaxMessageSize(I){return I===void 0?"":"a=max-message-size:".concat(I).concat(this.eol)}printMid(I){return I===void 0?"":"a=mid:".concat(I).concat(this.eol)}printSSRCGroups(I){return I.map(X=>"a=ssrc-group:".concat(X.semantic).concat(X.ssrcIds.map(J=>"".concat(m).concat(J.toString(10))).join("")).concat(this.eol)).join("")}}function we(ge){return new Ne().parse(ge)}function We(ge,I){return new An().print(ge,I)}}},r={};function i(s){if(r[s])return r[s].exports;var c=r[s]={exports:{}};return n[s](c,c.exports,i),c.exports}return i.d=(s,c)=>{for(var u in c)i.o(c,u)&&!i.o(s,u)&&Object.defineProperty(s,u,{enumerable:!0,get:c[u]})},i.o=(s,c)=>Object.prototype.hasOwnProperty.call(s,c),i.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i(8)})();function Ai(n){return NB.parse(n)}function Jc(n,r){return NB.print(n,r)}var efe=za("Array","keys"),tfe=Hs,nfe=Dr,rfe=R,ife=efe,mO=Array.prototype,afe={DOMTokenList:!0,NodeList:!0},ofe=function(n){var r=n.keys;return n===mO||rfe(mO,n)&&r===mO.keys||nfe(afe,tfe(n))?ife:r},oa=l(ofe);function pn(n,r,i){return(r=function(s){var c=function(u){if(typeof u!="object"||!u)return u;var h=u[Symbol.toPrimitive];if(h!==void 0){var f=h.call(u,"string");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(s);return typeof c=="symbol"?c:c+""}(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}function PB(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function ot(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?PB(Object(i),!0).forEach(function(s){pn(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):PB(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const xB=new class extends ln{constructor(){super(...arguments),pn(this,"currentUploadLogID",0)}reportLogUploadError(n){const{errorRange:r}=n;r[r.length-1]&&r[r.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=r[r.length-1],this.emit("REPORT_LOG_UPLOAD",n))}};class sfe{constructor(r){pn(this,"logger",void 0),pn(this,"prefixLists",[]),this.logger=r}debug(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];this.logger.debug(...this.prefixLists,...i)}info(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];this.logger.info(...this.prefixLists,...i)}warning(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];this.logger.warning(...this.prefixLists,...i)}error(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];this.logger.error(...this.prefixLists,...i)}prefix(r){return this.prefixLists.push(r),this}popPrefix(){return this.prefixLists.pop(),this}}function gO(){const n=new Date;return n.toTimeString().split(" ")[0]+":"+n.getMilliseconds()}function DB(){const n=new Date,r=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return r?(r==null?void 0:r[0])+":"+n.getUTCMilliseconds():n.toTimeString().split(" ")[0]+":"+n.getMilliseconds()}const Ra={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},lE=Date.now(),Rm=n=>{for(const r in Ra)if(Object.prototype.hasOwnProperty.call(Ra,r)&&Ra[r]===n)return r;return"DEFAULT"},A=new class{constructor(){pn(this,"proxyServerURL",void 0),pn(this,"logLevel",Ra.DEBUG),pn(this,"uploadState","collecting"),pn(this,"uploadLogWaitingList",[]),pn(this,"uploadLogUploadingList",[]),pn(this,"uploadErrorCount",0),pn(this,"currentLogID",0),pn(this,"url",void 0),pn(this,"extLog",(n,r)=>{this.appendLogToWaitingList(n,...r)})}debug(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=[Ra.DEBUG].concat(r);this.log.apply(this,s)}info(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=[Ra.INFO].concat(r);this.log.apply(this,s)}warning(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=[Ra.WARNING].concat(r);this.log.apply(this,s)}warn(){this.warning(...arguments)}error(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=[Ra.ERROR].concat(r);this.log.apply(this,s)}upload(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=[Ra.DEBUG].concat(r);this.uploadLog.apply(this,s)}setLogLevel(n){n=Math.min(Math.max(0,n),4),this.logLevel=n}enableLogUpload(){Ut("UPLOAD_LOG",!0)}disableLogUpload(){Ut("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(n){this.proxyServerURL=n}prefix(n){return new sfe(this).prefix(n)}log(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(Date.now()-lE<100)return void setTimeout(()=>{this.log(...r)},Date.now()-lE);const s=Math.max(0,Math.min(4,r[0]));if(r[0]=gO()+" Agora-SDK [".concat(Rm(s),"]:"),this.appendLogToWaitingList(s,...r),s<this.logLevel)return;const c=gO()+" %cAgora-SDK [".concat(Rm(s),"]:");let u=[];if(!Y("USE_NEW_LOG"))switch(s){case Ra.DEBUG:u=[c,"color: #64B5F6;"].concat(r.slice(1)),console.log.apply(console,u);break;case Ra.INFO:u=[c,"color: #1E88E5; font-weight: bold;"].concat(r.slice(1)),console.log.apply(console,u);break;case Ra.WARNING:u=[c,"color: #FB8C00; font-weight: bold;"].concat(r.slice(1)),console.warn.apply(console,u);break;case Ra.ERROR:u=[c,"color: #B00020; font-weight: bold;"].concat(r.slice(1)),console.error.apply(console,u)}}uploadLog(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(Date.now()-lE<100)return void setTimeout(()=>{this.uploadLog(...r)},Date.now()-lE);const s=Math.max(0,Math.min(4,r[0]));r[0]=gO()+" Agora-SDK [".concat(Rm(s),"]:"),this.appendLogToWaitingList(s,...r)}appendLogToWaitingList(n){if(!Y("UPLOAD_LOG"))return;for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];Array.isArray(i[0])?i[0][0]=DB()+" Agora-SDK [".concat(Rm(n),"]:"):i[0]=DB()+" Agora-SDK [".concat(Rm(n),"]:");let c="";i.forEach(u=>{typeof u=="object"&&(u=JSON.stringify(u)),c+="".concat(u," ")}),this.uploadLogWaitingList.push({payload_str:c,log_level:n,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const n=this.uploadLogUploadingList,r={sdk_version:Ca,process_id:Y("PROCESS_ID"),payload:JSON.stringify(n)};return Mo(async()=>{const i=await mi.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Y("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Y("LOG_UPLOAD_SERVER"),"/upload/v1")),r,{responseType:"text"});if(i.data!=="OK"){const s=new Error("unexpected upload log response");throw s.response=i,s}},()=>(this.uploadLogUploadingList=[],!1),i=>{const s={status:-1,message:i.message,errorRange:n.map(c=>c.log_item_id)};return i.response?(s.status=i.response.status,s.data=i.response.data,s.headers=i.response.headers):i.request&&(s.status=i.request.status),xB.reportLogUploadError(s),!0},{timeout:Y("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Y("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Y("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_INTERVAL"))}).catch(n=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var LB;function cfe(n){return vr(n.reportId,"params.reportId",0,100,!1),vr(n.category,"params.category",0,100,!1),vr(n.event,"params.event",0,100,!1),vr(n.label,"params.label",0,100,!1),Bt(n.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(LB={}).FREE="free",LB.UPLOADING="uploading",function(n){n[n.MISC=0]="MISC",n[n.INTERNAL_EVENT=1]="INTERNAL_EVENT",n[n.PUBLIC_EVENT=2]="PUBLIC_EVENT",n[n.WEB_EVENT=3]="WEB_EVENT",n[n.INTERNAL_API=4]="INTERNAL_API",n[n.WEB_API=5]="WEB_API",n[n.PUBLIC_API=6]="PUBLIC_API"}({});const lfe={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let nr=function(n){return n.PUBLISH="publish",n.SUBSCRIBE="subscribe",n.WS_COMPRESSOR_INIT="ws_compressor_init",n.SESSION_INIT="session_init",n.JOIN_CHOOSE_SERVER="join_choose_server",n.REQ_USER_ACCOUNT="req_user_account",n.JOIN_GATEWAY="join_gateway",n.REJOIN_GATEWAY="rejoin_gateway",n.STREAM_SWITCH="stream_switch",n.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",n.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",n.FIRST_VIDEO_RECEIVED="first_video_received",n.FIRST_AUDIO_RECEIVED="first_audio_received",n.FIRST_VIDEO_DECODE="first_video_decode",n.FIRST_AUDIO_DECODE="first_audio_decode",n.ON_ADD_AUDIO_STREAM="on_add_audio_stream",n.ON_ADD_VIDEO_STREAM="on_add_video_stream",n.ON_UPDATE_STREAM="on_update_stream",n.ON_REMOVE_STREAM="on_remove_stream",n.USER_ANALYTICS="req_user_analytics",n.PC_STATS="pc_stats",n.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",n.AB_TEST="ab_test",n}({}),on=function(n){return n.SESSION="io.agora.pb.Wrtc.Session",n.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",n.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",n.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",n.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",n.PUBLISH="io.agora.pb.Wrtc.Publish",n.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",n.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",n.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",n.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",n.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",n.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",n.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",n.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",n.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",n.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",n.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",n.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",n.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",n.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",n.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",n.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",n.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",n.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",n.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",n.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",n.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",n.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",n.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",n.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",n.PC_STATS="io.agora.pb.Wrtc.PCStats",n.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",n.AB_TEST="io.agora.pb.Wrtc.ABTest",n}({});(function(n){n[n.WORKER_EVENT=156]="WORKER_EVENT",n[n.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let ufe=function(n){return n[n.SESSION=26]="SESSION",n[n.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",n[n.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",n[n.JOIN_GATEWAY=28]="JOIN_GATEWAY",n[n.PUBLISH=30]="PUBLISH",n[n.SUBSCRIBE=29]="SUBSCRIBE",n[n.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",n[n.STREAM_SWITCH=32]="STREAM_SWITCH",n[n.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",n[n.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",n[n.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",n[n.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",n[n.API_INVOKE=41]="API_INVOKE",n[n.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",n[n.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",n[n.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",n[n.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",n[n.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",n[n.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",n[n.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",n[n.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",n[n.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",n[n.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",n[n.WORKER_EVENT=156]="WORKER_EVENT",n[n.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",n[n.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",n[n.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",n[n.USER_ANALYTICS=1e4]="USER_ANALYTICS",n[n.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",n}({});function Xe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(r,i,s){const c=s.value;if(typeof c=="function"){const u=n.className||r.__className__||(r.constructor.name==="AgoraRTCClient"?"Client":r.constructor.name);s.value=function(){for(var h,f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];let _=m;if(n.argsMap)try{_=n.argsMap(this,...m)}catch(w){A.warning(w),_=[]}try{JSON.stringify(_)}catch{A.warning("arguments for method ".concat(u,".").concat(String(i)," not serializable for apiInvoke.")),_=[]}const S=(n.report||$e).reportApiInvoke(this._sessionId||null,{id:this._clientId||((h=this.store)===null||h===void 0?void 0:h.clientId)||this._ID,name:"".concat(u,".").concat(String(i)),options:_,tag:fn.TRACER,reportResult:n.reportResult},n.throttleTime);try{const w=c.apply(this,m);return w instanceof Ie?w.then(O=>(S.onSuccess(n.reportResult&&O),O)).catch(O=>{throw S.onError(O),O}):(S.onSuccess(n.reportResult&&w),w)}catch(w){throw S.onError(w),w}}}return s}}const $e=new class{constructor(){pn(this,"baseInfoMap",new Map),pn(this,"proxyServer",void 0),pn(this,"eventUploadTimer",void 0),pn(this,"setSessionIdTimer",void 0),pn(this,"url",void 0),pn(this,"sids",new Set),pn(this,"backupUrl",void 0),pn(this,"_appId",void 0),pn(this,"_aid",0),pn(this,"keyEventUploadPendingItems",[]),pn(this,"normalEventUploadPendingItems",[]),pn(this,"apiInvokeUploadPendingItems",[]),pn(this,"apiInvokeCount",0),pn(this,"apiInvokeLoggedCount",0),pn(this,"ltsList",[]),pn(this,"lastSendNormalEventTime",Date.now()),pn(this,"customReportCounterTimer",void 0),pn(this,"customReportCount",0),pn(this,"extApiInvoke",async n=>{for(const r of n){const i=ot(ot({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:fn.TRACER});this.sendApiInvoke(i)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Y("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Y("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(n){return this.baseInfoMap.get(n)}setAppId(n){this._appId=n,this._aid=parseInt(n.replace(/[a-fA-F0-9]{8}/g,r=>{let[i,s]=r;return i+s}),16)||0}reportApiInvoke(n,r,i){r.timeout=r.timeout||6e4,r.reportResult=r.reportResult===void 0||r.reportResult;const s=Date.now();this.apiInvokeCount+=1;const c=this.apiInvokeCount,u=!!Y("SHOW_REPORT_INVOKER_LOG"),h=!!Y("SHOW_REPORT_USER_INVOKER_LOG"),f=u||h&&r.id;f&&(this.apiInvokeLoggedCount+=1);const m=this.apiInvokeLoggedCount;function y(O,W){if(f){let k="[apiInvoke-".concat(m,"]");r.id&&(k+="[".concat(r.id,"]")),r.name&&(k+="[".concat(r.name,"]")),A.info("".concat(k," ").concat(O),O==="start"?r.options:W||"")}}const _=()=>({tag:r.tag,invokeId:c,sid:n,name:r.name,apiInvokeTime:s,options:r.options,states:r.states||null});y("start");let S=!1;_r(r.timeout).then(()=>{S||(this.sendApiInvoke(ot(ot({},_()),{},{error:$.API_INVOKE_TIMEOUT,success:!1})),y("timeout"))});const w=new de($.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:O=>{const W=()=>{if(S)throw w;return S=!0,this.sendApiInvoke(ot(ot({},_()),{},{success:!0},r.reportResult&&{result:O})),y("onSuccess"),O};return i?mB(W,r.name+"Success",i,()=>S=!0):W()},onError:O=>{const W=()=>{if(S)throw O;S=!0,this.sendApiInvoke(ot(ot({},_()),{},{success:!1,error:O})),y("onFailure",O.toString())};return i?mB(W,r.name+"Error",i,()=>S=!0):W()}}}sessionInit(n,r){if(this.baseInfoMap.has(n))return;const i=Date.now(),s=this.createBaseInfo(n,i);s.cname=r.cname;const c=Object.assign({},{willUploadConsoleLog:Y("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:dO?"global":"oversea",areas:Y("AREAS")&&Y("AREAS").join(",")},r.extend),{stringUid:u,channelProfile:h,channelMode:f,isABTestSuccess:m,lsid:y,clientRole:_}=r,S=Date.now(),w=ot(ot({},s),{},{eventType:nr.SESSION_INIT,appid:r.appid,browser:navigator.userAgent,buildFormat:r.buildFormat,build:fO,lts:S,elapse:S-i,extend:JSON.stringify(c),mode:r.mode,process:Y("PROCESS_ID"),appType:Y("APP_TYPE"),success:!0,version:Ca,stringUid:u,channelProfile:h,channelMode:f,isABTestSuccess:m,lsid:y,clientType:Oe(O=window.navigator.userAgent).call(O,"AgoraWebView")?42:20,clientRole:_,serviceId:Y("PROCESS_ID"),extensionID:Y("PLUGIN_INFO").join(",")||""});var O;this.send({type:on.SESSION,data:w},!0)}joinChooseServer(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{role:r.role,eventType:nr.JOIN_CHOOSE_SERVER,lts:c,eventElapse:r.elapse||c-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:c-i.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3,corssRegionTagReq:r.corssRegionTagReq||void 0,corssRegionTagRes:r.corssRegionTagRes||void 0});this.send({type:on.JOIN_CHOOSE_SERVER,data:u},!0)}reqUserAccount(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{eventType:nr.REQ_USER_ACCOUNT,lts:c,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:r.elapse||c-i.startTime,eventElapse:c-r.lts,extend:JSON.stringify(r.extend)});this.send({type:on.REQ_USER_ACCOUNT,data:u},!0)}joinGateway(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info;r.vid&&(s.vid=r.vid),s.uid=r.uid,s.cid=r.cid;const c=Date.now(),{firstSuccess:u,avoidJoinStartTime:h,addr:f,isProxy:m}=r,y=c-(u&&h?h:i.startTime),_=ot(ot({},s),{},{eventType:nr.JOIN_GATEWAY,lts:c,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,errorMsg:r.errorMsg||"",elapse:y,eventElapse:c-r.lts,firstSuccess:u,signalChannel:r.signalChannel,preload:r.preload?1:0,installId:uO(),isABTestSuccess:r.isABTestSuccess?1:0}),S=_.success?1:0;if(r.succ&&(i.lastJoinSuccessTime=c),u)this.send({type:on.JOIN_GATEWAY,data:_},!0);else{let w;if(f)if(m){const W=f.match(/h=(\d{1,3}-){3}\d{1,3}/g),k=f.match(/p=[0-9]{1,6}/g);w={isSuccess:S,gatewayIp:W&&W.length?W[0].split("=")[1].replace(/-/g,"."):"",port:k&&k.length?k[0].split("=")[1]:"",isProxy:m?1:0}}else{const W=f.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),k=f.match(/(:|p=)[0-9]{1,6}/g);w={isSuccess:S,gatewayIp:W&&W.length?W[0].split("//")[1].replace(/-/g,"."):"",port:k&&k.length?k[0].split(/:|p=/g)[1]:"",isProxy:m?1:0}}else w={isSuccess:S,gatewayIp:"",port:"",isProxy:m?1:0};delete _.success,delete _.eventType,delete _.firstSuccess,_.vid=Number(_.vid);const O=Object.assign({},_,w,{eventType:nr.REJOIN_GATEWAY});this.send({type:on.RE_JOIN_GATEWAY,data:O},!0)}}joinChannelTimeout(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=Date.now(),c=ot(ot({},i.info),{},{lts:s,timeout:r,elapse:s-i.startTime});this.send({type:on.JOIN_CHANNEL_TIMEOUT,data:c},!0)}publish(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{eventType:nr.PUBLISH,lts:c,eventElapse:r.eventElapse,elapse:c-i.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:on.PUBLISH,data:u},!0)}subscribe(n,r,i){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,u=Date.now(),h=ot(ot({},c),{},{eventType:nr.SUBSCRIBE,lts:u,eventElapse:r.eventElapse,elapse:u-s.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid,preSsrc:r.preSsrc?1:0},i&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof r.peerid=="string"?h.peerSuid=r.peerid:h.peer=r.peerid,this.send({type:on.SUBSCRIBE,data:h},!0)}wsCompressorInit(n){var r;const i=[...oa(r=this.baseInfoMap).call(r)],s=i.length?i[0]:"UnableToGetSid",c=this.baseInfoMap.get(s);if(!c)return;const u=c.info,h=Date.now(),f=ot(ot({},u),{},{eventType:nr.WS_COMPRESSOR_INIT,lts:h,eventElapse:n.eventElapse,elapse:h-c.startTime,status:n.status?1:2});this.send({type:on.WS_COMPRESSOR_INIT,data:f},!0)}firstRemoteVideoDecode(n,r,i,s){const c=this.baseInfoMap.get(n);if(!c)return;const u=c.info,h=Date.now(),f=ot(ot(ot({},u),s),{},{elapse:h-c.startTime,eventType:r,lts:h,firstDecodeFrame:Math.max((s.firstFrame||h)-c.startTime,0),apEnd:Math.max(s.apEnd-c.startTime,0),apStart:Math.max(s.apStart-c.startTime,0),joinGwEnd:Math.max(s.joinGwEnd-c.startTime,0),joinGwStart:Math.max(s.joinGwStart-c.startTime,0),pcEnd:Math.max(s.pcEnd-c.startTime,0),pcStart:Math.max(s.pcStart-c.startTime,0),subscriberEnd:Math.max(s.subscriberEnd-c.startTime,0),subscriberStart:Math.max(s.subscriberStart-c.startTime,0),videoAddNotify:Math.max(s.videoAddNotify-c.startTime,0)});this.send({type:i,data:f},!0)}firstRemoteFrame(n,r,i,s){const c=this.baseInfoMap.get(n);if(!c)return;const u=c.info,h=Date.now(),f=ot(ot(ot({},u),s),{},{elapse:h-c.startTime,eventType:r,lts:h});this.send({type:i,data:f},!0)}abTest(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:c-i.startTime,eventType:nr.AB_TEST,lts:c});this.send({type:on.AB_TEST,data:u},!0)}pcStats(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:c-i.startTime,eventType:nr.PC_STATS,lts:c,preallocation:r.preallocation?1:0});this.send({type:on.PC_STATS,data:u},!0)}updateRemoteRTPCapabilities(n,r){if(n){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{vid:s.vid===void 0?0:Number(s.vid),eventType:nr.UPDATE_REMOTE_RTPCAPABILITIES,lts:c});this.send({type:on.UPDATE_REMOTE_RTPCAPABILITIES,data:u},!0)}}onGatewayStream(n,r,i,s){const c=this.baseInfoMap.get(n);if(!c)return;const u=c.info,h=Date.now(),f=ot(ot(ot({},u),s),{},{eventType:r,lts:h});this.send({type:i,data:f},!0)}streamSwitch(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{eventType:nr.STREAM_SWITCH,lts:c,isDual:r.isdual,elapse:c-i.startTime,success:r.succ});this.send({type:on.STREAM_SWITCH,data:u},!0)}requestProxyAppCenter(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{eventType:nr.REQUEST_PROXY_APPCENTER,lts:c,eventElapse:c-r.lts,elapse:c-i.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:on.REQUEST_PROXY_APPCENTER,data:u},!0)}requestProxyWorkerManager(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{eventType:nr.REQUEST_PROXY_WORKER_MANAGER,lts:c,eventElapse:c-r.lts,elapse:c-i.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:on.REQUEST_PROXY_WORKER_MANAGER,data:u},!0)}setProxyServer(n){this.proxyServer=n,n?A.debug("reportProxyServerurl: ".concat(n)):A.debug("disable reportProxyServerurl: ".concat(n))}peerPublishStatus(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot({},s),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:c,elapse:c-i.startTime,joinChannelSuccessElapse:c-(i.lastJoinSuccessTime||c),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:on.PEER_PUBLISH_STATUS,data:u},!0)}workerEvent(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now();(function(u,h,f){const m=u[h];if(!m||typeof m!="string")return[u];u[h]="";const y=ps(JSON.stringify(u));let _=0;const S=[];let w=0;for(let O=0;O<m.length;O++)w+=m.charCodeAt(O)<=127?1:3,w<=f-y||(S[S.length]=Me(Me({},u),{},{[h]:m.substring(_,O)}),_=O,w=m.charCodeAt(O)<=127?1:3);return _!==m.length-1&&(S[S.length]=Me(Me({},u),{},{[h]:m.substring(_)})),S})(ot(ot(ot({},s),r),{},{elapse:c-i.startTime,lts:c,productType:"WebRTC"}),"payload",1300).forEach(u=>this.send({type:on.WORKER_EVENT,data:u},!0))}apworkerEvent(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{elapse:c-i.startTime,lts:c});this.send({type:on.AP_WORKER_EVENT,data:u},!0)}joinWebProxyAP(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{elapse:c-i.startTime,lts:c,extend:r.extend||void 0});this.send({type:on.JOIN_WEB_PROXY_AP,data:u},!0)}WebSocketQuit(n,r){const i=this.baseInfoMap.get(n);if(!i)return;const s=i.info,c=Date.now(),u=ot(ot(ot({},s),r),{},{elapse:c-i.startTime,lts:c});this.send({type:on.WEBSOCKET_QUIT,data:u},!0)}async sendCustomReportMessage(n,r){if(this.customReportCount+=r.length,this.customReportCount>Y("CUSTOM_REPORT_LIMIT"))throw new de($.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const i=Date.now(),s=r.map(c=>({type:on.USER_ANALYTICS,data:ot(ot({sid:n},c),{},{lts:i})}));try{Y("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(s):await this.postDataToStatsCollector(s)}catch(c){throw A.error("send custom report message failed",c.toString()),new de($.CUSTOM_REPORT_SEND_FAILED,c.message)}}sendApiInvoke(n){const r=Y("NOT_REPORT_EVENT");if(n.tag&&Oe(r)&&Oe(r).call(r,n.tag))return!1;if(n.sid===null)return this.apiInvokeUploadPendingItems.push(n),!1;const i=this.baseInfoMap.get(n.sid);if(!i)return this.apiInvokeUploadPendingItems.push(n),!1;const{cname:s,uid:c,cid:u}=i.info;let h;if(n.lts=n.lts||Date.now(),n.error)if(n.error instanceof de){const{code:m,message:y}=n.error;h=m||y||n.error.toString()}else h=n.error.toString();const f={invokeId:n.invokeId,sid:n.sid,cname:s,cid:u,uid:c,lts:n.lts,success:n.success,elapse:n.lts-i.startTime,execElapse:n.lts-n.apiInvokeTime,apiName:n.name,options:n.options?JSON.stringify(n.options):void 0,execStates:n.states?JSON.stringify(n.states):void 0,execResult:n.result?JSON.stringify(n.result):void 0,errorCode:n.error?h:void 0,errorMsg:n.error?JSON.stringify(n.error):void 0};return this.send({type:on.API_INVOKE,data:f},!1),!0}addSid(n){this.sids.add(n)}removeSid(n){this.sids.delete(n)}appendSessionId(){const n=this.apiInvokeUploadPendingItems;if(n.length===0)return;const r=Array.from(this.sids).find(i=>i!==null);r&&n.forEach(i=>{i&&(i.sid=r,this.sendApiInvoke(Object.assign({},i)))}),n.length=0}send(n,r){if(r)return this.keyEventUploadPendingItems.push(n),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(n),this.normalEventUploadPendingItems.length>Y("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(n,r){const i=[],s=[];for(;n.length;){const u=n.shift();i.length<20?i.push(u):s.push(u)}n.push(...s);for(const u of[...i]){var c;this.ltsList.indexOf(u.data.lts)!==-1?(u.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(u.data.lts)):(this.ltsList.push(u.data.lts),om(c=this.ltsList).call(c,(h,f)=>h-f))}return r||(this.lastSendNormalEventTime=Date.now()),Y("ENABLE_EVENT_REPORT")&&i.length&&(Y("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(i):this.postDataToStatsCollector(i)).catch((u=>h=>{Y("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(u):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(u),this.normalEventUploadPendingItems.length>Y("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Y("NORMAL_EVENT_QUEUE_CAPACITY")),A.warning("report: drop normal events"))))})(i)),n}async postDataToStatsCollector2(n){xn.networkState===Hi.OFFLINE&&await Ie.race([xn.onlineWaiter,_r(2*Gn.maxRetryTimeout)]);const r=c=>{let u=new Uint8Array;return c.forEach(h=>{const f=Q0(JSON.stringify(h.data)),m=new ArrayBuffer(5),y=(S=>{let w=0;return Object.entries(on).forEach(O=>{let[W,k]=O;k===S.type&&(w=ufe[W])}),w})(h),_=new DataView(m);_.setUint16(0,f.byteLength,!0),_.setUint8(2,255&y),_.setUint8(3,y>>>8&255),_.setUint8(4,y>>>16&255),u=oB(u,new Uint8Array(m)),u=oB(u,f)}),u},i="event";let s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(i):"https://".concat(Y("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(i);for(let c=0;c<2;c+=1){c===1&&(s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(i):"https://".concat(Y("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(i));try{await aO(s,{timeout:1e4,data:r(n),headers:ot(ot({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(u){if(c===1)throw u;continue}return}}async postDataToStatsCollector(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=(f=>{const m=f&&f.data.sid&&this.baseInfoMap.get(f.data.sid);return m&&m.info.vid&&+m.info.vid||0})(n[0]),s=i?void 0:this._aid,c={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:n.map(f=>JSON.stringify(f)),vid:i,aid:s};xn.networkState===Hi.OFFLINE&&await Ie.race([xn.onlineWaiter,_r(2*Gn.maxRetryTimeout)]);const u=r?"/events/proto-raws":"/events/messages";let h=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("EVENT_REPORT_DOMAIN"),"&p=").concat(Y("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(Y("EVENT_REPORT_DOMAIN"),":").concat(Y("STATS_COLLECTOR_PORT")).concat(u));for(let f=0;f<2;f+=1){f===1&&(h=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Y("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(Y("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Y("STATS_COLLECTOR_PORT")).concat(u)));try{r?await Yhe(h,{timeout:1e4,data:c}):await aO(h,{timeout:1e4,data:c})}catch(m){if(f===1)throw m;continue}return}}createBaseInfo(n,r){const i=Object.assign({},lfe);return i.sid=n,this.baseInfoMap.set(n,{info:i,startTime:r}),i}reportResourceTiming(n,r){const i=performance.getEntriesByName(n),s=i[i.length-1];s&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:s,tag:fn.TRACER}).onSuccess()}};xB.on("REPORT_LOG_UPLOAD",n=>{n.networkState=xn.networkState,$e.reportApiInvoke(null,{name:"logUploadError",options:n,tag:fn.TRACER}).onSuccess("logUploadError")});class se extends de{constructor(r){super(r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),pn(this,"name","AgoraRTCException")}print(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(r,A)}throw(){super.throw(A)}}const Er={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function bt(){return Er}function kB(){return"setSinkId"in HTMLAudioElement.prototype&&(!Y("RESTRICTION_SET_PLAYBACK_DEVICE")||(Xs()||qV())&&!Y0())}function MB(){return!Er.supportUnifiedPlan||Y("CHROME_FORCE_PLAN_B")&&Js()}let Sr=function(n){return n.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",n.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",n.IOS_INTERRUPTION_START="ios-interruption-start",n.IOS_INTERRUPTION_END="ios-interruption-end",n.STATE_CHANGE="state-change",n}({});function Eh(n,r,i){return{sampleRate:n,stereo:r,bitrate:i}}function _t(n,r,i,s,c){return{width:n,height:r,frameRate:i,bitrateMin:s,bitrateMax:c}}function to(n,r,i,s,c){return{width:{max:n},height:{max:r},frameRate:i,bitrateMin:s,bitrateMax:c}}function yO(n,r){return{numSpatialLayers:n,numTemporalLayers:r}}const dfe={"90p":_t(160,90),"90p_1":_t(160,90),"120p":_t(160,120,15,30,65),"120p_1":_t(160,120,15,30,65),"120p_3":_t(120,120,15,30,50),"120p_4":_t(212,120),"180p":_t(320,180,15,30,140),"180p_1":_t(320,180,15,30,140),"180p_3":_t(180,180,15,30,100),"180p_4":_t(240,180,15,30,120),"240p":_t(320,240,15,40,200),"240p_1":_t(320,240,15,40,200),"240p_3":_t(240,240,15,40,140),"240p_4":_t(424,240,15,40,220),"360p":_t(640,360,15,80,400),"360p_1":_t(640,360,15,80,400),"360p_3":_t(360,360,15,80,260),"360p_4":_t(640,360,30,80,600),"360p_6":_t(360,360,30,80,400),"360p_7":_t(480,360,15,80,320),"360p_8":_t(480,360,30,80,490),"360p_9":_t(640,360,15,80,800),"360p_10":_t(640,360,24,80,800),"360p_11":_t(640,360,24,80,1e3),"480p":_t(640,480,15,100,500),"480p_1":_t(640,480,15,100,500),"480p_2":_t(640,480,30,100,1e3),"480p_3":_t(480,480,15,100,400),"480p_4":_t(640,480,30,100,750),"480p_6":_t(480,480,30,100,600),"480p_8":_t(848,480,15,100,610),"480p_9":_t(848,480,30,100,930),"480p_10":_t(640,480,10,100,400),"720p":_t(1280,720,15,120,1130),"720p_auto":_t(1280,720,30,900,3e3),"720p_1":_t(1280,720,15,120,1130),"720p_2":_t(1280,720,30,120,2e3),"720p_3":_t(1280,720,30,120,1710),"720p_5":_t(960,720,15,120,910),"720p_6":_t(960,720,30,120,1380),"1080p":_t(1920,1080,15,120,2080),"1080p_1":_t(1920,1080,15,120,2080),"1080p_2":_t(1920,1080,30,120,3e3),"1080p_3":_t(1920,1080,30,120,3150),"1080p_5":_t(1920,1080,60,120,4780),"1440p":_t(2560,1440,30,120,4850),"1440p_1":_t(2560,1440,30,120,4850),"1440p_2":_t(2560,1440,60,120,7350),"4k":_t(3840,2160,30,120,8910),"4k_1":_t(3840,2160,30,120,8910),"4k_3":_t(3840,2160,60,120,13500)},hfe={"480p":to(640,480,5),"480p_1":to(640,480,5),"480p_2":to(640,480,30),"480p_3":to(640,480,15),"720p":to(1280,720,5),"720p_auto":_t(1280,720,30,900,3e3),"720p_1":to(1280,720,5),"720p_2":to(1280,720,30),"720p_3":to(1280,720,15),"1080p":to(1920,1080,5),"1080p_1":to(1920,1080,5),"1080p_2":to(1920,1080,30),"1080p_3":to(1920,1080,15)},ffe={"1SL1TL":yO(1,1),"3SL3TL":yO(3,3),"2SL3TL":yO(2,3)};function gs(n){return n||(n="480p_1"),typeof n=="string"?Object.assign({},dfe[n]):n}function vO(n){return typeof n=="string"?Object.assign({},hfe[n]):n}function uE(n){return typeof n=="string"?Object.assign({},ffe[n]):n}const pfe={speech_low_quality:Eh(16e3,!1),speech_standard:Eh(32e3,!1,18),music_standard:Eh(48e3,!1),standard_stereo:Eh(48e3,!0,56),high_quality:Eh(48e3,!1,128),high_quality_stereo:Eh(48e3,!0,192)};function dE(n){return typeof n=="string"?Object.assign({},pfe[n]):n}const Sh=[];function UB(n){return Jn(n,"mediaSource",["screen","window","application"]),!0}let je=function(n){return n.NEED_RENEGOTIATE="@need_renegotiate",n.NEED_REPLACE_TRACK="@need_replace_track",n.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",n.NEED_CLOSE="@need_close",n.NEED_ENABLE_TRACK="@need_enable_track",n.NEED_DISABLE_TRACK="@need_disable_track",n.NEED_SESSION_ID="@need_sid",n.SET_OPTIMIZATION_MODE="@set_optimization_mode",n.GET_STATS="@get_stats",n.GET_RTC_STATS="@get_rtc_stats",n.GET_LOW_VIDEO_TRACK="@get_low_video_track",n.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",n.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",n.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",n.NEED_MUTE_TRACK="@need_mute_track",n.NEED_UNMUTE_TRACK="@need_unmute_track",n}({}),Yt=function(n){return n.SCREEN_TRACK="screen_track",n.CUSTOM_TRACK="custome_track",n.LOW_STREAM="low_stream",n.SCREEN_LOW_TRACK="screen_low_track",n}({}),bh=function(n){return n[n.HIGH_STREAM=0]="HIGH_STREAM",n[n.LOW_STREAM=1]="LOW_STREAM",n}({}),mfe=function(n){return n[n.HIGH_STREAM=0]="HIGH_STREAM",n[n.LOW_STREAM=1]="LOW_STREAM",n[n.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",n[n.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",n[n.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",n[n.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",n[n.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",n[n.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",n}({}),gfe=function(n){return n[n.DISABLE=0]="DISABLE",n[n.LOW_STREAM=1]="LOW_STREAM",n[n.AUDIO_ONLY=2]="AUDIO_ONLY",n[n.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",n[n.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",n[n.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",n[n.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",n[n.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",n[n.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",n}({}),Au=function(n){return n.TRANSCEIVER_UPDATED="transceiver-updated",n.SEI_TO_SEND="sei-to-send",n.SEI_RECEIVED="sei-received",n.TRACK_UPDATED="track-updated",n}({}),Th=function(n){return n.SOURCE_STATE_CHANGE="source-state-change",n.TRACK_ENDED="track-ended",n.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",n.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",n.CLOSED="closed",n}({}),wh=function(n){return n.FIRST_FRAME_DECODED="first-frame-decoded",n.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",n.VIDEO_STATE_CHANGED="video-state-changed",n}({}),Ch=function(n){return n.AUDIO="audio",n.VIDEO="video",n.DATA="data",n}({}),sa=function(n){return n.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",n.RECEIVE_TRACK_BUFFER="receive_track_buffer",n.ON_AUDIO_BUFFER="on_audio_buffer",n.UPDATE_SOURCE="update_source",n}({});(function(n){n.UPDATE_TRACK_SOURCE="update-track-source"})({});const _O={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},EO={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},jB={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},yfe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},VB={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ii=function(n){return n.ON_TRACK="on_track",n.ON_NODE="on_node",n}({}),ca=function(n){return n.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",n.REQUEST_CONSTRAINTS="request_constraints",n}({}),Om=function(n){return n.IDLE="IDLE",n.INITING="INITING",n.INITEND="INITEND",n}({}),Iu=function(n){return n.STATE_CHANGE="state_change",n.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",n.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",n.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",n}({}),zr=function(n){return n.NONE="none",n.INIT="init",n.CANPLAY="canplay",n.PLAYING="playing",n.PAUSED="paused",n.SUSPEND="suspend",n.STALLED="stalled",n.WAITING="waiting",n.ERROR="error",n.DESTROYED="destroyed",n.ABORT="abort",n.ENDED="ended",n.EMPTIED="emptied",n.LOADEDDATA="loadeddata",n}({}),ys=function(n){return n[n.VideoStateStopped=0]="VideoStateStopped",n[n.VideoStateStarting=1]="VideoStateStarting",n[n.VideoStateDecoding=2]="VideoStateDecoding",n[n.VideoStateFrozen=3]="VideoStateFrozen",n}({});const SO={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let hE=function(n){return n.OPEN="open",n.MESSAGE="message",n.CLOSE="close",n.CLOSING="closing",n.ERROR="error",n}({});function Et(n,r,i,s,c){var u,h,f={};return Object.keys(s).forEach(function(m){f[m]=s[m]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=Ao(u=CL(h=i.slice()).call(h)).call(u,function(m,y){return y(n,r,m)||m},f),c&&f.initializer!==void 0&&(f.value=f.initializer?f.initializer.call(c):void 0,f.initializer=void 0),f.initializer===void 0?(Object.defineProperty(n,r,f),null):f}function oe(n,r,i){return(r=function(s){var c=function(u){if(typeof u!="object"||!u)return u;var h=u[Symbol.toPrimitive];if(h!==void 0){var f=h.call(u,"string");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(s);return typeof c=="symbol"?c:c+""}(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}function BB(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function sn(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?BB(Object(i),!0).forEach(function(s){oe(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):BB(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class FB extends ln{set _mediaStreamTrack(r){r!==this.mediaStreamTrack&&(this.safeEmit(Au.TRACK_UPDATED,r),this.mediaStreamTrack=r)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(r,i){super(),oe(this,"trackMediaType",void 0),oe(this,"_ID",void 0),oe(this,"_rtpTransceiver",void 0),oe(this,"_lowRtpTransceiver",void 0),oe(this,"_hints",[]),oe(this,"_isClosed",!1),oe(this,"_originMediaStreamTrack",void 0),oe(this,"mediaStreamTrack",void 0),oe(this,"_external",{}),this._ID=i||qt(8,"track-"),this._originMediaStreamTrack=r,this.mediaStreamTrack=r,function(s){Oe(Sh).call(Sh,s)||Sh.push(s)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(r){return r||Yc(()=>{var i;$e.reportApiInvoke(null,{name:Wn.GET_MEDIA_STREAM_TRACK,options:[],tag:fn.TRACER}).onSuccess(((i=this._mediaStreamTrack)===null||i===void 0?void 0:i.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(r){return r===bh.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(r){const i=Sh.indexOf(r);i!==-1&&Sh.splice(i,1)}(this),this.emit(Th.CLOSED),this.removeAllListeners(Au.SEI_RECEIVED)}_updateRtpTransceiver(r,i){if(i===bh.LOW_STREAM){if(this._lowRtpTransceiver===r)return;this._lowRtpTransceiver=r}else{if(this._rtpTransceiver===r)return;this._rtpTransceiver=r}this.emit(Au.TRANSCEIVER_UPDATED,r,i)}}class Rh extends FB{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(r,i){super(r,i),oe(this,"_enabled",!0),oe(this,"_muted",!1),oe(this,"_isExternalTrack",!1),oe(this,"_isClosed",!1),oe(this,"_enabledMutex",void 0),oe(this,"processor",void 0),oe(this,"_processorContext",void 0),oe(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Lr("".concat(this.getTrackId())),r.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var r,i;return(r=(i=this._originMediaStreamTrack)===null||i===void 0?void 0:i.label)!==null&&r!==void 0?r:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,A.debug("[".concat(this.getTrackId(),"] close")),this.emit(je.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(r,i){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=s,r!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),i&&this._originMediaStreamTrack.stop()),r.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=r,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Kt(this,je.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Th.TRACK_ENDED)}stateCheck(r,i){if(A.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(r,": ").concat(i,"]")),Qs(i,r),this._enabled&&this._muted&&r==="enabled"&&i===!1)throw new de($.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",A);if(!this._enabled&&!this._muted&&r==="muted"&&i===!0)throw new de($.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",A)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():Ie.resolve([])}}const WB=window.AudioContext||window.webkitAudioContext;let la=null;const jt=new class extends ln{constructor(){super(...arguments),oe(this,"prevState",void 0),oe(this,"curState",void 0),oe(this,"currentTime",void 0),oe(this,"currentTimeStuckAt",void 0),oe(this,"interruptDetectorTrack",void 0),oe(this,"onLocalAudioTrackMute",()=>{A.info("ios15-interruption-start"),this.emit(Sr.IOS_15_16_INTERRUPTION_START)}),oe(this,"onLocalAudioTrackUnmute",async()=>{A.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?A.info("ios15-interruption-end-canceled"):(la&&await la.suspend(),this.emit(Sr.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(n){A.debug("webaudio bindInterruptDetectorTrack ".concat(n.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=n,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(n){A.debug("webaudio unbindInterruptDetectorTrack ".concat(n.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===n&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Oh(){if(!la){if(function(){if(!WB)return void A.error("your browser is not support web audio");A.info("create audio context");const n=sn({},Y("WEBAUDIO_INIT_OPTIONS"));A.debug("audio context init option:",JSON.stringify(n)),la=new WB(n),jt.curState=la.state,la.onstatechange=()=>{jt.prevState=jt.curState,jt.curState=la?la.state:void 0;const{prevState:r,curState:i}=jt,s=i==="running",c=i==="interrupted",u=r==="running",h=r==="suspended",f=r==="interrupted",m=St().osVersion;(ri()||Za())&&u&&c&&(A.info("ios".concat(m,"-interruption-start")),jt.emit(Sr.IOS_INTERRUPTION_START)),(ri()||Za())&&(h||f)&&s&&(A.info("ios".concat(m,"-interruption-end")),jt.emit(Sr.IOS_INTERRUPTION_END)),r!==i&&jt.emit(Sr.STATE_CHANGE,i,r)},setInterval(()=>{var r;const i=(r=la)===null||r===void 0?void 0:r.currentTime;jt.currentTime!==i?(jt.currentTimeStuckAt&&(A.debug("AudioContext current time resume at ".concat(i)),jt.currentTimeStuckAt=void 0),jt.currentTime=i):(i!==jt.currentTimeStuckAt&&($e.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:i},tag:fn.TRACER}).onSuccess(),A.warning("AudioContext current time stuck at ".concat(i))),jt.currentTimeStuckAt=i)},5e3),async function(r){const i=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let s,c=!1,u=!1,h=!1;function f(k){r.state==="running"?m(!1):ri()||Za()?r.state==="suspended"&&(m(!0),k&&r.resume().then(y,y)):r.state!=="closed"&&(m(!0),k&&r.resume().then(y,y))}function m(k){if(c!==k){c=k;for(let j=0,H=i;j<H.length;j+=1){const K=H[j];k?window.addEventListener(K,_,{capture:!0,passive:!0}):window.removeEventListener(K,_,{capture:!0,passive:!0})}}}function y(){f(!1)}function _(){f(!0)}function S(k){if(!h)if(s.paused)if(k){let j;w(!1),h=!0;try{j=s.play(),j?j.then(O,O):(s.addEventListener("playing",O),s.addEventListener("abort",O),s.addEventListener("error",O))}catch{O()}}else w(!0);else w(!1)}function w(k){if(u!==k){u=k;for(let j=0,H=i;j<H.length;j++){const K=H[j];k?window.addEventListener(K,W,{capture:!0,passive:!0}):window.removeEventListener(K,W,{capture:!0,passive:!0})}}}function O(){s.removeEventListener("playing",O),s.removeEventListener("abort",O),s.removeEventListener("error",O),h=!1,S(!1)}function W(){S(!0)}if(ri()){const k=r.createMediaStreamDestination(),j=document.createElement("div");j.innerHTML="<audio x-webkit-airplay='deny'></audio>",s=j.children.item(0),s.controls=!1,s.disableRemotePlayback=!0,s.preload="auto",s.srcObject=k.stream,S(!0)}jt.on(Sr.STATE_CHANGE,function(){f(!0)}),f(!1)}(la)}(),!la)throw new de($.NOT_SUPPORTED,"can not create audio context");return la}return la}function Nu(n){if(function(){if(bO!==null)return bO;const s=Oh(),c=s.createBufferSource(),u=s.createGain(),h=s.createGain();c.connect(u),c.connect(h),c.disconnect(u);let f=!1;try{c.disconnect(u)}catch{f=!0}return c.disconnect(),bO=f,f}())return;const r=n.connect,i=n.disconnect;n.connect=(s,c,u)=>{var h;return n._inputNodes||(n._inputNodes=[]),Oe(h=n._inputNodes).call(h,s)||(s instanceof AudioNode?(n._inputNodes.push(s),r.call(n,s,c,u)):r.call(n,s,c)),n},n.disconnect=(s,c,u)=>{i.call(n),s?tE(n._inputNodes,s):n._inputNodes=[];for(const h of n._inputNodes)r.call(n,h)}}let bO=null;function TO(n,r){let i=!1;const s=1/r;if(Y("DISABLE_WEBAUDIO")){const c=window.setInterval(()=>{i?window.clearInterval(c):n(performance.now()/1e3)},1e3*s)}else{const c=Oh();let u=c.createGain();u.gain.value=0,u.connect(c.destination);const h=()=>{if(i)return void(u=null);const f=c.createOscillator();f.onended=h,f.connect(u),f.start(0),f.stop(c.currentTime+s),n(c.currentTime)};h()}return()=>{i=!0}}class GB{constructor(){oe(this,"context",void 0),oe(this,"analyserNode",void 0),oe(this,"sourceNode",void 0),this.context=Oh(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(r){if(r!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=r,r==null||r.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||ri()||Za()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const r=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(r);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let c=0;c<r.length;++c)r[c]=s[c]/128-1}const i=Ao(r).call(r,(s,c)=>s+c*c,0)/r.length;return Math.max(10*Math.log10(i)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var r,i;(r=this.sourceNode)===null||r===void 0||r.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(i=this.sourceNode)===null||i===void 0||i.connect(this.analyserNode)}catch{A.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class $B extends ln{get processSourceNode(){return this.sourceNode}set processedNode(r){var i;if(!this.isDestroyed&&this._processedNode!==r){try{var s;(s=this.sourceNode)===null||s===void 0||s.disconnect(this.outputNode)}catch{}(i=this._processedNode)===null||i===void 0||i.disconnect(),this._processedNode=r,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),oe(this,"outputNode",void 0),oe(this,"outputTrack",void 0),oe(this,"isPlayed",!1),oe(this,"sourceNode",void 0),oe(this,"context",void 0),oe(this,"audioBufferNode",void 0),oe(this,"destNode",void 0),oe(this,"audioOutputLevel",0),oe(this,"volumeLevelAnalyser",void 0),oe(this,"_processedNode",void 0),oe(this,"playNode",void 0),oe(this,"isDestroyed",!1),oe(this,"onNoAudioInput",void 0),oe(this,"isNoAudioInput",!1),oe(this,"_noAudioInputCount",0),this.context=Oh(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Nu(this.outputNode),this.volumeLevelAnalyser=new GB}startGetAudioBuffer(r){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(r),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=i=>{this.emit(sa.ON_AUDIO_BUFFER,function(s){for(let c=0;c<s.outputBuffer.numberOfChannels;c+=1){const u=s.outputBuffer.getChannelData(c);for(let h=0;h<u.length;h+=1)u[h]=0}return s.inputBuffer}(i))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!bt().webAudioMediaStreamDest)throw new de($.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(r){this.context.state!=="running"&&nE(()=>{jt.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=r||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(r>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;ri()||Za()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const i=this.volumeLevelAnalyser.getAnalyserNode();let s;i.getFloatTimeDomainData?(s=new Float32Array(i.fftSize),i.getFloatTimeDomainData(s)):(s=new Uint8Array(i.fftSize),i.getByteTimeDomainData(s));let c=!1;for(let u=0;u<s.length;u++)s[u]!==0&&(c=!0);return c?(this.isNoAudioInput=!1,!0):(await _r(200),await this.checkHasAudioInput(r?r+1:1)&&c)}getAudioVolume(){return this.outputNode.gain.value}setVolume(r){this.outputNode.gain.setValueAtTime(r,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var r,i;(r=this.processedNode)===null||r===void 0||r.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var r;this.processedNode?(r=this.processedNode)===null||r===void 0||r.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class HB extends $B{get isFreeze(){return!1}constructor(r,i,s){var c;if(super(),oe(this,"sourceNode",void 0),oe(this,"track",void 0),oe(this,"clonedTrack",void 0),oe(this,"audioElement",void 0),oe(this,"isCurrentTrackCloned",!1),oe(this,"isRemoteTrack",!1),oe(this,"originVolumeLevelAnalyser",void 0),oe(this,"rebuildWebAudio",async()=>{if(A.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void A.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>A.info("resume success")),A.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const f=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?f.stop():this.isCurrentTrackCloned=!0;const m=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(m),Nu(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const y=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(y,this.context.currentTime),Nu(this.outputNode),this.emit(sa.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=m,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),r.kind!=="audio")throw new de($.UNEXPECTED_ERROR);this.track=r;const u=new MediaStream([this.track]);if(this.isRemoteTrack=!!i,this.sourceNode=this.context.createMediaStreamSource(u),Nu(this.sourceNode),s){const f=s.clone();f.enabled=!0,this.clonedTrack=f,A.debug("create an unmuted track ".concat(f.id," from the original track ").concat(s.id," to get the volume"));const m=this.context.createMediaStreamSource(new MediaStream([f]));Nu(m),this.originVolumeLevelAnalyser=new GB,this.originVolumeLevelAnalyser.updateSource(m)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=u;const h=St();i&&h.os===tr.IOS&&Number((c=h.osVersion)===null||c===void 0?void 0:c.split(".")[0])<15&&(jt.on(Sr.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(f=>{f||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(r){this.sourceNode.disconnect(),this.track=r,this.isCurrentTrackCloned=!1;const i=new MediaStream([r]);this.sourceNode=this.context.createMediaStreamSource(i),Nu(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(sa.UPDATE_SOURCE),this.audioElement.srcObject=i}destroy(){var r;this.audioElement.srcObject=null,this.audioElement.remove(),jt.off("state-change",this.rebuildWebAudio),(r=this.originVolumeLevelAnalyser)===null||r===void 0||r.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(r){return this.context.createMediaStreamSource(new MediaStream([r]))}updateOriginTrack(r){const i=r.clone();i.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=i),A.debug("create an unmuted track ".concat(i.id," from the original track ").concat(r.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([i]));Nu(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function zB(n,r,i){const s=(u,h)=>u?typeof u!="number"?u.max||u.exact||u.ideal||u.min||h:u:h,c={audio:!!i&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n,maxHeight:s(r.height,1080),maxWidth:s(r.width,1920)}}};return r.frameRate&&typeof r.frameRate!="number"?(c.video.mandatory.maxFrameRate=r.frameRate.max,c.video.mandatory.minFrameRate=r.frameRate.min):typeof r.frameRate=="number"&&(c.video.mandatory.maxFrameRate=r.frameRate),await navigator.mediaDevices.getUserMedia(c)}async function vfe(n,r){const i=await KB(n.mediaSource),{sourceId:s,audio:c}=await function(u){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ie((f,m)=>{const y=document.createElement("div");y.innerText="share screen",y.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const _=document.createElement("div");_.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const S=document.createElement("div");S.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",S.setAttribute("style","height: 12%;");const w=document.createElement("div");w.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const O=document.createElement("div");O.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const W=document.createElement("button");W.innerHTML="cancel",W.setAttribute("style","width: 85px;"),W.onclick=()=>{document.body.removeChild(H);const K=new Error("NotAllowedError");K.name="NotAllowedError",m(K)};let k=h;const j=document.createElement("div");if(h){const K=document.createElement("input");K.setAttribute("type","checkbox");const Q=document.createElement("span");K.setAttribute("style","margin-right: 6px;"),Q.innerText="Share audio",K.checked=k,K.onchange=()=>{k=K.checked},j.appendChild(K),j.appendChild(Q)}O.appendChild(j),O.appendChild(W),_.appendChild(S),_.appendChild(w),_.appendChild(O);const H=document.createElement("div");H.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),H.appendChild(y),H.appendChild(_),document.body.appendChild(H),u.map(K=>{if(K.id){const Q=document.createElement("div");Q.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let ie=K.thumbnail;try{const{width:re}=ie.getSize();re>1920&&(ie=ie.resize({width:1920}))}catch(re){throw re&&re.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),re}Q.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+ie.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+K.name.replace(/[\u00A0-\u9999<>\&]/g,function(re){return"&#"+re.charCodeAt(0)+";"})+"</span>",Q.onclick=()=>{document.body.removeChild(H),f({sourceId:K.id,audio:k})},w.appendChild(Q)}})})}(i,r);return await zB(s,n,c)}async function KB(n){let r=["window","screen"];n!=="application"&&n!=="window"||(r=["window"]),n==="screen"&&(r=["screen"]);const i=sB();if(!i)throw console.error("failed to fetch electron, please mount it to window"),new de($.ELECTRON_IS_NULL);let s=null;try{var c;s=((c=i.desktopCapturer)===null||c===void 0?void 0:c.getSources({types:r}))||i.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:r})}catch{s=null}s&&s.then||(s=new Ie((u,h)=>{i.desktopCapturer.getSources({types:r},(f,m)=>{f?h(f):u(m)})}));try{return await s}catch(u){throw new de($.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,u.toString())}}const wO=new Lr("safari");let qB=!1,YB=!1;async function ua(n,r){let i=0,s=null;for(;i<2;)try{s=await _fe(n,r,i>0);break}catch(c){if(c instanceof de)throw A.error("[".concat(r,"] ").concat(c.toString())),c;const u=fE(c.name||c.code||c,c.message);if(u.code===$.MEDIA_OPTION_INVALID){A.debug("[".concat(r,"] detect media option invalid, retry")),i+=1,await _r(500);continue}throw A.error("[".concat(r,"] ").concat(u.toString())),u}if(!s)throw new de($.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}async function _fe(n,r,i){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new de($.NOT_SUPPORTED,"can not find getUserMedia");i&&(n.video&&(delete n.video.width,delete n.video.height),n.screen&&(delete n.screen.width,delete n.screen.height));const s=bt(),c=new MediaStream;if(n.audioSource&&c.addTrack(n.audioSource),n.videoSource&&c.addTrack(n.videoSource),!n.audio&&!n.video&&!n.screen)return A.debug("Using Video Source/ Audio Source"),c;if(n.screen)if(sB())n.screen.sourceId?Ah(c,await zB(n.screen.sourceId,n.screen,!!n.screenAudio)):Ah(c,await vfe(n.screen,!!n.screenAudio));else if(Xs()&&n.screen.extensionId&&n.screen.mandatory){if(!s.getStreamFromExtension)throw new de($.NOT_SUPPORTED,"This browser does not support screen sharing");A.debug("[".concat(r,'] Screen access on chrome stable, looking for extension"'));const w=await(h=n.screen.extensionId,f=r,new Ie((O,W)=>{try{chrome.runtime.sendMessage(h,{getStream:!0},k=>{if(!k||!k.streamId)return A.error("[".concat(f,"] No response from Chrome Plugin. Plugin not installed properly"),k),void W(new de($.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));O(k.streamId)})}catch(k){A.error("[".concat(f,"] AgoraRTC screensharing plugin is not accessible(").concat(h,")"),k.toString()),W(new de($.CHROME_PLUGIN_NOT_INSTALL))}}));n.screen.mandatory.chromeMediaSourceId=w,Ah(c,await navigator.mediaDevices.getUserMedia({video:{mandatory:n.screen.mandatory}}))}else if(s.getDisplayMedia){var u;n.screen.mediaSource&&UB(n.screen.mediaSource);const w={width:n.screen.width,height:n.screen.height,frameRate:n.screen.frameRate,displaySurface:(u=n.screen.displaySurface)!==null&&u!==void 0?u:n.screen.mediaSource==="screen"?"monitor":n.screen.mediaSource},{selfBrowserSurface:O,surfaceSwitching:W,systemAudio:k,preferCurrentTab:j}=n.screen,H={selfBrowserSurface:O,surfaceSwitching:W,systemAudio:k,preferCurrentTab:j};!O&&delete H.selfBrowserSurface,!W&&delete H.surfaceSwitching,!k&&delete H.systemAudio,!j&&delete H.preferCurrentTab,A.debug("[".concat(r,"] getDisplayMedia:"),JSON.stringify({video:w,audio:n.screenAudio,controls:H})),Ah(c,await navigator.mediaDevices.getDisplayMedia(sn({video:w,audio:n.screenAudio},H)))}else{if(!gn())throw A.error("[".concat(r,"] This browser does not support screenSharing")),new de($.NOT_SUPPORTED,"This browser does not support screen sharing");{n.screen.mediaSource&&UB(n.screen.mediaSource);const w={video:{mediaSource:n.screen.mediaSource,width:n.screen.width,height:n.screen.height,frameRate:n.screen.frameRate}};A.debug("[".concat(r,"] getUserMedia: ").concat(JSON.stringify(w))),Ah(c,await navigator.mediaDevices.getUserMedia(w))}}var h,f;if(!n.video&&!n.audio)return c;let m={video:n.video,audio:n.audio},y=Y("MEDIA_DEVICE_CONSTRAINTS");if(y)try{typeof y=="string"&&(y=JSON.parse(y)),m=tO(m,y)}catch{}A.debug("[".concat(r,"] GetUserMedia"),JSON.stringify(m)),St();let _,S=null;(Cr()||ri()||Z_())&&(S=await wO.lock());try{_=await navigator.mediaDevices.getUserMedia(m)}catch(w){throw S&&S(),w}return m.audio&&(qB=!0),m.video&&(YB=!0),Ah(c,_),S&&S(),c}function fE(n,r){switch(n){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new de($.MEDIA_OPTION_INVALID,"".concat(n,": ").concat(r));case"NotFoundError":case"DevicesNotFoundError":return new de($.DEVICE_NOT_FOUND,"".concat(n,": ").concat(r));case"NotSupportedError":return new de($.NOT_SUPPORTED,"".concat(n,": ").concat(r));case"NotReadableError":return new de($.NOT_READABLE,"".concat(n,": ").concat(r));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new de($.PERMISSION_DENIED,"".concat(n,": ").concat(r));case"ConstraintNotSatisfiedError":return new de($.CONSTRAINT_NOT_SATISFIED,"".concat(n,": ").concat(r));default:return A.error("getUserMedia unexpected error",n),new de($.UNEXPECTED_ERROR,"".concat(n,": ").concat(r))}}function Ah(n,r){const i=n.getVideoTracks()[0],s=n.getAudioTracks()[0],c=r.getVideoTracks()[0],u=r.getAudioTracks()[0];u&&(s&&n.removeTrack(s),n.addTrack(u)),c&&(i&&n.removeTrack(i),n.addTrack(c))}const da=new class extends ln{get state(){return this._state}set state(n){n!==this._state&&(this.emit(Iu.STATE_CHANGE,n),this._state=n)}constructor(){super(),oe(this,"_state",Om.IDLE),oe(this,"isAccessMicrophonePermission",!1),oe(this,"isAccessCameraPermission",!1),oe(this,"lastAccessMicrophonePermission",!1),oe(this,"lastAccessCameraPermission",!1),oe(this,"checkdeviceMatched",!1),oe(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(Y("ENUMERATE_DEVICES_INTERVAL")||(eE()||Q_()===tr.HARMONY_OS)&&Js())&&this.updateDevicesInfo()},Y("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(n=>A.error(n.toString()))}async enumerateDevices(n,r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new de($.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const s=await navigator.mediaDevices.enumerateDevices(),c=this.checkMediaDeviceInfoIsOk(s);let u=!this.isAccessMicrophonePermission&&n,h=!this.isAccessCameraPermission&&r;c.audio&&(u=!1),c.video&&(h=!1);let f=null,m=null,y=null;if(!i&&(u||h)){if(wO.isLocked&&(A.debug("[device manager] wait GUM lock"),(await wO.lock())(),A.debug("[device manager] GUM unlock")),qB&&(u=!1,this.isAccessMicrophonePermission=!0),YB&&(h=!1,this.isAccessCameraPermission=!0),A.debug("[device manager] check media device permissions",n,r,u,h),u&&h){try{y=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(_){const S=fE(_.name||_.code||_,_.message);if(S.code===$.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(u){try{f=await navigator.mediaDevices.getUserMedia({audio:n})}catch(_){const S=fE(_.name||_.code||_,_.message);if(S.code===$.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessMicrophonePermission=!0}else if(h){try{m=await navigator.mediaDevices.getUserMedia({video:r})}catch(_){const S=fE(_.name||_.code||_,_.message);if(S.code===$.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessCameraPermission=!0}A.debug("[device manager] mic permission",n,"cam permission",r)}try{const _=await navigator.mediaDevices.enumerateDevices();return f&&f.getTracks().forEach(S=>S.stop()),m&&m.getTracks().forEach(S=>S.stop()),y&&y.getTracks().forEach(S=>S.stop()),f=null,m=null,y=null,_}catch(_){return f&&f.getTracks().forEach(S=>S.stop()),m&&m.getTracks().forEach(S=>S.stop()),y&&y.getTracks().forEach(S=>S.stop()),f=null,m=null,y=null,new de($.ENUMERATE_DEVICES_FAILED,_.toString()).throw()}}async getRecordingDevices(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,n)).filter(r=>r.kind==="audioinput")}async getCamerasDevices(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,n)).filter(r=>r.kind==="videoinput")}async getSpeakers(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,n)).filter(r=>r.kind==="audiooutput")}searchDeviceIdByName(n){let r=null;return this.deviceInfoMap.forEach(i=>{i.device.label===n&&(r=i.device.deviceId)}),r}async getDeviceById(n){const r=(await this.enumerateDevices(!0,!0,!0)).find(i=>i.deviceId===n);if(!r)throw new de($.DEVICE_NOT_FOUND,"deviceId: ".concat(n));return r}async init(){this.state=Om.INITING;try{await this.updateDevicesInfo(),this.state=Om.INITEND}catch(n){throw A.warning("Device Detection functionality cannot start properly.",n.toString()),this.state=Om.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new de($.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),n}}async updateDevicesInfo(){const n=await this.enumerateDevices(!0,!0,!0),r=Date.now(),i=[];if(n[0]&&n[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const c=n.find(h=>h.kind==="audioinput"&&h.deviceId==="default"),u=n.find(h=>h.kind==="audiooutput"&&h.deviceId==="default");c&&u?u.groupId===c.groupId?A.debug("[device-check] default input ".concat(c.label," and output ").concat(u.label," is the same group")):A.debug("[device-check] default input ".concat(c.label," and output ").concat(u.label," is not the same group")):A.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(n);if(n.forEach(c=>{if(!c.deviceId)return;const u=this.deviceInfoMap.get("".concat(c.kind,"_").concat(c.deviceId));if((u?u.state:"INACTIVE")!=="ACTIVE"){const h={initAt:r,updateAt:r,device:c,state:"ACTIVE"};this.deviceInfoMap.set("".concat(c.kind,"_").concat(c.deviceId),h),i.push(h)}u&&(u.updateAt=r)}),this.deviceInfoMap.forEach((c,u)=>{c.state==="ACTIVE"&&c.updateAt!==r&&(c.state="INACTIVE",i.push(c))}),this.state!==Om.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));i.forEach(c=>{switch(c.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Iu.RECORDING_DEVICE_CHANGED,c);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Iu.CAMERA_DEVICE_CHANGED,c);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Iu.PLAYOUT_DEVICE_CHANGED,c)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(n){const r=n.filter(c=>c.kind==="audioinput"),i=n.filter(c=>c.kind==="videoinput"),s={audio:!1,video:!1};for(const c of r)if(c.label&&c.deviceId){s.audio=!0;break}for(const c of i)if(c.label&&c.deviceId){s.video=!0;break}return s}};let CO=!1;const ha=new class extends ln{constructor(){super(...arguments),oe(this,"onAutoplayFailed",void 0),oe(this,"onAudioAutoplayFailed",void 0)}};function XB(){if(St(),!CO){const n=r=>{r.preventDefault(),CO=!1,vm()?document.body.removeEventListener("click",n,!0):(document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0))};CO=!0,vm()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)),A.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),ha.onAutoplayFailed?ha.onAutoplayFailed():ha.onAudioAutoplayFailed?A.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):A.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),ha.emit("autoplay-failed")}}function JB(n,r,i,s){if(!n)return;const c=$e.getBaseInfoBySessionId(n);if(!c)return;const u=c.info,h=Date.now(),f=sn(sn({},u),{},{vid:u.vid===void 0?0:Number(u.vid),lts:h,elapse:h-c.startTime,cbRegistered:ha.onAutoplayFailed||ha.onAudioAutoplayFailed?1:-1,errorMsg:i,mediaType:r,trackId:s,extend:void 0});$e.send({type:on.AUTOPLAY_FAILED,data:f},!0)}const Efe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],gi=new class{constructor(){oe(this,"onAutoplayFailed",void 0),oe(this,"elementMap",new Map),oe(this,"elementStateMap",new Map),oe(this,"elementsNeedToResume",[]),oe(this,"sinkIdMap",new Map),oe(this,"autoResumeAfterInterruption",n=>{Array.from(this.elementMap.entries()).forEach(r=>{let[i,s]=r;const c=this.elementStateMap.get(i),u=s.srcObject.getAudioTracks()[0],h=u&&u.readyState;if(A.debug("resume after interrupted, ele: ".concat(c," audio: ").concat(h," ").concat(n)),h==="live"){if(n)return s.pause(),void s.play();if(jt.curState==="running")return mh()?(s.pause(),void s.play()):void(c&&c==="paused"&&s.play())}})}),oe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(n=>{let[r,i]=n;const s=i.srcObject.getAudioTracks()[0];s&&s.readyState==="live"&&(A.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),i.pause(),i.play())})}),this.autoResumeAudioElement(),jt.on(Sr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),jt.on(Sr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),jt.on(Sr.STATE_CHANGE,()=>{ri()&&jt.prevState==="suspended"&&jt.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(n,r){const i=this.elementMap.get(n);if(this.sinkIdMap.set(n,r),i)try{await i.setSinkId(r)}catch(s){throw new de($.PERMISSION_DENIED,"can not set sink id: "+s.toString())}}play(n,r,i,s){if(this.elementMap.has(r))return;const c=document.createElement("audio");c.autoplay=!0,c.srcObject=new MediaStream([n]),this.bindAudioElementEvents(r,c),this.elementMap.set(r,c),this.elementStateMap.set(r,zr.INIT),this.setVolume(r,i);const u=this.sinkIdMap.get(r);if(u)try{c.setSinkId(u).catch(f=>{A.warning("[".concat(r,"] set sink id failed"),f.toString())})}catch(f){A.warning("[".concat(r,"] set sink id failed"),f.toString())}const h=c.play();h&&h.then&&h.catch(f=>{s&&JB(s,"audio",f.message,r),A.warning("audio element play warning",f.toString()),this.elementMap.has(r)&&f.name==="NotAllowedError"&&(A.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(c),nE(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),XB()}))})}updateTrack(n,r){const i=this.elementMap.get(n);i&&(i.srcObject=new MediaStream([r]))}isPlaying(n){return this.elementMap.has(n)&&this.elementStateMap.get(n)==="playing"}setVolume(n,r){const i=this.elementMap.get(n);i&&(r=Math.max(0,Math.min(100,r)),i.volume=r/100)}stop(n){const r=this.elementMap.get(n);if(this.sinkIdMap.delete(n),!r)return;const i=this.elementsNeedToResume.indexOf(r);this.elementsNeedToResume.splice(i,1),r.srcObject=null,r.remove(),this.elementMap.delete(n),this.elementStateMap.delete(n)}bindAudioElementEvents(n,r){Efe.forEach(i=>{r.addEventListener(i,s=>{const c=this.elementStateMap.get(n),u=s.type==="pause"?"paused":s.type;if(A.debug("[".concat(n,"] audio-element-status change ").concat(c," => ").concat(u)),s.type==="error"){const h=r==null?void 0:r.error;h&&A.error("[".concat(n,"] media error, code: ").concat(h.code,", message: ").concat(h.message))}this.elementStateMap.set(n,u)})})}getPlayerState(n){return this.elementStateMap.get(n)||"uninit"}autoResumeAudioElement(){const n=()=>{this.elementsNeedToResume.forEach(r=>{r.play().then(i=>{A.debug("Auto resume audio element success")}).catch(i=>{A.warning("Auto resume audio element failed!",i)})}),this.elementsNeedToResume=[]};new Ie(r=>{document.body?r():window.addEventListener("load",()=>r())}).then(()=>{vm()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0))})}};function Rn(){return function(n,r,i){const s=i.value;return typeof s=="function"&&(i.value=function(){this._isClosed&&new de($.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",A);for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];const f=s.apply(this,u);return f instanceof Ie?new Ie((m,y)=>{f.then(m).catch(y)}):f}),i}}class QB extends ln{constructor(r){super(),oe(this,"name","VideoProcessorDestination"),oe(this,"ID","0"),oe(this,"_source",void 0),oe(this,"videoContext",void 0),oe(this,"inputTrack",void 0),this.videoContext=r}get kind(){return"video"}get enabled(){return!0}pipe(){throw new de($.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new de($.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(r){if(r.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);r.track&&r.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=r.track,this.emit(ii.ON_TRACK,r.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ii.ON_TRACK,void 0)}}class ZB extends ln{set chained(r){this._chained=r}get chained(){return this._chained}constructor(r,i){super(),oe(this,"constraintsMap",new Map),oe(this,"statsRegistry",[]),oe(this,"usageRegistry",[]),oe(this,"trackId",void 0),oe(this,"direction",void 0),oe(this,"_chained",!1),this.trackId=r,this.direction=i}async getConstraints(){return await Or(this,ca.REQUEST_CONSTRAINTS)}async requestApplyConstraints(r,i){var s;return A.info("processor ".concat(i.name," requestApplyConstraints for ").concat(this.trackId)),r&&this.constraintsMap.set(i,r),Kt(this,ca.REQUEST_UPDATE_CONSTRAINTS,Array.from(na(s=this.constraintsMap).call(s)))}async requestRevertConstraints(r){var i;if(this.constraintsMap.has(r))return A.info("processor ".concat(r.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(r),Kt(this,ca.REQUEST_UPDATE_CONSTRAINTS,Array.from(na(i=this.constraintsMap).call(i)))}registerStats(r,i,s){this.statsRegistry.find(c=>c.processorID===r.ID&&c.processorName===r.name&&c.type===i)||this.statsRegistry.push({processorName:r.name,processorID:r.ID,type:i,cb:s})}unregisterStats(r,i){const s=this.statsRegistry.findIndex(c=>c.processorID===r.ID&&c.processorName===r.name&&c.type===i);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const r=[];for(const{processorID:i,processorName:s,type:c,cb:u}of this.statsRegistry)try{const h=u();r.push({processorID:i,processorName:s,type:c,stats:h})}catch(h){A.error(new de($.UNEXPECTED_ERROR,h.message))}return r}registerUsage(r,i){this.usageRegistry.find(s=>s.processorID===r.ID&&s.processorName===r.name)||this.usageRegistry.push({processorID:r.ID,processorName:r.name,cb:i})}unregisterUsage(r){const i=this.usageRegistry.findIndex(s=>s.processorID===r.ID&&s.processorName===r.name);i!==-1&&this.usageRegistry.splice(i,1)}async gatherUsage(){const r=[];if(!this.chained)return[];for(const{cb:i}of this.usageRegistry)try{let s=i();s instanceof Ie&&(s=await s),r.push(sn(sn({},s),{},{direction:this.direction}))}catch(s){A.error("gather extension usage error",s)}return r}getDirection(){return this.direction}}class eF extends ln{constructor(r){super(),oe(this,"name","AudioProcessorDestination"),oe(this,"ID","0"),oe(this,"inputTrack",void 0),oe(this,"inputNode",void 0),oe(this,"audioProcessorContext",void 0),oe(this,"_source",void 0),this.audioProcessorContext=r}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new de($.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new de($.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ii.ON_TRACK,void 0),this.emit(ii.ON_NODE,void 0)}updateInput(r){if(r.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);r.track&&this.inputTrack!==r.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=r.track,this.emit(ii.ON_TRACK,this.inputTrack)),r.node&&this.inputNode!==r.node&&(this.audioProcessorContext.chained=!0,this.inputNode=r.node,this.emit(ii.ON_NODE,this.inputNode))}}class tF extends ln{set chained(r){this._chained=r}get chained(){return this._chained}constructor(r,i,s){super(),oe(this,"constraintsMap",new Map),oe(this,"statsRegistry",[]),oe(this,"audioContext",void 0),oe(this,"trackId",void 0),oe(this,"direction",void 0),oe(this,"usageRegistry",[]),oe(this,"_chained",!1),this.audioContext=r,this.trackId=i,this.direction=s}async getConstraints(){return Or(this,ca.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(r,i){var s;return A.info("processor ".concat(i.name," requestApplyConstraints for ").concat(this.trackId)),r&&this.constraintsMap.set(i,r),Kt(this,ca.REQUEST_UPDATE_CONSTRAINTS,Array.from(na(s=this.constraintsMap).call(s)))}async requestRevertConstraints(r){var i;if(this.constraintsMap.has(r))return this.constraintsMap.delete(r),Kt(this,ca.REQUEST_UPDATE_CONSTRAINTS,Array.from(na(i=this.constraintsMap).call(i)))}registerStats(r,i,s){this.statsRegistry.find(c=>c.processorID===r.ID&&c.processorName===r.name&&c.type===i)||this.statsRegistry.push({processorName:r.name,processorID:r.ID,type:i,cb:s})}unregisterStats(r,i){const s=this.statsRegistry.findIndex(c=>c.processorID===r.ID&&c.processorName===r.name&&c.type===i);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const r=[];for(const{processorID:i,processorName:s,type:c,cb:u}of this.statsRegistry)try{const h=u();r.push({processorID:i,processorName:s,type:c,stats:h})}catch(h){A.error(new de($.UNEXPECTED_ERROR,h.message))}return r}registerUsage(r,i){this.usageRegistry.find(s=>s.processorID===r.ID&&s.processorName===r.name)||this.usageRegistry.push({processorID:r.ID,processorName:r.name,cb:i})}unregisterUsage(r){const i=this.usageRegistry.findIndex(s=>s.processorID===r.ID&&s.processorName===r.name);i!==-1&&this.usageRegistry.splice(i,1)}async gatherUsage(){const r=[];if(!this.chained)return[];for(const{cb:i}of this.usageRegistry)try{let s=i();s instanceof Ie&&(s=await s),r.push(sn(sn({},s),{},{direction:this.direction}))}catch(s){A.error("gather extension usage error",s)}return r}getDirection(){return this.direction}}class RO extends ln{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),oe(this,"context",void 0),oe(this,"processSourceNode",void 0),oe(this,"outputTrack",void 0),oe(this,"processedNode",void 0),oe(this,"clonedTrack",void 0),oe(this,"outputNode",void 0),this.outputNode=new Sfe}setVolume(){}createOutputTrack(){throw new de($.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Sfe{disconnect(){}connect(){}}function nF(n){return new Ie((r,i)=>{let s=!1;const c=document.createElement("video");c.setAttribute("autoplay",""),c.setAttribute("muted",""),c.muted=!0,c.autoplay=!0,c.setAttribute("playsinline",""),c.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(c);const u=ri()?"canplay":"playing";c.addEventListener(u,()=>{const h=c.videoWidth,f=c.videoHeight;!h&&gn()||(s=!0,c.srcObject=null,c.remove(),r([h,f]))}),c.srcObject=new MediaStream([n]),c.play().catch(rE),setTimeout(()=>{s||(c.srcObject=null,c.remove(),r([c.videoWidth,c.videoHeight]))},4e3)})}function pE(n){const r={};n.facingMode&&(r.facingMode=n.facingMode),n.cameraId&&(r.deviceId={exact:n.cameraId});const i=gs(n.encoderConfig);return i.width!=null&&(r.width=i.width),i.height!=null&&(r.height=i.height),!nB()&&i.frameRate&&(r.frameRate=i.frameRate),qV()&&typeof r.frameRate=="object"&&(r.frameRate.max=60),gn()&&(r.frameRate={ideal:30,max:30}),r}function rF(n){const r={};return nB()||(n.AGC!==void 0&&(r.autoGainControl=n.AGC),n.AEC!==void 0&&(r.echoCancellation=n.AEC),n.ANS!==void 0&&(r.noiseSuppression=n.ANS,Xs()&&n.ANS&&(r.googHighpassFilter=n.ANS))),r}function iF(n){const r=rF(n);if(n.encoderConfig){const i=dE(n.encoderConfig);r.channelCount=i.stereo?2:1,r.sampleRate=i.sampleRate,r.sampleSize=i.sampleSize}return n.microphoneId&&(r.deviceId={exact:n.microphoneId}),eE()&&(r.sampleRate=void 0),r}const bfe=n=>{const r=n._encoderConfig;if(!r)return;const{frameRate:i,width:s,height:c}=n.getMediaStreamTrackSettings();let{frameRate:u=i,width:h=s,height:f=c}=r;if(!u||!h||!f)return;h=nO(h),f=nO(f),u=nO(u);const{max:m,min:y}=function(O,W,k){const j=200*Math.pow(k/15,.6)*Math.pow(O*W/640/360,.75);return{min:Math.floor(j),max:Math.floor(4*j)}}(h,f,u),{bitrateMax:_,bitrateMin:S}=r||{};_||A.debug("calculate bitrate: [w: ".concat(h,", h: ").concat(f,", fps: ").concat(u,"] => [brMax: ").concat(_,", brMin: ").concat(S,"]"));const{maxFramerate:w}=Y("ENCODER_CONFIG_LIMIT");return w&&typeof w=="number"&&(u=Math.min(u,w)),{frameRate:u,bitrateMax:_||m,bitrateMin:S||y,scaleResolutionDownBy:1,scale:0}},aF=async(n,r,i)=>await(async(s,c,u)=>{const h=function(y){const _=[];for(let S=0;S<y.length;S+=2)_.push(parseInt(y.slice(S,S+2),16));return Uint8Array.from(_)}(vB(""+c+u)).slice(0,16),f=h.slice(0,12),m=await window.crypto.subtle.importKey("raw",h,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:f},m,s))})(n.buffer,r,i),OO=n=>{const r=document.createElement("canvas");return r.width=2,r.height=2,new Ie((i,s)=>{r.toBlob(async c=>{if(r.remove(),c){const u=await oF(c);i({buffer:u,width:r.width,height:r.height})}else s(new de($.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},n,1)})},oF=async n=>{const r=await n.arrayBuffer();return new Uint8Array(r)};var sF,cF,lF,uF,dF,hF,fF,pF,mF,gF,yF,vF,_F,EF,SF,bF,TF,wF,dn,CF,RF,OF,AF,IF,NF,vs,PF,xF,DF,LF,kF,MF,UF,jF,VF,BF,FF,WF,GF,Ir;let vn=(sF=Xe({argsMap:(n,r)=>[n.getTrackId(),r],throttleTime:300}),cF=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),lF=Rn(),uF=vh("LocalAudioTrack","_enabledMutex"),dF=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),hF=Rn(),fF=vh("LocalAudioTrack","_enabledMutex"),pF=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),mF=Rn(),gF=Rn(),yF=Rn(),vF=Xe({argsMap:n=>[n.getTrackId()]}),_F=Rn(),EF=Xe({argsMap:n=>[n.getTrackId()]}),SF=Rn(),bF=Xe({argsMap:n=>[n.getTrackId()]}),TF=Xe({argsMap:(n,r)=>[n.getTrackId(),r.name]}),wF=Xe({argsMap:n=>[n.getTrackId()]}),Et((dn=class extends Rh{get _source(){return this.initWebAudio()}set _source(n){this._trackSource=n}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?gi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(n,r,i,s){super(n,i),oe(this,"trackMediaType",Ch.AUDIO),oe(this,"_encoderConfig",void 0),oe(this,"_trackSource",void 0),oe(this,"metadata",[]),oe(this,"_enabled",!0),oe(this,"_volume",100),oe(this,"_useAudioElement",!0),oe(this,"_bypassWebAudio",!1),oe(this,"processor",void 0),oe(this,"_processorContext",void 0),oe(this,"_processorDestination",void 0),oe(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=r,this._getOriginVolumeLevel=!!s,this._trackSource=new RO,Y("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),Y("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),Cr()&&!la?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(n){Bt(n,"volume",0,1e3),this._volume=n,this._source.setVolume(n/100),this._useAudioElement&&gi.setVolume(this.getTrackId(),n);try{if(this._bypassWebAudio)return void A.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const r=this._source.createOutputTrack();this._mediaStreamTrack!==r&&(this._mediaStreamTrack=r,Kt(this,je.NEED_REPLACE_TRACK,this).then(()=>{A.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(i=>{A.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),i)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(n){if(!this._useAudioElement||!kB())throw new de($.NOT_SUPPORTED,"your browser does not support setting the audio output device");await gi.setSinkID(this.getTrackId(),n)}async setEnabled(n,r,i){return this._setEnabled(n,r,i)}async _setEnabled(n,r,i){if(!i){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),n),n){this._originMediaStreamTrack.enabled=!0;try{i||(this._enabled=!0),await Kt(this,je.NEED_ENABLE_TRACK,this),A.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(n," success"))}catch(s){throw i||(this._enabled=!1),A.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}}else{this._originMediaStreamTrack.enabled=!1,i||(this._enabled=!1);try{await Kt(this,je.NEED_DISABLE_TRACK,this)}catch(s){throw i||(this._enabled=!0),A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}}}async setMuted(n){n!==this._muted&&(this.stateCheck("muted",n),this._muted=n,this._originMediaStreamTrack.enabled=!n,A.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(n)),n?await Kt(this,je.NEED_MUTE_TRACK,this):await Kt(this,je.NEED_UNMUTE_TRACK,this))}getStats(){return Yc(()=>{A.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),ia(this,je.GET_STATS)||sn({},_O)}setAudioFrameCallback(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(sa.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(sa.ON_AUDIO_BUFFER),this._source.on(sa.ON_AUDIO_BUFFER,i=>n(i))}play(){A.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(A.debug("[".concat(this.getTrackId(),"] start audio playback in element")),gi.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){A.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?gi.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];A.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&gi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(n,r){this._originMediaStreamTrack!==n&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),n.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=n,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:n,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Kt(this,je.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(n))}renewMediaStreamTrack(n){return Ie.resolve(void 0)}pipe(n){if(this._bypassWebAudio)throw new de($.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===n)return n;if(n._source)throw new de($.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(!this.processor)return;const r=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(n){n.on(ii.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r),await Kt(this,je.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Kt(this,je.NEED_REPLACE_TRACK,this))}),n.on(ii.ON_NODE,r=>{this._source.processedNode=r})}unbindProcessorDestinationEvents(n){n.removeAllListeners(ii.ON_TRACK),n.removeAllListeners(ii.ON_NODE)}bindProcessorContextEvents(n){n.on(ca.REQUEST_CONSTRAINTS,async r=>{r(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(n){n.removeAllListeners(ca.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof RO&&(this._trackSource=new HB(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const n=new tF(this._source.context,this.getTrackId(),"local"),r=new eF(n);return this._processorContext=n,this._processorDestination=r,this.bindProcessorContextEvents(n),this.bindProcessorDestinationEvents(r),this._source.on(sa.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:n})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(gi.stop(this.getTrackId()),this._source.play()),Kt(this,je.NEED_REPLACE_MIXING_TRACK,this).then(()=>{A.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(i=>{A.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),i)})),{processorContext:n,processorDestination:r}}}).prototype,"setVolume",[sF],Object.getOwnPropertyDescriptor(dn.prototype,"setVolume"),dn.prototype),Et(dn.prototype,"setPlaybackDevice",[cF,lF],Object.getOwnPropertyDescriptor(dn.prototype,"setPlaybackDevice"),dn.prototype),Et(dn.prototype,"setEnabled",[uF,dF,hF],Object.getOwnPropertyDescriptor(dn.prototype,"setEnabled"),dn.prototype),Et(dn.prototype,"setMuted",[fF,pF,mF],Object.getOwnPropertyDescriptor(dn.prototype,"setMuted"),dn.prototype),Et(dn.prototype,"getStats",[gF],Object.getOwnPropertyDescriptor(dn.prototype,"getStats"),dn.prototype),Et(dn.prototype,"setAudioFrameCallback",[yF],Object.getOwnPropertyDescriptor(dn.prototype,"setAudioFrameCallback"),dn.prototype),Et(dn.prototype,"play",[vF,_F],Object.getOwnPropertyDescriptor(dn.prototype,"play"),dn.prototype),Et(dn.prototype,"stop",[EF,SF],Object.getOwnPropertyDescriptor(dn.prototype,"stop"),dn.prototype),Et(dn.prototype,"close",[bF],Object.getOwnPropertyDescriptor(dn.prototype,"close"),dn.prototype),Et(dn.prototype,"pipe",[TF],Object.getOwnPropertyDescriptor(dn.prototype,"pipe"),dn.prototype),Et(dn.prototype,"unpipe",[wF],Object.getOwnPropertyDescriptor(dn.prototype,"unpipe"),dn.prototype),dn),mE=(CF=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),RF=Rn(),OF=vh("MicrophoneAudioTrack","_enabledMutex"),AF=Xe({argsMap:(n,r,i)=>[n.getTrackId(),r,i]}),IF=Rn(),NF=Xe({argsMap:n=>[n.getTrackId()]}),Et((vs=class extends vn{get __className__(){return"MicrophoneAudioTrack"}constructor(n,r,i,s){super(n,r.encoderConfig?dE(r.encoderConfig):{},s,Y("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),oe(this,"_config",void 0),oe(this,"_deviceName","default"),oe(this,"_constraints",void 0),oe(this,"_originalConstraints",void 0),oe(this,"_enabled",!0),this._config=r,this._constraints=i,this._originalConstraints=i,this._deviceName=n.label,typeof r.bypassWebAudio=="boolean"&&(this._bypassWebAudio=r.bypassWebAudio),(mh()||q0())&&jt.bindInterruptDetectorTrack(this)}async setDevice(n){if(A.info("[".concat(this.getTrackId(),"] start set device to ").concat(n)),this._enabled)try{const r=await da.getDeviceById(n),i={};i.audio=sn({},this._constraints),i.audio.deviceId={exact:n},this._originMediaStreamTrack.stop();let s=null;try{s=await ua(i,this.getTrackId())}catch(c){throw A.error("[".concat(this.getTrackId(),"] setDevice failed"),c.toString()),s=await ua({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),c}await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),this._deviceName=r.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(r){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await da.getDeviceById(n);this._deviceName=r.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(r){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}A.info("[".concat(this.getTrackId(),"] set device to ").concat(n," success"))}async setEnabled(n,r,i){if(r)return A.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(n);if(!i){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),n),Y("AUTO_RESET_AUDIO_ROUTE")&&(ri()||Za())){const h=navigator.audioSession;h&&(n||(h.type="playback"),h.type="auto")}if(!n){var s;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(s=this._source.clonedTrack)===null||s===void 0||s.stop(),i||(this._enabled=!1);try{await Kt(this,je.NEED_DISABLE_TRACK,this)}catch(h){throw A.error("[".concat(this.getTrackId(),"] setEnabled false failed"),h.toString()),h}return}const c=sn({},this._constraints),u=da.searchDeviceIdByName(this._deviceName);u&&!c.deviceId&&(c.deviceId=u);try{i||(this._enabled=!0);const h=await ua({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(h.getAudioTracks()[0],!1),await Kt(this,je.NEED_ENABLE_TRACK,this)}catch(h){throw i||(this._enabled=!1),A.error("[".concat(this.getTrackId(),"] setEnabled true failed"),h.toString()),h}A.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(mh()||q0())&&jt.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((ri()||Za())&&this._enabled&&!this._isClosed&&jt.duringInterruption){const n=async()=>{jt.off(Sr.IOS_INTERRUPTION_END,n),this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};jt.on(Sr.IOS_INTERRUPTION_END,n)}else A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Th.TRACK_ENDED)}async renewMediaStreamTrack(n){const r=n||this._constraints,i=da.searchDeviceIdByName(this._deviceName);if(i&&!r.deviceId&&(r.deviceId=i),this._constraints=r,this._enabled){this._originMediaStreamTrack.stop();const s=await ua({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!0)}}bindProcessorContextEvents(n){super.bindProcessorContextEvents(n),n.on(ca.REQUEST_UPDATE_CONSTRAINTS,async(r,i,s)=>{try{const c=Object.assign({},this._originalConstraints,...r);await this.renewMediaStreamTrack(c),i()}catch(c){s(c)}})}unbindProcessorContextEvents(n){super.unbindProcessorContextEvents(n),n.removeAllListeners(ca.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[CF,RF],Object.getOwnPropertyDescriptor(vs.prototype,"setDevice"),vs.prototype),Et(vs.prototype,"setEnabled",[OF,AF,IF],Object.getOwnPropertyDescriptor(vs.prototype,"setEnabled"),vs.prototype),Et(vs.prototype,"close",[NF],Object.getOwnPropertyDescriptor(vs.prototype,"close"),vs.prototype),vs),Tfe=(PF=Xe({argsMap:(n,r)=>[n.getTrackId(),r,n.duration]}),xF=Rn(),DF=Xe({argsMap:n=>[n.getTrackId()]}),LF=Rn(),kF=Xe({argsMap:n=>[n.getTrackId()]}),MF=Rn(),UF=Xe({argsMap:n=>[n.getTrackId()]}),jF=Rn(),VF=Xe({argsMap:n=>[n.getTrackId()]}),BF=Rn(),FF=Xe({argsMap:n=>[n.getTrackId()]}),WF=Xe({argsMap:n=>[n.getTrackId()]}),GF=Rn(),Et((Ir=class extends vn{get __className__(){return"BufferSourceAudioTrack"}constructor(n,r,i,s){super(r.createOutputTrack(),i,s),oe(this,"source",void 0),oe(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=n,this._bufferSource=r,this._bufferSource.on(sa.AUDIO_SOURCE_STATE_CHANGE,c=>{this.safeEmit(Th.SOURCE_STATE_CHANGE,c)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(n){n&&this._bufferSource.updateOptions(n),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(n){this._bufferSource.seekAudioBuffer(n)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(n){Bt(n,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(n)}}).prototype,"startProcessAudioBuffer",[PF,xF],Object.getOwnPropertyDescriptor(Ir.prototype,"startProcessAudioBuffer"),Ir.prototype),Et(Ir.prototype,"pauseProcessAudioBuffer",[DF,LF],Object.getOwnPropertyDescriptor(Ir.prototype,"pauseProcessAudioBuffer"),Ir.prototype),Et(Ir.prototype,"seekAudioBuffer",[kF,MF],Object.getOwnPropertyDescriptor(Ir.prototype,"seekAudioBuffer"),Ir.prototype),Et(Ir.prototype,"resumeProcessAudioBuffer",[UF,jF],Object.getOwnPropertyDescriptor(Ir.prototype,"resumeProcessAudioBuffer"),Ir.prototype),Et(Ir.prototype,"stopProcessAudioBuffer",[VF,BF],Object.getOwnPropertyDescriptor(Ir.prototype,"stopProcessAudioBuffer"),Ir.prototype),Et(Ir.prototype,"close",[FF],Object.getOwnPropertyDescriptor(Ir.prototype,"close"),Ir.prototype),Et(Ir.prototype,"setAudioBufferPlaybackSpeed",[WF,GF],Object.getOwnPropertyDescriptor(Ir.prototype,"setAudioBufferPlaybackSpeed"),Ir.prototype),Ir);class qn extends vn{get __className__(){return"MixingAudioTrack"}get isActive(){for(const r of this.trackList)if(r._enabled&&!r._isClosed&&!r.muted)return!0;return!1}constructor(){const r=Oh().createMediaStreamDestination();super(r.stream.getAudioTracks()[0],void 0,qt(8,"track-mix-")),oe(this,"trackList",void 0),oe(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=r,this.trackList=[]}hasAudioTrack(r){return this.trackList.indexOf(r)!==-1}addAudioTrack(r){this.trackList.indexOf(r)===-1?(A.debug("add ".concat(r.getTrackId()," to mixing track")),r._source.outputNode.connect(this.destNode),this.trackList.push(r),this.updateEncoderConfig()):A.debug("track ".concat(r.getTrackId()," is already added"))}removeAudioTrack(r){if(this.trackList.indexOf(r)!==-1){A.debug("remove ".concat(r.getTrackId()," from mixing track"));try{r._source.outputNode.disconnect(this.destNode)}catch{}tE(this.trackList,r),this.updateEncoderConfig()}}updateEncoderConfig(){const r={};this.trackList.forEach(i=>{i._encoderConfig&&((i._encoderConfig.bitrate||0)>(r.bitrate||0)&&(r.bitrate=i._encoderConfig.bitrate),(i._encoderConfig.sampleRate||0)>(r.sampleRate||0)&&(r.sampleRate=i._encoderConfig.sampleRate),(i._encoderConfig.sampleSize||0)>(r.sampleSize||0)&&(r.sampleSize=i._encoderConfig.sampleSize),i._encoderConfig.stereo&&(r.stereo=!0))}),this._encoderConfig=r}_updateRtpTransceiver(r){this._rtpTransceiver!==r&&(this._rtpTransceiver=r,this.trackList.forEach(i=>{i instanceof qn?i.emit(Au.TRANSCEIVER_UPDATED,r):i._updateRtpTransceiver(r)}))}}class wfe extends $B{set currentState(r){r!==this._currentState&&(this._currentState=r,this.safeEmit(sa.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),oe(this,"audioBuffer",void 0),oe(this,"sourceNode",void 0),oe(this,"startPlayTime",0),oe(this,"startPlayOffset",0),oe(this,"pausePlayTime",0),oe(this,"options",void 0),oe(this,"currentLoopCount",0),oe(this,"currentPlaybackSpeed",100),oe(this,"_currentState","stopped"),this.audioBuffer=r,this.options=i,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(r){this.currentState==="stopped"?(this.options=r,this.startPlayOffset=this.options.startPlayTime||0):A.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(r){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=r,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=r))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(r){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=r/100),this.currentPlaybackSpeed=r}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const r=this.context.createBufferSource();return r.buffer=this.audioBuffer,r.loop=!!this.options.loop,r.connect(this.outputNode),r.playbackRate.value=this.currentPlaybackSpeed/100,r}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const $F=new Map;class AO{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const r=this.renderStats.curTs-this.renderStats.lastTs,i=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/r;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,i}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(r){r!==this._videoElementStatus&&(A.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(r)),this._videoElementStatus=r)}get videoState(){return this._videoState}set videoState(r){var i;r!==this._videoState&&(this._videoState=r,(i=this.onVideoStateChanged)===null||i===void 0||i.call(this,this.videoState))}constructor(r){oe(this,"trackId",void 0),oe(this,"config",void 0),oe(this,"onFirstVideoFrameDecoded",void 0),oe(this,"onVideoStateChanged",void 0),oe(this,"freezeTimeCounterList",[]),oe(this,"renderFreezeAccTime",0),oe(this,"isKeepLastFrame",!1),oe(this,"timeUpdatedCount",0),oe(this,"freezeTime",0),oe(this,"playbackTime",0),oe(this,"lastTimeUpdatedTime",0),oe(this,"autoplayFailed",!1),oe(this,"videoTrack",void 0),oe(this,"videoElement",void 0),oe(this,"cacheVideoElement",void 0),oe(this,"renderStats",void 0),oe(this,"_videoState",ys.VideoStateStopped),oe(this,"videoElementCheckInterval",void 0),oe(this,"videoElementFreezeTimeout",void 0),oe(this,"_videoElementStatus",zr.NONE),oe(this,"isGettingVideoDimensions",!1),oe(this,"startGetVideoDimensions",()=>{const i=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return A.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(i,500)};!this.isGettingVideoDimensions&&i()}),oe(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&jt.curState==="running"&&(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(KV())),eB()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),oe(this,"handleVideoEvents",i=>{switch(i.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=zr.PLAYING;break;case"loadeddata":if(this.videoState=ys.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=zr.CANPLAY;break;case"stalled":this.videoElementStatus=zr.STALLED;break;case"suspend":this.videoElementStatus=zr.SUSPEND;break;case"pause":this.videoElementStatus=zr.PAUSED,ri()||Za()||Cr()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=zr.WAITING;break;case"abort":this.videoElementStatus=zr.ABORT;break;case"ended":this.videoElementStatus=zr.ENDED;break;case"emptied":this.videoElementStatus=zr.EMPTIED;break;case"error":{const s=this.videoElement.error;s&&(this.videoElementStatus=zr.ERROR,A.error("[".concat(this.trackId,"] media error: ").concat(s.message," (").concat(s.code,")")));break}case"timeupdate":{const s=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=s);const c=s-this.lastTimeUpdatedTime,u=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=s,ec.lastVisibleTime<ec.lastHiddenTime||u<ec.lastHiddenTime||u<ec.lastVisibleTime)return;for(c>Y("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=c),this.playbackTime+=c;this.playbackTime>=6e3;){this.playbackTime-=6e3;const h=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(h),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),oe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(KV())),eB()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=r.trackId,this.config=r,r.element instanceof HTMLVideoElement?this.videoElement=r.element:this.videoElement=document.createElement("video"),jt.on(Sr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),jt.on(Sr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var r;return(r=this.videoElement.parentElement)!==null&&r!==void 0?r:void 0}updateConfig(r){this.config=r,this.trackId=r.trackId,r.element!==this.videoElement&&(this.destroy(),this.videoElement=r.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(r){this.videoTrack!==r&&(this.videoTrack=r,this.initVideoElement())}play(r){const i=this.videoElement.play();i&&i.catch&&i.catch(c=>{r&&JB(r,"video",c.message,this.trackId),c.name==="NotAllowedError"?(A.warning("detected video element autoplay failed",c),this.autoplayFailed=!0,this.handleAutoPlayFailed()):A.warning("[".concat(this.trackId,"] play warning: "),c)});const s=St();if((s.name==="Safari"&&Number(s.version)===15||mh())&&i&&i.then){const c=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};i.then(c).catch(c)}}getCurrentFrame(){const r=document.createElement("canvas");r.width=this.videoElement.videoWidth,r.height=this.videoElement.videoHeight;const i=r.getContext("2d");if(!i)return A.error("create canvas context failed!"),new ImageData(2,2);i.drawImage(this.videoElement,0,0,r.width,r.height);const s=i.getImageData(0,0,r.width,r.height);return r.remove(),s}async getCurrentFrameToUint8Array(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const c=s.getContext("2d");return c?(c.drawImage(this.videoElement,0,0,s.width,s.height),new Ie((u,h)=>{s.toBlob(async f=>{if(s.remove(),f){const m=await oF(f);u({buffer:m,width:s.width,height:s.height})}else h(new de($.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},r,i<0?.1:i>1?1:i)})):await OO(r)}destroy(){this.renderStats=void 0,jt.off(Sr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),jt.off(Sr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=ys.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=zr.INIT,!this.videoElementCheckInterval&&(HF.forEach(u=>{this.videoElement.addEventListener(u,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(u){return u!==document.body&&document.body.contains(u)})(this.videoElement)||(this.videoElementStatus=zr.DESTROYED)},1e3),Y("ENABLE_VIDEO_FRAME_CALLBACK"))){var r,i;let u;const h=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",h),this.videoElementFreezeTimeout=window.setTimeout(f,Y("VIDEO_FREEZE_DURATION")))},f=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===ys.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=ys.VideoStateFrozen:document.addEventListener("visibilitychange",h))},m=(y,_)=>{if(this.videoElementStatus===zr.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=_.mediaTime):this.renderStats={lastTs:_.mediaTime,curTs:_.mediaTime,lastRenderNum:0,renderNum:0},u){const O=_.presentationTime-u.presentationTime;this.videoState===ys.VideoStateStarting&&(this.videoState=ys.VideoStateDecoding),this.videoState===ys.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(f,Y("VIDEO_FREEZE_DURATION"))),O<Y("VIDEO_FREEZE_DURATION")&&this.videoState===ys.VideoStateFrozen&&(this.videoState=ys.VideoStateDecoding),O>Y("VIDEO_FREEZE_DURATION")&&ec.lastVisibleTime>=ec.lastHiddenTime&&u.timestamp>ec.lastVisibleTime&&u.timestamp>ec.lastHiddenTime&&(this.renderFreezeAccTime+=O)}u=sn(sn({},_),{},{timestamp:y})}var S,w;Y("ENABLE_VIDEO_FRAME_CALLBACK")&&((S=(w=this.videoElement).requestVideoFrameCallback)===null||S===void 0||S.call(w,m))};(r=(i=this.videoElement).requestVideoFrameCallback)===null||r===void 0||r.call(i,m)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),eE()&&!Y("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const s=St();s.name==="Safari"&&Number(s.version)===15||mh()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,gn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,gn()&&this.videoElement.load());const c=this.videoElement.play();c!==void 0&&c.catch(u=>{A.debug("[".concat(this.trackId,"] playback interrupted"),u.toString())})}resetVideoElement(){HF.forEach(r=>{this.videoElement&&this.videoElement.removeEventListener(r,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=zr.NONE}handleAutoPlayFailed(){const r=i=>{i.preventDefault(),this.videoElement.play().then(()=>{A.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(s=>{A.error(s)}),this.autoplayFailed=!1,vm()?document.body.removeEventListener("click",r,!0):(document.body.removeEventListener("touchstart",r,!0),document.body.removeEventListener("mousedown",r,!0))};vm()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0)),XB()}}const HF=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class zF extends AO{constructor(r){super(r),oe(this,"container",void 0),oe(this,"slot",void 0),this.slot=r.element,this.updateConfig(r)}updateConfig(r){this.config=r,this.trackId=r.trackId;const i=r.element;i!==this.slot&&(this.destroy(),this.slot=i),this.createElements()}updateVideoTrack(r){this.videoTrack!==r&&(this.videoTrack=r,this.createElements())}play(r){var i;(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)&&super.play(r)}getCurrentFrame(){var r;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(r){var i;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(r,s):await OO(r)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Y("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var r;!this.container||(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var r;if((r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var KF,qF,YF,XF,JF,QF,ZF,e3,t3,n3,r3,i3,a3,o3,s3,c3,l3,u3,d3,h3,f3,p3,m3,g3,gt,y3,v3,_3,E3,S3,b3,T3,w3,fa;let tn=(KF=Xe({argsMap:(n,r,i)=>[n.getTrackId(),typeof r=="string"?r:r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),qF=Rn(),YF=Xe({argsMap:n=>[n.getTrackId()]}),XF=vh("LocalVideoTrack","_enabledMutex"),JF=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),QF=Rn(),ZF=vh("LocalVideoTrack","_enabledMutex"),e3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),t3=Rn(),n3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),r3=Rn(),i3=Rn(),a3=Xe({argsMap:(n,r,i)=>[n.getTrackId(),r,i]}),o3=Rn(),s3=Rn(),c3=Rn(),l3=Rn(),u3=Rn(),d3=Rn(),h3=Rn(),f3=Xe({argsMap:(n,r)=>[n.getTrackId(),r.name]}),p3=Xe({argsMap:n=>[n.getTrackId()]}),m3=Xe({argsMap:n=>[n.getTrackId()]}),g3=Xe({argsMap:(n,r,i)=>[n.getTrackId(),r.label,i]}),gt=class g9 extends Rh{get videoHeight(){if(Cr()){const{height:r}=this._mediaStreamTrack.getSettings();return this._videoHeight=r,this._videoHeight}return this._videoHeight}get videoWidth(){if(Cr()){const{width:r}=this._mediaStreamTrack.getSettings();return this._videoWidth=r,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==zr.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(r){this._processorContext=r}get __className__(){return"LocalVideoTrack"}constructor(r,i,s,c,u,h){if(super(r,u),oe(this,"trackMediaType",Ch.VIDEO),oe(this,"_player",void 0),oe(this,"isUseScaleResolutionDownBy",!1),oe(this,"_videoVisibleTimer",null),oe(this,"_previousVideoVisibleStatus",void 0),oe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),oe(this,"_encoderConfig",void 0),oe(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),oe(this,"_optimizationMode",void 0),oe(this,"_videoHeight",void 0),oe(this,"_videoWidth",void 0),oe(this,"_forceBitrateLimit",void 0),oe(this,"_enabled",!0),oe(this,"_processorDestination",void 0),oe(this,"_processorContext",void 0),Cr()){const{width:f,height:m}=r.getSettings();this._videoWidth=f,this._videoHeight=m}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=i,this._scalabilityMode=s,this._optimizationMode=c,this._hints=h||[],this._hints.indexOf(Yt.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(H0(Nt.CHROME,115)&&Q_().indexOf("Windows")!==-1){const f=function(m,y){if("VideoFrame"in window&&"TransformStream"in window&&bt().supportWebRTCInsertableStream){const _=new MediaStreamTrackProcessor(m),S=new MediaStreamTrackGenerator({kind:"video"});let w,O,W=Date.now();const k=()=>{j&&(clearInterval(j),j=void 0),w&&(w.close(),w=void 0),m.stop(),O=void 0,S.removeEventListener("ended",k)};let j=window.setInterval(()=>{if(O&&w&&Date.now()-W>1e3)try{S.readyState==="live"?O.enqueue(w.clone()):k()}catch{k()}},1e3);const H=new TransformStream({transform:(K,Q)=>{S.readyState==="live"?(O=Q,W=Date.now(),w===void 0?(w=K,Q.enqueue(K.clone())):(Q.enqueue(w),w=K)):K.close()}});return S.addEventListener("ended",k),_.readable.pipeThrough(H).pipeTo(S.writable),S}}(r);f&&(A.info("local screen video track begin to inject frame"),this._mediaStreamTrack=f)}i&&this._hints.indexOf(Yt.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(i),this._processorContext=new ZB(this.getTrackId(),"local"),this._processorDestination=new QB(this.processorContext),this.bindProcessorDestinationEvents()}play(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof r=="string"){const c=document.getElementById(r);c?r=c:(A.warning("[".concat(this.getTrackId(),'] can not find "#').concat(r,'" element, use document.body')),r=document.body)}A.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(i));const s=sn(sn(sn({},this._getDefaultPlayerConfig()),i),{},{trackId:this.getTrackId(),element:r});this._player?this._player.updateConfig(s):(r instanceof HTMLVideoElement?this._player=new AO(s):this._player=new zF(s),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.safeEmit(Th.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},Y("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,A.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(r,i){if(!i){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),r),!r){this._originMediaStreamTrack.enabled=!1;try{await Kt(this,je.NEED_DISABLE_TRACK,this)}catch(s){throw A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}return i||(this._enabled=!1),void A.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Kt(this,je.NEED_ENABLE_TRACK,this)}catch(s){throw A.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}A.info("[".concat(this.getTrackId(),"] setEnabled to true success")),i||(this._enabled=!0)}async setMuted(r){r!==this._muted&&(this.stateCheck("muted",r),this._muted=r,this._originMediaStreamTrack.enabled=!r,A.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(r)),r?await Kt(this,je.NEED_MUTE_TRACK,this):await Kt(this,je.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(r,i){if(!this._enabled)throw new de($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(r=gs(r),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:r.bitrateMin),r.width||r.height||r.frameRate){const s=pE({encoderConfig:r});(Cr()||ri()||Za())&&(s.deviceId=void 0),A.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(r),JSON.stringify(s));try{await this._originMediaStreamTrack.applyConstraints(s),this.updateMediaStreamTrackResolution()}catch(c){const u=new de($.UNEXPECTED_ERROR,c.toString());throw A.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}}this._encoderConfig=r,this._hints.indexOf(Yt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Kt(this,je.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(A)}}getStats(){return Yc(()=>{A.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),ia(this,je.GET_STATS)||sn({},EO)}async setBeautyEffect(r){A.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(r,i):await OO(r)}async setBitrateLimit(r){A.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(r))),r&&(this._forceBitrateLimit=r,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<r.max_bitrate?this._encoderConfig.bitrateMax:r.max_bitrate:this._encoderConfig.bitrateMax=r.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=r.min_bitrate))}async setOptimizationMode(r){if(r!=="motion"&&r!=="detail"&&r!=="balanced")return void A.error($.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const i=this._optimizationMode;try{this._optimizationMode=r,await Kt(this,je.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(s){throw this._optimizationMode=i,A.error("[".concat(this.getTrackId(),"] set optimization mode failed"),s.toString()),s}A.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(r,")"))}setScalabiltyMode(r){if(r.numSpatialLayers===1&&r.numTemporalLayers!==1)return A.error($.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=r,A.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(r,")"))}updateMediaStreamTrackResolution(){nF(this._originMediaStreamTrack).then(r=>{let[i,s]=r;this._videoHeight=s,this._videoWidth=i}).catch(rE)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(r){if(!this._enabled)throw new de($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");A.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(r)),r=gs(r),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:r.bitrateMin),this._encoderConfig=r,this._hints.indexOf(Yt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Kt(this,je.NEED_UPDATE_VIDEO_ENCODER,this)}catch(i){return i.throw(A)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:r,height:i,frameRate:s}=this.getMediaStreamTrackSettings();if(!r||!i||!s)return;const{bitrateMax:c,bitrateMin:u}=this._encoderConfig;if(u==null||c==null){const{max:h,min:f}=function(m,y,_,S,w){const O=Y("BITRATE_ADAPTER_TYPE");if(O==="DEFAULT_BITRATE")return{min:S,max:w};if(w===void 0){var W;const j=Math.floor(200*Math.pow(_/15,.6)*Math.pow(m*y/640/360,.75));w=O==="STANDARD_BITRATE"?4*j:2*j,S=(W=S)!==null&&W!==void 0?W:j}else{var k;S=(k=S)!==null&&k!==void 0?k:Math.floor(w/10)}return{min:S,max:w}}(r,i,s,u,c);this._encoderConfig.bitrateMin=f,this._encoderConfig.bitrateMax=h,A.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(r,", h: ").concat(i,", fps: ").concat(s,"] => [brMax: ").concat(h,", brMin: ").concat(f,"]"))}}getVideoElementVisibleStatus(){try{var r,i;const s=this==null||(r=this._player)===null||r===void 0?void 0:r.getContainerElement(),c={track:this,element:this==null||(i=this._player)===null||i===void 0?void 0:i.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:u,slot:h}=c;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const f=aB.checkOneElementVisible(u),m=Object.assign({},f);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const y=$e.reportApiInvoke(null,{tag:fn.TRACER,name:Wn.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?y.onSuccess("Video is visible"):y.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(s){throw new de($.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}async renewMediaStreamTrack(r){}pipe(r){if(this.processor===r)return r;if(r._source)throw new de($.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),r}unpipe(){if(!this.processor)return;const r=this.processor;this.processor._source=void 0,this.processor=void 0,r.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;r&&(s=sn(sn({},s),gs(r))),s=wu(s);const c=qt(8,"track-video-cloned-"),u=new g9(i?this._mediaStreamTrack.clone():this._mediaStreamTrack,s,wu(this._scalabilityMode),this._optimizationMode,c,wu(this._hints));return r&&s&&u.setEncoderConfiguration(s),A.debug("clone video track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(i)),u}async replaceTrack(r,i){if(!(r instanceof MediaStreamTrack))throw new de($.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(r.kind!=="video")throw new de($.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(r,i,!0),this.updateMediaStreamTrackResolution()}sendSeiData(r){if(Yc(()=>{$e.reportApiInvoke(null,{name:Wn.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:fn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!Y("ENABLE_VIDEO_SEI")||!Y("ENABLE_ENCODED_TRANSFORM"))return void A.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(r instanceof Uint8Array==0)return new de($.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const i=this.getRTCRtpTransceiver();if(!i)return void A.warning("Video track is not published, SEI can not be send");const s=i.sender.getParameters();if(s.codecs.length===0)return;const c=s.codecs[0].mimeType.toLocaleLowerCase();c==="video/h264"?this.safeEmit("sei-to-send",r):A.warning("SEI is not supported by ".concat(c))}bindProcessorDestinationEvents(){this.processorDestination.on(ii.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(),await Kt(this,je.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Kt(this,je.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ii.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(ca.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(ca.REQUEST_CONSTRAINTS)}},Et(gt.prototype,"play",[KF,qF],Object.getOwnPropertyDescriptor(gt.prototype,"play"),gt.prototype),Et(gt.prototype,"stop",[YF],Object.getOwnPropertyDescriptor(gt.prototype,"stop"),gt.prototype),Et(gt.prototype,"setEnabled",[XF,JF,QF],Object.getOwnPropertyDescriptor(gt.prototype,"setEnabled"),gt.prototype),Et(gt.prototype,"setMuted",[ZF,e3,t3],Object.getOwnPropertyDescriptor(gt.prototype,"setMuted"),gt.prototype),Et(gt.prototype,"setEncoderConfiguration",[n3,r3],Object.getOwnPropertyDescriptor(gt.prototype,"setEncoderConfiguration"),gt.prototype),Et(gt.prototype,"getStats",[i3],Object.getOwnPropertyDescriptor(gt.prototype,"getStats"),gt.prototype),Et(gt.prototype,"setBeautyEffect",[a3,o3],Object.getOwnPropertyDescriptor(gt.prototype,"setBeautyEffect"),gt.prototype),Et(gt.prototype,"getCurrentFrameData",[s3],Object.getOwnPropertyDescriptor(gt.prototype,"getCurrentFrameData"),gt.prototype),Et(gt.prototype,"getCurrentFrameImage",[c3],Object.getOwnPropertyDescriptor(gt.prototype,"getCurrentFrameImage"),gt.prototype),Et(gt.prototype,"setBitrateLimit",[l3],Object.getOwnPropertyDescriptor(gt.prototype,"setBitrateLimit"),gt.prototype),Et(gt.prototype,"setOptimizationMode",[u3],Object.getOwnPropertyDescriptor(gt.prototype,"setOptimizationMode"),gt.prototype),Et(gt.prototype,"setScalabiltyMode",[d3],Object.getOwnPropertyDescriptor(gt.prototype,"setScalabiltyMode"),gt.prototype),Et(gt.prototype,"updateMediaStreamTrackResolution",[h3],Object.getOwnPropertyDescriptor(gt.prototype,"updateMediaStreamTrackResolution"),gt.prototype),Et(gt.prototype,"pipe",[f3],Object.getOwnPropertyDescriptor(gt.prototype,"pipe"),gt.prototype),Et(gt.prototype,"unpipe",[p3],Object.getOwnPropertyDescriptor(gt.prototype,"unpipe"),gt.prototype),Et(gt.prototype,"close",[m3],Object.getOwnPropertyDescriptor(gt.prototype,"close"),gt.prototype),Et(gt.prototype,"replaceTrack",[g3],Object.getOwnPropertyDescriptor(gt.prototype,"replaceTrack"),gt.prototype),gt),IO=(y3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),v3=Rn(),_3=vh("CameraVideoTrack","_enabledMutex"),E3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),S3=Rn(),b3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),T3=Rn(),w3=Xe({argsMap:n=>[n.getTrackId()]}),fa=class y9 extends tn{get __className__(){return"CameraVideoTrack"}constructor(r,i,s,c,u,h){super(r,gs(i.encoderConfig),c,u,h),oe(this,"_config",void 0),oe(this,"_originalConstraints",void 0),oe(this,"_constraints",void 0),oe(this,"_enabled",!0),oe(this,"_deviceName","default"),oe(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(mh()||q0())&&!function(){const f=St();if(f.os!==tr.IOS||!f.osVersion)return!1;const m=f.osVersion.split(".");return Number(m[0])===15&&Number(m[1])>=2}()&&tB()&&this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=i,this._originalConstraints=s,this._constraints=s,this._deviceName=r.label,this._encoderConfig=gs(this._config.encoderConfig),jt.on(Sr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),jt.on(Sr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(r){return typeof r=="string"?this._setDeviceById(r):r.deviceId?this._setDeviceById(r.deviceId):r.facingMode?this._setDeviceByFacingModel(r.facingMode):void 0}async _setDeviceById(r){if(A.info("[".concat(this.getTrackId(),"] set device to ").concat(r)),this._enabled)try{const i=await da.getDeviceById(r),s={};s.video=sn({},this._constraints),s.video.deviceId={exact:r},s.video.facingMode=void 0,this._originMediaStreamTrack.stop();let c=null;try{c=await ua(s,this.getTrackId())}catch(u){throw A.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),c=await ua({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=i.label,this._config.cameraId=r,this._constraints.deviceId={exact:r}}catch(i){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}else try{const i=await da.getDeviceById(r);this._deviceName=i.label,this._config.cameraId=r,this._constraints.deviceId={exact:r}}catch(i){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}A.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(r){A.info("[".concat(this.getTrackId(),"] set facingMode ").concat(r));const i={video:sn(sn({},this._constraints),{},{deviceId:void 0,facingMode:{exact:r}})};if(this._enabled){this._originMediaStreamTrack.stop();let s=null;try{s=await ua(i,this.getTrackId())}catch(c){throw A.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),c.toString()),s=await ua({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),c}await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=r,this._config.cameraId=void 0,this._constraints=sn({},i.video),A.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(r,i){if(!i){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),r),r){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const s=await ua({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1)}await Kt(this,je.NEED_ENABLE_TRACK,this)}catch(s){throw A.error("[".concat(this.getTrackId(),"] setEnabled true error"),s.toString()),s}this.updateMediaStreamTrackResolution(),A.info("[".concat(this.getTrackId(),"] setEnabled to true success")),i||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),i||(this._enabled=!1);try{await Kt(this,je.NEED_DISABLE_TRACK,this)}catch(s){throw A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}A.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(r,i){if(!this._enabled)throw new de($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");r=gs(r),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate||r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate||r.bitrateMin);const s=yn(this._config);s.encoderConfig=r;const c=pE(s);(Cr()||ri()||Za())&&(c.deviceId=void 0),A.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(r),JSON.stringify(c));try{await this._originMediaStreamTrack.applyConstraints(c),this.updateMediaStreamTrackResolution()}catch(u){const h=new de($.UNEXPECTED_ERROR,u.toString());throw A.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}this._config=s,this._constraints=c,this._originalConstraints=c,this._encoderConfig=r,this._hints.indexOf(Yt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Kt(this,je.NEED_UPDATE_VIDEO_ENCODER,this)}catch(u){return u.throw(A)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((ri()||Za())&&this._enabled&&!this._isClosed&&jt.duringInterruption){const r=async()=>{jt.off(Sr.IOS_INTERRUPTION_END,r),this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};jt.on(Sr.IOS_INTERRUPTION_END,r)}else A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Th.TRACK_ENDED)}async renewMediaStreamTrack(r){const i=r||this._constraints,s=da.searchDeviceIdByName(this._deviceName);if(s&&!i.deviceId&&(i.deviceId={exact:s}),this._enabled){const c=await ua({video:i},this.getTrackId());this._constraints=i,await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),jt.off(Sr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),jt.off(Sr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;r&&(s=sn(sn({},s),gs(r))),s=wu(s);const c=qt(8,"track-cam-cloned-"),u=new y9(i?this._mediaStreamTrack.clone():this._mediaStreamTrack,wu(sn(sn({},this._config),{},{encoderConfig:s})),wu(this._constraints),wu(this._scalabilityMode),this._optimizationMode,c);return r&&s&&u.setEncoderConfiguration(s),A.debug("clone track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(i)),u}bindProcessorContextEvents(){this.processorContext.on(ca.REQUEST_UPDATE_CONSTRAINTS,async(r,i,s)=>{try{const c=Object.assign({},this._originalConstraints,...r);await this.renewMediaStreamTrack(c),i()}catch(c){s(c)}}),this.processorContext.on(ca.REQUEST_CONSTRAINTS,async r=>{r(this._originMediaStreamTrack.getSettings())})}},Et(fa.prototype,"setDevice",[y3,v3],Object.getOwnPropertyDescriptor(fa.prototype,"setDevice"),fa.prototype),Et(fa.prototype,"setEnabled",[_3,E3,S3],Object.getOwnPropertyDescriptor(fa.prototype,"setEnabled"),fa.prototype),Et(fa.prototype,"setEncoderConfiguration",[b3,T3],Object.getOwnPropertyDescriptor(fa.prototype,"setEncoderConfiguration"),fa.prototype),Et(fa.prototype,"close",[w3],Object.getOwnPropertyDescriptor(fa.prototype,"close"),fa.prototype),fa);function NO(n,r,i,s){i.optimizationMode&&(s&&s.width&&s.height?(i.encoderConfig=sn(sn({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),i.optimizationMode!=="motion"&&i.optimizationMode!=="detail"||(r.contentHint=i.optimizationMode,r.contentHint===i.optimizationMode?A.debug("[".concat(n,"] set content hint to"),i.optimizationMode):A.debug("[".concat(n,"] set content hint failed")))):A.warning("[".concat(n,"] can not apply optimization mode bitrate config, no encoderConfig")))}var C3,R3,O3,A3,Oa,I3,N3,P3,x3,D3,L3,Kr;class k3 extends FB{getUserId(){return this._userId}constructor(r,i,s,c){super(r,"track-".concat(r.kind,"-").concat(i,"-").concat(c.clientId,"_").concat(qt(5,""))),oe(this,"_userId",void 0),oe(this,"_uintId",void 0),oe(this,"_isDestroyed",!1),oe(this,"store",void 0),oe(this,"processor",void 0),oe(this,"processorContext",void 0),this._userId=i,this._uintId=s,this.store=c}_updateOriginMediaStreamTrack(r){this._originMediaStreamTrack=r,this._mediaStreamTrack=r,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,A.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let Ih=(C3=Xe({argsMap:(n,r,i)=>[n.getTrackId(),typeof r=="string"?r:r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),R3=Xe({argsMap:n=>[n.getTrackId()]}),O3=Xe({argsMap:(n,r)=>[n.getTrackId(),r.name]}),A3=Xe({argsMap:n=>[n.getTrackId()]}),Et((Oa=class extends k3{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==zr.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(n,r,i,s){super(n,r,i,s),oe(this,"_videoVisibleTimer",null),oe(this,"_previousVideoVisibleStatus",void 0),oe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),oe(this,"trackMediaType",Ch.VIDEO),oe(this,"_videoWidth",void 0),oe(this,"_videoHeight",void 0),oe(this,"_player",void 0),oe(this,"processorDestination",void 0),oe(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new ZB(this.getTrackId(),"remote"),this.processorDestination=new QB(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Yc(()=>{A.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),ia(this,je.GET_STATS)||sn({},VB)}play(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string"){const s=document.getElementById(n);s?n=s:(A.warning("[".concat(this.getTrackId(),'] can not find "#').concat(n,'" element, use document.body')),n=document.body)}A.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const i=sn(sn({fit:"cover"},r),{},{trackId:this.getTrackId(),element:n});this._player?this._player.updateConfig(i):(n instanceof HTMLVideoElement?this._player=new AO(i):this._player=new zF(i),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(wh.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=s=>{this.safeEmit(wh.VIDEO_STATE_CHANGED,s)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const s=this.getVideoElementVisibleStatus();this.safeEmit(wh.VIDEO_ELEMENT_VISIBLE_STATUS,s)}catch{}},Y("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,A.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){nF(this._originMediaStreamTrack).then(n=>{let[r,i]=n;this._videoHeight=i,this._videoWidth=r}).catch(rE)}_updatePlayerSource(){A.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var n,r;const i=this==null||(n=this._player)===null||n===void 0?void 0:n.getContainerElement(),s={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:i==null?void 0:i.parentElement},{element:c,slot:u}=s;if(this.isPlaying&&c instanceof HTMLVideoElement&&u instanceof HTMLElement){const h=aB.checkOneElementVisible(c),f=Object.assign({},h);if(f.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=f.visible;const m=$e.reportApiInvoke(null,{tag:fn.TRACER,name:Wn.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});f.visible?m.onSuccess("Video is visible"):m.onSuccess("Invisible because of ".concat(f.reason))}return f}return}catch(i){throw new de($.GET_VIDEO_ELEMENT_VISIBLE_ERROR,i.message)}}pipe(n){if(this.processor===n)return n;if(n._source)throw new de($.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),n}unpipe(){if(!this.processor)return;const n=this.processor;this.processor._source=void 0,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ii.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ii.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(n){this.emit(Au.SEI_RECEIVED,n)}}).prototype,"play",[C3],Object.getOwnPropertyDescriptor(Oa.prototype,"play"),Oa.prototype),Et(Oa.prototype,"stop",[R3],Object.getOwnPropertyDescriptor(Oa.prototype,"stop"),Oa.prototype),Et(Oa.prototype,"pipe",[O3],Object.getOwnPropertyDescriptor(Oa.prototype,"pipe"),Oa.prototype),Et(Oa.prototype,"unpipe",[A3],Object.getOwnPropertyDescriptor(Oa.prototype,"unpipe"),Oa.prototype),Oa),Nh=(I3=Xe({argsMap:(n,r)=>[n.getTrackId(),r],throttleTime:300}),N3=Xe({argsMap:(n,r)=>[n.getTrackId(),r]}),P3=Xe({argsMap:n=>[n.getTrackId()]}),x3=Xe({argsMap:n=>[n.getTrackId()]}),D3=Xe({argsMap:(n,r)=>[n.getTrackId(),r.name]}),L3=Xe({argsMap:n=>[n.getTrackId()]}),Et((Kr=class extends k3{get isPlaying(){return this._useAudioElement?gi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(n,r,i,s){super(n,r,i,s),oe(this,"trackMediaType",Ch.AUDIO),oe(this,"_source",void 0),oe(this,"_useAudioElement",!0),oe(this,"_volume",100),oe(this,"processorContext",void 0),oe(this,"processorDestination",void 0),oe(this,"_played",!1),oe(this,"_bypassWebAudio",!1),Y("DISABLE_WEBAUDIO")?(this._source=new RO,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new HB(n,!0),Y("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(sa.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(wh.FIRST_FRAME_DECODED)}),this.processorContext=new tF(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new eF(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(sa.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(sa.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(sa.ON_AUDIO_BUFFER),this._source.on(sa.ON_AUDIO_BUFFER,i=>n(i))}setVolume(n){this._volume=n,this._useAudioElement?gi.setVolume(this.getTrackId(),n):this._source.setVolume(n/100)}async setPlaybackDevice(n){if(!this._useAudioElement||!kB())throw new de($.NOT_SUPPORTED,"your browser does not support setting the audio output device");await gi.setSinkID(this.getTrackId(),n)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Yc(()=>{A.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),ia(this,je.GET_STATS)||sn({},jB)}play(){A.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(A.debug("[".concat(this.getTrackId(),"] use audio element to play")),gi.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){A.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?gi.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];A.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&gi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(n){if(this._bypassWebAudio)throw new de($.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===n)return n;if(n._source)throw new de($.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(this._bypassWebAudio)throw new de($.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const r=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ii.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(n)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ii.ON_NODE,n=>{this._source.processedNode=n;const r=!n;this._useAudioElement!==r&&(this._played?(this.stop(),this._useAudioElement=r,this.play()):this._useAudioElement=r)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ii.ON_TRACK),this.processorDestination.removeAllListeners(ii.ON_NODE)}}).prototype,"setVolume",[I3],Object.getOwnPropertyDescriptor(Kr.prototype,"setVolume"),Kr.prototype),Et(Kr.prototype,"setPlaybackDevice",[N3],Object.getOwnPropertyDescriptor(Kr.prototype,"setPlaybackDevice"),Kr.prototype),Et(Kr.prototype,"play",[P3],Object.getOwnPropertyDescriptor(Kr.prototype,"play"),Kr.prototype),Et(Kr.prototype,"stop",[x3],Object.getOwnPropertyDescriptor(Kr.prototype,"stop"),Kr.prototype),Et(Kr.prototype,"pipe",[D3],Object.getOwnPropertyDescriptor(Kr.prototype,"pipe"),Kr.prototype),Et(Kr.prototype,"unpipe",[L3],Object.getOwnPropertyDescriptor(Kr.prototype,"unpipe"),Kr.prototype),Kr);const ec=new class extends ln{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),oe(this,"_lastHiddenTime",0),oe(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),A.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class M3 extends ln{constructor(r,i){super(),oe(this,"trackMediaType",Ch.DATA),oe(this,"_version",1),oe(this,"_type",3),oe(this,"_config",void 0),oe(this,"_originDataChannel",void 0),oe(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),oe(this,"_dataStreamPacketHandler",{serialize:s=>s,deserialize:s=>s}),oe(this,"_datachannelEventMap",new Map),this._config=r,i&&(this._originDataChannel=i,this._bandDataChannelEvents(i)),this._initPacketHeader()}useDataStream(r){this._dataStreamPacketHandler=r}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Y("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var r,i;return(r=(i=this._originDataChannel)===null||i===void 0?void 0:i.readyState)!==null&&r!==void 0?r:"connecting"}get _originDataChannelId(){var r,i;return(r=(i=this._originDataChannel)===null||i===void 0?void 0:i.id)!==null&&r!==void 0?r:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new Ie((r,i)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&r();const s=setTimeout(()=>{var c;i(new de($.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((c=this._originDataChannel)===null||c===void 0?void 0:c.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(s),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),r()},this._originDataChannel.onerror=()=>{throw clearTimeout(s),new de($.DATACHANNEL_CONNECTION_TIMEOUT)}}else i(new de($.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(r){this._originDataChannel=r,this._bandDataChannelEvents(r)}_initPacketHeader(){const r=new DataView(this._dataStreamPacketHeader);r.setUint16(0,this._version),r.setUint8(2,this._type),r.setUint8(3,this._config.id)}_bandDataChannelEvents(r){this._unbindDataChannelEvents(r),[hE.OPEN,hE.CLOSE,hE.ERROR].forEach(i=>{const s=()=>{this.emit(i)};this._datachannelEventMap.set(i,s),r.addEventListener(i,s)})}_unbindDataChannelEvents(r){Array.from(this._datachannelEventMap.entries()).forEach(i=>{let[s,c]=i;r.removeEventListener(s,c)}),this._datachannelEventMap.clear()}}class Cfe extends M3{constructor(r){super(r),oe(this,"_messageListener",void 0),this._messageListener=i=>{if(i.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const s=i.data.slice(0,this._dataStreamPacketHeader.byteLength),c=new DataView(s).getUint8(3);if(c!==this.id)return void(Y("SHOW_DATASTREAM2_LOG")&&A.debug("invalid datachannel id: ".concat(c," !== ").concat(this.id)));let u=i.data.slice(this._dataStreamPacketHeader.byteLength);u=this._dataStreamPacketHandler.deserialize(u),this.emit(hE.MESSAGE,u)}}_updateOriginDataChannel(r){super._updateOriginDataChannel(r),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class Rfe extends M3{send(r){if(this._originDataChannel){let i=r;i=this._dataStreamPacketHandler.serialize(r);const s=new Uint8Array(this._dataStreamPacketHeader.byteLength+i.byteLength);s.set(new Uint8Array(this._dataStreamPacketHeader),0),s.set(new Uint8Array(i),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(s.buffer)}}}function gE(){const n=new Blob([atob("ZnVuY3Rpb24gZShlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLGE9W10sbz0wO2Zvcig7YS5sZW5ndGg8bjspbyszPG4mJjA9PT1yW29dJiYwPT09cltvKzFdJiYzPT09cltvKzJdJiYoMD09PXJbbyszXXx8MT09PXJbbyszXXx8Mj09PXJbbyszXXx8Mz09PXJbbyszXSk/KGEucHVzaChyW29dLHJbbysxXSxyW28rM10pLG8rPTQpOihhLnB1c2gocltvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9ZnVuY3Rpb24gdChlLHQpe2NvbnN0IG49ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtsZXQgbj1bXSxyPTA7Zm9yKDtyPHQ7KXIrMjx0JiYwPT09ZVtyXSYmMD09PWVbcisxXSYmKDA9PT1lW3IrMl18fDE9PT1lW3IrMl18fDI9PT1lW3IrMl18fDM9PT1lW3IrMl0pPyhuLnB1c2goZVtyXSxlW3IrMV0sMyxlW3IrMl0pLHIrPTMpOihuLnB1c2goZVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KHQpLHI9bi5sZW5ndGgsYT1NYXRoLmZsb29yKHIvMjU1KSxvPXIlMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNithKzErcitlLmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8YTspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1vLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkoZSksNitpK3IpLHMuYnVmZmVyfW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+LTEmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSYmKHNlbGYub25ydGN0cmFuc2Zvcm09bj0+e2NvbnN0IHI9bi50cmFuc2Zvcm1lcjtsZXQgYT1bXTtyLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9ZT0+e2UuZGF0YS5zZWkmJmEucHVzaChlLmRhdGEuc2VpKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IG89ci5yZWFkYWJsZS5nZXRSZWFkZXIoKSxzPXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7InJ4Ij09PXIub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtjb25zdCBuPW5ldyBEYXRhVmlldyh0LmRhdGEpO2xldCByPTA7Zm9yKDtyKzQ8dC5kYXRhLmJ5dGVMZW5ndGg7KXtpZigwPT09bi5nZXRVaW50OChyKzApJiYwPT09bi5nZXRVaW50OChyKzEpJiYwPT09bi5nZXRVaW50OChyKzIpJiYxPT09bi5nZXRVaW50OChyKzMpJiY2PT09bi5nZXRVaW50OChyKzQpKXtsZXQgYT1yKzYsbz0wLHM9MDtmb3IoOzI1NT09PShzPW4uZ2V0VWludDgoYSsrKSk7KW8rPTI1NTtvKz1zO2NvbnN0IGk9ZSh0LmRhdGEsYSxvKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaSl9cisrfXJldHVybiBudWxsfShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1hLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>g_.revokeObjectURL(n),0),new Worker(g_.createObjectURL(n))}var Ph=function(n){return n[n.AUDIO_LEVEL=1]="AUDIO_LEVEL",n[n.METADATA=2]="METADATA",n}(Ph||{});function U3(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=n.getUint8(0);if(i!==71)return;const s=n.getUint16(1),c=3+s,u=new Uint8Array(n.byteLength-c);u.set(new Uint8Array(n.buffer,c,n.byteLength-c));const h={m:i,tlvLen:s,tlv:[],frame:u};let f=3;for(;f<c;){const m=n.getUint8(f),y=n.getUint16(f+1),_=3;if(m===Ph.AUDIO_LEVEL){let S=n.getUint8(f+_);for(let w=1;w<y;w++)S=S<<8|n.getUint8(f+_+w);h.tlv.push({tag:m,length:y,value:r?127^S>>1:127&S})}else if(m===Ph.METADATA){const S=new Uint8Array(y);for(let w=0;w<y;w++)S[w]=n.getUint8(f+_+w);h.tlv.push({tag:m,length:y,value:S})}f+=_+y}return h}const yE=new Map;async function Ofe(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bt().supportWebRTCEncodedTransform)return void A.warning("browser not support audio encoded transform");if(yE.has(n)||!n.track)return;const i={track:n.track};if(Xs()){if(!n.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let c=null;try{c=n.createEncodedStreams()}catch(h){return void A.error("create audio-encoded-streams error",h&&h.message)}const u=new TransformStream({transform(h,f){i.controller||(i.controller=f),n.track&&n.track.id!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s));const m=r.metadata&&r.metadata();m?function(y,_){const{chunk:S,controller:w}=_;S.data=function(O,W,k){const j=k.byteLength,H=j+1+2,K=3+H,Q=new ArrayBuffer(O.byteLength+K),ie=new DataView(Q);ie.setUint8(0,71),ie.setUint16(1,H),ie.setUint8(3,W),ie.setUint16(4,j);for(let te=0;te<j;te++)ie.setUint8(6+te,k[te]);const re=new Uint8Array(ie.buffer);return re.set(new Uint8Array(O),K),re.buffer}(S.data,Ph.METADATA,y),w.enqueue(S)}(m,{sender:n,chunk:h,controller:f}):f.enqueue(h)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Cr()){if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const c=gE(),u=new MessageChannel;await new Ie(f=>c.onmessage=m=>{m.data==="registered"&&f(void 0)});const h=new RTCRtpScriptTransform(c,{name:"tx",port:u.port2},[u.port2]);n.transform=h,await new Ie(f=>c.onmessage=m=>{m.data==="started"&&f(void 0)}),u.port1.onmessage=f=>{var m;f.data.transformed&&n.track&&((m=n.track)===null||m===void 0?void 0:m.id)!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s))},i.worker=c}function s(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",s)}const c=yE.get(n);if(c){yE.delete(n);try{var u,h;(u=c.controller)===null||u===void 0||u.terminate(),(h=c.worker)===null||h===void 0||h.terminate()}catch(f){A.warning(f&&f.message)}}}yE.set(n,i),n.track.addEventListener("ended",s)}const vE=127,Pu=1e-10,PO=139/13,_E=new Map;function xO(n,r,i){const s="".concat(n,"-").concat(r,"-").concat(i);let c=0;return _E.has(s)?c=_E.get(s):(c=Math.log(function(h,f){const m=h-f;f<m&&(f=m);let y=1;for(let _=h,S=1;_>f;_--,S++)y=y*_/S;return y}(r,n))+n*Math.log(.5)+(r-n)*Math.log(1-.5)-Math.log(i)+i*n,_E.set(s,c)),c<Pu&&(c=Pu),c}function j3(n,r,i){const s=r.length,c=n.length/s;let u=!1;for(let h=0,f=0;h<s;h++){let m=0;for(let y=f+c;f<y;f++)n[f]>i&&m++;r[h]!==m&&(r[h]=m,u=!0)}return u}window.cache=_E;let Afe=0;class V3{constructor(r){oe(this,"id",void 0),oe(this,"immediates",[]),oe(this,"lastNonSilence",-1),oe(this,"immediateSpeechActivityScore",Pu),oe(this,"lastLevelChangedTime",Date.now()),oe(this,"levels",[]),oe(this,"longs",[]),oe(this,"longSpeechActivityScore",Pu),oe(this,"mediums",[]),oe(this,"mediumSpeechActivityScore",Pu),oe(this,"minLevel",0),oe(this,"nextMinLevel",0),oe(this,"nextMinLevelWindowLength",0),oe(this,"energyScore",0),this.id=r||"".concat(Afe++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const r=this.immediates,i=this.levels,s=this.minLevel+PO;let c=!1;for(let u=0;u<r.length;++u){let h=i[u];h<s&&(h=0);const f=Math.floor(h/PO);r[u]!==f&&(r[u]=f,c=!0)}return c}computeLongs(){return j3(this.mediums,this.longs,4)}computeMediums(){return j3(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=xO(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(r){this.longSpeechActivityScore=xO(this.longs[0],10,47),this.longSpeechActivityScore>Pu&&(this.lastNonSilence=r)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=xO(this.mediums[0],5,24)}evaluateSpeechActivityScores(r){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(r)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var r;return"[".concat(CL(r=[...this.levels]).call(r).join(),"]")}getSpeechActivityScore(r){switch(r){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+r)}}levelChanged(r,i){if(this.lastLevelChangedTime<=i){this.lastLevelChangedTime=i;let s=r;return r<0&&(s=0),r>vE&&(s=vE),this.levels.unshift(s),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(s),s>=this.minLevel+PO?s:s/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(r){if(r!==0){if(this.minLevel===0||this.minLevel>r)return this.minLevel=r,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=r,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>r&&(this.nextMinLevel=r),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let i=Math.sqrt(this.minLevel*this.nextMinLevel);i<0?i=0:i>vE&&(i=vE),this.minLevel=i,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class Ife{constructor(r){oe(this,"algorithm",void 0),this.algorithm=r}execute(){let r=!this.algorithm;if(!r)try{const i=this.algorithm.runInDecisionMaker(this);i<=0?r=!0:setTimeout(this.execute.bind(this),i)}catch{r=!0}r&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class DO{constructor(r,i,s){oe(this,"isDominant",void 0),oe(this,"energyRanking",void 0),oe(this,"energyScore",void 0),this.isDominant=r,this.energyRanking=i,this.energyScore=s}}class Nfe extends ln{constructor(r){super(),oe(this,"dominantId",null),oe(this,"lastDecisionTime",0),oe(this,"lastLevelChangedTime",0),oe(this,"lastLevelIdleTime",0),oe(this,"relativeSpeechActivities",[]),oe(this,"speakers",new Map),oe(this,"enableSilence",!1),oe(this,"timeoutToSilenceInterval",0),oe(this,"decisionMaker",null),oe(this,"loudest",[]),oe(this,"numLoudestToTrack",3),oe(this,"energyExpireTimeMs",250),oe(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=r,this.enableSilence=r>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,i=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=r,i!=null&&(this.energyExpireTimeMs=i),s!=null&&(this.energyAlphaPct=s),this.loudest.length>r&&this.loudest.splice(r)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(r){return this.loudest.some(i=>i.id===r)}levelChanged(r,i){const s=Date.now(),c=this.getOrCreateSpeaker(r);this.lastLevelChangedTime<s&&(this.lastLevelChangedTime=s,this.maybeStartDecisionMaker());const u=c.levelChanged(i,s);return this.updateLoudestList(c,u,s)}runInDecisionMaker(r){return this.decisionMaker!==r||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(r){this.decisionMaker===r&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(r){r.forEach(i=>{this.speakers.has(i.id)||this.speakers.set(i.id,i)})}removeSpeakers(r){r.forEach(i=>{this.speakers.delete(i.id)})}getOrCreateSpeaker(r){let i=this.speakers.get(r);return i||(i=new V3(r),this.speakers.set(r,i),this.maybeStartDecisionMaker()),i}updateLoudestList(r,i,s){const c=r.id===this.dominantId;if(i<0){let m=0;for(;m<this.loudest.length&&this.loudest[m]!==r;)++m;return new DO(c,m,r.energyScore)}if(r.energyScore=Math.floor((this.energyAlphaPct*i+(100-this.energyAlphaPct)*r.energyScore+50)/100),this.numLoudestToTrack===0)return new DO(c,0,r.energyScore);const u=s-this.energyExpireTimeMs;let h=0;for(;h<this.loudest.length;){const m=this.loudest[h];if(m.getLastLevelChangedTime()<u&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(h,1);else if(m.id!==r.id)++h;else if(this.loudest.splice(h,1),this.loudest.length<this.numLoudestToTrack)break}let f=0;for(;f<this.loudest.length&&!(this.loudest[f].energyScore<r.energyScore);)++f;return f<this.numLoudestToTrack&&(this.loudest.splice(f,0,r),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new DO(c,f,r.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new Ife(this),this.decisionMaker.execute())}makeDecision(r){let i=null,s=null;const c=this.speakers.size;let u=null;if(c===0)u=null;else if(c===1){var h;const f=na(h=this.speakers).call(h).next().value;this.enableSilence&&f&&(u=f.id,f.evaluateSpeechActivityScores(r),r-f.lastNonSilence>this.timeoutToSilenceInterval&&(u=null))}else{let f=this.dominantId==null?null:this.speakers.get(this.dominantId);if(f==null){const _=this.speakers.entries().next();_.value&&(u=_.value[0],f=_.value[1])}else u=f.id;f!=null&&f.evaluateSpeechActivityScores(r);const m=this.relativeSpeechActivities;let y=2;for(const _ of this.speakers.entries()){const[S,w]=_;if(w===f)continue;w.evaluateSpeechActivityScores(r);for(let j=0;j<m.length;++j){const H=f==null?Pu:f.getSpeechActivityScore(j);m[j]=Math.log(w.getSpeechActivityScore(j)/H)}const O=m[0],W=m[1],k=m[2];O>3&&W>2&&k>0&&W>y&&(y=W,u=S)}this.enableSilence&&f!=null&&u===f.id&&r-f.lastNonSilence>this.timeoutToSilenceInterval&&(u=null)}u==null&&!this.enableSilence||u===this.dominantId||(i=this.dominantId,this.dominantId=u,s=this.dominantId),s==null&&!this.enableSilence||s===i||this.emit("ActiveSpeakerChanged",s)}_runInDecisionMaker(){const r=Date.now(),i=300-(r-this.lastLevelIdleTime);let s=0;i<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(r),this.lastLevelIdleTime=r):s=i;let c=300-(r-this.lastDecisionTime);return c<=0&&(this.lastDecisionTime=r,this.makeDecision(r),c=300-(Date.now()-r)),c>0&&s>c&&(s=c),s}timeoutIdleLevels(r){const i=[];for(const c of na(s=this.speakers).call(s)){var s;const u=r-c.getLastLevelChangedTime();36e5<u&&(this.dominantId==null||c.id!==this.dominantId)?i.push(c.id):300<u&&c.levelTimedOut()}i.forEach(c=>this.speakers.delete(c))}}const xh=new Map;let jo=null,EE=null,xu=[];const Pfe=1e3/15,Vo=new Map,SE=new Map;class xfe{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(r,i){oe(this,"id",void 0),oe(this,"track",void 0),oe(this,"score",0),oe(this,"active",!0),oe(this,"muted",!1),oe(this,"timer",0),oe(this,"actives",0),oe(this,"inactives",0),this.id=r,this.track=i,this.setActive(Vo.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const r=this.active;this.active=this.activeRate>=.8;const{actives:i,inactives:s}=function(){const c=[],u=[];return Array.from(na(Vo).call(Vo)).forEach(h=>{h.active?c.push(h):u.push(h)}),{actives:c,inactives:u}}();if(i.length>3){let c;i.forEach(u=>{(!c||c.score>u.score)&&(c=u)}),c&&c.setActive(!1)}if(i.length<3&&s.length>0){let c;s.forEach(u=>{(!c||c.score<u.score)&&u.id!==this.id&&(c=u)}),c&&r&&!this.active&&(c.samples>40&&c.activeRate-this.activeRate>.4?c.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(r){this.active=r,this.resetTimer(),this.setMuted(!r)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const r=function(i){let s;return Array.from(na(Vo).call(Vo)).forEach(c=>{!c.active||c.id===i||c.samples<40||(!s||c.score<s.score)&&(s=c)}),s}(this.id);r&&this.activeRate-r.activeRate>.4&&(r.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const r=function(i){let s;return Array.from(na(Vo).call(Vo)).forEach(c=>{c.active||c.id===i||c.samples<40||(!s||c.score>s.score)&&(s=c)}),s}(this.id);r&&r.activeRate-this.activeRate>.4&&(r.setActive(!0),this.setActive(!1))}addSample(r){r?this.actives+=1:this.inactives+=1,this.samples>Pfe&&this.autoCheckActive()}setMuted(r){this.track&&(this.track.enabled=!r,this.muted=r)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let bE;function B3(n){const r=Vo.get(n);r&&(Vo.delete(n),r.clearTimer())}const TE=new Map,Dfe=new Map;async function LO(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bt().supportWebRTCEncodedTransform)return void A.warning("browser not support audio encoded transform");if(TE.has(n))return;const i={track:n.track};if(Xs()){if(!n.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");H0(Nt.CHROME,87,116)||(r.enableTopn=!1);let c=null;try{c=n.createEncodedStreams()}catch(h){return void A.error("create audio-encoded-streams error",h&&h.message)}const u=new TransformStream({transform(h,f){i.controller||(i.controller=f),n.track&&n.track.id!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s)),r.enableTopn?function(m,y,_){var S;const w=U3(new DataView(y.data));if(!w)return _.enqueue(y);const O=m.track.id;Dfe.set(O,m.track);const W=(S=w.tlv.find(ie=>ie.tag===Ph.AUDIO_LEVEL))===null||S===void 0?void 0:S.value;let k=0;typeof W=="number"&&(k=127-W);const j=Math.round(Math.pow(10,k/60)-1),{selected:H,speaker:K}=function(ie,re){let te=xh.get(ie);if(te||(te=function(he){const Se=new V3;return xh.set(he,Se),jo||(jo=new Nfe(Y("TOPN_SILENCE_THRESHOLD")||500),jo.on("ActiveSpeakerChanged",Ne=>{Ne!=null&&(EE=Ne)})),jo.addSpeakers([Se]),Se}(ie)),xh.size<=3)return{selected:!0,speaker:te};if(!jo)throw new Error("no active speaker detector");return jo.levelChanged(te.id,re),xu=jo.loudest.map(he=>he.id),EE&&!Oe(xu).call(xu,EE)&&xu.length>=3&&xu.pop(),{selected:Oe(xu).call(xu,te.id)||te.id===EE,speaker:te}}(m,j),Q=function(ie,re,te){const he=Vo.get(ie)||new xfe(ie,re);return he.score=te,Vo.set(ie,he),function(Se){if(SE.set(Se,!0),!bE)return void(bE=Date.now());const Ne=Date.now();Ne-bE>1e3&&(SE.get(Se)?SE.set(Se,!1):(B3(Se),SE.delete(Se)),bE=Ne)}(ie),he}(O,m.track,K.energyScore);Q.addSample(H),Q.active&&(y.data=w.frame.buffer,_.enqueue(y))}(n,h,f):r.enableMetadata?function(m,y,_){const S=U3(new DataView(m.data));if(!S)return y.enqueue(m);const w=S.tlv.find(O=>O.tag===Ph.METADATA);w&&_&&w.value instanceof Uint8Array&&_(w.value),m.data=S.frame.buffer,y.enqueue(m)}(h,f,r.onMetadata):f.enqueue(h)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Cr()){if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const c=gE(),u=new MessageChannel;await new Ie(f=>c.onmessage=m=>{m.data==="registered"&&f(void 0)});const h=new RTCRtpScriptTransform(c,{name:"rx",port:u.port2},[u.port2]);n.transform=h,await new Ie(f=>c.onmessage=m=>{m.data==="started"&&f(void 0)}),u.port1.onmessage=f=>{var m;f.data.transformed&&n.track&&((m=n.track)===null||m===void 0?void 0:m.id)!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s))},i.worker=c}function s(){n.track.removeEventListener("ended",s),function(c){const u=TE.get(c);if(u){(function(m){const y=xh.get(m);y&&(xh.delete(m),jo&&(jo.removeSpeakers([y]),xh.size===0&&(jo.destroy(),jo=null)))})(c),B3(c.track.id),TE.delete(c);try{var h,f;(h=u.controller)===null||h===void 0||h.terminate(),(f=u.worker)===null||f===void 0||f.terminate()}catch(m){A.warning(m&&m.message)}}}(n)}TE.set(n,i),n.track.addEventListener("ended",s)}function Lfe(n,r,i){let s=new Uint8Array(n,r,i),c=[],u=0;for(;c.length<i;)u+3<i&&s[u]===0&&s[u+1]===0&&s[u+2]===3&&(s[u+3]===0||s[u+3]===1||s[u+3]===2||s[u+3]===3)?(c.push(s[u],s[u+1],s[u+3]),u+=4):(c.push(s[u]),u++);return new Uint8Array(c)}const wE=new Map;async function kfe(n,r){if(!bt().supportWebRTCEncodedTransform)return void A.warning("browser not support video encoded transform");if(wE.has(n)||!n.track)return;const i={track:n.track};if(Xs()){if(!n.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let c=null;try{c=n.createEncodedStreams()}catch(f){return void A.error("create video-encoded-streams error",f&&f.message)}const u=[];r.on("sei-to-send",f=>{u.push(f)});const h=new TransformStream({transform(f,m){i.controller||(i.controller=m),n.track&&n.track.id!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s));const y=u.shift();y&&(f.data=function(_,S){const w=function(K){const Q=K.length;let ie=[],re=0;for(;re<Q;)re+2<Q&&K[re]===0&&K[re+1]===0&&(K[re+2]===0||K[re+2]===1||K[re+2]===2||K[re+2]===3)?(ie.push(K[re],K[re+1],3,K[re+2]),re+=3):(ie.push(K[re]),re++);return new Uint8Array(ie)}(S),O=w.length,W=Math.floor(O/255),k=O%255,j=new Uint8Array(6+W+1+O+_.byteLength);j[0]=0,j[1]=0,j[2]=0,j[3]=1,j[4]=6,j[5]=101;let H=0;for(;H<W;)j[6+H]=255,H++;return j[6+H]=k,H++,j.set(w,6+H),j.set(new Uint8Array(_),6+H+O),j.buffer}(f.data,y)),m.enqueue(f)}});c.readable.pipeThrough(h).pipeTo(c.writable)}else{if(!Cr())return;{if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const c=gE(),u=new MessageChannel;await new Ie(f=>c.onmessage=m=>{m.data==="registered"&&f(void 0)});const h=new RTCRtpScriptTransform(c,{name:"tx",port:u.port2},[u.port2]);n.transform=h,await new Ie(f=>c.onmessage=m=>{m.data==="started"&&f(void 0)}),r.on("sei-to-send",f=>{u.port1.postMessage({sei:f})}),u.port1.onmessage=f=>{var m;f.data.transformed&&n.track&&((m=n.track)===null||m===void 0?void 0:m.id)!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s))},i.worker=c}}function s(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",s)}const c=wE.get(n);if(c){wE.delete(n);try{var u,h;(u=c.controller)===null||u===void 0||u.terminate(),(h=c.worker)===null||h===void 0||h.terminate()}catch(f){A.warning(f&&f.message)}}}wE.set(n,i),n.track.addEventListener("ended",s)}const Am=new Map;async function kO(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bt().supportWebRTCEncodedTransform)return void A.warning("browser not support video encoded transform");if(!n.track)return;if(Am.has(n)){const c=Am.get(n);return void(c&&(c.onSei=r.onSei))}const i={track:n.track,onSei:r.onSei};if(Xs()){if(!n.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let c=null;try{c=n.createEncodedStreams()}catch(h){return void A.error("create video-encoded-streams error",h&&h.message)}const u=new TransformStream({transform(h,f){i.controller||(i.controller=f),n.track&&n.track.id!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s));const m=function(y){const _=new DataView(y.data);let S=0;for(;S+4<y.data.byteLength;){if(_.getUint8(S+0)===0&&_.getUint8(S+1)===0&&_.getUint8(S+2)===0&&_.getUint8(S+3)===1&&_.getUint8(S+4)===6){let w=S+6,O=0,W=0;for(;(W=_.getUint8(w++))===255;)O+=255;O+=W;const k=Lfe(y.data,w,O);return new Uint8Array(k)}S++}return null}(h);m&&i.onSei&&i.onSei(m),f.enqueue(h)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Cr()){if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const c=gE(),u=new MessageChannel;await new Ie(f=>c.onmessage=m=>{m.data==="registered"&&f(void 0)});const h=new RTCRtpScriptTransform(c,{name:"rx",port:u.port2},[u.port2]);n.transform=h,await new Ie(f=>c.onmessage=m=>{m.data==="started"&&f(void 0)}),u.port1.onmessage=f=>{var m;f.data.transformed&&n.track&&((m=n.track)===null||m===void 0?void 0:m.id)!==i.track.id?(A.debug("video track changed: ".concat(i.track.id," => ").concat(n.track.id)),i.track.removeEventListener("ended",s),i.track=n.track,i.track.addEventListener("ended",s)):f.data.sei&&i.onSei&&i.onSei(f.data.sei)},i.worker=c}function s(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",s)}(function(c){const u=Am.get(c);if(u){Am.delete(c);try{var h,f;(h=u.controller)===null||h===void 0||h.terminate(),(f=u.worker)===null||f===void 0||f.terminate()}catch(m){A.warning(m&&m.message)}}})(n)}Am.set(n,i),n.track.addEventListener("ended",s)}(function(){const n=St();Er.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Er.getStreamFromExtension=n.name===Nt.CHROME&&Number(n.version)>34,Er.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const r=new RTCPeerConnection;let i=!1;try{r.addTransceiver("audio"),i=!0}catch{}return r.close(),i}(),Er.supportMinBitrate=n.name===Nt.CHROME||n.name===Nt.EDGE,Er.supportSetRtpSenderParameters=function(){const r=St();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Js()||!(!Cr()&&!Z_())||r.name===Nt.FIREFOX&&Number(r.version)>=64)}(),n.name===Nt.SAFARI&&(Number(n.version)>=14?Er.supportDualStream=!0:Er.supportDualStream=!1),Er.webAudioMediaStreamDest=function(){const r=St();return!(r.name===Nt.SAFARI&&Number(r.version)<12)}(),Er.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",Er.supportWebGL=typeof WebGLRenderingContext<"u",Er.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Js()||(Er.webAudioWithAEC=!0),Er.supportShareAudio=function(){const r=St();return(r.os===tr.WIN_10||r.os===tr.WIN_81||r.os===tr.WIN_7||r.os===tr.LINUX||r.os===tr.MAC_OS||r.os===tr.CHROMIUM_OS)&&r.name===Nt.CHROME&&Number(r.version)>=74}(),Er.supportDataChannel=!!(ph(76)||function(r){const i=St();return!(i.name!==Nt.FIREFOX||!i.osVersion)&&Number(i.version)>=r}(68)||XV(14)),Er.supportPCSetConfiguration=function(){const r=window.RTCPeerConnection;return!gn()&&!!r&&r.prototype.setConfiguration instanceof Function}(),Er.supportWebRTCEncodedTransform=function(){const r=St();return r.name==="Chrome"&&Number(r.version)>=87||r.name==="Safari"&&Number(r.version)>=15}(),Er.supportWebRTCInsertableStream=function(){const r=St();return(r.name===Nt.CHROME||r.name===Nt.EDGE)&&Number(r.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Er.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,Er.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,nE(()=>{Er.supportDualStreamEncoding=function(){const r=St();return!!Y("DISABLE_WEBAUDIO")||r.name==="Safari"&&Number(r.version)>=14||!!(r.name==="Chrome"&&/Windows/i.test(r.os||"")&&Number(r.version)>=100&&Y("CHROME_DUAL_STREAM_USE_ENCODING"))}(),A.debug("browser ua: ",navigator.userAgent),A.info("browser info: ",n),A.info("browser compatibility: ",Er)})})();const Mfe=["CHINA","GLOBAL"],F3=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Du=[],Dh=[];function Lu(n,r){return!!r&&Du.some(i=>i.uid===n&&i.channelName===r)}function MO(){return Dh.length>0}var Ufe=fj.forEach,W3=Av("forEach")?[].forEach:function(n){return Ufe(this,n,arguments.length>1?arguments[1]:void 0)};kt({target:"Array",proto:!0,forced:[].forEach!==W3},{forEach:W3});var jfe=za("Array","forEach"),Vfe=Hs,Bfe=Dr,Ffe=R,Wfe=jfe,UO=Array.prototype,Gfe={DOMTokenList:!0,NodeList:!0},$fe=function(n){var r=n.forEach;return n===UO||Ffe(UO,n)&&r===UO.forEach||Bfe(Gfe,Vfe(n))?Wfe:r},Hfe=l($fe),zfe=cs,G3=Lv;kt({target:"Object",stat:!0,forced:d(function(){G3(1)})},{keys:function(n){return G3(zfe(n))}});var $3=l(er.Object.keys),Kfe=l(bL),qfe=l(wL),Yfe=kt,H3=Fp,Xfe=qv,Jfe=Bn,z3=cC,Qfe=Vc,Zfe=Tn,epe=CR,tpe=Fn,npe=Fc,rpe=rj("slice"),ipe=tpe("species"),jO=Array,ape=Math.max;Yfe({target:"Array",proto:!0,forced:!rpe},{slice:function(n,r){var i,s,c,u=Zfe(this),h=Qfe(u),f=z3(n,h),m=z3(r===void 0?h:r,h);if(H3(u)&&(i=u.constructor,(Xfe(i)&&(i===jO||H3(i.prototype))||Jfe(i)&&(i=i[ipe])===null)&&(i=void 0),i===jO||i===void 0))return npe(u,f,m);for(s=new(i===void 0?jO:i)(ape(m-f,0)),c=0;f<m;f++,c++)f in u&&epe(s,c,u[f]);return s.length=c,s}});var ope=za("Array","slice"),spe=R,cpe=ope,VO=Array.prototype,lpe=function(n){var r=n.slice;return n===VO||spe(VO,n)&&r===VO.slice?cpe:r},upe=l(lpe);function Fe(n,r,i,s,c){var u,h,f,m={};return Hfe(u=$3(s)).call(u,function(y){m[y]=s[y]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=Kfe(h=qfe(f=upe(i).call(i)).call(f)).call(h,function(y,_){return _(n,r,y)||y},m),c&&m.initializer!==void 0&&(m.value=m.initializer?m.initializer.call(c):void 0,m.initializer=void 0),m.initializer===void 0&&(ZU(n,r,m),m=null),m}let CE=function(n){return n[n.ACCESS_POINT=101]="ACCESS_POINT",n[n.UNILBS=201]="UNILBS",n[n.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",n}({}),BO=function(n){return n[n.IIIEGAL_APPID=1]="IIIEGAL_APPID",n[n.IIIEGAL_UID=2]="IIIEGAL_UID",n[n.INTERNAL_ERROR=3]="INTERNAL_ERROR",n}({}),no=function(n){return n[n.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",n[n.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",n[n.INTERNAL_ERROR=8]="INTERNAL_ERROR",n[n.NO_AUTHORIZED=9]="NO_AUTHORIZED",n[n.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",n[n.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",n[n.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",n[n.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",n[n.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",n[n.USER_OVERLOAD=16]="USER_OVERLOAD",n[n.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",n[n.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",n}({}),ai=function(n){return n[n.NO_FLAG_SET=100]="NO_FLAG_SET",n[n.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",n[n.INVALID_FALG_SET=102]="INVALID_FALG_SET",n[n.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",n[n.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",n[n.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",n[n.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",n[n.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",n[n.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",n[n.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",n[n.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",n[n.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",n[n.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",n[n.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",n[n.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",n[n.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",n[n.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",n[n.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",n[n.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",n}({}),Ye=function(n){return n[n.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",n[n.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",n[n.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",n[n.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",n[n.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",n[n.K_TICKET_INVALID=7]="K_TICKET_INVALID",n[n.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",n[n.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",n[n.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",n[n.K_UID_BANNED=14]="K_UID_BANNED",n[n.K_IP_BANNED=15]="K_IP_BANNED",n[n.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",n[n.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",n[n.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",n[n.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",n[n.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",n[n.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",n[n.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",n[n.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",n[n.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",n[n.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",n[n.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",n[n.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",n[n.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",n[n.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",n[n.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",n[n.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",n[n.ERR_INVALID_UID=117]="ERR_INVALID_UID",n[n.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",n[n.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",n[n.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",n[n.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",n[n.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",n[n.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",n[n.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",n[n.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",n[n.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",n[n.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",n[n.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",n[n.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",n[n.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",n[n.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",n[n.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",n[n.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",n[n.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",n[n.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",n[n.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",n[n.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",n[n.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",n[n.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",n[n.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",n[n.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",n[n.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",n[n.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",n[n.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",n[n.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",n[n.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",n[n.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",n[n.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",n[n.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",n[n.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",n[n.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",n[n.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",n[n.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",n[n.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",n}({}),Jt=function(n){return n.CONNECTING="connecting",n.CONNECTED="connected",n.RECONNECTING="reconnecting",n.CLOSED="closed",n}({}),et=function(n){return n.WS_CONNECTED="ws_connected",n.WS_RECONNECTING="ws_reconnecting",n.WS_CLOSED="ws_closed",n.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",n.ON_BINARY_DATA="on_binary_data",n.REQUEST_RECOVER="request_recover",n.REQUEST_JOIN_INFO="request_join_info",n.REQUEST_REJOIN_INFO="req_rejoin_info",n.IS_P2P_DISCONNECTED="is_p2p_dis",n.DISCONNECT_P2P="dis_p2p",n.ABORT_P2P_EXECUTION="abort_p2p_execution",n.NEED_RENEW_SESSION="need-sid",n.REPORT_JOIN_GATEWAY="report_join_gateway",n.REQUEST_TIMEOUT="request_timeout",n.REQUEST_SUCCESS="request_success",n.JOIN_RESPONSE="join_response",n.PRE_CONNECT_PC="pre_connect_pc",n.P2P_CONNECTION="p2p_connection",n.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",n.P2P_SUBSCRIBE="p2p_subscribe",n.P2P_UNSUBSCRIBE="p2p_unsubscribe",n.P2P_EXCHANGE_SDP="p2p_exchange_sdp",n.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",n.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",n.RECOVER_NOTIFICATION="recover_notification",n}({}),Qe=function(n){return n.PING="ping",n.PING_BACK="ping_back",n.JOIN="join_v3",n.REJOIN="rejoin_v3",n.LEAVE="leave",n.SET_CLIENT_ROLE="set_client_role",n.PUBLISH="publish",n.PUBLISH_DATASTREAM="publish_datastream",n.UNPUBLISH="unpublish",n.UNPUBLISH_DATASTREAM="unpublish_datastream",n.SUBSCRIBE="subscribe",n.PRE_SUBSCRIBE="pre_subscribe",n.SUBSCRIBE_DATASTREAM="subscribe_datastream",n.SUBSCRIBE_STREAMS="subscribe_streams",n.UNSUBSCRIBE="unsubscribe",n.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",n.UNSUBSCRIBE_STREAMS="unsubscribe_streams",n.SUBSCRIBE_CHANGE="subscribe_change",n.TRAFFIC_STATS="traffic_stats",n.RENEW_TOKEN="renew_token",n.SWITCH_VIDEO_STREAM="switch_video_stream",n.DEFAULT_VIDEO_STREAM="default_video_stream",n.SET_FALLBACK_OPTION="set_fallback_option",n.GATEWAY_INFO="gateway_info",n.CONTROL="control",n.SEND_METADATA="send_metadata",n.DATA_STREAM="data_stream",n.PICK_SVC_LAYER="pick_svc_layer",n.RESTART_ICE="restart_ice",n.CONNECT_PC="connect_pc",n.SET_VIDEO_PROFILE="set_video_profile",n.SET_PARAMETER="set_parameter",n.SET_RTM2_FLAG="set_rtm2_flag",n}({}),Im=function(n){return n.WRTC_STATS="wrtc_stats",n.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",n.DENOISER_STATS="denoiser_stats",n.EXTENSION_USAGE_STATS="extension_usage_stats",n}({}),ft=function(n){return n.ON_USER_ONLINE="on_user_online",n.ON_USER_OFFLINE="on_user_offline",n.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",n.ON_PUBLISH_STREAM="on_publish_stream",n.ON_UPLINK_STATS="on_uplink_stats",n.ON_P2P_LOST="on_p2p_lost",n.ON_REMOVE_STREAM="on_remove_stream",n.ON_ADD_AUDIO_STREAM="on_add_audio_stream",n.ON_ADD_VIDEO_STREAM="on_add_video_stream",n.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",n.ON_USER_BANNED="on_user_banned",n.ON_USER_LICENSE_BANNED="on_user_license_banned",n.ON_NOTIFICATION="on_notification",n.ON_CRYPT_ERROR="on_crypt_error",n.MUTE_AUDIO="mute_audio",n.MUTE_VIDEO="mute_video",n.UNMUTE_AUDIO="unmute_audio",n.UNMUTE_VIDEO="unmute_video",n.ON_P2P_OK="on_p2p_ok",n.RECEIVE_METADATA="receive_metadata",n.ON_DATA_STREAM="on_data_stream",n.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",n.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",n.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",n.ENABLE_LOCAL_VIDEO="enable_local_video",n.DISABLE_LOCAL_VIDEO="disable_local_video",n.ENABLE_LOCAL_AUDIO="enable_local_audio",n.DISABLE_LOCAL_AUDIO="disable_local_audio",n.ON_PUBLISHED_USER_LIST="on_published_user_list",n}({}),oi=function(n){return n.SEND_ONLY="SEND_ONLY",n.RECEIVE_ONLY="RECEIVE_ONLY",n}({}),at=function(n){return n.CONNECTED="websocket:connected",n.RECONNECTING="websocket:reconnecting",n.WILL_RECONNECT="websocket:will_reconnect",n.CLOSED="websocket:closed",n.FAILED="websocket:failed",n.ON_MESSAGE="websocket:on_message",n.REQUEST_NEW_URLS="websocket:request_new_urls",n.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",n}({});function RE(n){if(typeof n!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(n))throw A.error("Invalid Channel Name ".concat(n)),new se($.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function OE(n){if(r=n,!(typeof r=="number"&&Math.floor(r)===r&&0<=r&&r<=4294967295||iB(n,1,255)))throw new se($.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var r;typeof n=="string"&&A.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let tc=function(n){return n.TRANSCODE="mix_streaming",n.RAW="raw_streaming",n}({});const dpe={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},FO={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function WO(n,r){vr(n.url,"".concat(r,".url"),1,1e3,!1),hn(n.x)||Bt(n.x,"".concat(r,".x"),0,1e4),hn(n.y)||Bt(n.y,"".concat(r,".y"),0,1e4),hn(n.width)||Bt(n.width,"".concat(r,".width"),0,1e4),hn(n.height)||Bt(n.height,"".concat(r,".height"),0,1e4),hn(n.zOrder)||Bt(n.zOrder,"".concat(r,".zOrder"),0,255),hn(n.alpha)||Bt(n.alpha,"".concat(r,".alpha"),0,1,!1)}const hpe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let Qc=function(n){return n.WARNING="@live_uap-warning",n.ERROR="@line_uap-error",n.PUBLISH_STREAM_STATUS="@live_uap-publish-status",n.WORKER_STATUS="@live_uap-worker-status",n.REQUEST_NEW_ADDRESS="@live_uap-request-address",n}({}),GO=function(n){return n.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",n}({}),Yn=function(n){return n[n.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",n[n.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",n[n.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",n[n.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",n[n.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",n[n.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",n[n.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",n[n.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",n[n.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",n[n.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",n[n.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",n[n.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",n[n.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",n[n.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",n[n.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",n[n.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",n[n.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",n[n.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",n}({});function K3(n){if(!n.channelName)throw new se($.INVALID_PARAMS,"invalid channelName in info");if(typeof n.uid!="number")throw new se($.INVALID_PARAMS,"invalid uid in info, uid must be a number");return n.token&&vr(n.token,"info.token",1,2047),OE(n.uid),RE(n.channelName),!0}let si=function(n){return n[n.SetSdkProfile=0]="SetSdkProfile",n[n.SetSourceChannel=1]="SetSourceChannel",n[n.SetSourceUserId=2]="SetSourceUserId",n[n.SetDestChannel=3]="SetDestChannel",n[n.StartPacketTransfer=4]="StartPacketTransfer",n[n.StopPacketTransfer=5]="StopPacketTransfer",n[n.UpdateDestChannel=6]="UpdateDestChannel",n[n.Reconnect=7]="Reconnect",n[n.SetVideoProfile=8]="SetVideoProfile",n}({}),nc=function(n){return n.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",n.NETWORK_CONNECTED="NETWORK_CONNECTED",n.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",n.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",n.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",n.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",n.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",n.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",n.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",n.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",n}({}),Ii=function(n){return n.RELAY_STATE_IDLE="RELAY_STATE_IDLE",n.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",n.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",n.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",n}({}),Lh=function(n){return n.RELAY_OK="RELAY_OK",n.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",n.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",n.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",n}({}),Dt=function(n){return n.High="high",n.Low="low",n.Audio="audio",n.Screen="screen",n.ScreenLow="screen_low",n}({}),dr=function(n){return n.DISCONNECT="disconnect",n.CONNECTION_STATE_CHANGE="connection-state-change",n.NETWORK_QUALITY="network-quality",n.STREAM_TYPE_CHANGE="stream-type-change",n.IS_P2P_DISCONNECTED="is-p2p-dis",n.DISCONNECT_P2P="dis-p2p",n.REQUEST_NEW_GATEWAY_LIST="req-gate-url",n.NEED_RENEW_SESSION="need-sid",n.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",n.JOIN_RESPONSE="join-response",n.RESET_CONNECTION_EVENTS="reset-connection-events",n.PRE_CONNECT_PC="pre-connect_pc",n.UPDATE_GATEWAY_CONFIG="update-gateway-config",n}({}),AE=function(n){return n.P2P_DISCONNECTED="P2P_DISCONNECTED",n.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",n.TIMEOUT="TIMEOUT",n.UNKNOWN_REASON="UNKNOWN_REASON",n}({}),rr=function(n){return n[n.Nothing=0]="Nothing",n[n.Audio=1]="Audio",n[n.LwoVideo=2]="LwoVideo",n[n.Video=4]="Video",n[n.Data=8]="Data",n[n.DataStream0=256]="DataStream0",n[n.DataStream1=512]="DataStream1",n[n.DataStream2=1024]="DataStream2",n[n.DataStream3=2048]="DataStream3",n[n.DataStream4=4096]="DataStream4",n[n.DataStream5=8192]="DataStream5",n[n.DataStream6=16384]="DataStream6",n[n.DataStream7=32768]="DataStream7",n}({}),Ot=function(n){return n.CHINA="CHINA",n.ASIA="ASIA",n.NORTH_AMERICA="NORTH_AMERICA",n.EUROPE="EUROPE",n.JAPAN="JAPAN",n.INDIA="INDIA",n.KOREA="KOREA",n.HKMC="HKMC",n.US="US",n.OCEANIA="OCEANIA",n.SOUTH_AMERICA="SOUTH_AMERICA",n.AFRICA="AFRICA",n.OVERSEA="OVERSEA",n.GLOBAL="GLOBAL",n.EXTENSIONS="EXTENSIONS",n}({});const q3=[Ot.AFRICA,Ot.ASIA,Ot.CHINA,Ot.EUROPE,Ot.GLOBAL,Ot.INDIA,Ot.JAPAN,Ot.NORTH_AMERICA,Ot.OCEANIA,Ot.OVERSEA,Ot.SOUTH_AMERICA];let kr=function(n){return n.CHINA="CN",n.ASIA="AS",n.NORTH_AMERICA="NA",n.EUROPE="EU",n.JAPAN="JP",n.INDIA="IN",n.KOREA="KR",n.HKMC="HK",n.US="US",n.OCEANIA="OC",n.SOUTH_AMERICA="SA",n.AFRICA="AF",n.OVERSEA="OVERSEA",n.GLOBAL="GLOBAL",n.EXTENSIONS="GLOBAL",n}({});const IE={CHINA:{},ASIA:{CODE:kr.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:kr.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:kr.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:kr.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:kr.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:kr.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:kr.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:kr.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:kr.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:kr.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:kr.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:kr.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:kr.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};dO&&(IE.CHINA={CODE:kr.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let Nm=function(n){return n.UPDATE_BITRATE_LIMIT="update_bitrate_limit",n.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",n}({});function Y3(n){return!!n&&!(!n.uplink||!n.id)&&n.uplink.max_bitrate!==void 0&&n.uplink.min_bitrate!==void 0}class X3 extends ln{constructor(r,i){super(),F(this,"onICEConnectionStateChange",void 0),F(this,"onConnectionStateChange",void 0),F(this,"onDTLSTransportStateChange",void 0),F(this,"onDTLSTransportError",void 0),F(this,"onICETransportStateChange",void 0),F(this,"onFirstAudioReceived",void 0),F(this,"onFirstVideoReceived",void 0),F(this,"onFirstAudioDecoded",void 0),F(this,"onFirstVideoDecoded",void 0),F(this,"onFirstVideoDecodedTimeout",void 0),F(this,"onSelectedLocalCandidateChanged",void 0),F(this,"onSelectedRemoteCandidateChanged",void 0),F(this,"onICECandidateError",void 0),F(this,"getLocalVideoStats",void 0)}}class J3 extends X3{constructor(r,i){super(r,i),F(this,"establishPromise",void 0)}}let Ue=function(n){return n.VIDEO="video",n.AUDIO="audio",n}({}),Fr=function(n){return n.UDP_RELAY="udp_relay",n.UDP_TCP_RELAY="udp_tcp_relay",n.TCP_RELAY="tcp_relay",n.RELAY="relay",n}({}),rc=function(n){return n[n.FIRST_CONNECTION=0]="FIRST_CONNECTION",n[n.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",n[n.RELAY_RESTART=2]="RELAY_RESTART",n[n.TCP_RESTART=3]="TCP_RESTART",n[n.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",n[n.OLD_RESTART=11]="OLD_RESTART",n[n.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",n}({});const Q3=["disconnected","failed"];let Ee=function(n){return n.LocalVideoTrack="videoTrack",n.LocalAudioTrack="audioTrack",n.LocalVideoLowTrack="videoLowTrack",n}({}),xt=function(n){return n.New="new",n.Connected="connected",n.Reconnecting="reconnecting",n.Disconnected="disconnected",n}({}),Ke=function(n){return n.AudioMetadata="audioMetadata",n.StateChange="stateChange",n.IceConnectionStateChange="iceConnectionStateChange",n.RequestMuteLocal="requestMuteLocal",n.RequestUnmuteLocal="requestUnmuteLocal",n.RequestRePublish="requestRePublish",n.RequestRePublishDataChannel="requestRePublishDataChannel",n.RequestReSubscribe="requestReSubscribe",n.RequestUploadStats="requestUploadStats",n.RequestUpload="requestUpload",n.MediaReconnectStart="MediaReconnectStart",n.MediaReconnectEnd="MediaReconnectEnd",n.NeedSignalRTT="NeedSignalRTT",n.RequestRestartICE="RequestRestartIce",n.PeerConnectionStateChange="PeerConnectionStateChange",n.RequestReconnect="RequestReconnect",n.RequestReconnectPC="RequestReconnectPC",n.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",n.P2PLost="P2PLost",n.UpdateVideoEncoder="UpdateVideoEncoder",n.ConnectionTypeChange="ConnectionTypeChange",n.RequestLowStreamParameter="RequestLowStreamParameter",n.QueryClientConnectionState="QueryClientConnectionState",n.LocalCandidate="LocalCandidate",n.RequestP2PMuteLocal="requestP2PMuteLocal",n.RequestP2PUnPublish="RequestP2PUnPublish",n.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",n.RequestP2PMuteRemote="RequestP2PMuteRemote",n.RequestP2PRestartICE="RequestP2PRestartICE",n}({}),ro=function(n){return n.CONNECTING="CONNECTING",n.RECONNECTING="RECONNECTING",n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n}({}),io=function(n){return n[n.CONNECT_AP=0]="CONNECT_AP",n[n.AP_CONNECTED=1]="AP_CONNECTED",n[n.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",n[n.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",n[n.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",n[n.CONNECT_WORKER=5]="CONNECT_WORKER",n[n.WORKER_CONNECTED=6]="WORKER_CONNECTED",n[n.CLOSED=7]="CLOSED",n}({}),hr=function(n){return n.CONNECTION_STATE_CHANGE="connection-state-change",n.STATE_CHANGE="state-change",n.INSPECT_RESULT="inspect-result",n.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",n.REQUEST_NEW_WORKER_URL="request-new-worker-url",n}({}),Z3=function(n){return n.CONNECTED="transmitter:connected",n.RECONNECTING="transmitter:reconnecting",n.WILL_RECONNECT="transmitter:will_reconnect",n.CLOSED="transmitter:closed",n.FAILED="transmitter:failed",n.ON_MESSAGE="transmitter:on_message",n.REQUEST_NEW_URLS="transmitter:request_new_urls",n.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",n.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",n.FAILBACK="transmitter:failback",n.PRE_CONNECT_PC="transmitter:pre_connect_pc",n}({}),_s=function(n){return n.CAMERA_CHANGED="camera-changed",n.MICROPHONE_CHANGED="microphone-changed",n.PLAYBACK_DEVICE_CHANGED="playback-device-changed",n.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",n.AUTOPLAY_FAILED="autoplay-failed",n.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",n.SECURITY_POLICY_VIOLATION="security-policy-violation",n}({}),Aa=function(n){return n.CONNECTING="CONNECTING",n.RECONNECTING="RECONNECTING",n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n}({}),Bo=function(n){return n.CONNECTION_STATE_CHANGE="connection-state-change",n.STATE_CHANGE="state-change",n.INSPECT_RESULT="inspect-result",n.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",n.REQUEST_NEW_WORKER_URL="request-new-worker-url",n}({}),kh=function(n){return n[n.CONNECT_AP=0]="CONNECT_AP",n[n.AP_CONNECTED=1]="AP_CONNECTED",n[n.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",n[n.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",n[n.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",n[n.CONNECT_WORKER=5]="CONNECT_WORKER",n[n.WORKER_CONNECTED=6]="WORKER_CONNECTED",n[n.CLOSED=7]="CLOSED",n}({}),On=function(n){return n.CALL="call",n.CANDIDATE="candidate",n.PUBLISH="publish",n.UNPUBLISH="unpublish",n.CONTROL="control",n.RESTART_ICE="restart_ice",n.ACK="ack",n.RESPONSE="response",n.JOIN="join",n.CHECK="check",n}({}),Mh=function(n){return n.ABORT="abort",n}({}),Zc=function(n){return n.MUTE_LOCAL_AUDIO="mute_local_audio",n.MUTE_LOCAL_VIDEO="mute_local_video",n.UNMUTE_LOCAL_AUDIO="unmute_local_audio",n.UNMUTE_LOCAL_VIDEO="unmute_local_video",n}({}),fpe=function(n){return n.P2P_TOKEN_TIMEOUT="p2p_token_timeout",n.P2P_TOKEN_CHANGED="p2p_token_changed",n}({});const ppe={[CE.ACCESS_POINT]:{[ai.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[ai.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[ai.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[ai.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[ai.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[ai.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[ai.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[CE.UNILBS]:{[no.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[no.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[no.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[no.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[no.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[no.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[no.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[no.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[no.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[no.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[no.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[no.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[CE.STRING_UID_ALLOCATOR]:{[BO.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[BO.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[BO.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Uh(n){const r=ppe[Math.floor(n/1e4)];if(!r)return{desc:"unknown error",retry:!1};const i=r[n%1e4];if(!i){if(Math.floor(n/1e4)===CE.ACCESS_POINT){const s=n%1e4;if(s.toString()[0]==="1")return{desc:n.toString(),retry:!1};if(s.toString()[0]==="2")return{desc:n.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return i}const mpe={[Ye.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Ye.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Ye.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Ye.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Ye.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Ye.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Ye.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Ye.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Ye.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Ye.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Ye.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Ye.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Ye.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Ye.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Ye.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Ye.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Ye.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Ye.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Ye.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Ye.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Ye.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Ye.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Ye.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Ye.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Ye.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Ye.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Ye.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Ye.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Ye.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Ye.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Ye.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Ye.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Ye.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Ye.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Ye.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Ye.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Ye.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Ye.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Ye.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Ye.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Ye.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Ye.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Ye.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Ye.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Ye.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Ye.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Ye.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Ye.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Ye.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Ye.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Ye.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Ye.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Ye.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Ye.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Ye.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Ye.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Ye.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Ye.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Ye.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Ye.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Ye.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Ye.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Ye.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Ye.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function Pm(n){return mpe[n]||{desc:"UNKNOWN_ERROR_".concat(n),action:"failed"}}function e4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function $O(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?e4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}function t4(n,r){if(typeof n=="string")return n;const{proxy:i,host:s,port:c}=n;if(r){const u=Y("JOIN_GATEWAY_FALLBACK_PORT")||443;return u===443?"wss://".concat(s,"/ws/?p=").concat(Number(c)+150):"wss://".concat(s,":").concat(u,"/ws/?p=").concat(Number(c)+150)}return i?"wss://".concat(i,"/ws/?h=").concat(s,"&p=").concat(c):"wss://".concat(s,":").concat(c)}const gpe=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,ype=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,vpe=/wss:\/\/(.+):([0-9]+)\/?/,_pe=/wss:\/\/(.[^\/]+)\/?/;let Epe=0;class Spe{constructor(r,i){F(this,"id",0),F(this,"store",void 0),F(this,"recordIndex",void 0),F(this,"websockets",[]),F(this,"try443PortDuration",2e3),F(this,"forceCloseWSDuration",5e3),F(this,"try443PortTimeout",null),F(this,"forceCloseTimeout",null),F(this,"isTry443PortFailed",!1),F(this,"isNormalPortFailed",!1),F(this,"useDoubleDomain",!1),F(this,"useProxy",!1),F(this,"startTime",Date.now()),this.id=++Epe,this.try443PortDuration=Y("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=r||5e3,this.store=i}closeAllWebsockets(){this.websockets.forEach(r=>{r.onopen=null,r.onclose=null,r.onmessage=null,r.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var r;const i=Date.now()-this.startTime;for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];A.debug("[choose-best-ws ".concat((r=this.store)===null||r===void 0?void 0:r.clientId," ").concat(this.id,"] ").concat(i,"ms:"),...c)}createWebSocket(r,i,s){this.logger("createWebSocket:",r,{isTry443Port:i,hasTimeoutDetection:s});const c=Y("GATEWAY_DOMAINS"),u=Date.now(),h=[],f=c.find(w=>{var O;return Oe(O=r.host).call(O,w)});f||(this.useDoubleDomain=!1);const m=[];if(this.useDoubleDomain)c.forEach(w=>{m.push(t4($O($O({},r),{},{host:r.host.replace(f,w)}),i))});else{const w=$O({},r);if(i&&f){const O=c.find(W=>W!==f);O&&(w.host=w.host.replace(f,O))}m.push(t4(w,i))}try{m.forEach(w=>{const O=new WebSocket(w);O.binaryType="arraybuffer",h.push(O),this.logger("ws is connecting:",O.url)})}catch(w){if(this.logger("ws create failed"),h.forEach(O=>O.close()),h.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(r,i,s);if(!i&&Number(r.port)!==443)return this.createWebSocket(r,!0,s);throw new se($.WS_ERR,"init websocket failed! Error: ".concat(w.toString()))}const y=ym();this.store&&this.store.recordJoinChannelService({urls:h.map(w=>w.url),service:"gateway"},this.recordIndex),h.forEach(w=>{w.onopen=()=>{this.logger("onopen: ws ".concat(w.url," open cost ").concat(Date.now()-u,"ms")),this.websockets.forEach(O=>{O!==w&&(O.onopen=null,O.onclose=null,O.onmessage=null,O.close(),this.logger("close backup websocket: ".concat(O.url)))}),this.websockets.length=0,y.resolve(w)},w.onclose=O=>{this.logger("onclose: ws ".concat(w.url," closed cost ").concat(Date.now()-u,"ms state: ").concat(w.readyState));const W=h.every(k=>k.readyState===WebSocket.CLOSED||k.readyState===WebSocket.CLOSING);this.logger("".concat(i?"443":"47xx"," websocket closed, all failed: ").concat(W)),W&&(i||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(O.reason)),y.reject({code:O.code,reason:AE.A_ROUND_WS_FAILED})):!i&&W&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),S()),i?this.isTry443PortFailed=W:this.isNormalPortFailed=W},w.onmessage=O=>this.logger("".concat(w.url," onmessage: ").concat(O.data))}),this.websockets.push(...h);const _=()=>{this.websockets.forEach(w=>w.readyState!==WebSocket.OPEN&&w.close())},S=()=>{if(y.isResolved)return _();St().os===tr.MAC_OS&&gn()&&_(),this.createWebSocket(r,!0,!0).then(w=>{y.resolve(w)}).catch(w=>{this.isNormalPortFailed&&y.reject(w),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",y.isResolved),this.forceCloseTimeout=null,_()},this.forceCloseWSDuration)};return s||(()=>{if(i||this.useProxy)return this.logger("add 5s timeout at ".concat(i?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,_()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",y.isResolved),this.try443PortTimeout=null,S()},this.try443PortDuration)})(),y.promise}chooseBestWebsocket(r,i,s,c){return this.useDoubleDomain=!!i,typeof r=="string"&&(r=function(u){let h,f,m;return[,h,f,m]=u.match(gpe)||[],h||([,f,m]=u.match(ype)||[]),f&&m||([,f,m]=u.match(vpe)||[]),f&&m||([,f]=u.match(_pe)||[]),f||A.warning("un-destructible url: ",u),{proxy:h,host:f,port:m||"443"}}(r)),this.recordIndex=c,this.useProxy=!!r.proxy,s&&this.useProxy&&(A.warn("cannot use 443 only when use proxy"),s=!1),this.createWebSocket(r,!!s,!1).finally(()=>this.clearTimeout())}}function n4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}class r4 extends ln{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(r){var i;Oe(i=["tryNext","recover"]).call(i,r)&&this.resetReconnectCount(r),this._reconnectMode=r}get state(){return this._state}set state(r){r!==this._state&&(this._state=r,this._state==="reconnecting"?this.emit(at.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(at.CONNECTED):this._state==="closed"?this.emit(at.CLOSED):this._state==="failed"&&this.emit(at.FAILED))}resetReconnectCount(r){A.debug("websocket reset reconnect count, reason: "+r),this.reconnectCount=0}constructor(r,i){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],c=arguments.length>3&&arguments[3]!==void 0&&arguments[3],u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=arguments.length>5?arguments[5]:void 0;super(),F(this,"connectionID",0),F(this,"currentURLIndex",0),F(this,"urls",[]),F(this,"_reconnectMode","tryNext"),F(this,"reconnectReason",void 0),F(this,"_initMutex",void 0),F(this,"name",void 0),F(this,"_state","closed"),F(this,"reconnectInterrupter",void 0),F(this,"websocket",void 0),F(this,"retryConfig",void 0),F(this,"reconnectCount",0),F(this,"forceCloseTimeout",5e3),F(this,"onlineReconnectListener",void 0),F(this,"useCompress",void 0),F(this,"tryDoubleDomain",!1),F(this,"use443PortOnly",!1),F(this,"wsInflateLength",0),F(this,"wsDeflateLength",0),F(this,"closeEstablishingWs",()=>{}),F(this,"store",void 0),F(this,"joinGatewayRecordIndex",void 0),this.store=h,this.name=r,this.retryConfig=function(S){for(var w=1;w<arguments.length;w++){var O=arguments[w]!=null?arguments[w]:{};w%2?n4(Object(O),!0).forEach(function(W){F(S,W,O[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(O)):n4(Object(O)).forEach(function(W){Object.defineProperty(S,W,Object.getOwnPropertyDescriptor(O,W))})}return S}({},i),this.useCompress=s,this.tryDoubleDomain=c,this.use443PortOnly=u,this._initMutex=new Lr("websocket",h?h.clientId:void 0);const{timeout:f,timeoutFactor:m}=i,y=Math.max(300,Math.floor(3*f/5)),_=Math.max(1.2,Math.floor(8*m)/10);Hi.ONLINE&&(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=_),xn.on(gh.NETWORK_STATE_CHANGE,(S,w)=>{S!==w&&(this.resetReconnectCount("network state change: ".concat(w," -> ").concat(S)),S===Hi.ONLINE?(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=_):(this.retryConfig.timeout=f,this.retryConfig.timeoutFactor=m))})}getConnection(){return this.websocket||void 0}async init(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=i,this.urls=r,this.state="connecting";try{const c=ym(),u=this.urls[this.currentURLIndex];Y("ENABLE_PREALLOC_PC")&&this.emit(Z3.PRE_CONNECT_PC),this.createWebSocketConnection(u).then(c.resolve).catch(c.reject),this.once(at.CLOSED,()=>{c.reject(new de($.WS_DISCONNECT))}),this.once(at.CONNECTED,c.resolve),await c.promise}catch{}finally{s()}}close(r,i){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const s=this.websocket;i?setTimeout(()=>s.close(),500):s.close(),this.websocket=void 0}this.state=r?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(r,i){if(!this.websocket)return void A.warning("[".concat(this.name,"] can not reconnect, no websocket"));r!==void 0&&(this.reconnectMode=r),A.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(i)]},this.joinGatewayRecordIndex);const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:i})}sendMessage(r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new de($.WS_ABORT,"websocket is not ready");try{i||(r=JSON.stringify(r)),this.websocket.send(r)}catch(s){throw new de($.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(r){this.wsDeflateLength=this.wsDeflateLength+r.originLength,this.wsInflateLength=this.wsInflateLength+r.compressedLength}getWsInflateData(){const r=this.wsInflateLength,i=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:r,wsDeflateLength:i}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(r){var i;const s=ym();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const c=_=>{var S;(S=this.store)===null||S===void 0||S.signalChannelOpen(),A.debug("[".concat(this.name,"] websocket opened:"),_),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s.resolve()},u=async _=>{var S;if(A.debug("[".concat(this.name,"] websocket close ").concat((S=this.websocket)===null||S===void 0?void 0:S.url,", code: ").concat(_.code,", reason: ").concat(_.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)s.reject(new de($.WS_DISCONNECT,"websocket close: ".concat(_.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=_.reason,this.state="reconnecting");const w=ia(this,at.WILL_RECONNECT,this.reconnectMode,_.reason)||this.reconnectMode,O=await this.reconnectWithAction(w);if(this.state==="closed")return void A.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!O)return s.reject(new de($.WS_DISCONNECT,"websocket reconnect failed: ".concat(_.code))),this.close(!0);s.resolve()}},h=_=>{this.emit(at.ON_MESSAGE,_)},f=_=>{A.warn("[".concat(this.connectionID,"] ws open error ").concat(_))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Y("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(r=Y("GATEWAY_WSS_ADDRESS")),A.debug("[".concat(this.name,"] start connect, url:"),r);const m=(i=this.store)===null||i===void 0?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var y;const _=await this.chooseBestWebsocketConnection(r);this.websocket=_,c&&c(this.websocket.url),this.websocket.onclose=u,this.websocket.onmessage=h,this.websocket.onerror=f,(y=this.store)===null||y===void 0||y.recordJoinChannelService({endTs:Date.now(),status:"success"},m),this.joinGatewayRecordIndex=m}catch(_){const S=this.state==="closed",w=_ instanceof de,O=w&&_.code===$.WS_ABORT,W=w&&_.code===$.WS_ERR,k=w?_.message:_&&(_.reason||_.toString());A.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(k)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:O?"aborted":"error",errors:[_]},m),S||W?(s.reject(S?new de($.WS_DISCONNECT,"websocket is closed: ".concat(k)):new de($.WS_ERR,"init websocket failed: ".concat(k))),W&&A.error("[".concat(this.name,"] init websocket failed: ").concat(k))):u(_)}return s.promise}async reconnectWithAction(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;A.warning("[choose-best-ws] action: =>",r),this.onlineReconnectListener||xn.isOnline||!xn.onlineWaiter||(this.onlineReconnectListener=xn.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let s=!0;if(this.reconnectInterrupter=()=>s=!1,i){const h=rO(this.reconnectCount,this.retryConfig);A.debug("[".concat(this.name,"] wait ").concat(h,"ms to reconnect websocket, mode: ").concat(r)),await Ie.race([_r(h),this.onlineReconnectListener||new Ie(()=>{})])}if(this._state==="closed"||!s)return!1;this.reconnectCount+=1;const c=async(h,f)=>{this.emit(at.RECONNECT_CREATE_CONNECTION,f),await this.createWebSocketConnection(h)};try{if(r==="retry")await c(this.urls[this.currentURLIndex],r);else if(r==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);A.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await c(this.urls[this.currentURLIndex],r)}else r==="recover"&&(A.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Or(this,at.REQUEST_NEW_URLS),this.currentURLIndex=0,await c(this.urls[this.currentURLIndex],r))}catch(h){var u;A.error("[".concat(this.name,"] reconnect failed ").concat(h&&h.toString()));const f=h==null||(u=h.data)===null||u===void 0?void 0:u.desc;return Array.isArray(f)&&Oe(f).call(f,"dynamic key expired")?(this.emit(at.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(r,i)}return!0}}class HO extends r4{constructor(r,i){super(r,i,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(r,i){const s=ym(),c=function(h,f){return new Spe(h,f)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{A.debug("[choose-best-ws] close establishing websockets"),c.closeAllWebsockets(),s.reject(new de($.WS_ABORT,"choose best websocket aborted"))};const u=Y("GATEWAY_DOMAINS");return A.debug("[choose-best-ws] currentDomain: ",r,", domains: ",u,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),c.chooseBestWebsocket(r,this.tryDoubleDomain,this.use443PortOnly,i).then(s.resolve).catch(s.reject),s.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class xm extends r4{constructor(r,i){super(r,i,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(r,i){return new Ie((s,c)=>{let u=!1;const h=[];this.closeEstablishingWs=()=>{A.debug("[choose-best-ws] close establishing websockets"),h.forEach(W=>{W.onclose=null,W.onopen=null,W.onmessage=null,W.close()}),c(new de($.WS_ABORT,"choose best websocket aborted"))};const f=Y("GATEWAY_DOMAINS");let m;const y=r.indexOf("?h="),_=f.find(W=>y!==-1?Oe(r).call(r,W,y):Oe(r).call(r,W));A.debug("[choose-best-ws] currentDomain: ",_,", domains: ",f);let S=!this.tryDoubleDomain||!_;if(!S&&_){var w;const W=Date.now();try{f.forEach(k=>{const j=y===-1?r.replace(_,k):r.substr(0,y)+r.substr(y).replace(_,k),H=new WebSocket(j);H.binaryType="arraybuffer",h.push(H),A.debug("[choose-best-ws] ws is connecting:",H.url)})}catch{for(A.debug("[choose-best-ws] ws create failed, fallback to single url"),h.forEach(j=>j.close());h.length;)h.pop();S=!0}(w=this.store)===null||w===void 0||w.recordJoinChannelService({urls:h.map(k=>k.url),service:"gateway"},i),h.forEach(k=>{k.onopen=()=>{if(u)return;const j=Date.now()-W;A.debug("[choose-best-ws] ws open cost ".concat(j,"ms")),h.filter(H=>H!==k).forEach(H=>{A.debug("[choose-best-ws]close backup websocket: ".concat(H.url)),H.close()}),u=!0,s(k)},k.onclose=j=>{m=j,!u&&(h.find(H=>!(H.readyState===WebSocket.CLOSED||H.readyState===WebSocket.CLOSING))||(A.debug("[choose-best-ws] all websocket is closed"),u=!0,c(m)))},k.onmessage=j=>{A.debug("[choose-best-ws]".concat(k.url," onmessage: ").concat(j.data))}}),_r(this.forceCloseTimeout).then(()=>{h.forEach(k=>{k.readyState!==WebSocket.OPEN&&k.close()})})}if(S){var O;let W;A.debug("[choose-best-ws] use single url: ",r),(O=this.store)===null||O===void 0||O.recordJoinChannelService({urls:[r],service:"gateway"},i);try{W=new WebSocket(r),h.push(W),W.binaryType="arraybuffer"}catch(k){const j=new de($.WS_ERR,"init websocket failed! Error: ".concat(k.toString()));return A.error("[".concat(this.name,"]").concat(j)),void c(j)}W.onopen=()=>{s(W)},W.onclose=k=>{c(k)},W.onmessage=k=>{A.debug("[choose-best-ws]".concat(W.url," onmessage: ").concat(k.data))},_r(this.forceCloseTimeout).then(()=>{W&&W.readyState!==WebSocket.OPEN&&W.close()})}}).then(s=>(this.closeEstablishingWs=void 0,s)).catch(s=>{throw this.closeEstablishingWs=void 0,s})}}class bpe extends ln{get connectionState(){return this._connectionState}set connectionState(r){r!==this._connectionState&&(this._connectionState=r,r===Jt.CONNECTED?this.emit(et.WS_CONNECTED):r===Jt.RECONNECTING?this.emit(et.WS_RECONNECTING,this._websocketReconnectReason):r===Jt.CLOSED&&this.emit(et.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(r,i){super(),F(this,"_disconnectedReason",void 0),F(this,"_websocketReconnectReason",void 0),F(this,"_connectionState",Jt.CLOSED),F(this,"reconnectToken",void 0),F(this,"websocket",void 0),F(this,"openConnectionTime",void 0),F(this,"clientId",void 0),F(this,"lastMsgTime",Date.now()),F(this,"uploadCache",[]),F(this,"uploadCacheInterval",void 0),F(this,"rttRolling",new EB(5)),F(this,"pingpongTimer",void 0),F(this,"wsInflateDataTimer",void 0),F(this,"pingpongTimeoutCount",0),F(this,"joinResponse",void 0),F(this,"multiIpOption",void 0),F(this,"initError",void 0),F(this,"spec",void 0),F(this,"store",void 0),F(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(et.ON_BINARY_DATA,s.data);const c=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const u="res-@".concat(c._id);this.emit(u,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){if(this.emit(c._type,c._message),c._type===ft.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===ft.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(Pt.UID_BANNED);break;case 15:this.close(Pt.IP_BANNED);break;case 16:this.close(Pt.CHANNEL_BANNED)}if(c._type===ft.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case Ye.ERR_LICENSE_MISSING:this.close(Pt.LICENSE_MISSING);break;case Ye.ERR_LICENSE_EXPIRED:this.close(Pt.LICENSE_EXPIRED);break;case Ye.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Pt.LICENSE_MINUTES_EXCEEDED);break;case Ye.ERR_LICENSE_PERIOD_INVALID:this.close(Pt.LICENSE_PERIOD_INVALID);break;case Ye.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Pt.LICENSE_MULTIPLE_SDK_SERVICE);break;case Ye.ERR_LICENSE_ILLEGAL:this.close(Pt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=r.clientId,this.spec=r,this.store=i,this.websocket=new HO("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Jt.CONNECTED&&this.reconnect("retry",Rr.OFFLINE)})}async request(r,i,s,c){const u=qt(6,""),h={_id:u,_type:r,_message:i},f=this.websocket.connectionID,m=()=>new Ie((W,k)=>{if(this.connectionState===Jt.CONNECTED)return W();const j=()=>{this.off(et.WS_CLOSED,H),W()},H=()=>{this.off(et.WS_CONNECTED,j),k(new se($.WS_ABORT))};this.once(et.WS_CONNECTED,j),this.once(et.WS_CLOSED,H),r!==Qe.PUBLISH&&r!==Qe.PUBLISH_DATASTREAM&&r!==Qe.SUBSCRIBE&&r!==Qe.SUBSCRIBE_DATASTREAM&&r!==Qe.UNSUBSCRIBE&&r!==Qe.UNSUBSCRIBE_DATASTREAM&&r!==Qe.UNPUBLISH&&r!==Qe.UNPUBLISH_DATASTREAM&&r!==Qe.CONTROL&&r!==Qe.RESTART_ICE||this.once(et.DISCONNECT_P2P,()=>{k(new se($.DISCONNECT_P2P))}),r!==Qe.PUBLISH&&r!==Qe.RESTART_ICE||this.once(et.ABORT_P2P_EXECUTION,()=>{k(new se($.DISCONNECT_P2P))})});if(this.connectionState!==Jt.CONNECTING&&this.connectionState!==Jt.RECONNECTING||r===Qe.JOIN||r===Qe.REJOIN||await m(),this.websocket.sendMessage(h,!0),c)return;const y=new Ie((W,k)=>{let j=!1;const H=(Q,ie)=>{j=!0,W({isSuccess:Q==="success",message:ie||{}}),this.off(et.WS_CLOSED,K),this.off(et.WS_RECONNECTING,K),this.emit(et.REQUEST_SUCCESS,r,i)};this.once("res-@".concat(u),H);const K=()=>{k(new se($.WS_ABORT,"type: ".concat(r))),this.off(et.WS_CLOSED,K),this.off(et.WS_RECONNECTING,K),this.off("res-@".concat(u),H)};this.once(et.WS_CLOSED,K),this.once(et.WS_RECONNECTING,K),_r(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||j||(A.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(r)),this.emit(et.REQUEST_TIMEOUT,r,i))})});let _=null;try{_=await y}catch(W){if(this.connectionState===Jt.CLOSED||r===Qe.LEAVE)throw new se($.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?W.throw():r===Qe.JOIN||r===Qe.REJOIN?null:(await m(),await this.request(r,i))}if(_.isSuccess)return _.message;const S=Number(_.message.error_code||_.message.code),w=Pm(S),O=new se($.UNEXPECTED_RESPONSE,"".concat(w.desc,": ").concat(_.message.error_str),{code:S,data:_.message,desc:w.desc});return w.action==="success"?_.message:(A.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(r,", error_code: ").concat(S,", message: ").concat(w.desc,", action: ").concat(w.action)),S===Ye.ERR_TOO_MANY_BROADCASTERS?((r===Qe.JOIN||r===Qe.REJOIN)&&(this.initError=O,this.close()),O.throw()):w.action==="failed"?O.throw():w.action==="quit"?(this.initError=O,this.close(),O.throw()):(S===Ye.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_.message.option,A.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Rr.MULTI_IP)):this.reconnect(w.action,Rr.SERVER_ERROR),r===Qe.JOIN||r===Qe.REJOIN?null:await this.request(r,i)))}waitMessage(r,i){return new Ie(s=>{const c=u=>{(!i||i(u))&&(this.off(r,c),s(u))};this.on(r,c)})}uploadWRTCStats(r){if(!this.store.sessionId)return void A.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const i={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:r};this.upload(Im.WRTC_STATS,i)}upload(r,i){const s={_type:r,_message:i};try{this.websocket.sendMessage(s)}catch{const u=Y("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Jt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Y("UPLOAD_CACHE_INTERVAL")||2e3))}}send(r,i){const s={_type:r,_message:i};this.websocket.sendMessage(s)}init(r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ie((i,s)=>{this.once(et.WS_CONNECTED,()=>i(this.joinResponse)),this.once(et.WS_CLOSED,c=>s(this.initError||new se($.WS_ABORT,c))),this.connectionState=Jt.CONNECTING,this.websocket.init(r).catch(s),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=r||Pt.LEAVE,this.connectionState=Jt.CLOSED,A.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(et.ABORT_P2P_EXECUTION);const r=await Or(this,et.REQUEST_JOIN_INFO),i=await this.request(Qe.JOIN,r);if(!i)return this.emit(et.REPORT_JOIN_GATEWAY,AE.TIMEOUT,this.url||""),!1;this.joinResponse=i,this.emit(et.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Jt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new se($.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const r=bm(this,et.REQUEST_REJOIN_INFO);r.token=this.reconnectToken;const i=await this.request(Qe.REJOIN,r);return!!i&&(this.connectionState=Jt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),i.peers&&i.peers.forEach(s=>{this.emit(ft.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(ft.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(ft.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(ft.MUTE_AUDIO,{uid:s.uid}):this.emit(ft.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(ft.MUTE_VIDEO,{uid:s.uid}):this.emit(ft.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(ft.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(ft.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(ft.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(ft.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(ft.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(r,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(r,i)}handleNotification(r){A.debug("[".concat(this.clientId,"] receive notification: "),r);const i=Pm(r.code);if(r.code===28&&"detail"in r&&(A.info("[".concat(this.clientId,"] receive recover notification: "),r.detail),this.emit(et.RECOVER_NOTIFICATION,r.detail)),i.action!=="success"){if(i.action!=="failed")return i.action==="quit"?(i.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Pt.UID_BANNED),void this.close()):void this.reconnect(i.action,Rr.SERVER_ERROR);A.error("[".concat(this.clientId,"] ignore error: "),i.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const r=Y("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=r&&(A.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>Y("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Rr.TIMEOUT):this.request(Qe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-i;this.rttRolling.add(s),Y("REPORT_STATS")&&this.send(Qe.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWsInflateData(){const{wsInflateLength:r,wsDeflateLength:i}=this.websocket.getWsInflateData();r!==0&&i!==0&&this.upload(Im.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:i,ws_inflate_length:r})}handleWebsocketEvents(){this.websocket.on(at.RECONNECT_CREATE_CONNECTION,r=>{this.emit(et.WS_RECONNECT_CREATE_CONNECTION,r)}),this.websocket.on(at.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(at.CLOSED,()=>{this.connectionState=Jt.CLOSED}),this.websocket.on(at.FAILED,()=>{this._disconnectedReason=Pt.NETWORK_ERROR,this.connectionState=Jt.CLOSED}),this.websocket.on(at.RECONNECTING,r=>{this._websocketReconnectReason=r,this.joinResponse=void 0,this.connectionState===Jt.CONNECTED?this.connectionState=Jt.RECONNECTING:this.connectionState=Jt.CONNECTING}),this.websocket.on(at.WILL_RECONNECT,(r,i,s)=>{const c=bm(this,et.IS_P2P_DISCONNECTED),u=c||r!=="retry";c&&r==="retry"&&(A.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),r="tryNext",i=AE.P2P_DISCONNECTED),u&&(A.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(r)),this.emit(et.REPORT_JOIN_GATEWAY,i||AE.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(et.DISCONNECT_P2P)),s(r)}),this.websocket.on(at.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(r=>{A.warning("[".concat(this.clientId,"] rejoin failed ").concat(r)),this.reconnect("tryNext",Rr.SERVER_ERROR)}):this.join().catch(r=>{if(this.emit(et.REPORT_JOIN_GATEWAY,r,this.url||""),r instanceof se){if(r.code===$.UNEXPECTED_RESPONSE&&r.data.code===Ye.ERR_NO_AUTHORIZED)return this.initError=new se($.TOKEN_EXPIRE,"dynamic key expired"),void this.close(Pt.TOKEN_EXPIRE);A.error("[".concat(this.clientId,"] join gateway request failed"),r.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Rr.SERVER_ERROR):(this.initError=r,this.close())}})}),this.websocket.on(at.REQUEST_NEW_URLS,(r,i)=>{Or(this,et.REQUEST_RECOVER,this.multiIpOption).then(r).catch(i)}),this.websocket.on(at.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ft.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(Z3.PRE_CONNECT_PC,()=>{this.emit(et.PRE_CONNECT_PC)})}}let Tpe=function(n){return n.NATIVE_RTC="native_rtc",n.NATIVE_RTM="native_rtm",n.WEB_RTC="web_rtc",n.WEB_RTM="web_rtm",n}({}),Dn=function(n){return n[n.CHOOSE_SERVER=11]="CHOOSE_SERVER",n[n.CLOUD_PROXY=18]="CLOUD_PROXY",n[n.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",n[n.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",n}({});function i4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function NE(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?i4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):i4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}function jh(n){return n.match(/^[\.\:\d]+$/)?"".concat(n.replace(/[^\d]/g,"-"),".").concat(Y("TURN_DOMAIN")):(A.debug("Cannot recognized as ip address: ".concat(n,", use as host")),n)}function zO(n,r){n.addresses||(n.addresses=[]);const i=function(f,m){if(Y("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return f.map(S=>{let{ip:w,port:O}=S;return{address:"".concat(w,":").concat(O)}});const y=Y("GATEWAY_DOMAINS");let _=y[1]&&Oe(m).call(m,y[1])?1:0;return f.map(S=>{let{domain_prefix:w,port:O,ip:W}=S;if(w)return{address:"".concat(w,".").concat(y[_++%y.length],":").concat(O)};const k=/^[\.\:\d]+$/.test(W),j=k?"".concat(W.replace(/[^\d]/g,"-"),".").concat(y[_++%y.length],":").concat(O):"".concat(W,":").concat(O);return k||A.debug("Cannot recognized as ip address: ".concat(W,", use as host")),{ip:W,port:O,address:j}})}(n.addresses,r),s=Array.isArray(n.detail)&&n.detail[18];if(s&&typeof s=="string"){const f=s.split(";");for(let m=0;m<f.length;m++){var c;const y=Hr(c=f[m]).call(c);i[m]&&y&&(i[m].ip6=y)}}const u=n.detail&&n.detail.candidate;let h;if(u){const[f,m]=u.split(":");f&&m&&(h={port:Number(m),ip:f,address:"".concat(f,":").concat(m)})}return{gatewayAddrs:i,apGatewayAddress:h,uid:n.uid,cid:n.cid,cert:n.cert,vid:n.detail&&n.detail[8],uni_lbs_ip:n.detail&&n.detail[1],res:n,csIp:n.detail&&n.detail[502]}}function zi(n){return typeof n=="number"?n:n.exact||n.ideal||n.max||n.min||0}function a4(n){const r=n._encoderConfig;if(!r)return{};const i={resolution:r.width&&r.height?"".concat(zi(r.width),"x").concat(zi(r.height)):void 0,maxVideoBW:r.bitrateMax,minVideoBW:r.bitrateMin};return typeof r.frameRate=="number"?(i.maxFrameRate=r.frameRate,i.minFrameRate=r.frameRate):r.frameRate&&(i.maxFrameRate=r.frameRate.max||r.frameRate.ideal||r.frameRate.exact||r.frameRate.min,i.minFrameRate=r.frameRate.min||r.frameRate.ideal||r.frameRate.exact||r.frameRate.max),i}function o4(n){return n>=0&&n<.17?1:n>=.17&&n<.36?2:n>=.36&&n<.59?3:n>=.59&&n<=1?4:n>1?5:0}function Dm(n,r){let i,s,c;switch(r){case Dn.CHOOSE_SERVER:s=4096,c="choose server";break;case Dn.CLOUD_PROXY:s=1048576,c="proxy";break;case Dn.CLOUD_PROXY_5:s=4194304,c="proxy5";break;case Dn.CLOUD_PROXY_FALLBACK:s=4194310,c="proxy fallback";break;default:throw new se($.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:n.detail&&n.detail[502],retry:!1})}if(n.response_body.forEach(u=>{u.buffer&&u.buffer.flag===s&&(i={code:u.buffer.code,addresses:(u.buffer.edges_services||[]).map(h=>NE(NE({},h),{},{ticket:u.buffer.cert})),server_ts:n.enter_ts,uid:u.buffer.uid,cid:u.buffer.cid,cname:u.buffer.cname,detail:NE(NE({},u.buffer.detail),n.detail),flag:u.buffer.flag,opid:n.opid,cert:u.buffer.cert})}),!i)throw new se($.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(c," from multi unilbs response"),{csIp:n.detail&&n.detail[502]});return i}async function s4(n,r){return await Ie.all(n.addresses.map(async i=>({address:jh(i.ip),tcpport:i.port,udpport:i.port,username:r&&Y("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?r.toString():Ar.username,password:r&&Y("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await Z0(r.toString()):Ar.password})))}function KO(n,r){const i=r.getMediaStreamTrack(!0).getSettings(),s=r.videoHeight||i.height,c=r.videoWidth||i.width;return s&&c?Math.max(Math.min(s,c)/Math.min(zi(n.height),zi(n.width)),1):(A.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function el(n){let{candidateType:r,relayProtocol:i,type:s,address:c,port:u,protocol:h}=n;const f={candidateType:r,relayProtocol:i,protocol:h};if(s!=="local-candidate"){const m=c.split(".");m.length>=4&&(m[1]="*",m[2]="*"),f.address=m.join("."),f.port=u}return f}function PE(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y("SVC_MODE");if(Y("ENABLE_SVC"))return function(r){return r in oE}(n)?n:oE.L1T3}const c4={[Ue.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[Ue.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function xE(n,r,i){r.forEach(s=>{var c;const u=c4[n].find(f=>{var m;let{key:y}=f;return Oe(m=s.extensionName).call(m,y)});if(!u)return;const h=i.find(f=>{let{extensionName:m}=f;return Oe(m).call(m,u.key)});h&&Oe(c=h.extensionName).call(c,"gdpr_forbidden")&&(s.extensionName=h.extensionName)})}function Vh(n,r){r.forEach(i=>{var s;const c=c4[n].find(u=>{var h;let{key:f}=u;return Oe(h=i.extensionName).call(h,f)});Oe(s=i.extensionName).call(s,"gdpr_forbidden")&&c&&(i.extensionName=c.extensionName)})}function l4(n){return n==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||Oe(n).call(n,"abs-send-time")}function DE(n){return n==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||Oe(n).call(n,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function u4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function d4(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?u4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):u4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}function Lm(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;const{filterRTX:c,filterVideoFec:u,filterAudioFec:h,filterAudioCodec:f,filterVideoCodec:m}=r,{useXR:y}=i;let _=[],S=[],w=[],O=[],W=!1,k=!1;if(Ai(n).mediaDescriptions.forEach(H=>{s&&s!==H.attributes.direction||(H.media.mediaType!=="video"||W||(S=H.attributes.payloads,O=H.attributes.extmaps,W=!0),H.media.mediaType!=="audio"||k||(_=H.attributes.payloads,w=H.attributes.extmaps,k=!0))}),!O||S.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!w||_.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(S.forEach(H=>{var K;(K=H.rtpMap)!==null&&K!==void 0&&K.clockRate&&(H.rtpMap.clockRate=parseInt(H.rtpMap.clockRate)),y&&H.rtcpFeedbacks.push({type:"rrtr"})}),_.forEach(H=>{var K;(K=H.rtpMap)!==null&&K!==void 0&&K.clockRate&&(H.rtpMap.clockRate=parseInt(H.rtpMap.clockRate)),y&&H.rtcpFeedbacks.push({type:"rrtr"})}),c&&(_=_.filter(H=>{var K;return((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName.toLowerCase())!=="rtx"}),S=S.filter(H=>{var K;return((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName.toLowerCase())!=="rtx"})),u&&(S=S.filter(H=>{var K;return!/(red)|(ulpfec)|(flexfec)/i.test(((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName)||"")})),h&&(_=_.filter(H=>{var K;return!/(red)|(ulpfec)|(flexfec)/i.test(((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName)||"")})),f&&(f==null?void 0:f.length)>0&&(_=_.filter(H=>{var K;return Oe(f).call(f,((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName.toLowerCase())||"")})),m&&(m==null?void 0:m.length)>0){const H=S.filter(K=>{var Q;return Oe(m).call(m,((Q=K.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLowerCase())||"")});S=H.concat(c?[]:XO(H,S))}const j=Y("UNSUPPORTED_VIDEO_CODEC");return j&&j.length>0&&(S=S.filter(H=>!(H.rtpMap&&Oe(j).call(j,H.rtpMap.encodingName.toLowerCase())))),{audioCodecs:_,videoCodecs:S,audioExtensions:w,videoExtensions:O}}function tl(n){const r=Ai(n);let i,s;for(const c of r.mediaDescriptions){if(!i){const u=c.attributes.iceUfrag,h=c.attributes.icePwd;if(!u||!h)throw new Error("Cannot get iceUfrag or icePwd from SDP.");i={iceUfrag:u,icePwd:h}}if(!s){const u=c.attributes.fingerprints;u.length>0&&(s={fingerprints:u})}}if(!s&&r.attributes.fingerprints.length>0&&(s={fingerprints:r.attributes.fingerprints}),!s||!i)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:i,dtlsParameters:s}}function h4(n,r){const i=[],s=n.attributes.ssrcGroups.filter(h=>h.semantic==="FID"),c=n.attributes.ssrcGroups.find(h=>h.semantic==="SIM"),u=n.attributes.ssrcs;if(c)c.ssrcIds.forEach(h=>{var f;const m=(f=s.find(y=>y.ssrcIds[0]===h))===null||f===void 0?void 0:f.ssrcIds[1];i.push({ssrcId:h,rtx:r?m:void 0})});else if(s.length>0){const h=s[0].ssrcIds[0],f=s[0].ssrcIds[1];i.push({ssrcId:h,rtx:r?f:void 0})}else{if(u.length===0)throw new Error("No ssrcs found on local media description.");i.push({ssrcId:u[0].ssrcId})}return i}function f4(n,r,i){const{cname:s}=n;let c=[];r&&(c=p4(r)),c.length===0&&(c=n.iceParameters.candidates.map(_=>({foundation:_.foundation,componentId:"1",transport:_.protocol,priority:_.priority.toString(),connectionAddress:_.ip,port:_.port.toString(),type:_.type,extension:{}})),A.debug("Using candidates from gateway."));const u={fingerprints:n.dtlsParameters.fingerprints.map(_=>({hashFunction:_.algorithm,fingerprint:_.fingerprint}))},h={iceUfrag:n.iceParameters.iceUfrag,icePwd:n.iceParameters.icePwd};let f;switch(n.dtlsParameters.role){case"server":f="passive";break;case"client":f="active";break;case"auto":f="actpass"}const m=kE(n.rtpCapabilities),y=[];return Array.isArray(i)&&i.length>0&&i.forEach(_=>{y.push({kind:Ue.VIDEO,ssrcId:_.v,rtx:_.v_rtx,mslabel:"".concat(_.v,"_").concat(_.a)},{kind:Ue.AUDIO,ssrcId:_.a,mslabel:"".concat(_.v,"_").concat(_.a)})}),{dtlsParameters:u,iceParameters:h,candidates:c,rtpCapabilities:m,setup:f,cname:s,preSSRCs:y}}function p4(n){let r=[];return n.ip&&typeof n.port=="number"&&(r=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip,port:n.port.toString(),type:"host",extension:{}}],A.debug("Using remote candidate from AP ".concat(n.ip,":").concat(n.port)),n.ip6&&(r.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip6,port:n.port.toString(),type:"host",extension:{}}),A.debug("Using IPV6 remote candidate from AP ".concat(n.ip6,":").concat(n.port)))),r}function ku(n,r,i){const s=[],c=[];return n.forEach(u=>{let{ssrcId:h,rtx:f}=u;const m=qt(8,"track-"),y={ssrcId:h,attributes:d4({label:m,mslabel:i=i||qt(10,""),msid:"".concat(i," ").concat(m)},r&&{cname:r})};if(s.push(y),f!==void 0){const _={ssrcId:f,attributes:d4({label:m,mslabel:i,msid:"".concat(i," ").concat(m)},r&&{cname:r})};s.push(_),c.push({semantic:"FID",ssrcIds:[h,f]})}}),n.length>1&&c.push({semantic:"SIM",ssrcIds:n.map(u=>{let{ssrcId:h}=u;return h})}),{ssrcs:s,ssrcGroups:c}}function Bh(n,r){r instanceof vn&&n.attributes.payloads.forEach(i=>{var s;const c=(s=i.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase();if(!c||["opus","pcmu","pcma","g722"].indexOf(c)===-1)return;i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters.minptime="10",i.fmtp.parameters.useinbandfec="1";const u=r._encoderConfig;u&&c!=="pcmu"&&c!=="pcma"&&c!=="g722"&&(u.bitrate&&!gn()&&(i.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*u.bitrate))),u.sampleRate&&(i.fmtp.parameters.maxplaybackrate="".concat(u.sampleRate),i.fmtp.parameters["sprop-maxcapturerate"]="".concat(u.sampleRate)),u.stereo&&(i.fmtp.parameters.stereo="1",i.fmtp.parameters["sprop-stereo"]="1"))})}function qO(n){const r=n.attributes.unrecognized.findIndex(i=>i.attField==="x-google-flag"&&i.attValue==="conference");r!==-1&&n.attributes.unrecognized.splice(r,1)}function YO(n,r){var i;if(!(r instanceof tn&&r._encoderConfig&&r._hints.indexOf(Yt.SCREEN_TRACK)===-1))return;const s=r._encoderConfig;bt().supportMinBitrate&&s.bitrateMin&&n.attributes.payloads.forEach(c=>{var u,h;Oe(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=c.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-min-bitrate"]="".concat(s.bitrateMin))}),bt().supportMinBitrate&&!Oe(i=r._hints).call(i,Yt.LOW_STREAM)&&s.bitrateMax&&n.attributes.payloads.forEach(c=>{var u,h;Oe(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=c.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-start-bitrate"]="".concat(Y("X_GOOGLE_START_BITRATE")||Math.floor(s.bitrateMax)))})}function m4(n){if(n.media.mediaType!=="video")return;const r=St();if(r.name!==Nt.SAFARI&&r.os!==tr.IOS)return;const i=n.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));i!==-1&&n.attributes.extmaps.splice(i,1)}function LE(n,r,i){if(!r)return;let s,c;if(n.media.mediaType==="video"?(s=i.videoExtensions,c=i.videoCodecs):(s=i.audioExtensions,c=i.audioCodecs),r.twcc===!0){const u=s.find(h=>DE(h.extensionName));if(u){const h=u.extensionName;n.attributes.extmaps.find(m=>DE(m.extensionName))||n.attributes.extmaps.push({entry:u.entry,extensionName:h}),function(m,y){return y.filter(_=>!!m.find(S=>S.payloadType===_.payloadType&&!!S.rtcpFeedbacks.find(w=>w.type==="transport-cc")))}(c,n.attributes.payloads).forEach(m=>{m.rtcpFeedbacks.find(y=>y.type==="transport-cc")||m.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(r.twcc===!1){const u=n.attributes.extmaps.findIndex(h=>DE(h.extensionName));u!==-1&&n.attributes.extmaps.splice(u,1),n.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(m=>m.type==="transport-cc");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}if(r.remb===!0){const u=s.find(h=>l4(h.extensionName));if(u){const h=u.extensionName;n.attributes.extmaps.find(m=>m.extensionName===h)||n.attributes.extmaps.push({entry:u.entry,extensionName:h}),function(m,y){return y.filter(_=>!!m.find(S=>S.payloadType===_.payloadType&&!!S.rtcpFeedbacks.find(w=>w.type==="goog-remb")))}(c,n.attributes.payloads).forEach(m=>{m.rtcpFeedbacks.find(y=>y.type==="goog-remb")||m.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(r.remb===!1){const u=n.attributes.extmaps.findIndex(h=>l4(h.extensionName));u!==-1&&n.attributes.extmaps.splice(u,1),n.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(m=>m.type==="goog-remb");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}}function g4(n,r,i){if(gn()||n.media.mediaType!=="video"||!(r instanceof tn)||i!=="vp9"&&i!=="vp8"||i==="vp8"&&!Y("SIMULCAST")||i==="vp9"&&Y("ENABLE_SVC")||r._scalabilityMode===void 0||r._scalabilityMode.numSpatialLayers<=1)return;const s=i==="vp8"?2:r._scalabilityMode.numSpatialLayers,c=n.attributes.ssrcs[0],u=n.attributes.ssrcGroups.find(f=>f.semantic==="FID"&&f.ssrcIds[0]===c.ssrcId),h={semantic:"SIM",ssrcIds:[c.ssrcId]};for(let f=1;f<s;f++)n.attributes.ssrcs.push({ssrcId:c.ssrcId+f,attributes:yn(c.attributes)}),h.ssrcIds.push(c.ssrcId+f),u&&(n.attributes.ssrcs.push({ssrcId:u.ssrcIds[1]+f,attributes:yn(c.attributes)}),n.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[c.ssrcId+f,u.ssrcIds[1]+f]}));n.attributes.ssrcGroups.unshift(h)}async function y4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=new RTCPeerConnection;i.addTransceiver("video",{direction:"sendonly"}),i.addTransceiver("audio",{direction:"sendonly"}),i.addTransceiver("video",{direction:"recvonly"}),i.addTransceiver("audio",{direction:"recvonly"});const s=(await i.createOffer()).sdp,{send:c,recv:u,sendrecv:h}=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;const _=Lm(y,f,m,"sendonly"),S=Lm(y,f,m,"recvonly"),w={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},O={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},W={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(_,S,"videoExtensions",w,O,W),ao(_,S,"videoCodecs",w,O,W),ao(_,S,"audioExtensions",w,O,W),ao(_,S,"audioCodecs",w,O,W),Y("RAISE_H264_BASELINE_PRIORITY")){const k=[],j=[];W.videoCodecs.forEach((H,K)=>{var Q;if(((Q=H.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLocaleLowerCase())==="h264"){var ie,re;const te=W.videoCodecs[K+1],he=te&&b4(H,te),Se=(ie=H.fmtp)===null||ie===void 0?void 0:ie.parameters["profile-level-id"],Ne=(re=H.fmtp)===null||re===void 0?void 0:re.parameters["packetization-mode"];!Se||Se!==Y("FIRST_H264_PROFILE_LEVEL_ID")||Y("FIRST_PACKETIZATION_MODE")&&Ne!==Y("FIRST_PACKETIZATION_MODE")?he?j.push([H,te]):j.push([H]):he?k.push([H,te]):k.push([H])}}),k.length>0&&j.length>0&&(A.debug("raising H264 baseline profile priority"),W.videoCodecs.forEach((H,K)=>{var Q;if(((Q=H.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLocaleLowerCase())==="h264"){const ie=b4(H,W.videoCodecs[K+1]),re=k.shift()||j.shift()||[];re.length>0&&(ie?W.videoCodecs.splice(K,2,...re):W.videoCodecs.splice(K,1,...re))}}),O.videoCodecs=O.videoCodecs.filter(H=>{var K,Q;return!(((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName.toLocaleLowerCase())==="h264"&&((Q=H.fmtp)===null||Q===void 0?void 0:Q.parameters["profile-level-id"])!==Y("FIRST_H264_PROFILE_LEVEL_ID"))}),Y("FILTER_SEND_H264_BASELINE")&&(w.videoCodecs=w.videoCodecs.filter(H=>{var K,Q;return!(((K=H.rtpMap)===null||K===void 0?void 0:K.encodingName.toLocaleLowerCase())==="h264"&&((Q=H.fmtp)===null||Q===void 0?void 0:Q.parameters["profile-level-id"])!==Y("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:w,recv:O,sendrecv:W}}(n,r,s);try{i.close()}catch{}return{send:c,recv:u,sendrecv:h}}function v4(){const n={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},r=Lm(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(n,r,"videoExtensions",i,s,c),ao(n,r,"videoCodecs",i,s,c),ao(n,r,"audioExtensions",i,s,c),ao(n,r,"audioCodecs",i,s,c),Y("RAISE_H264_BASELINE_PRIORITY")){const u=c.videoCodecs.findIndex(h=>h.rtpMap&&h.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&h.fmtp&&h.fmtp.parameters["profile-level-id"]==="42001f");if(u!==-1){const h=c.videoCodecs.findIndex(f=>f.rtpMap&&f.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(h<u){A.debug("raising H264 baseline profile priority");const f=c.videoCodecs[u];c.videoCodecs.splice(u,1),c.videoCodecs.splice(h,0,f)}h!==-1&&(s.videoCodecs=s.videoCodecs.filter(f=>!(f.rtpMap&&f.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&f.fmtp&&f.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:i,recv:s,sendrecv:c}}function ao(n,r,i,s,c,u){if(i==="videoExtensions"||i==="audioExtensions"){const h=[];return n[i].forEach(f=>{r[i].some((m,y)=>{if(f.entry===m.entry&&f.extensionName===m.extensionName)return h.push(y),!0})?u[i].push(f):s[i].push(f)}),void r[i].forEach((f,m)=>{h.indexOf(m)===-1&&c[i].push(f)})}if(i==="videoCodecs"||i==="audioCodecs"){const h=[];return n[i].forEach(f=>{r[i].some((m,y)=>{if(f.payloadType===m.payloadType&&JSON.stringify(f)===JSON.stringify(m))return h.push(y),!0})?u[i].push(f):s[i].push(f)}),void r[i].forEach((f,m)=>{h.indexOf(m)===-1&&c[i].push(f)})}}function kE(n){const{send:r,recv:i,sendrecv:s}=n;if(!s){if(!r||!i)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:r,recv:i}}let c,u;return r?(c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c.audioCodecs=[...r.audioCodecs,...s.audioCodecs],c.videoCodecs=[...r.videoCodecs,...s.videoCodecs],c.audioExtensions=[...r.audioExtensions,...s.audioExtensions],c.videoExtensions=[...r.videoExtensions,...s.videoExtensions]):c=s,i?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...i.audioCodecs,...s.audioCodecs],u.videoCodecs=[...i.videoCodecs,...s.videoCodecs],u.audioExtensions=[...i.audioExtensions,...s.audioExtensions],u.videoExtensions=[...i.videoExtensions,...s.videoExtensions]):u=s,{send:c,recv:u}}function Fh(n){n.media.mediaType==="audio"&&n.attributes.payloads.filter(r=>{var i;return((i=r.rtpMap)===null||i===void 0?void 0:i.encodingName.toLowerCase())==="opus"}).forEach(r=>{r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"})}function km(n,r,i,s){let c=[];if(n===Ue.VIDEO){if(Y("H264_PROFILE_LEVEL_ID")&&s==="h264"&&(c=r.videoCodecs.filter(u=>{var h;return Oe(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,s)&&u&&u.fmtp&&u.fmtp.parameters["profile-level-id"]===Y("H264_PROFILE_LEVEL_ID")})),!Array.isArray(c)||c.length===0){let u=[];const h=[],f=[],m=[];if(i.videoCodecs.forEach(y=>{const _=y.rtpMap&&y.rtpMap.encodingName.toLowerCase()||"";Oe(_).call(_,s)?u.push(y):Oe(_).call(_,"vp9")?h.push(y):Oe(_).call(_,"vp8")?f.push(y):Oe(_).call(_,"h264")&&m.push(y)}),u.length===0){let y="";h.length!==0?(u=h,y="vp9"):f.length!==0?(u=f,y="vp8"):m.length!==0&&(u=m,y="h264"),A.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(y))}u.length!==0&&(c=r.videoCodecs.filter(y=>u.some(_=>_.payloadType===y.payloadType)))}if(c.length===0&&(A.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(r.videoCodecs[0].rtpMap&&r.videoCodecs[0].rtpMap.encodingName)),c=r.videoCodecs),Y("USE_PUB_RTX")||Y("USE_SUB_RTX")){const u=XO(c,r.videoCodecs);c=[...c,...u]}}else c=r.audioCodecs.filter(u=>{var h;return Oe(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,s)}),c.length===0&&(A.warning("codec ".concat(s," not included in rtpCapabilities, fallback to opus")),c=r.audioCodecs.filter(u=>{var h;return Oe(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,"opus")}));return c}function XO(n,r){const i=n.map(s=>s.payloadType.toString());return r.filter(s=>s.rtpMap&&s.rtpMap.encodingName==="rtx"&&s.fmtp&&s.fmtp.parameters.apt&&Oe(i).call(i,s.fmtp&&s.fmtp.parameters.apt))}async function ME(n,r,i){const s=r.toString(),c=E4(s,"offer","remote","exchangeSDP");await n.setRemoteDescription({type:"offer",sdp:s});const u=await n.createAnswer();if(!u.sdp)throw new Error("cannot get answer sdp");let h=u.sdp;h=_4(h,i||{}),c==null||c(h||""),await n.setLocalDescription({type:"answer",sdp:h})}function _4(n,r,i){const s=Ai(n),{useXR:c}=r;return s.mediaDescriptions.forEach(u=>{var h;u.attributes.mid&&(Array.isArray(i)&&!Oe(i).call(i,u.attributes.mid)||(u.media.mediaType==="audio"&&Fh(u),c&&Oe(h=["audio","video"]).call(h,u.media.mediaType)&&u.attributes.payloads.forEach(f=>{f.rtcpFeedbacks.findIndex(m=>m.type==="rrtr")===-1&&f.rtcpFeedbacks.push({type:"rrtr"})})))}),Jc(s)}function E4(n,r,i,s){if(Y("SDP_LOGGING"))return A.upload("exchanging ".concat(i," ").concat(r," SDP during P2PConnection.").concat(s,`
`),n),r==="offer"?c=>{E4(c,"answer",i==="local"?"remote":"local",s)}:void 0}function S4(n){const r=Y("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(r)&&r.length>0)&&r.some(i=>Oe(n).call(n,i))}function b4(n,r){try{var i;return((i=n.fmtp)===null||i===void 0?void 0:i.parameters.apt)===r.payloadType.toString()}catch{return!1}}function T4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Ia(n,r){return typeof Y(n)===r?Y(n):void 0}function wpe(){try{const n=Y("EXPERIMENTS")||{};return typeof n=="string"||Array.isArray(n)?{}:function(r){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?T4(Object(s),!0).forEach(function(c){F(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):T4(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}({},n)}catch(n){return A.debug("handle gateway attributes failed: ",n),{}}}const w4={};function Mu(n){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&A.debug("install service ".concat(n.name)),w4[n.name]=n}function nl(n){const r=w4[n];if(!r)throw new de($.INVALID_OPERATION,"".concat(n," not found, please use AgoraRTC.use(").concat(n,"Service) to load it first"));return r}function C4(n,r){return nl("DataStream").create(n,r)}function R4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function ic(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?R4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):R4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const JO=new Map;class Cpe extends ln{get state(){return this._state}set state(r){if(r===this._state)return;const i=this._state;this._state=r,r==="DISCONNECTED"&&this._disconnectedReason?this.emit(dr.CONNECTION_STATE_CHANGE,r,i,this._disconnectedReason):this.emit(dr.CONNECTION_STATE_CHANGE,r,i)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(r){A.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(r)),this._joinGatewayStartTime=r}constructor(r,i){var s,c,u;super(),F(this,"store",void 0),F(this,"joinInfo",void 0),F(this,"key",void 0),F(this,"ntpOffset",0),F(this,"signal",void 0),F(this,"role",void 0),F(this,"inChannelInfo",{joinAt:null,duration:0}),F(this,"spec",void 0),F(this,"_state","DISCONNECTED"),F(this,"_statsCollector",void 0),F(this,"_disconnectedReason",void 0),F(this,"isSignalRecover",!1),F(this,"hasChangeBGPAddress",!1),F(this,"trafficStatsInterval",void 0),F(this,"networkQualityInterval",void 0),F(this,"_joinGatewayStartTime",0),F(this,"_signalTimeout",!1),F(this,"_clientRoleOptions",void 0),F(this,"_isProactiveJoin",!1),this.store=r,this.spec=i,this.signal=this.store.useP2P?(s={spec:ic(ic({},i),{},{retryConfig:i.websocketRetryConfig}),store:r},(c=(u=nl("P2PChannel")).createSubmodule)===null||c===void 0?void 0:c.call(u,s)):new bpe(ic(ic({},i),{},{retryConfig:i.websocketRetryConfig}),r),this._statsCollector=i.statsCollector,this.role=i.role||"audience",this._clientRoleOptions=i.clientRoleOptions,this.handleSignalEvents()}async join(r,i,s){this.store.joinGatewayStart(),r.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const c=Date.now();let u=JO.get(r.cname);if(u||(u=new Map,JO.set(r.cname,u)),this._isProactiveJoin=!0,u.has(r.uid)){const y=new se($.UID_CONFLICT);throw $e.joinGateway(r.sid,{lts:c,succ:!1,ec:y.code,addr:null,uid:r.uid,cid:r.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!r.proxyServer,signalChannel:"0",preload:r.preload}),y}u.set(r.uid,!0),this.joinInfo=r,this.key=i;let h=0;this.joinGatewayStartTime=c;const f=r.proxyServer;try{A.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(h));const y=r.gatewayAddrs.map(_=>{let{address:S}=_;const[w,O]=S.split(":"),W={host:w,port:O};return r.proxyServer&&(W.proxy=r.proxyServer),W});h=(await this.signal.init(y)).uid,A.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(h," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(y){var m;throw A.error("[".concat(this.store.clientId,"] User join failed"),y.toString()),$e.joinGateway(r.sid,{lts:c,succ:!1,ec:((m=y.data)===null||m===void 0?void 0:m.desc)||y.code,errorMsg:y.message,addr:this.signal.url,uid:r.uid,cid:r.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!f,signalChannel:"0",preload:r.preload}),u.delete(r.uid),this.signal.close(),y}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),A.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(y=>{A.warning("[".concat(this.store.clientId,"] get traffic stats error"),y.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(dr.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(dr.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(dr.NETWORK_QUALITY,{uplinkNetworkQuality:o4(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:o4(this._statsCollector.trafficStats.B_dnq)}):this.emit(dr.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),h}async leave(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],i=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){i!==Pt.FALLBACK&&(this.state="DISCONNECTING");try{r||this.signal.connectionState!==Jt.CONNECTED||await function(s,c){return c===1/0?s:Ie.race([s,Khe(c)])}(this.signal.request(Qe.LEAVE,void 0,!0),3e3)}catch(s){A.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),s)}this.signal.close(i),i!==Pt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(r,i,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const c={state:"offer",p2p_id:this.store.p2pId,ortc:i,mode:this.spec.mode,extend:Y("PUB_EXTEND"),twcc:!!Y("PUBLISH_TWCC"),rtx:!!Y("USE_PUB_RTX")};try{return(await this.signal.request(Qe.PUBLISH,c,!0))._message}catch(u){if(s&&u.data&&u.data.code===Ye.ERR_PUBLISH_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),u.toString()),await this.tryUnpubBeforeRepub(r,i),this.publish(r,i,!1);throw u}}async publishDataChannel(r,i,s){var c;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={stream_id:i.streamId,ordered:i.ordered?1:0,max_retrans_times:(c=i.maxRetransmits)!==null&&c!==void 0?c:10,channel_id:i.channelId,metadata:i.metadata};try{await this.signal.request(Qe.PUBLISH_DATASTREAM,u,!0)}catch(h){if(s&&h.data&&h.data.code===Ye.ERR_PUBLISH_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),h.toString()),await this.tryUnpubDataChannelBeforeRepub(r,i),this.publishDataChannel(r,i,!1);throw h}}async unpublish(r,i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Qe.UNPUBLISH,{stream_id:i,ortc:r},!0)}catch(s){A.warning("[".concat(this.store.clientId,"] unpublish warning: "),s)}}async unpublishDataChannel(r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ie.all(r.map(i=>this.signal.request(Qe.UNPUBLISH_DATASTREAM,{channel_id:i},!0)))}catch(i){A.warning("unpublish datachannels warning: ",i)}}async presubscribe(r,i,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const c={stream_id:r,stream_type:i,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Y("SUBSCRIBE_TWCC"),rtx:!!Y("USE_SUB_RTX")||void 0,extend:Y("SUB_EXTEND"),svc:Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0};try{return await this.signal.request(Qe.PRE_SUBSCRIBE,c,!0)}catch(u){if(s&&u.data&&u.data.code===Ye.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),u.toString()),this.presubscribe(r,i,!1);throw u}}async subscribe(r,i,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const c={stream_id:r,stream_type:i.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Y("SUBSCRIBE_TWCC"),rtx:!!Y("USE_SUB_RTX"),extend:Y("SUB_EXTEND"),ssrcId:i.ssrcId,svc:Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0};try{return(await this.signal.request(Qe.SUBSCRIBE,c,!0))._message}catch(u){if(s&&u.data&&u.data.code===Ye.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),u.toString()),await this.tryUnsubBeforeResub(r,i),await this.subscribe(r,i,!1);throw u}}async subscribeDataChannel(r,i,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const c={uid:r,stream_id:i.id,channel_id:i.datachannelId};try{return void await this.signal.request(Qe.SUBSCRIBE_DATASTREAM,c,!0)}catch(u){if(s&&u.data&&u.data.code===Ye.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),u.toString()),await this.tryUnsubDataChannelBeforeResub(r,i),await this.subscribeDataChannel(r,i,!1);throw u}}async subscribeAll(r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const s={p2p_id:this.store.p2pId,users:r,dtx:!1,rtx:!!Y("USE_SUB_RTX"),twcc:!!Y("SUBSCRIBE_TWCC"),svc:Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0};try{return await this.signal.request(Qe.SUBSCRIBE_STREAMS,s,!0)}catch(c){if(i&&c.data&&c.data.code===Ye.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),c.toString()),await this.tryMassUnsubBeforeResub(r),await this.subscribeAll(r,!1);throw c}}async setVideoProfile(r){const i=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let c=s.frameRate,u=s.width,h=s.height,f=!0;return typeof c!="number"&&(c=c.exact||c.ideal||c.max||c.min||0,c||(f=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(f=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,c||(f=!1)),f?{stream_type:0,width:u,height:h,fps:c,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(r);if(i)return this.signal.request(Qe.SET_VIDEO_PROFILE,i);A.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(r,i){try{await this.signal.request(Qe.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:r,stream_id:i},!0)}catch(s){A.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),s)}}async unsubscribeDataChannel(r,i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ie.all(r.map(s=>this.signal.request(Qe.UNSUBSCRIBE_DATASTREAM,{stream_id:s,uid:i},!0)))}catch(s){A.warning("unsubscribeDataChannel warning: ",s)}}async massUnsubscribe(r){try{await this.signal.request(Qe.UNSUBSCRIBE_STREAMS,r,!0)}catch(i){A.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),i)}}async reconnectPC(r){const{iceParameters:i,dtlsParameters:s,rtpCapabilities:c}=r;return{gatewayEstablishParams:await this.signal.request(Qe.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:i,dtlsParameters:s,rtpCapabilities:c}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Qe.GATEWAY_INFO)}async renewToken(r){await this.signal.request(Qe.RENEW_TOKEN,r),this.key=r.token}updateClientRole(r,i){i&&(this._clientRoleOptions=Object.assign({},i)),Y("CLIENT_ROLE_OPTIONS")&&(A.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(Y("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},Y("CLIENT_ROLE_OPTIONS"))),this.role=r}async setClientRole(r,i){if(i&&(this._clientRoleOptions=Object.assign({},i)),Y("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},Y("CLIENT_ROLE_OPTIONS")),A.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(Y("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=r);let s,c=0;r==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(s=this._clientRoleOptions.delay,c=1):c=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:c=0,await this.signal.request(Qe.SET_CLIENT_ROLE,{role:r,level:c,delay:s,client_ts:Date.now()}),this.role=r}async setRemoteVideoStreamType(r,i){await this.signal.request(Qe.SWITCH_VIDEO_STREAM,{stream_id:r,stream_type:i})}async setDefaultRemoteVideoStreamType(r){await this.signal.request(Qe.DEFAULT_VIDEO_STREAM,{stream_type:r})}async setStreamFallbackOption(r,i){await this.signal.request(Qe.SET_FALLBACK_OPTION,{stream_id:r,fallback_type:i})}async pickSVCLayer(r,i){await this.signal.request(Qe.PICK_SVC_LAYER,{stream_id:r,spatial_layer:i.spatialLayer,temporal_layer:i.temporalLayer})}async setRTM2Flag(r){await this.signal.request(Qe.SET_RTM2_FLAG,{rtm2_flag:r})}async sendExtensionMessage(r,i,s){if(this.store.useP2P)return this.signal.sendExtensionMessage(r,i,s)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),ic({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Qe.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const r=JO.get(this.joinInfo.cname);r&&r.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const r=function(i){let s;return s=i.startsWith("dc")?i.match(/(dc\:\/\/)?([^:]+):(\d+)/):i.match(/(wss\:\/\/)?([^:]+):(\d+)/),s?{username:Ar.username,password:Ar.password,turnServerURL:s[2],tcpport:parseInt(s[3])+30,udpport:parseInt(s[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],r&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(ic(ic({},Ar),{},{turnServerURL:r.turnServerURL,tcpport:r.tcpport,udpport:r.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const r=await this.signal.request(Qe.TRAFFIC_STATS,void 0,!0);r.timestamp=Date.now(),r.ntp_offset!=null&&(this.ntpOffset=r.ntp_offset),r.peer_delay.forEach(i=>{const s=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(c=>c.peer_uid===i.peer_uid);s&&s.B_st!==i.B_st&&nE(()=>{this.emit(dr.STREAM_TYPE_CHANGE,i.peer_uid,i.B_st)})}),this._statsCollector.updateTrafficStats(r)}getJoinMessage(r){if(!this.joinInfo||!this.key)throw new se($.UNEXPECTED_ERROR,"can not generate join message, no join info");const i=Object.assign({},this.joinInfo.apResponse);let s=Y("REPORT_APP_SCENARIO");if(typeof s!="string")try{s=JSON.stringify(s)}catch{s=void 0}var c;s&&s.length>128&&(s=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(dr.UPDATE_GATEWAY_CONFIG),c=this.store.clientId,Oe(Dh).call(Dh,c)||Dh.push(c);const u=!(gn()||YV(87)||MB())&&typeof Y("ENABLE_PRE_SUB")=="boolean"&&Y("ENABLE_PRE_SUB"),h=!MB()&&Ia("ENABLE_PREALLOC_PC","boolean"),f=wpe(),m=ic({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Ca,browser:navigator.userAgent,process_id:Y("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:i,extend:Y("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:s,attributes:{userAttributes:ic({enableEncodedTransform:!!Y("ENABLE_AUDIO_METADATA")&&ph(87)||!!Y("ENABLE_AUDIO_TOPN")&&H0(Nt.CHROME,87,116)||void 0,enableAudioMetadata:!!Y("ENABLE_AUDIO_METADATA")&&ph(87),topnSmoothLevel:Y("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:Y("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:Y("TOPN_SWITCH_HOLD_MS"),topnAudioGain:Y("TOPN_AUDIO_GAIN"),enablePublishedUserList:Y("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Y("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Ia("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Ia("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Ia("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:Y("USE_PUB_RTX")===!0||Y("USE_SUB_RTX")===!0||void 0,disableFEC:Y("DISABLE_FEC"),enableNTPReport:!!Y("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Y("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!Y("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Ia("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!Y("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!Y("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Ia("USE_XR","boolean"),enableLossbasedBwe:Ia("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!Y("ENABLE_AUT_CC")||void 0,enableCCFallback:Ia("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:h,preSubNum:u?Ia("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Ia("PUBLISH_TWCC","boolean"),enableSubTWCC:Ia("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Ia("USE_PUB_RTX","boolean"),enableSubRTX:Ia("USE_SUB_RTX","boolean"),enableSubSVC:Y("ENABLE_SVC")?Y("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0,enableSvcExtended:Y("ENABLE_SVC")&&Array.isArray(Y("SVC_EXTENDED"))&&Y("SVC_EXTENDED").length!==0?Y("SVC_EXTENDED"):void 0},f)},join_ts:this.joinGatewayStartTime},r);return this.joinInfo.stringUid&&(m.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(m.aes_mode=this.joinInfo.aesmode,Y("ENCRYPT_AES")?(m.aes_secret=this.joinInfo.aespassword,m.aes_encrypt=!0):m.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(m.aes_salt=this.joinInfo.aessalt)),i.addresses[this.signal.websocket.currentURLIndex]&&(m.ap_response.ticket=i.addresses[this.signal.websocket.currentURLIndex].ticket,delete i.addresses),this.joinInfo.defaultVideoStream!==void 0&&(m.default_video_stream=this.joinInfo.defaultVideoStream),m}getRejoinMessage(){if(!this.joinInfo)throw new se($.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(et.WS_RECONNECT_CREATE_CONNECTION,r=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(et.WS_RECONNECTING,r=>{this.joinInfo&&$e.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r||Rr.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",$e.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(et.WS_CLOSED,r=>{let i;switch(r){case Pt.LEAVE:i=Rr.LEAVE;break;case Pt.UID_BANNED:case Pt.IP_BANNED:case Pt.CHANNEL_BANNED:case Pt.SERVER_ERROR:i=Rr.SERVER_ERROR;break;case Pt.FALLBACK:i=Rr.FALLBACK;break;case Pt.LICENSE_MISSING:case Pt.LICENSE_EXPIRED:case Pt.LICENSE_MINUTES_EXCEEDED:case Pt.LICENSE_PERIOD_INVALID:case Pt.LICENSE_MULTIPLE_SDK_SERVICE:case Pt.LICENSE_ILLEGAL:case Pt.TOKEN_EXPIRE:i=r;break;default:i=Rr.NETWORK_ERROR}A.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(i||"undefined -> "+Rr.NETWORK_ERROR)),this.joinInfo&&$e.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:r===Pt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i}),this._disconnectedReason=r,r!==Pt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(et.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const r=Y("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;r&&(r.level||r.delay)&&(A.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(r.level,", delay: ").concat(r.delay)),this.setClientRole(this.role,r))}if($e.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const r=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!r)return void A.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(r));Ut("EVENT_REPORT_DOMAIN",r[1]),Ut("EVENT_REPORT_BACKUP_DOMAIN",r[1]),Ut("LOG_UPLOAD_SERVER","".concat(r[1],":6444"))}}}),this.signal.on(ft.ON_UPLINK_STATS,r=>{this._statsCollector.updateUplinkStats(r)}),this.signal.on(et.REQUEST_RECOVER,(r,i,s)=>{if(!this.joinInfo)return s(new se($.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));r&&(this.joinInfo.multiIP=r,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Or(this,dr.REQUEST_NEW_GATEWAY_LIST).then(i).catch(s)}),this.signal.on(et.REQUEST_JOIN_INFO,async(r,i,s)=>{var c;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void r(this.getJoinMessage({ortc:{}}));const{iceParameters:u,dtlsParameters:h,rtpCapabilities:f}=await Or(this,dr.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(c=this.joinInfo)===null||c===void 0?void 0:c.turnServer});try{r(this.getJoinMessage({ortc:{iceParameters:u,dtlsParameters:h,rtpCapabilities:f,version:"2"}}))}catch(m){i(m)}}),this.signal.on(et.REQUEST_REJOIN_INFO,r=>{r(this.getRejoinMessage())}),this.signal.on(et.REPORT_JOIN_GATEWAY,(r,i)=>{if(!this.joinInfo)return;let s,c="";var u;r instanceof se?(s=((u=r.data)===null||u===void 0?void 0:u.desc)||r.code,c=r.message):s=r,$e.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:s,errorMsg:c,addr:i,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(et.IS_P2P_DISCONNECTED,r=>{r(bm(this,dr.IS_P2P_DISCONNECTED))}),this.signal.on(et.DISCONNECT_P2P,()=>{this.emit(dr.DISCONNECT_P2P)}),this.signal.on(et.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(et.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(et.JOIN_RESPONSE,r=>{const i=this.getCurrentGatewayAddress();this.emit(dr.JOIN_RESPONSE,r,i)}),this.signal.on(et.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const r=this.getCurrentGatewayAddress(),i=Y("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(r&&i){const s=p4(r);this.emit(dr.PRE_CONNECT_PC,{candidates:s,fingerprint:i})}}}),this.signal.on(et.RECOVER_NOTIFICATION,r=>{this.joinInfo&&typeof Y("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(Y("AP_REQUEST_DETAIL"),";").concat(r))})}async tryUnsubBeforeResub(r,i){try{await this.signal.request(Qe.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:r,ortc:[i]},!0)}catch(s){throw A.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),s),s}}async tryUnsubDataChannelBeforeResub(r,i){try{await this.signal.request(Qe.UNSUBSCRIBE,{stream_id:i.id},!0)}catch(s){throw A.warning("unsubscribe datachannel warning",s),s}}async tryUnpubBeforeRepub(r,i){try{await this.signal.request(Qe.UNPUBLISH,{stream_id:r,ortc:i},!0)}catch(s){throw A.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),s),s}}async tryUnpubDataChannelBeforeRepub(r,i){try{await this.signal.request(Qe.UNPUBLISH_DATASTREAM,{channnel_id:i.channelId},!0)}catch(s){throw A.warning("unpublish datastream warning: ",s),s}}async tryMassUnsubBeforeResub(r){const i={users:r.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{await this.signal.request(Qe.UNSUBSCRIBE_STREAMS,i,!0)}catch(s){throw A.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),s),s}}async muteLocal(r,i){const s={action:r.find(c=>c.stream_type===Dt.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:r,stream_id:i};try{await this.signal.request(Qe.CONTROL,s,!0,!0)}catch(c){throw A.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),c),c}}async unmuteLocal(r,i){const s={action:r.find(c=>c.stream_type===Dt.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:r,stream_id:i};try{await this.signal.request(Qe.CONTROL,s,!0,!0)}catch(c){throw A.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),c),c}}async muteRemote(r,i){const s={action:r===Ue.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:i};try{await this.signal.request(Qe.CONTROL,s,!0,!0)}catch(c){throw A.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),c),c}}async unmuteRemote(r,i){const s={action:r===Ue.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:i};try{await this.signal.request(Qe.CONTROL,s,!0,!0)}catch(c){throw A.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),c),c}}uploadWRTCStats(r){this.signal.uploadWRTCStats(r)}upload(r,i){this.signal.upload(r,i)}getSignalRTT(){return this.signal.rtt}async restartICE(r){const i={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:r};try{return await this.signal.request(Qe.RESTART_ICE,i,!0)}catch(s){throw A.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),s),s}}reconnect(r,i){this.state==="CONNECTED"&&this.signal.reconnect(r||void 0,i||Rr.P2P_FAILED)}getCurrentGatewayAddress(){var r,i;if(!Y("GATEWAY_WSS_ADDRESS"))return Y("USE_CANDIDATE_FROM_AP_DETAIL")&&(r=this.joinInfo)!==null&&r!==void 0&&r.apGatewayAddress?(A.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(i=this.joinInfo)!==null&&i!==void 0&&i.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(r){await this.signal.request(Qe.SET_PARAMETER,{enablePublishAudioFilter:r})}}let UE=0,QO=0;function Fo(n,r,i,s){return new Ie((c,u)=>{r.timeout=r.timeout||Y("HTTP_CONNECT_TIMEOUT"),r.responseType=r.responseType||"json",r.data&&!i?(r.data=JSON.stringify(r.data),UE+=ps(r.data)):i&&(r.data.size?UE+=r.data.size:r.data instanceof FormData?UE+=fB(r.data):UE+=ps(JSON.stringify(r.data))),r.headers=r.headers||{},r.headers["Content-Type"]=r.headers["Content-Type"]||"application/json",r.method="POST",r.url=n,mi.request(r).then(h=>{typeof h.data=="string"?QO+=ps(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?QO+=h.data.byteLength:QO+=ps(JSON.stringify(h.data)),s&&c({data:h.data,headers:h.headers}),c(h.data)}).catch(h=>{mi.isCancel(h)?u(new se($.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new se($.NETWORK_TIMEOUT,h.message)):h.response?u(new se($.NETWORK_RESPONSE_ERROR,h.response.status)):u(new se($.NETWORK_ERROR,h.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var n;function r(pe){var we=0;return function(){return we<pe.length?{done:!1,value:pe[we++]}:{done:!0}}}var i=typeof Object.defineProperties=="function"?Object.defineProperty:function(pe,we,We){return pe==Array.prototype||pe==Object.prototype||(pe[we]=We.value),pe},s,c=function(pe){pe=[typeof globalThis=="object"&&globalThis,pe,typeof window=="object"&&window,typeof self=="object"&&self,typeof o=="object"&&o];for(var we=0;we<pe.length;++we){var We=pe[we];if(We&&We.Math==Math)return We}throw Error("Cannot find global object")}(this);function u(pe,we){if(we)e:{var We=c;pe=pe.split(".");for(var ge=0;ge<pe.length-1;ge++){var I=pe[ge];if(!(I in We))break e;We=We[I]}(we=we(ge=We[pe=pe[pe.length-1]]))!=ge&&we!=null&&i(We,pe,{configurable:!0,writable:!0,value:we})}}function h(pe){return(pe={next:pe})[Symbol.iterator]=function(){return this},pe}function f(pe){var we=typeof Symbol<"u"&&Symbol.iterator&&pe[Symbol.iterator];return we?we.call(pe):{next:r(pe)}}if(u("Symbol",function(pe){function we(I,X){this.A=I,i(this,"description",{configurable:!0,writable:!0,value:X})}if(pe)return pe;we.prototype.toString=function(){return this.A};var We="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ge=0;return function I(X){if(this instanceof I)throw new TypeError("Symbol is not a constructor");return new we(We+(X||"")+"_"+ge++,X)}}),u("Symbol.iterator",function(pe){if(pe)return pe;pe=Symbol("Symbol.iterator");for(var we="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),We=0;We<we.length;We++){var ge=c[we[We]];typeof ge=="function"&&typeof ge.prototype[pe]!="function"&&i(ge.prototype,pe,{configurable:!0,writable:!0,value:function(){return h(r(this))}})}return pe}),typeof Object.setPrototypeOf=="function")s=Object.setPrototypeOf;else{var m;e:{var y={};try{y.__proto__={a:!0},m=y.a;break e}catch{}m=!1}s=m?function(pe,we){if(pe.__proto__=we,pe.__proto__!==we)throw new TypeError(pe+" is not extensible");return pe}:null}var _=s;function S(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function w(pe){if(pe.m)throw new TypeError("Generator is already running");pe.m=!0}function O(pe,we){return pe.h=3,{value:we}}function W(pe){this.g=new S,this.G=pe}function k(pe,we,We,ge){try{var I=we.call(pe.g.j,We);if(!(I instanceof Object))throw new TypeError("Iterator result "+I+" is not an object");if(!I.done)return pe.g.m=!1,I;var X=I.value}catch(J){return pe.g.j=null,pe.g.s(J),j(pe)}return pe.g.j=null,ge.call(pe.g,X),j(pe)}function j(pe){for(;pe.g.h;)try{var we=pe.G(pe.g);if(we)return pe.g.m=!1,{value:we.value,done:!1}}catch(We){pe.g.v=void 0,pe.g.s(We)}if(pe.g.m=!1,pe.g.l){if(we=pe.g.l,pe.g.l=null,we.F)throw we.D;return{value:we.return,done:!0}}return{value:void 0,done:!0}}function H(pe){this.next=function(we){return pe.o(we)},this.throw=function(we){return pe.s(we)},this.return=function(we){return function(We,ge){w(We.g);var I=We.g.j;return I?k(We,"return"in I?I.return:function(X){return{value:X,done:!0}},ge,We.g.return):(We.g.return(ge),j(We))}(pe,we)},this[Symbol.iterator]=function(){return this}}function K(pe,we){return we=new H(new W(we)),_&&pe.prototype&&_(we,pe.prototype),we}if(S.prototype.o=function(pe){this.v=pe},S.prototype.s=function(pe){this.l={D:pe,F:!0},this.h=this.C||this.u},S.prototype.return=function(pe){this.l={return:pe},this.h=this.u},W.prototype.o=function(pe){return w(this.g),this.g.j?k(this,this.g.j.next,pe,this.g.o):(this.g.o(pe),j(this))},W.prototype.s=function(pe){return w(this.g),this.g.j?k(this,this.g.j.throw,pe,this.g.o):(this.g.s(pe),j(this))},u("Array.prototype.entries",function(pe){return pe||function(){return function(we,We){we instanceof String&&(we+="");var ge=0,I=!1,X={next:function(){if(!I&&ge<we.length){var J=ge++;return{value:We(J,we[J]),done:!1}}return I=!0,{done:!0,value:void 0}}};return X[Symbol.iterator]=function(){return X},X}(this,function(we,We){return[we,We]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var Q=function(pe,we){for(var We=0;We<pe.length;We++)we(pe[We])},ie=function(pe){return pe.replace(/\r?\n|\r/g,`\r
`)},re=function(pe,we,We){return we instanceof Blob?(We=We!==void 0?We+"":typeof we.name=="string"?we.name:"blob",we.name===We&&Object.prototype.toString.call(we)!=="[object Blob]"||(we=new File([we],We)),[String(pe),we]):[String(pe),String(we)]},te=function(pe,we){if(pe.length<we)throw new TypeError(we+" argument required, but only "+pe.length+" present.")},he=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Se=he.FormData,Ne=he.XMLHttpRequest&&he.XMLHttpRequest.prototype.send,ke=he.Request&&he.fetch,pt=he.navigator&&he.navigator.sendBeacon,mt=he.Element&&he.Element.prototype,Xt=he.Symbol&&Symbol.toStringTag;Xt&&(Blob.prototype[Xt]||(Blob.prototype[Xt]="Blob"),"File"in he&&!File.prototype[Xt]&&(File.prototype[Xt]="File"));try{new File([],"")}catch{he.File=function(we,We,ge){return we=new Blob(we,ge||{}),Object.defineProperties(we,{name:{value:We},lastModified:{value:+(ge&&ge.lastModified!==void 0?new Date(ge.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Xt&&Object.defineProperty(we,Xt,{value:"File"}),we}}var An=function(pe){return pe.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},_n=function(pe){this.i=[];var we=this;pe&&Q(pe.elements,function(We){if(We.name&&!We.disabled&&We.type!=="submit"&&We.type!=="button"&&!We.matches("form fieldset[disabled] *"))if(We.type==="file"){var ge=We.files&&We.files.length?We.files:[new File([],"",{type:"application/octet-stream"})];Q(ge,function(I){we.append(We.name,I)})}else We.type==="select-multiple"||We.type==="select-one"?Q(We.options,function(I){!I.disabled&&I.selected&&we.append(We.name,I.value)}):We.type==="checkbox"||We.type==="radio"?We.checked&&we.append(We.name,We.value):(ge=We.type==="textarea"?ie(We.value):We.value,we.append(We.name,ge))})};if((n=_n.prototype).append=function(pe,we,We){te(arguments,2),this.i.push(re(pe,we,We))},n.delete=function(pe){te(arguments,1);var we=[];pe=String(pe),Q(this.i,function(We){We[0]!==pe&&we.push(We)}),this.i=we},n.entries=function pe(){var we,We=this;return K(pe,function(ge){if(ge.h==1&&(we=0),ge.h!=3)return we<We.i.length?ge=O(ge,We.i[we]):(ge.h=0,ge=void 0),ge;we++,ge.h=2})},n.forEach=function(pe,we){te(arguments,1);for(var We=f(this),ge=We.next();!ge.done;ge=We.next()){var I=f(ge.value);ge=I.next().value,I=I.next().value,pe.call(we,I,ge,this)}},n.get=function(pe){te(arguments,1);var we=this.i;pe=String(pe);for(var We=0;We<we.length;We++)if(we[We][0]===pe)return we[We][1];return null},n.getAll=function(pe){te(arguments,1);var we=[];return pe=String(pe),Q(this.i,function(We){We[0]===pe&&we.push(We[1])}),we},n.has=function(pe){te(arguments,1),pe=String(pe);for(var we=0;we<this.i.length;we++)if(this.i[we][0]===pe)return!0;return!1},n.keys=function pe(){var we,We,ge,I,X=this;return K(pe,function(J){if(J.h==1&&(we=f(X),We=we.next()),J.h!=3)return We.done?void(J.h=0):(ge=We.value,I=f(ge),O(J,I.next().value));We=we.next(),J.h=2})},n.set=function(pe,we,We){te(arguments,2),pe=String(pe);var ge=[],I=re(pe,we,We),X=!0;Q(this.i,function(J){J[0]===pe?X&&(X=!ge.push(I)):ge.push(J)}),X&&ge.push(I),this.i=ge},n.values=function pe(){var we,We,ge,I,X=this;return K(pe,function(J){if(J.h==1&&(we=f(X),We=we.next()),J.h!=3)return We.done?void(J.h=0):(ge=We.value,(I=f(ge)).next(),O(J,I.next().value));We=we.next(),J.h=2})},_n.prototype._asNative=function(){for(var pe=new Se,we=f(this),We=we.next();!We.done;We=we.next()){var ge=f(We.value);We=ge.next().value,ge=ge.next().value,pe.append(We,ge)}return pe},_n.prototype._blob=function(){var pe="----formdata-polyfill-"+Math.random(),we=[],We="--"+pe+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(ge,I){return typeof ge=="string"?we.push(We+An(ie(I))+`"\r
\r
`+ie(ge)+`\r
`):we.push(We+An(ie(I))+'"; filename="'+An(ge.name)+`"\r
Content-Type: `+(ge.type||"application/octet-stream")+`\r
\r
`,ge,`\r
`)}),we.push("--"+pe+"--"),new Blob(we,{type:"multipart/form-data; boundary="+pe})},_n.prototype[Symbol.iterator]=function(){return this.entries()},_n.prototype.toString=function(){return"[object FormData]"},mt&&!mt.matches&&(mt.matches=mt.matchesSelector||mt.mozMatchesSelector||mt.msMatchesSelector||mt.oMatchesSelector||mt.webkitMatchesSelector||function(pe){for(var we=(pe=(this.document||this.ownerDocument).querySelectorAll(pe)).length;0<=--we&&pe.item(we)!==this;);return-1<we}),Xt&&(_n.prototype[Xt]="FormData"),Ne){var Ei=he.XMLHttpRequest.prototype.setRequestHeader;he.XMLHttpRequest.prototype.setRequestHeader=function(pe,we){Ei.call(this,pe,we),pe.toLowerCase()==="content-type"&&(this.B=!0)},he.XMLHttpRequest.prototype.send=function(pe){pe instanceof _n?(pe=pe._blob(),this.B||this.setRequestHeader("Content-Type",pe.type),Ne.call(this,pe)):Ne.call(this,pe)}}ke&&(he.fetch=function(pe,we){return we&&we.body&&we.body instanceof _n&&(we.body=we.body._blob()),ke.call(this,pe,we)}),pt&&(he.navigator.sendBeacon=function(pe,we){return we instanceof _n&&(we=we._asNative()),pt.call(this,pe,we)}),he.FormData=_n}})();const Mm=()=>{const n=Y("AREAS");return n.length===0&&n.push(Ot.GLOBAL),Ao(n).call(n,(r,i,s)=>{const c=O4(i);return c?s===0?c:"".concat(r,",").concat(c):r},"")},O4=n=>n===Ot.OVERSEA?"".concat(kr.ASIA,",").concat(kr.EUROPE,",").concat(kr.AFRICA,",").concat(kr.NORTH_AMERICA,",").concat(kr.SOUTH_AMERICA,",").concat(kr.OCEANIA):kr[n],jE={GLOBAL:{ASIA:[Ot.CHINA,Ot.JAPAN,Ot.INDIA,Ot.KOREA,Ot.HKMC],EUROPE:[],NORTH_AMERICA:[Ot.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},VE=Object.keys(jE[Ot.GLOBAL]),ZO=[Ot.CHINA,Ot.NORTH_AMERICA,Ot.EUROPE,Ot.ASIA,Ot.JAPAN,Ot.INDIA,Ot.OCEANIA,Ot.SOUTH_AMERICA,Ot.AFRICA,Ot.KOREA,Ot.HKMC,Ot.US],Rpe=function(n,r){let i=[];if(Oe(n).call(n,Ot.GLOBAL)){const u=[Ot.GLOBAL,Ot.OVERSEA],h=Object.keys(IE);if(r===Ot.GLOBAL)throw new se($.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(r===Ot.CHINA)i=[Ot.OVERSEA];else if(c=r,Oe(VE).call(VE,c)){const f=(s=r,jE[Ot.GLOBAL][s]||[]),m=[...u,r,...f];i=h.filter(y=>!Oe(m).call(m,y))}else if(function(f){let m=!1;return VE.forEach(y=>{var _;Oe(_=jE[Ot.GLOBAL][y]).call(_,f)&&(m=!0)}),m}(r)){const f=function(y){let _;return VE.forEach(S=>{var w;Oe(w=jE[Ot.GLOBAL][S]).call(w,y)&&(_=S)}),_}(r),m=[...u,f,r];i=h.filter(y=>!Oe(m).call(m,y))}else i=n;i=function(f){const m=[];return ZO.forEach(y=>{Oe(f).call(f,y)&&m.push(y)}),m.concat(f.filter(y=>!Oe(ZO).call(ZO,y)))}(i)}else i=n;var s,c;return i};function A4(n){var r,i;if(!n&&Oe(r=Y("AREAS")).call(r,Ot.EXTENSIONS))return A.debug("update area from ap : reset"),void eA(Mfe,!0);if(!Oe(i=Y("AREAS")).call(i,Ot.GLOBAL)||!n)return;let s=IE.EXTENSIONS;s&&(s={CODE:O4(Ot.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(n,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(n,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(n,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(n,".agora.io"),"cds-ap-web-2-".concat(n,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(n,".agora.io"),"sua-ap-web-2-".concat(n,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(n,".agora.io"),"uap-ap-web-2-".concat(n,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(n,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(n,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(n,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(n,".agora.io")]},A.debug("update area from ap success: ".concat(n,",config is "),s),Ut("AREAS",[Ot.EXTENSIONS],!0),Object.keys(s).map(c=>{c==="LOG_UPLOAD_SERVER"||c==="EVENT_REPORT_DOMAIN"||c==="EVENT_REPORT_BACKUP_DOMAIN"||c==="PROXY_SERVER_TYPE3"?Ut(c,s[c][0]):Ut(c,s[c])}))}function eA(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=$e.reportApiInvoke(null,{name:Wn.SET_AREA,options:n,tag:fn.TRACER});try{let s=[];if(typeof n=="string"&&(s=[n]),Array.isArray(n)&&(n.forEach(u=>{if(!Oe(q3).call(q3,u))throw new se($.INVALID_PARAMS,"invalid area code")}),s=n),Object.prototype.toString.call(n)==="[object Object]"){const{areaCode:u,excludedArea:h}=n;if(!u)throw new se($.INVALID_PARAMS,"area code is needed");let f=u;typeof u=="string"&&(f=[u]),s=h?Rpe(f,h):f}if(!r){if(Uo.AREAS){const u=new se($.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return i.onError(u),void A.warning("setArea is prohibited because of config-distribute")}if(Oe(s).call(s,Ot.GLOBAL)&&Y("AREAS")===Ot.EXTENSIONS){const u=new se($.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return i.onError(u),void A.warning("setArea is prohibited because of ap extensions")}}Ut("AREAS",s,r);const c=(u=>{const h={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return u.map(f=>{const m=IE[f],y=Object.keys(m);y&&y.map(_=>{_!=="CODE"&&(h[_]=h[_].concat(m[_]))})}),h})(s);Object.keys(c).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?Ut(u,c[u][0]):Ut(u,c[u])}),A.debug("set area success:",s.join(","))}catch(s){throw i.onError(s),s}i.onSuccess()}function I4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Es(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?I4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):I4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let tA=1;function Ope(n,r,i,s,c){tA+=1;const u={sid:i.sid,command:"convergeAllocateEdge",uid:"666",appId:i.appId,ts:Math.floor(Date.now()/1e3),seq:tA,requestId:tA,version:Ca,cname:i.cname},h={service_name:r,json_body:JSON.stringify(u)};let f,m,y=n[0];return Mo(async()=>{f=Date.now();const _=await Fo(y,{data:h,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(m=Date.now()-f,_.code!==0){const O=new se($.UNEXPECTED_RESPONSE,"live streaming ap error, code"+_.code,{retry:!0,responseTime:m});throw A.error(O.toString()),O}const S=JSON.parse(_.json_body);if(S.code!==200){const O=new se($.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(S.code,", reason: ").concat(S.reason),{code:S.code,responseTime:m});throw A.error(O.toString()),O}if(!S.servers||S.servers.length===0){const O=new se($.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:S.code,responseTime:m});throw A.error(O.toString()),O}const w=function(O,W){return{addressList:O.servers.map(k=>"wss://".concat(k.address.replace(/\./g,"-"),".").concat(Y("WORKER_DOMAIN"),":").concat(k.wss,"?serviceName=").concat(encodeURIComponent(W))),workerToken:O.workerToken,vid:O.vid}}(S,r);return Y("LIVE_STREAMING_ADDRESS")&&(w.addressList=Y("LIVE_STREAMING_ADDRESS")instanceof Array?Y("LIVE_STREAMING_ADDRESS"):[Y("LIVE_STREAMING_ADDRESS")]),Es(Es({},w),{},{responseTime:m})},(_,S)=>($e.apworkerEvent(i.sid,{success:!0,sc:200,serviceName:r,responseDetail:JSON.stringify(_.addressList),firstSuccess:S===0,responseTime:m,serverIp:n[S%n.length]}),!1),(_,S)=>($e.apworkerEvent(i.sid,{success:!1,sc:_.data&&_.data.code||200,serviceName:r,responseTime:m,serverIp:n[S%n.length]}),!!(_.code!==$.OPERATION_ABORTED&&_.code!==$.UNEXPECTED_RESPONSE||_.data&&_.data.retry)&&(y=n[(S+1)%n.length],!0)),c)}let nA=1;function N4(n,r,i,s){let{url:c,areaCode:u}=n;const{clientId:h,sid:f}=r,m=Date.now();let y;const _=r.role,[S,w]=iA(r,u,[Dn.CHOOSE_SERVER]);let O=xn.networkState;return Mo(async()=>{O&&xn.networkState===Hi.OFFLINE&&xn.onlineWaiter&&await Ie.race([xn.onlineWaiter,_r(s&&s.maxRetryTimeout||Gn.maxRetryTimeout)]),O=xn.networkState;const{data:W,headers:k}=await Fo(c,{data:S,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);y=k.http3==="1"?1:-1,$e.reportResourceTiming(c,f),x4(W,c,r,m,[Dn.CHOOSE_SERVER],y);const j=Dm(W,Dn.CHOOSE_SERVER);return rA(j),zO(j,c)},W=>(W&&$e.joinChooseServer(f,{role:_,lts:m,succ:!0,csAddr:c,opid:w,serverList:W.gatewayAddrs.map(k=>k.address),ec:null,cid:W.cid.toString(),uid:W.uid.toString(),csIp:W.csIp,unilbsServerIds:[Dn.CHOOSE_SERVER].toString(),isHttp3:y,corssRegionTagReq:r.apRequestDetail,corssRegionTagRes:W.res.detail&&W.res.detail[38]}),!1),W=>W.code!==$.OPERATION_ABORTED&&(W.code===$.CAN_NOT_GET_GATEWAY_SERVER?W.data.retry:($e.joinChooseServer(f,{role:_,lts:m,succ:!1,csAddr:c,serverList:null,opid:w,ec:W.code,csIp:W.data&&W.data.csIp,unilbsServerIds:[Dn.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:O}),isHttp3:y,corssRegionTagReq:r.apRequestDetail}),A.warning("[".concat(h||"sid-".concat(f.slice(0,6)),"] Choose server network error, retry"),W),!0)),s)}function P4(n,r,i,s){let c,{url:u,areaCode:h,serviceIds:f}=n;const m=Date.now(),y=r.role,[_,S]=iA(r,h,f);let w;return Mo(async()=>{w&&xn.networkState===Hi.OFFLINE&&xn.onlineWaiter&&await Ie.race([xn.onlineWaiter,_r(s&&s.maxRetryTimeout||Gn.maxRetryTimeout)]),w=xn.networkState;const{data:O,headers:W}=await Fo(u,{data:_,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);c=W.http3==="1"?1:-1,$e.reportResourceTiming(u,r.sid),x4(O,u,r,m,f,c);const k=Dm(O,Dn.CHOOSE_SERVER),j=Dm(O,r.cloudProxyServer==="proxy5"?Dn.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Dn.CLOUD_PROXY:Dn.CLOUD_PROXY_FALLBACK);return rA(k),{gatewayInfo:zO(k,u),proxyInfo:j,url:u}},O=>(O.gatewayInfo&&$e.joinChooseServer(r.sid,{role:y,lts:m,succ:!0,csAddr:u,serverList:O.gatewayInfo.gatewayAddrs.map(W=>W.address),ec:null,opid:S,cid:O.gatewayInfo.cid.toString(),uid:O.gatewayInfo.uid.toString(),csIp:O.gatewayInfo.csIp,unilbsServerIds:f.toString(),isHttp3:c,corssRegionTagReq:r.apRequestDetail,corssRegionTagRes:O.gatewayInfo.res.detail&&O.gatewayInfo.res.detail[38]}),O.proxyInfo&&$e.joinWebProxyAP(r.sid,{lts:m,sucess:1,apServerAddr:u,turnServerAddrList:O.proxyInfo.addresses.map(W=>W.ip).join(","),errorCode:null,eventType:r.cloudProxyServer,unilbsServerIds:f.toString()}),!1),O=>O.code!==$.OPERATION_ABORTED&&(O.code===$.CAN_NOT_GET_GATEWAY_SERVER?O.data.retry:($e.joinWebProxyAP(r.sid,{lts:m,sucess:0,apServerAddr:u,turnServerAddrList:null,errorCode:O.code,eventType:r.cloudProxyServer,unilbsServerIds:f.toString(),extend:JSON.stringify({networkState:w})}),A.warning("[".concat(r.clientId,"] multi unilbs network error, retry"),O),!0)),s)}const x4=(n,r,i,s,c,u)=>{const{sid:h,clientId:f,cloudProxyServer:m}=i,y=[],_=S=>{S.flag===4096?$e.joinChooseServer(h,{role:i.role,lts:s,succ:!1,csAddr:r,opid:n.opid,serverList:null,ec:S.error.message,csIp:S.error.data&&S.error.data.csIp,unilbsServerIds:c.toString(),isHttp3:u,corssRegionTagReq:i.apRequestDetail}):S.flag!==1048576&&S.flag!==4194304&&S.flag!==4194310||$e.joinWebProxyAP(h,{lts:s,sucess:0,apServerAddr:r,turnServerAddrList:null,errorCode:S.error.code,eventType:m,unilbsServerIds:c.toString()})};if(n.response_body.forEach(S=>{const w=S.buffer.code;if(S.uri===23&&w===0&&!S.buffer.edges_services)if(S.buffer.flag===4194310)A.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),S.buffer.edges_services=[];else{const O={error:new se($.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:n.detail[502]}),flag:S.buffer.flag};y.push(O),_(O)}if(w!==0){const O=Uh(w),W={error:new se($.CAN_NOT_GET_GATEWAY_SERVER,O.desc,{desc:O.desc,retry:O.retry,csIp:n.detail[502]}),flag:S.buffer.flag};S.buffer.flag===4194310?A.warning(W.error.toString()):y.push(W),_(W)}}),y.length)throw A.warning("[".concat(f||"sid-".concat(h.slice(0,6)),"] multi unilbs ").concat(r," failed, ").concat(y.map(S=>"flag: ".concat(S.flag,", message: ").concat(S.error.message,", retry: ").concat(S.error.data.retry)).join(" | "))),new se($.CAN_NOT_GET_GATEWAY_SERVER,y.map(S=>"flag: ".concat(S.flag,", message: ").concat(S.error.message)).join(" | "),{retry:!!y.find(S=>S.error.data.retry),csIp:n.detail[502],desc:[...new Set(y.map(S=>{var w;return S==null||(w=S.error)===null||w===void 0||(w=w.data)===null||w===void 0?void 0:w.desc}).filter(S=>!!S))]})},rA=n=>{var r,i,s,c;if(n.addresses&&n.addresses.length===0&&n.code===0)throw new se($.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:n.detail&&n.detail[502]});if(Y("AP_AREA")&&((s=n.detail)!==null&&s!==void 0&&s[23]&&typeof((c=n.detail)===null||c===void 0?void 0:c[23])=="string"?A4(n.detail[23].toLowerCase()):A4()),(r=n.detail)!==null&&r!==void 0&&r[19]&&typeof((i=n.detail)===null||i===void 0?void 0:i[19])=="string"){const h=n.detail[19],f=h==null?void 0:h.split(";");for(let m=0;m<f.length;m++){var u;const y=Hr(u=f[m]).call(u);n.addresses[m]&&f&&(n.addresses[m].fingerprint=y)}}if(Y("GATEWAY_ADDRESS")&&Y("GATEWAY_ADDRESS").length>0){A.debug("assign gateway address to",Y("GATEWAY_ADDRESS"));const h=Y("GATEWAY_ADDRESS").map(f=>{var m,y;const _=(m=(y=n.addresses.find(S=>S.ip===f.ip&&S.port===f.port))===null||y===void 0?void 0:y.fingerprint)!==null&&m!==void 0?m:"";return{ip:f.ip,port:f.port,ticket:n.addresses[0]&&n.addresses[0].ticket,fingerprint:_}});n.addresses=h}},Ape=(n,r)=>{if(n.response_body&&n.response_body.length){const i=n.response_body[0];if(i.buffer.code!==0){const s=Uh(i.buffer.code);throw new se($.UPDATE_TICKET_FAILED,"[".concat(i.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return i.buffer.ticket}throw A.debug("update ticket request received ap response without response body:",r),new se($.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},iA=(n,r,i)=>{const s=Math.floor(Math.random()*1e12),c=n.role==="host"?"1":n.role==="audience"?"2":void 0,u={appid:n.appId,client_ts:Date.now(),opid:s,sid:n.sid,request_bodies:[{uri:22,buffer:{cname:n.cname,detail:Es(Es(Es({6:n.stringUid,11:r,12:Y("USE_NEW_TOKEN")?"1":void 0},c?{17:c}:{}),{},{22:r},n.apRequestDetail?{33:n.apRequestDetail}:{}),n.apRTM?{26:"RTM2"}:{}),key:n.token,service_ids:i,uid:n.uid||0}}]};u.request_bodies.forEach(f=>{n.multiIP&&n.multiIP.gateway_ip&&(f.buffer.detail[5]=JSON.stringify({vocs_ip:[n.multiIP.uni_lbs_ip],vos_ip:[n.multiIP.gateway_ip]}))});const h=new FormData;return h.append("request",JSON.stringify(u)),[h,s]},Ipe=(n,r)=>{const i=Math.floor(Math.random()*1e12),s={appid:n.appId,client_ts:Date.now(),opid:i,sid:n.sid,request_bodies:[{uri:28,buffer:{cname:n.cname,detail:{1:"",6:n.stringUid,12:"1"},token:n.token,service_ids:r,uid:n.uid||0,edges_services:n.apResponse.addresses.map(u=>({ip:u.ip,port:u.port}))}}]},c=new FormData;return c.append("request",JSON.stringify(s)),[c,i]};let Wh=0;function Gh(n){return Ie.all(n.map(r=>r.then(i=>{throw i},i=>i))).then(r=>{throw r},r=>r)}const Um=async n=>{let{fragementLength:r,referenceList:i,asyncMapHandler:s,allFailedhandler:c,promisesCollector:u}=n,h=0;const f=r;let m,y=0;const _=async()=>{const S=(()=>{const w=h*f,O=w+f;return i.slice(w,O).map(s)})();u&&u.push(...S);try{m=await Gh(S)}catch(w){if(y+=f,h++,!(y>=i.length))return void await _();c(w)}S.forEach(w=>w.cancel())};return await _(),m},D4=async n=>{let{referenceList:r,asyncMapHandler:i,closeFn:s}=n;const c=r.length;let u=0;const h=async()=>{const f=i(r.shift());try{return await f}catch(m){if(u++,u>=c||s!=null&&s(m))throw m;return h()}};return h()};async function aA(n,r,i,s){return{gatewayInfo:await async function(u,h,f,m){let y=null;const _=[],S=async()=>{const O=Y("WEBCS_DOMAIN").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(j=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(j+"/api/v2/transpond/webrtc?v=2"):"https://".concat(j,"/api/v2/transpond/webrtc?v=2"),areaCode:Mm()})),W=m.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:O.map(j=>j.url)}),k=await Um({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:O,asyncMapHandler:j=>(A.debug("[".concat(u.clientId,"] Connect to choose_server:"),j.url),N4(j,u,h,f)),allFailedhandler:j=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},W),j[0]},promisesCollector:_});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},W),k},w=async()=>{if(await _r(1e3),y!==null)return y;const O=Y("WEBCS_DOMAIN_BACKUP_LIST").map(j=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(j+"/api/v2/transpond/webrtc?v=2"):"https://".concat(j,"/api/v2/transpond/webrtc?v=2"),areaCode:Mm()})),W=m.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:O.map(j=>j.url)}),k=await Um({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:O,asyncMapHandler:j=>(A.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),j.url),N4(j,u,h,f)),allFailedhandler:j=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},W),j[0]},promisesCollector:_});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},W),k};try{return y=await Gh([S(),w()]),_.length&&_.forEach(O=>O.cancel&&typeof O.cancel=="function"&&O.cancel()),y}catch(O){throw O[0]}}(n,r,i,s)}}async function L4(n,r,i,s,c){const u=n.cloudProxyServer;if(u==="disabled"){if(n.useLocalAccessPoint)return await aA(n,r,i,c);if(Y("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:w,proxyInfo:O}=await U4(n,r,i,c);if(n.turnServer&&n.turnServer.mode!=="auto")return{gatewayInfo:w};const W=O.map(k=>({turnServerURL:k.address,tcpport:k.tcpport||Ar.tcpport,udpport:k.udpport||Ar.udpport,username:k.username||Ar.username,password:k.password||Ar.password,forceturn:!1,security:!0}));if(c.useP2P){var h;const k=(h=n.uid)!==null&&h!==void 0?h:w.uid,j="glb:".concat(k.toString()),H=await Z0(j),K=O.map(Q=>({turnServerURL:Q.address,tcpport:Q.tcpport||Ar.tcpport,udpport:Q.udpport||Ar.udpport,username:j,password:H,forceturn:!1,security:!0}));W.push(...K)}return n.turnServer={mode:"manual",servers:W},{gatewayInfo:w}}return await aA(n,r,i,c)}const{proxyInfo:f,gatewayInfo:m}=await U4(n,r,i,c),y={gatewayInfo:m},_=f.map(w=>({turnServerURL:w.address,tcpport:u==="proxy3"?void 0:w.tcpport?w.tcpport:Ar.tcpport,udpport:u==="proxy4"?void 0:w.udpport?w.udpport:Ar.udpport,username:w.username||Ar.username,password:w.password||Ar.password,forceturn:u!=="proxy4",security:u==="proxy5"}));if(c.useP2P){var S;const w=(S=n.uid)!==null&&S!==void 0?S:m.uid,O="glb:".concat(w.toString()),W=await Z0(O),k=f.map(j=>({turnServerURL:j.address,tcpport:u==="proxy3"?void 0:j.tcpport||Ar.tcpport,udpport:u==="proxy4"?void 0:j.udpport||Ar.udpport,username:O,password:W,forceturn:u!=="proxy4",security:u==="proxy5"}));_.push(...k)}return n.turnServer={mode:"manual",servers:_},A.debug("[".concat(n.clientId,"] set proxy server: ").concat(n.proxyServer,", mode: ").concat(u)),y}async function k4(n,r,i,s,c){const u=Y("ACCOUNT_REGISTER").slice(0,Y("AJAX_REQUEST_CONCURRENT"));let h=[];h=r.proxyServer?u.map(m=>"https://".concat(r.proxyServer,"/ap/?url=").concat(m+"/api/v1")):u.map(m=>"https://".concat(m,"/api/v1"));const f=c==null?void 0:c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:h});try{const m=await async function(y,_,S,w,O){const W=Date.now(),k={sid:S.sid,opid:10,appid:S.appId,string_uid:_};let j=y[0];const H=await Mo(()=>Fo(j+"".concat(j.indexOf("?")===-1?"?":"&","action=stringuid"),{data:k,cancelToken:w,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(K,Q)=>{if(K.code===0){if(K.uid<=0||K.uid>=Math.pow(2,32))throw A.error("Invalid Uint Uid ".concat(_," => ").concat(K.uid),K),$e.reqUserAccount(k.sid,{lts:W,success:!1,serverAddr:j,stringUid:k.string_uid,uid:K.uid,errorCode:$.INVALID_UINT_UID_FROM_STRING_UID,extend:k}),new se($.INVALID_UINT_UID_FROM_STRING_UID);return $e.reqUserAccount(k.sid,{lts:W,success:!0,serverAddr:j,stringUid:k.string_uid,uid:K.uid,errorCode:null,extend:k}),!1}const ie=Uh(K.code);return ie.retry&&(j=y[(Q+1)%y.length]),$e.reqUserAccount(k.sid,{lts:W,success:!1,serverAddr:j,stringUid:k.string_uid,uid:K.uid,errorCode:ie.desc,extend:k}),ie.retry},(K,Q)=>K.code!==$.OPERATION_ABORTED&&($e.reqUserAccount(k.sid,{lts:W,success:!1,serverAddr:j,stringUid:k.string_uid,uid:null,errorCode:K.code,extend:k}),j=y[(Q+1)%y.length],!0),O);if(H.code!==0){const K=Uh(H.code);throw new se($.UNEXPECTED_RESPONSE,K.desc)}return H}(h,n,r,i,s);return c==null||c.recordJoinChannelService({status:"success",endTs:Date.now()},f),m.uid}catch(m){throw c==null||c.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[m]},f),m}}async function Npe(n,r,i){const s=Y("ACCOUNT_REGISTER");let c=[];c=r.proxyServer?s.map(u=>"https://".concat(r.proxyServer,"/ap/?url=").concat(u+"/api/v1")):s.map(u=>"https://".concat(u,"/api/v1"));try{return await D4({referenceList:c,asyncMapHandler:h=>async function(f,m,y,_){const S=Date.now(),w={sid:y.sid,opid:10,appid:y.appId,string_uid:m};try{const O=await Fo(f+"".concat(f.indexOf("?")===-1?"?":"&","action=stringuid"),{data:w,cancelToken:_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(O.code!==0){const W=Uh(O.code);throw new se($.UNEXPECTED_RESPONSE,"preload sua error:".concat(W.desc),W)}if(O.uid<=0||O.uid>=Math.pow(2,32))throw new se($.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:S,url:f,req:w,uid:O.uid,elapse:Date.now()-S}}catch(O){throw O}}(h,n,r,i),closeFn:h=>h.code===$.OPERATION_ABORTED||h.code===$.UNEXPECTED_RESPONSE&&!h.data.retry})}catch(u){throw u}}async function Ppe(n,r,i){const s=Y("CDS_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(m=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(m+"/api/v1"):"https://".concat(m,"/api/v1?action=config")),c=s.map(m=>function(y,_,S,w){const O=St(),W={flag:64,cipher_method:0,features:Es(Es(Es(Es(Es({install_id:uO(),device:O.name,system:O.os,system_general:navigator.userAgent,vendor:_.appId,version:Ca,cname:_.cname,session_id:_.sid,proxyServer:_.proxyServer,sdk_type:Tpe.WEB_RTC,browser_name:O.name,browser_version:O.version,user_agent:navigator.userAgent,channel_name:_.cname},_.stringUid&&{string_uid:_.stringUid}),_.uid&&{uid:_.uid+""}),O.os&&{os_name:O.os}),O.osVersion&&{os_version:O.osVersion}),{},{detail:""})};return Mo(()=>Fo(y,{data:W,timeout:1e3,cancelToken:S,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,k=>k.code!==$.OPERATION_ABORTED,w)}(m,n,r,i));let u=null,h=null,f={};try{u=await Gh(c)}catch(m){if(m.code===$.OPERATION_ABORTED)throw m;h=m}if(c.forEach(m=>m.cancel()),$e.reportApiInvoke(n.sid,{name:Wn.REQUEST_CONFIG_DISTRIBUTE,options:{error:h,res:u}}).onSuccess(),u&&u.test_tags)try{f=function(m){if(!m.test_tags)return{};const y=m.test_tags,_=Object.keys(y),S={};return _.forEach(w=>{var O;const W=Hr(O=w.slice(4)).call(O),k=JSON.parse(y[w]),j=k[1];S[W]={tag:k[0]||"",value:j}}),S}(u)}catch{}return f}async function M4(n,r){const i=Y("WEBCS_DOMAIN").concat(Y("WEBCS_DOMAIN_BACKUP_LIST")).map(s=>({url:"https://".concat(s,"/api/v2/transpond/webrtc?v=2"),areaCode:Mm(),serviceIds:[Dn.CHOOSE_SERVER,Dn.CLOUD_PROXY_FALLBACK]}));try{return await D4({referenceList:i,asyncMapHandler:c=>async function(u,h,f){let m,{url:y,areaCode:_,serviceIds:S}=u;const w=Date.now(),[O,W]=iA(h,_,S);let k=xn.networkState;try{k&&xn.networkState===Hi.OFFLINE&&xn.onlineWaiter&&await Ie.race([xn.onlineWaiter,_r(Gn.maxRetryTimeout)]),k=xn.networkState;const{data:j,headers:H}=await Fo(y,{data:O,cancelToken:f,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);m=H.http3==="1"?1:-1,(re=>{const te=[];if(re.response_body.forEach(he=>{const Se=he.buffer.code;if(he.uri===23&&Se===0&&!he.buffer.edges_services)if(he.buffer.flag===4194310)he.buffer.edges_services=[];else{const Ne={error:new se($.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:re.detail[502]}),flag:he.buffer.flag};te.push(Ne)}if(Se!==0){const Ne=Uh(Se),ke={error:new se($.CAN_NOT_GET_GATEWAY_SERVER,Ne.desc,{desc:Ne.desc,retry:Ne.retry,csIp:re.detail[502]}),flag:he.buffer.flag};he.buffer.flag===4194310?A.warning(ke.error.toString()):te.push(ke)}}),te.length)throw new se($.CAN_NOT_GET_GATEWAY_SERVER,te.map(he=>"flag: ".concat(he.flag,", message: ").concat(he.error.message)).join(" | "),{retry:!!te.find(he=>he.error.data.retry),csIp:re.detail[502],desc:[...new Set(te.map(he=>{var Se;return he==null||(Se=he.error)===null||Se===void 0||(Se=Se.data)===null||Se===void 0?void 0:Se.desc}).filter(he=>!!he))]})})(j);const Q=Dm(j,Dn.CHOOSE_SERVER),ie=Dm(j,Dn.CLOUD_PROXY_FALLBACK);return rA(Q),{gatewayInfo:zO(Q,y),proxyInfo:ie,opid:W,requestTime:w,url:y,isHttp3:m,elapse:Date.now()-w}}catch(j){throw j}}(c,n,r),closeFn:c=>c.code===$.OPERATION_ABORTED||c.code===$.CAN_NOT_GET_GATEWAY_SERVER&&!c.data.retry})}catch(s){throw s}}async function U4(n,r,i,s){const c=Y("PROXY_SERVER_TYPE3"),u=(O,W,k)=>{let j=k||c;return Array.isArray(j)&&(j=W%2==0?c[1]:c[0]),"https://".concat(j,"/ap/?url=").concat(O)};let h=null;const f=[],m=async()=>{const O=Y("WEBCS_DOMAIN").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map((j,H)=>{let K;return K=n.cloudProxyServer==="disabled"&&n.proxyServer?u("".concat(j,"/api/v2/transpond/webrtc?v=2"),H,n.proxyServer):n.cloudProxyServer==="disabled"||n.cloudProxyServer==="fallback"?"https://".concat(j,"/api/v2/transpond/webrtc?v=2"):u("".concat(j,"/api/v2/transpond/webrtc?v=2"),H),{url:K,areaCode:Mm(),serviceIds:[Dn.CHOOSE_SERVER,n.cloudProxyServer==="proxy5"?Dn.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?Dn.CLOUD_PROXY:Dn.CLOUD_PROXY_FALLBACK]}}),W=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:O.map(j=>j.url)}),k=await Um({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:O,asyncMapHandler:j=>(A.debug("[".concat(n.clientId,"] Connect to choose_server:"),j.url),P4(j,n,r,i)),allFailedhandler:j=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},W),j[0]},promisesCollector:f});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},W),k},y=async()=>{if(await _r(1e3),h!==null)return h;const O=Y("WEBCS_DOMAIN_BACKUP_LIST").map((j,H)=>{let K;return K=n.cloudProxyServer==="disabled"&&n.proxyServer?u("".concat(j,"/api/v2/transpond/webrtc?v=2"),H,n.proxyServer):n.cloudProxyServer==="disabled"||n.cloudProxyServer==="fallback"?"https://".concat(j,"/api/v2/transpond/webrtc?v=2"):u("".concat(j,"/api/v2/transpond/webrtc?v=2"),H),{url:K,areaCode:Mm(),serviceIds:[Dn.CHOOSE_SERVER,n.cloudProxyServer==="proxy5"?Dn.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?Dn.CLOUD_PROXY:Dn.CLOUD_PROXY_FALLBACK]}}),W=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:O.map(j=>j.url)}),k=await Um({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:O,asyncMapHandler:j=>(A.debug("[".concat(n.clientId,"] Connect to backup choose_server:"),j.url),P4(j,n,r,i)),allFailedhandler:j=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},W),j[0]},promisesCollector:f});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},W),k};let _,S,w;try{({gatewayInfo:_,proxyInfo:S,url:w}=await Gh([m(),y()]))}catch(O){throw O[0]}if(f.length&&f.forEach(O=>O.cancel&&typeof O.cancel=="function"&&O.cancel()),!_||!S)throw new se($.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(n.apUrl=w,n.cloudProxyServer!=="disabled"&&Array.isArray(c)&&w){const O=/^https?:\/\/(.+?)(\/.*)?$/.exec(w)[1];Oe(c).call(c,O)&&(n.proxyServer=O,A.setProxyServer(O),$e.setProxyServer(O))}return h={gatewayInfo:_,proxyInfo:await s4(S,_.uid)},h}async function xpe(n,r,i){const s=Y("UAP_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(u=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap")),c=s.map(u=>function(h,f,m,y){const _={command:"convergeAllocateEdge",sid:f.sid,appId:f.appId,token:f.token,ts:Date.now(),version:Ca,cname:f.cname,uid:f.uid.toString(),requestId:nA,seq:nA};nA+=1;const S={service_name:"tele_channel",json_body:JSON.stringify(_)};return Mo(async()=>{const w=await Fo(h,{data:S,cancelToken:m,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(w.code!==0){const W=new se($.UNEXPECTED_RESPONSE,"cross channel ap error, code"+w.code,{retry:!0});throw A.error(W.toString()),W}const O=JSON.parse(w.json_body);if(O.code!==200){const W=new se($.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(O.code,", reason: ").concat(O.reason));throw A.error(W.toString()),W}if(!O.servers||O.servers.length===0){const W=new se($.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw A.error(W.toString()),W}return{vid:O.vid,workerToken:O.workerToken,addressList:(Y("CHANNEL_MEDIA_RELAY_SERVERS")||O.servers).map(W=>"wss://".concat(W.address.replace(/\./g,"-"),".").concat(Y("WORKER_DOMAIN"),":").concat(W.wss))}},void 0,w=>!!(w.code!==$.OPERATION_ABORTED&&w.code!==$.UNEXPECTED_RESPONSE||w.data&&w.data.retry),y)}(u,n,r,i));try{const u=await Gh(c);return c.forEach(h=>h.cancel()),u}catch(u){throw u[0]}}async function Dpe(n,r,i){let s=null;const c=[],u=async h=>{const f=Y(h?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(m=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(m+"/api/v2/transpond/webrtc?v=2"):"https://".concat(m,"/api/v2/transpond/webrtc?v=2"));return h&&(await _r(1e3),s!==null)?s:await Um({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:m=>(A.debug("[".concat(n.clientId,"] update ticket, Connect to ").concat(h?"backup":""," choose_server:"),m),function(y,_,S,w){const[O]=Ipe(_,[Dn.CHOOSE_SERVER]);let W=xn.networkState;return Mo(async()=>{W&&xn.networkState===Hi.OFFLINE&&xn.onlineWaiter&&await Ie.race([xn.onlineWaiter,_r(w&&w.maxRetryTimeout||Gn.maxRetryTimeout)]),W=xn.networkState;const k=await Fo(y,{data:O,cancelToken:S,headers:{"Content-Type":"multipart/form-data;"}},!0);return Ape(k,y)},()=>!1,k=>k.code!==$.OPERATION_ABORTED&&(k.code===$.UPDATE_TICKET_FAILED?k.data.retry:(A.warning("[".concat(_.clientId,"] update ticket network error, retry"),k),!0)),w)}(m,n,r,i)),allFailedhandler:m=>{throw m[0]},promisesCollector:c})};try{return s=await Gh([u(!1),u(!0)]),c.length&&c.forEach(h=>h.cancel&&typeof h.cancel=="function"&&h.cancel()),s}catch(h){throw h[0]}}function j4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function oA(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?j4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):j4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class Lpe extends ln{get isSuccess(){return!!this.configs}constructor(r,i){super(),F(this,"configs",void 0),F(this,"store",void 0),F(this,"joinInfo",void 0),F(this,"cancelToken",void 0),F(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),F(this,"interval",void 0),F(this,"mutex",void 0),F(this,"mutableParamsRead",!1),F(this,"configCache",{}),F(this,"limit_bitrate",void 0),this.mutex=new Lr("config-distribute",r),this.store=i}startGetConfigDistribute(r,i){this.joinInfo=r,this.cancelToken=i,this.interval&&this.stopGetConfigDistribute(),Y("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},Y("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,$e.reportApiInvoke(null,{options:void 0,name:Wn.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:fn.TRACER}).onSuccess(JSON.stringify(Uo))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void A.debug("[config-distribute] get config distribute interrupted have no joininfo");let r;const i=await this.mutex.lock();try{r=await Ppe(this.joinInfo,this.cancelToken,this.retryConfig),A.debug("[config-distribute] get config distribute",JSON.stringify(r));const s=function(c){var u;const h=om(u=Object.keys(c).filter(y=>/^webrtc_ng_global_parameter/.test(y))).call(u);for(let y=0;y<h.length;y++)for(let _=h.length-1;_>y;_--){const S=h[_],w=c[S].value;if(typeof w.__priority=="number"){const O=w.__priority,W=h[_-1],k=c[W].value;if(typeof k.__priority=="number"){if(!(O>k.__priority))continue;{const j=S;h[_]=h[_-1],h[_-1]=j}}else{const j=S;h[_]=h[_-1],h[_-1]=j}}}const f=Date.now();let m={};return h.forEach(y=>{const _=c[y].value.__expires;_&&_<=f||(m[y]=c[y])}),m}(r);this.cacheGlobalParameterConfig(s),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=s}catch(s){const c=new se($.NETWORK_RESPONSE_ERROR,s);A.warning("[config-distribute] ".concat(c.toString()))}finally{i()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(r){Y3(r)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==r.id&&this.emit(Nm.UPDATE_BITRATE_LIMIT,r):this.emit(Nm.UPDATE_BITRATE_LIMIT,r))}getLowStreamConfigDistribute(){return this.limit_bitrate&&oA({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(r){try{const i={},s=Object.keys(r),c=[];s.forEach(u=>{const h=r[u].value;i[u]=h;const f=h.__id;if(f&&this.configCache[u]&&this.configCache[u].__id===f)return;const m=h.__type,y=r[u].value,_=r[u].tag;let S=0;m?m===IB.REALTIME&&(S=1):Object.keys(y).some(w=>Object.prototype.hasOwnProperty.call(pO,w)||!MO()&&Object.prototype.hasOwnProperty.call(sE,w)?(S=1,!0):void 0),c.push({tag:_,isApplied:S,feature:u,params:JSON.stringify(h)})}),c.forEach(u=>{let{tag:h,feature:f,params:m,isApplied:y}=u;this.store.sessionId&&$e.abTest(this.store.sessionId,{intSucc:1,isApplied:y,tag:h,feature:f,params:m,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=i}catch(i){A.debug("handleABTestConfigDistribute error",i)}}cacheGlobalParameterConfig(r){const i=function(c){const u={};return Object.keys(c).forEach(h=>{const f=c[h].value,m=f.__expires,y=f.__type;Object.keys(f).forEach(_=>{_==="__id"||_==="__type"||_==="__priority"||_==="__expires"||Object.prototype.hasOwnProperty.call(u,_)||(u[_]=oA(oA({value:f[_]},m&&{expires:m}),y&&{type:y}))})}),u}(r);try{var s;const c=(s=i.LIMIT_BITRATE)===null||s===void 0?void 0:s.value;delete i.LIMIT_BITRATE,c&&Y3(c)&&this.handleBitrateLimit(c),this.limit_bitrate=c,this.handleGlobalParameterConfig(i),this.handleABTestConfigDistribute(r),function(f){try{const m=Date.now();Object.keys(f).forEach(y=>{const{value:_,type:S,expires:w}=f[y];w&&w<=m||((S===IB.REALTIME||Object.prototype.hasOwnProperty.call(pO,y))&&(Uo[y]=_,un[y]=_,A.debug("Update realtime parameters from config distribute",y,_)),S||MO()||!Object.prototype.hasOwnProperty.call(sE,y)||(Uo[y]=_,un[y]=_,A.debug("Update gateway parameters from config distribute",y,_)))})}catch(m){A.error("Error update config immediately: ".concat(f),m.message)}}(i);const u=JSON.stringify(i),h=window.btoa(u);window.localStorage.setItem("websdk_ng_global_parameter",h),A.debug("Caching global parameters ".concat(u))}catch(c){A.error("Error caching global parameters:",c.message)}}handleGlobalParameterConfig(r){try{const i=Date.now();Object.keys(r).forEach(s=>{if(s==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(un,s)){const{value:c,expires:u}=r[s];if(u&&u<=i)return;(function(h,f){try{return typeof h=="object"&&typeof f=="object"&&JSON.stringify(h)===JSON.stringify(f)}catch{return!1}})(un[s],c)||(Uo[s]=c,un[s]=c,this.emit(Nm.UPDATE_CLIENT_ROLE_OPTIONS,c),A.debug("Updating client role options: ".concat(JSON.stringify(c))))}})}catch(i){A.error("Error handling global parameter config:",i.message)}}}class kpe extends ln{constructor(){super(...arguments),F(this,"resultStorage",new Map)}setLocalAudioStats(r,i,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",r,this.checkAudioInputLevel(s,i)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",r,this.checkSendAudioBitrate(s,i))}setLocalVideoStats(r,i,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",r,this.checkSendVideoBitrate(s,i)),this.record("FRAMERATE_INPUT_TOO_LOW",r,this.checkFramerateInput(s,i)),this.record("FRAMERATE_SENT_TOO_LOW",r,this.checkFramerateSent(s))}setRemoteAudioStats(r,i){const s=r.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(i))}setRemoteVideoStats(r,i){const s=r.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(i))}record(r,i,s){if(Y("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(r)||this.resultStorage.set(r,{result:[],isPrevNormal:!0});const c=this.resultStorage.get(r);if(c&&(c.result.push(s),c.result.length>=5)){var u;const h=Oe(u=c.result).call(u,!0);c.isPrevNormal&&!h&&this.emit("exception",V4[r],r,i),!c.isPrevNormal&&h&&this.emit("exception",V4[r]+2e3,r+"_RECOVER",i),c.isPrevNormal=h,c.result=[]}}checkAudioOutputLevel(r){return!(r.receiveBitrate>0&&r.receiveLevel===0)}checkAudioInputLevel(r,i){return i instanceof qn&&!i.isActive||!!i.muted||r.sendVolumeLevel!==0}checkFramerateInput(r,i){let s=null;i._encoderConfig&&i._encoderConfig.frameRate&&(s=zi(i._encoderConfig.frameRate));const c=r.captureFrameRate;return!s||!c||!(s>10&&c<5||s<10&&s>=5&&c<=1)}checkFramerateSent(r){return!(r.captureFrameRate&&r.sendFrameRate&&r.captureFrameRate>5&&r.sendFrameRate<=1)}checkSendVideoBitrate(r,i){return!!i.muted||r.sendBitrate!==0}checkSendAudioBitrate(r,i){return i instanceof qn&&!i.isActive||!!i.muted||r.sendBitrate!==0}checkVideoDecode(r){return r.receiveBitrate===0||r.decodeFrameRate!==0}}const V4={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Mr=new class{markSubscribeStart(n,r){performance.mark("agora-web-sdk/".concat(n,"/subscribe-").concat(r))}markPublishStart(n,r){performance.mark("agora-web-sdk/".concat(n,"/publish-").concat(r))}measureFromSubscribeStart(n,r){const i=performance.getEntriesByName("agora-web-sdk/".concat(n,"/subscribe-").concat(r));if(i.length>0){const s=i[i.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(n,r){const i=performance.getEntriesByName("agora-web-sdk/".concat(n,"/publish-").concat(r));if(i.length>0){const s=i[i.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function B4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Uu(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?B4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):B4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class jm{constructor(r){F(this,"store",void 0),F(this,"onStatsException",void 0),F(this,"onUploadPublishDuration",void 0),F(this,"onStatsChanged",void 0),F(this,"localStats",new Map),F(this,"remoteStats",new Map),F(this,"updateStatsInterval",void 0),F(this,"trafficStats",void 0),F(this,"trafficStatsPeerList",[]),F(this,"uplinkStats",void 0),F(this,"exceptionMonitor",void 0),F(this,"p2pChannel",void 0),F(this,"scalabilityMode",oE.L1T1),F(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=r,this.exceptionMonitor=new kpe,this.exceptionMonitor.on("exception",(i,s,c)=>{this.onStatsException&&this.onStatsException(i,s,c)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ee.LocalAudioTrack)||Uu({},_O)}getLocalVideoTrackStats(){return this.localStats.get(Ee.LocalVideoTrack)||Uu({},EO)}getRemoteAudioTrackStats(r){const i=(u,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(m=>m.peer_uid===u);return f&&(h.publishDuration=f.B_ppad+(Date.now()-this.trafficStats.timestamp)),h},s={};if(r){var c;const u=(c=this.remoteStats.get(r))===null||c===void 0?void 0:c.audioStats;u&&(s[r]=i(r,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{audioStats:f}]=u;f&&(s[h]=i(h,f))});return s}getRemoteNetworkQualityStats(r){const i={};if(r){var s;const c=(s=this.remoteStats.get(r))===null||s===void 0?void 0:s.networkStats;c&&(i[r]=c)}else Array.from(this.remoteStats.entries()).forEach(c=>{let[u,{networkStats:h}]=c;h&&(i[u]=h)});return i}getRemoteVideoTrackStats(r){const i=(u,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(m=>m.peer_uid===u);return f&&(h.publishDuration=f.B_ppvd+(Date.now()-this.trafficStats.timestamp)),h},s={};if(r){var c;const u=(c=this.remoteStats.get(r))===null||c===void 0?void 0:c.videoStats;u&&(s[r]=i(r,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{videoStats:f}]=u;f&&(s[h]=i(h,f))});return s}getRTCStats(){let r=0,i=0,s=0,c=0;const u=this.localStats.get(Ee.LocalAudioTrack);u&&(r+=u.sendBytes,i+=u.sendBitrate);const h=this.localStats.get(Ee.LocalVideoTrack);h&&(r+=h.sendBytes,i+=h.sendBitrate);const f=this.localStats.get(Ee.LocalVideoLowTrack);f&&(r+=f.sendBytes,i+=f.sendBitrate),this.remoteStats.forEach(y=>{let{audioStats:_,videoStats:S}=y;_&&(s+=_.receiveBytes,c+=_.receiveBitrate),S&&(s+=S.receiveBytes,c+=S.receiveBitrate)});let m=1;return this.trafficStats&&(m+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:m,SendBitrate:i,SendBytes:r,RecvBytes:s,RecvBitrate:c,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(r){this.localStats.set(r,void 0)}removeLocalStats(r){r?this.localStats.delete(r):this.localStats.clear()}addRemoteStats(r){this.remoteStats.set(r,{})}removeRemoteStats(r){r?this.remoteStats.delete(r):this.remoteStats.clear()}addP2PChannel(r){this.p2pChannel=r}updateTrafficStats(r){r.peer_delay=r.peer_delay.filter(i=>i.B_ppad!==void 0||i.B_ppvd!==void 0),r.peer_delay.filter(i=>this.trafficStatsPeerList.indexOf(i.peer_uid)===-1).forEach(i=>{var s;const c=(s=this.p2pChannel)===null||s===void 0?void 0:s.getRemoteMedia(i.peer_uid),u=c!=null&&c.videoSSRC?Mr.measureFromSubscribeStart(this.store.clientId,c.videoSSRC):0,h=c!=null&&c.audioSSRC?Mr.measureFromSubscribeStart(this.store.clientId,c.audioSSRC):0;i.B_ppad!==void 0&&i.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(i.peer_uid,i.B_ppad,i.B_ppvd,u>h?u:h),this.trafficStatsPeerList.push(i.peer_uid))}),this.trafficStats=r}updateUplinkStats(r){this.uplinkStats&&this.uplinkStats.B_fir!==r.B_fir&&A.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(r.B_fir)),this.uplinkStats=r}static isRemoteVideoFreeze(r,i,s){if(!r)return!1;const c=!!s&&i.framesDecodeFreezeTime>s.framesDecodeFreezeTime,u=!s||i.framesDecodeCount>s.framesDecodeCount;return c||!u}static isRemoteAudioFreeze(r){return!!r&&r._isFreeze()}isLocalVideoFreeze(r){return!(!r.inputFrame||!r.sentFrame)&&r.inputFrame.frameRate>5&&r.sentFrame.frameRate<3}updateLocalStats(r){Array.from(this.localStats.entries()).forEach(i=>{let[s,c]=i;switch(s){case Ee.LocalVideoTrack:case Ee.LocalVideoLowTrack:{const h=c,f=Uu({},EO),m=r.getStats(),y=r.getLocalMedia(s);if(m){const _=m.videoSend.find(S=>S.ssrc===(y==null?void 0:y.ssrcs[0].ssrcId));if(_){const S=r.getLocalVideoSize(),w=r.getEncoderConfig(Ee.LocalVideoTrack);_.codec!=="H264"&&_.codec!=="H265"&&_.codec!=="VP8"&&_.codec!=="VP9"&&_.codec!=="AV1X"&&_.codec!=="AV1"||(f.codecType=_.codec),f.sendBytes=_.bytes,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0,_.inputFrame?(f.captureFrameRate=_.inputFrame.frameRate,f.captureResolutionHeight=_.inputFrame.height,f.captureResolutionWidth=_.inputFrame.width):S&&(f.captureResolutionWidth=S.width,f.captureResolutionHeight=S.height),_.sentFrame?(f.sendFrameRate=_.sentFrame.frameRate,f.sendResolutionHeight=_.sentFrame.height,f.sendResolutionWidth=_.sentFrame.width):S&&(f.sendResolutionWidth=S.width,f.sendResolutionHeight=S.height),_.avgEncodeMs&&(f.encodeDelay=_.avgEncodeMs),w&&w.bitrateMax&&(f.targetSendBitrate=1e3*w.bitrateMax),f.sendPackets=_.packets,f.sendPacketsLost=_.packetsLost,f.sendJitterMs=_.jitterMs,f.sendRttMs=_.rttMs,f.totalDuration=h?h.totalDuration+1:1,f.totalFreezeTime=h?h.totalFreezeTime:0,this.isLocalVideoFreeze(_)&&(f.totalFreezeTime+=1),_.scalabilityMode&&this.scalabilityMode!==_.scalabilityMode&&(A.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(_.scalabilityMode)),this.scalabilityMode=_.scalabilityMode)}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var u;this.localStats.set(s,f),((h==null?void 0:h.sendResolutionWidth)!==f.sendResolutionWidth||(h==null?void 0:h.sendResolutionHeight)!==f.sendResolutionHeight)&&((u=this.onStatsChanged)===null||u===void 0||u.call(this,"resolution",{width:f.sendResolutionWidth,height:f.sendResolutionHeight})),f&&y&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,y.track,f);break}case Ee.LocalAudioTrack:{const h=c,f=Uu({},_O),m=r.getStats(),y=r.getLocalMedia(s);if(m){const _=m.audioSend.find(S=>S.ssrc===(y==null?void 0:y.ssrcs[0].ssrcId));if(_){if(_.codec!=="opus"&&_.codec!=="aac"&&_.codec!=="PCMU"&&_.codec!=="PCMA"&&_.codec!=="G722"||(f.codecType=_.codec),_.inputLevel)f.sendVolumeLevel=Math.round(32767*_.inputLevel);else{const S=r.getLocalAudioVolume();S&&(f.sendVolumeLevel=Math.round(32767*S))}f.sendBytes=_.bytes,f.sendPackets=_.packets,f.sendPacketsLost=_.packetsLost,f.sendJitterMs=_.jitterMs,f.sendRttMs=_.rttMs,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0}}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Ee.LocalAudioTrack,f),f&&y&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,y.track,f);break}}})}updateRemoteStats(r){Array.from(this.remoteStats.entries()).forEach(i=>{var s,c;let[u,{videoStats:h,audioStats:f,videoPcStats:m}]=i;const y=f,_=h,S=m,w=Uu({},jB),O=Uu({},VB),W=Uu({},yfe),{audioTrack:k,videoTrack:j,audioSSRC:H,videoSSRC:K}=r.getRemoteMedia(u);let Q;Q=this.store.useP2P?r.getStats(!0):r.getStats();const ie=(s=Q)===null||s===void 0?void 0:s.audioRecv.find(Se=>Se.ssrc===H),re=(c=Q)===null||c===void 0?void 0:c.videoRecv.find(Se=>Se.ssrc===K),te=this.trafficStats&&this.trafficStats.peer_delay.find(Se=>Se.peer_uid===u);if(ie&&(ie.codec!=="opus"&&ie.codec!=="aac"&&ie.codec!=="PCMU"&&ie.codec!=="PCMA"&&ie.codec!=="G722"||(w.codecType=ie.codec),ie.outputLevel?w.receiveLevel=Math.round(32767*ie.outputLevel):k&&(w.receiveLevel=Math.round(32767*k.getVolumeLevel())),w.receiveBytes=ie.bytes,w.receivePackets=ie.packets,w.receivePacketsLost=ie.packetsLost,w.receivePacketsDiscarded=ie.packetsDiscarded,w.packetLossRate=w.receivePacketsLost/(w.receivePackets+w.receivePacketsLost),w.receiveBitrate=y?8*Math.max(0,w.receiveBytes-y.receiveBytes):0,w.totalDuration=y?y.totalDuration+1:1,w.totalFreezeTime=y?y.totalFreezeTime:0,w.freezeRate=w.totalFreezeTime/w.totalDuration,w.receiveDelay=ie.jitterBufferMs,w.totalDuration>10&&jm.isRemoteAudioFreeze(k)&&(w.totalFreezeTime+=1)),re){var he;re.codec!=="H264"&&re.codec!=="H265"&&re.codec!=="VP8"&&re.codec!=="VP9"&&re.codec!=="AV1X"&&re.codec!=="AV1"||(O.codecType=re.codec),O.receiveBytes=re.bytes,O.receiveBitrate=_?8*Math.max(0,O.receiveBytes-_.receiveBytes):0,O.decodeFrameRate=re.decodeFrameRate<0?0:re.decodeFrameRate,O.renderFrameRate=re.decodeFrameRate<0?0:re.decodeFrameRate,re.outputFrame&&(O.renderFrameRate=re.outputFrame.frameRate),re.receivedFrame?(O.receiveFrameRate=re.receivedFrame.frameRate,O.receiveResolutionHeight=re.receivedFrame.height,O.receiveResolutionWidth=re.receivedFrame.width):j&&(O.receiveResolutionHeight=j._videoHeight||0,O.receiveResolutionWidth=j._videoWidth||0),re.framesRateFirefox!==void 0&&(O.receiveFrameRate=Math.round(re.framesRateFirefox)),O.receivePackets=re.packets,O.receivePacketsLost=re.packetsLost,O.packetLossRate=O.receivePacketsLost/(O.receivePackets+O.receivePacketsLost);const Se=_?_.totalFreezeTime:0,Ne=_?_.totalDuration:0;O.totalDuration=_?_.totalDuration+1:1,O.totalFreezeTime=(he=re.totalFreezesDuration)!==null&&he!==void 0?he:Se||0,O.receiveDelay=re.jitterBufferMs||0;const ke=!!K&&r.getRemoteVideoIsReady(K);re.totalFreezesDuration===void 0&&j&&ke&&jm.isRemoteVideoFreeze(j,re,S)&&(O.totalFreezeTime+=1),O.freezeRate=Math.max(0,Math.min((O.totalFreezeTime-Se)/(O.totalDuration-Ne),1))}te&&(w.end2EndDelay=te.B_ad,O.end2EndDelay=te.B_vd,w.transportDelay=te.B_ed,O.transportDelay=te.B_ed,w.currentPacketLossRate=te.B_ealr4/100,O.currentPacketLossRate=te.B_evlr4/100,W.uplinkNetworkQuality=te.B_punq?te.B_punq:0,W.downlinkNetworkQuality=te.B_pdnq?te.B_pdnq:0),this.remoteStats.set(u,{audioStats:w,videoStats:O,videoPcStats:re,networkStats:W}),k&&this.exceptionMonitor.setRemoteAudioStats(k,w),j&&this.exceptionMonitor.setRemoteVideoStats(j,O)})}}class F4{constructor(){F(this,"destChannelMediaInfos",new Map),F(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(r){K3(r),this.srcChannelMediaInfo=r}addDestChannelInfo(r){K3(r),this.destChannelMediaInfos.set(r.channelName,r)}removeDestChannelInfo(r){RE(r),this.destChannelMediaInfos.delete(r)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function W4(n){if(!(n instanceof F4))return new se($.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const r=n.getSrcChannelMediaInfo(),i=n.getDestChannelMediaInfo();if(!r)return new se($.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(i.size===0)return new se($.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class rl{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(r,i){F(this,"uid",void 0),F(this,"_uintid",void 0),F(this,"_trust_in_room_",!0),F(this,"_trust_audio_enabled_state_",!0),F(this,"_trust_video_enabled_state_",!0),F(this,"_trust_audio_mute_state_",!0),F(this,"_trust_video_mute_state_",!0),F(this,"_audio_muted_",!1),F(this,"_video_muted_",!1),F(this,"_audio_enabled_",!0),F(this,"_video_enabled_",!0),F(this,"_audio_added_",!1),F(this,"_video_added_",!1),F(this,"_is_pre_created",!1),F(this,"_video_pre_subscribed",!1),F(this,"_audio_pre_subscribed",!1),F(this,"_trust_video_stream_added_state_",!0),F(this,"_trust_audio_stream_added_state_",!0),F(this,"_audioTrack",void 0),F(this,"_videoTrack",void 0),F(this,"_dataChannels",[]),F(this,"_audioSSRC",void 0),F(this,"_videoSSRC",void 0),F(this,"_audioOrtc",void 0),F(this,"_videoOrtc",void 0),F(this,"_cname",void 0),F(this,"_rtxSsrcId",void 0),F(this,"_videoMid",void 0),F(this,"_audioMid",void 0),this.uid=r,this._uintid=i}}function G4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function $4(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?G4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):G4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const Vm="9",H4=4e4;let Mpe=class{get localCapabilities(){return yn(this._localCapabilities)}get rtpCapabilities(){return yn(this._rtpCapabilities)}get candidates(){return yn(this._candidates)}get iceParameters(){return yn(this._iceParameters)}get dtlsParameters(){return yn(this._dtlsParameters)}constructor(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];F(this,"sessionDesc",void 0),F(this,"_localCapabilities",void 0),F(this,"_rtpCapabilities",void 0),F(this,"_candidates",void 0),F(this,"_originCandidates",void 0),F(this,"_iceParameters",void 0),F(this,"_isUseExtmapAllowMixed",void 0),F(this,"_dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname",void 0),F(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=r,n=yn(n);const{iceParameters:i,dtlsParameters:s,candidates:c,rtpCapabilities:u,setup:h,localCapabilities:f,cname:m}=n;this._rtpCapabilities=u,this._candidates=c,this._originCandidates=yn(c),this._iceParameters=i,this._dtlsParameters=s,this._localCapabilities=f,this.setup=h,this.cname=m,this.sessionDesc=this.updateRemoteRTPCapabilities(u),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(n){const r=this.candidates,i=this.dtlsParameters,s=this.iceParameters,c=this.rtpCapabilities.send;let u=this.sessionDesc.mediaDescriptions.length-1;for(let h=1;h<n;h++){const f=2*h+2e4,m=2*h+H4,{ssrcs:y,ssrcGroups:_}=ku([{ssrcId:f}],this.cname),{ssrcs:S,ssrcGroups:w}=ku([{ssrcId:m,rtx:Y("USE_SUB_RTX")?m+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Vm,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.videoCodecs.map(O=>O.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:r,extmaps:c.videoExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:S,ssrcGroups:w,rtcpFeedbackWildcards:[],payloads:c.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++u)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Vm,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.audioCodecs.map(O=>O.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:r,extmaps:c.audioExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:y,ssrcGroups:_,rtcpFeedbackWildcards:[],payloads:c.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++u)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Jc(this.sessionDesc)}send(n,r,i,s){const{ssrcs:c,ssrcGroups:u}=ku(r,this.cname,Y("SYNC_GROUP")?i:void 0),h=this.findPreloadMediaDesc(c);if(h){if(gn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,h.attributes.mid),s&&(s.twcc||s.remb)){const f=this.sessionDesc.mediaDescriptions.indexOf(h);return this.sessionDesc.mediaDescriptions[f]=this.mungSendMediaDesc(h,s),{mid:h.attributes.mid,needExchangeSDP:!0}}return{mid:h.attributes.mid,needExchangeSDP:!1}}{const f=this.findAvailableMediaIndex(n,c);let m;return f===-1||f===1&&(Cr()||function(){const y=St();return!(y.name!==Nt.CHROME||!y.osVersion)&&Number(y.version)<=90}()||Y("ENABLE_ENCODED_TRANSFORM")&&Xs())||f===0&&Y("USE_SUB_RTX")||ZV()?(m=this.createOrRecycleSendMedia(n,c,u,"sendonly",s),this.updateBundleMids()):(m=yn(this.sessionDesc.mediaDescriptions[f]),m.attributes.direction="sendonly",m.attributes.ssrcs=c,m.attributes.ssrcGroups=u,this.sessionDesc.mediaDescriptions[f]=this.mungSendMediaDesc(m,s)),gn()&&this.firefoxSsrcMidMap.set(c[0].ssrcId,m.attributes.mid),{mid:m.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:n,needExchangeSDP:r}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:n.attributes.mid,needExchangeSDP:r}}batchSend(n){const r=n.map(c=>{let{kind:u,ssrcMsg:h,mslabel:f}=c;return this.send(u,h,f)}),i=[];let s=!1;return r.forEach(c=>{let{mid:u,needExchangeSDP:h}=c;h&&(s=!0),i.push(u)}),{mids:i,needExchangeSDP:s}}stopSending(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>i.attributes.mid&&n.indexOf(i.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(i=>{i.attributes.mid==="0"||gn()||ZV()?i.attributes.ssrcs=[]:(i.attributes.ssrcs=[],i.attributes.direction="inactive",i.media.port="0")}),this.updateBundleMids()}mute(n){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(n){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}muteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>Oe(n).call(n,i.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="inactive"})}unmuteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>Oe(n).call(n,i.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="recvonly"})}receive(n,r,i,s){n.forEach((c,u)=>{this.createOrRecycleRecvMedia(c,[],"recvonly",r,i,s[u])}),this.updateBundleMids()}stopReceiving(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>n.indexOf(i.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(i=>{i.media.port="0",i.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(n){const r=this.sessionDesc||Ai((i=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(i?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var i;this._rtpCapabilities=n;const s=this.rtpCapabilities.send,c=this.localCapabilities.send;for(const u of r.mediaDescriptions){if(u.attributes.iceUfrag=this._iceParameters.iceUfrag,u.attributes.icePwd=this._iceParameters.icePwd,u.attributes.fingerprints=this._dtlsParameters.fingerprints,u.attributes.candidates=this._candidates,u.attributes.setup=this.setup,u.media.mediaType==="application"&&(u.attributes.sctpPort="5000"),u.media.mediaType==="video"){if(s.videoCodecs.length===0){const h=c.videoCodecs.filter(f=>{var m,y;return(m=f.rtpMap)===null||m===void 0?void 0:Oe(y=m.encodingName.toLowerCase()).call(y,"vp8")})||[c.videoCodecs[0]];u.media.fmts=h.map(f=>f.payloadType.toString(10)),u.attributes.payloads=h,u.attributes.extmaps=[]}else if(u.media.fmts=s.videoCodecs.map(h=>h.payloadType.toString(10)),u.attributes.payloads=s.videoCodecs,u.attributes.extmaps=s.videoExtensions,Y("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:h,ssrcGroups:f}=ku([{ssrcId:H4,rtx:Y("USE_SUB_RTX")?40001:void 0}],this.cname);u.attributes.ssrcs=h,u.attributes.ssrcGroups=f}}if(u.media.mediaType==="audio"){if(s.audioCodecs.length===0){const h=c.audioCodecs.filter(f=>{var m,y;return(m=f.rtpMap)===null||m===void 0?void 0:Oe(y=m.encodingName.toLowerCase()).call(y,"opus")})||[c.audioCodecs[0]];u.media.fmts=h.map(f=>f.payloadType.toString(10)),u.attributes.payloads=h,u.attributes.extmaps=[]}else if(u.media.fmts=s.audioCodecs.map(h=>h.payloadType.toString(10)),u.attributes.payloads=s.audioCodecs,u.attributes.extmaps=s.audioExtensions,Fh(u),Y("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:h,ssrcGroups:f}=ku([{ssrcId:2e4}],this.cname);u.attributes.ssrcs=h,u.attributes.ssrcGroups=f}}}return this.sessionDesc=r,this.currentMidIndex=r.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(n){const r=this._originCandidates.filter(s=>s.transport==="udp"),i=[];if(r.forEach(s=>{i.push($4($4({},s),{},{foundation:"tcpcandidate",priority:Number(s.priority)-1+"",transport:"tcp",port:Number(s.port)+90+""}))}),r.length!==0){switch(n){case Fr.TCP_RELAY:this._candidates=i;break;case Fr.UDP_TCP_RELAY:case Fr.RELAY:this._candidates=[...r,...i];break;default:this._candidates=r}for(const s of this.sessionDesc.mediaDescriptions)s.attributes.candidates=this.candidates}}restartICE(n){n=yn(n),this._iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=n.iceUfrag,r.attributes.icePwd=n.icePwd})}predictReceivingMids(n){const r=[];for(let i=0;i<n;i++)r.push((this.currentMidIndex+i+1).toString(10));return r}findAvailableMediaIndex(n,r){return this.sessionDesc.mediaDescriptions.findIndex(i=>{const s=i.media.mediaType===n&&i.media.port!=="0"&&(i.attributes.direction==="sendonly"||i.attributes.direction==="sendrecv")&&i.attributes.ssrcs.length===0;if(gn()){if(s){const c=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(c||i.attributes.mid!=="0"&&i.attributes.mid!=="1")||!(!c||c!==i.attributes.mid)}return!1}return s})}createOrRecycleDataChannel(){for(const i of this.sessionDesc.mediaDescriptions)if(i.media.mediaType==="application")return{mediaDesc:i,needExchangeSDP:!1};this.currentMidIndex+=1;const n="".concat(this.currentMidIndex),r={media:{mediaType:"application",port:Vm,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(n),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(r),{mediaDesc:r,needExchangeSDP:!0}}createOrRecycleRecvMedia(n,r,i,s,c,u){const h=n._mediaStreamTrack.kind,f=this.rtpCapabilities.recv,m=km(h,f,this.localCapabilities.send,h===Ue.VIDEO?s:c),y=h===Ue.VIDEO?f.videoExtensions:f.audioExtensions;this.currentMidIndex+=1;const _="".concat(this.currentMidIndex);let S={media:{mediaType:h,port:Vm,protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(O=>O.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_)}};S=this.mungRecvMediaDsec(S,n,u);const w=this.findFirstClosedMedia(h);if(w){const O=this.sessionDesc.mediaDescriptions.indexOf(w);this.sessionDesc.mediaDescriptions[O]=S}else this.sessionDesc.mediaDescriptions.push(S);return S}updateRemoteCodec(n,r,i){const s=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(S=>S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||"").filter(S=>{var w;return Oe(w=Object.keys(cE)).call(w,S)}))],c=new Set(r);if(s.every(S=>c.has(S)))return A.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(r)),!1;const u=this._rtpCapabilities.recv.videoCodecs.filter(S=>r.some(w=>{var O;return Oe(O=S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||"").call(O,w)}));if(u.length===0)return A.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(s," codecs: ").concat(r)),!1;const h=[...new Set(u.map(S=>S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||""))];let f;if(A.debug("updateRemoteCodec, from ".concat(s," to ").concat(h)),n.length===0)f=this.sessionDesc.mediaDescriptions.filter(S=>S.media.mediaType==="video"&&S.attributes.direction==="recvonly");else if(f=this.sessionDesc.mediaDescriptions.filter(S=>S.attributes.mid&&Oe(n).call(n,S.attributes.mid)&&S.attributes.direction==="recvonly"),f.length!==n.length)return A.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(n,", codecs: ").concat(r)),!1;if(Y("USE_PUB_RTX")||Y("USE_SUB_RTX")){const S=XO(u,this.rtpCapabilities.recv.videoCodecs);u.push(...S)}this._rtpCapabilities.recv.videoCodecs=u;const m=this.localCapabilities.send,y=this.rtpCapabilities.recv,_=km(Ue.VIDEO,y,m,i);return f.forEach(S=>{const w=_.map(O=>O.payloadType.toString(10));A.debug("updateRemoteCodec mid: ".concat(S.attributes.mid,", from"),S.attributes.payloads,"to",_),S.attributes.payloads=_,S.media.fmts=w}),!0}createOrRecycleSendMedia(n,r,i,s,c){const u=this.rtpCapabilities.send,h=n===Ue.VIDEO?u.videoCodecs:u.audioCodecs,f=n===Ue.VIDEO?u.videoExtensions:u.audioExtensions;this.currentMidIndex+=1;const m="".concat(this.currentMidIndex);let y={media:{mediaType:n,port:Vm,protos:["UDP","TLS","RTP","SAVPF"],fmts:h.map(S=>S.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:f,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:h,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(m)}};y=this.mungSendMediaDesc(y,c);const _=this.findFirstClosedMedia(n);if(_){const S=this.sessionDesc.mediaDescriptions.indexOf(_);this.sessionDesc.mediaDescriptions[S]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(n=>n.media.port!=="0").map(n=>n.attributes.mid)}mungRecvMediaDsec(n,r,i){const s=yn(n);return qO(s),Bh(s,r),YO(s,r),m4(s),LE(s,i,this.localCapabilities.send),s}mungSendMediaDesc(n,r){const i=yn(n);return LE(i,r,this.localCapabilities.recv),Fh(i),i}updateRecvMedia(n,r){const i=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===n);if(i!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],r);this.sessionDesc.mediaDescriptions[i]=s}}bumpMid(n){this.currentMidIndex+=n}findFirstClosedMedia(n){return this.sessionDesc.mediaDescriptions.find(r=>gn()?r.media.port==="0"&&r.media.mediaType===n:r.media.port==="0")}findPreloadMediaDesc(n){return this.sessionDesc.mediaDescriptions.find(r=>{var i;return((i=r.attributes)===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId)===n[0].ssrcId})}getSSRC(n){var r;return(r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===n))===null||r===void 0?void 0:r.attributes.ssrcs}};function z4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function ac(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?z4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):z4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}var $h=function(n){return n[n.DOWN=0]="DOWN",n[n.UP=1]="UP",n}($h||{});const BE=new Map;function K4(n,r,i,s){let{scale:c}=n;if(c===0&&s===$h.UP||c>=r.length-1&&s===$h.DOWN)return n;let u=ac(ac({},n),{},{scale:s===$h.DOWN?++c:--c});switch(i){case"maintain-framerate":u=ac(ac({},u),r[c].motion);break;case"maintain-resolution":u=ac(ac({},u),r[c].detail);break;case"balanced":u=ac(ac({},u),r[c].balanced)}return u}function q4(n,r){if(r){const i={overUse:0,underUse:0,adaptationList:Y4(r)};BE.set(n,i)}else BE.delete(n)}function Y4(n){const r=ac({},n),{bitrateMax:i,frameRate:s,scaleResolutionDownBy:c,bitrateMin:u}=r,{MIN_FRAME_RATE:h,MAX_THRESHOLD_FRAMERATE:f,MAX_SCALE:m,BITRATE_MIN_THRESHOLD:y,BITRATE_MAX_THRESHOLD:_,BWE_SCALE_UP_THRESHOLD:S,BWE_SCALE_DOWN_THRESHOLD:w,PERF_SCALE_DOWN_THRESHOLD:O,PERF_SCALE_UP_THRESHOLD:W,BALANCE_BITRATE_FACTOR:k,BALANCE_FRAMERATE_FACTOR:j,BALANCE_RESOLUTION_FACTOR:H,MOTION_RESOLUTION_FACTOR:K,MOTION_BITRATE_FACTOR:Q,DETAIL_FRAMERATE_FACTOR:ie,DETAIL_BITRATE_FACTOR:re}=hO,te=Math.min(r.frameRate,f),he=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(w,1)*i),bwe_up:i,fps_down:Math.round(Math.pow(O,1)*te),fps_up:s},balanced:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:i,bitrateMin:u},motion:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:i,bitrateMin:u},detail:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:i,bitrateMin:u}}];for(let Se=1;Se<=m;Se++){const Ne={bwe_up:Math.round(Math.pow(S,Se)*i),bwe_down:Math.round(Math.pow(w,Se+1)*i),fps_up:Math.round(Math.pow(W,Se)*te),fps_down:Math.round(Math.pow(O,Se+1)*te)},ke={scaleResolutionDownBy:c/Math.pow(H,Se),frameRate:Math.max(Math.round(Math.pow(j,Se)*s),h),bitrateMax:Math.max(Math.round(Math.pow(k,Se)*i),_),bitrateMin:Math.max(Math.round(Math.pow(k,Se)*u),y)},pt={scaleResolutionDownBy:c/Math.pow(K,Se),frameRate:s,bitrateMax:Math.max(Math.round(Math.pow(Q,Se)*i),_),bitrateMin:Math.max(Math.round(Math.pow(Q,Se)*u),y)},mt={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(ie,Se)*s),h),bitrateMax:Math.max(Math.round(Math.pow(re,Se)*i),_),bitrateMin:Math.max(Math.round(Math.pow(re,Se)*u),y)};he.push({scale:Se,threshold:Ne,balanced:ke,motion:pt,detail:mt})}return he}function Upe(n,r,i,s,c,u){const h=BE.get(n)||{overUse:0,underUse:0,adaptationList:Y4(c)},{adaptationList:f}=h;BE.set(n,h);const{OVERUSE_TIMES_THRESHOLD:m,UNDERUSE_TIMES_THRESHOLD:y}=hO,{scale:_}=s;let S,w;return typeof r=="number"&&r>0&&function(O,W,k,j){if(W>=k.length)return!1;let{threshold:{fps_down:H}}=k[W];return Y("FORCE_AG_HIGH_FRAMERATE")&&j==="maintain-framerate"&&(H=k[0].threshold.fps_down),O<H}(r,_,f,u)&&(h.overUse++,w=wm.CPU,h.overUse>m)||typeof i=="number"&&i>0&&function(O,W,k){if(W>=k.length)return!1;const{threshold:{bwe_down:j}}=k[W];return O<j}(i,_,f)&&(h.overUse++,w=wm.BANDWIDTH,h.overUse>m)?(h.overUse=0,h.underUse=0,S=K4(s,f,u,$h.DOWN),[S,w]):(typeof r=="number"&&r>0&&typeof i=="number"&&i>0&&function(O,W,k,j){if(W===0)return;let{threshold:{fps_up:H}}=k[W];return Y("FORCE_AG_HIGH_FRAMERATE")&&j==="maintain-framerate"&&(H=k[1].threshold.fps_up),O>H}(r,_,f,u)&&function(O,W,k){if(W===0)return;const{threshold:{bwe_up:j}}=k[W];return O>j}(i,_,f)&&(h.underUse++,h.underUse>y&&(h.overUse=0,h.underUse=0,S=K4(s,f,u,$h.UP),S.scale===0&&(w=wm.NONE))),[S,w])}function X4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function sA(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?X4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):X4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}function jpe(n){var r;return!!Y("ENABLE_AG_ADAPTATION")&&!!(n instanceof IO||Oe(r=n._hints).call(r,Yt.CUSTOM_TRACK))&&(!!Y("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(i){const s=St();if(s.os!==tr.IOS||!s.osVersion)return!1;const c=s.osVersion.split(".");return Number(c[0])>=i}(14)&&JV(17,4,!0)||XV(14)&&QV(17,4,!0)))}const FE=new Map;function WE(n,r){const i=FE.get(n);if(i){const{timer:s}=i;window.clearTimeout(s),FE.delete(n)}r.qualityLimitationReason=wm.NONE,q4(n)}function Vpe(n,r){var i;let s;switch(r){case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoTrack:s=Oe(i=n._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return s}function cA(n){const r=bt();if(n.some(i=>i._bypassWebAudio))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!r.webAudioMediaStreamDest)throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function lA(n,r){cA(n);const i=new qn;return n.forEach(s=>i.addAudioTrack(s)),i}const Bpe=!bt().supportUnifiedPlan||Y("CHROME_FORCE_PLAN_B")&&Js();function GE(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;return Bpe?(i={spec:r,store:n},nl("PlanBConnection").create(i)):new oc(r,n)}function uA(n){return n&&(n.iceConnectionState==="disconnected"||n.iceConnectionState==="checking"||n.iceConnectionState==="failed")}function J4(n){try{if(n.iceServers)return!1;if(n.turnServer&&n.turnServer.mode!=="off"){if(Sm(n.turnServer.servers))return!1;if(Y("FORCE_TURN_TCP")||n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).some(r=>r.forceturn))return!0}return!1}catch{return!1}}var yt;function Q4(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Wo(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?Q4(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Q4(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let oc=(yt=class jg extends J3{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var r,i;return(r=(i=this.peerConnection.getReceivers()[0])===null||i===void 0||(i=i.transport)===null||i===void 0?void 0:i.state)!==null&&r!==void 0?r:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var i;return Oe(i=Object.keys(cE)).call(i,r)}))]}constructor(r,i){super(r,i),F(this,"id",qt(5,"connection-")),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"forceTurn",!1),F(this,"remoteSDP",void 0),F(this,"initialOffer",void 0),F(this,"transportEventReceiver",void 0),F(this,"statsFilter",void 0),F(this,"extension",{useXR:Y("USE_XR")}),F(this,"localCapabilities",void 0),F(this,"remoteCodecs",void 0),F(this,"localCandidateCount",0),F(this,"allCandidatesReceived",!1),F(this,"isPreallocation",!1),F(this,"preSSRCMap",new Map),F(this,"dataStreamChannelMap",new Map),F(this,"establishPromise",void 0),F(this,"recoveredDataChannelIds",[]),F(this,"currentDataChannelId",1),F(this,"supportAV1RtpSpec",!1),F(this,"mutex",void 0),F(this,"qualityLimitationReason",wm.NONE),this.store=i,this.forceTurn=J4(r),this.mutex=new Lr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(jg.resolvePCConfiguration(r),{optional:[{googDscp:!0}]}),this.statsFilter=lO(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,gn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(r){const i=this.preSSRCMap.get(r);if(i!==void 0){const s=this.peerConnection.getTransceivers().find(c=>c.mid===i);if(s)return{transceiver:s,track:s.receiver.track,id:i}}}async updateRemoteRTPCapabilities(r,i){if(this.remoteCodecs=i,!this.remoteSDP)return void A.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(i));if(this.remoteSDP.updateRemoteCodec(r,i,this.store.codec)){const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else A.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=tl(s.sdp),u=await y4({filterRTX:!Y("USE_PUB_RTX")&&!Y("USE_SUB_RTX"),filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC"),filterVideoCodec:Y("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=kE(u),this.initialOffer=s,Y("ENABLE_SVC")&&this.store.codec=="av1"){const f=await async function(){try{const m=new RTCPeerConnection;m.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:oE.L1T3}]});const y=await m.createOffer();if(!y.sdp)return void m.close();const _=Ai(y.sdp).mediaDescriptions[0];if(!_)return;const S=_.attributes.extmaps.find(w=>w.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return m.close(),S}catch{return}}();var r;f&&(this.supportAV1RtpSpec=!0,(r=u.send)===null||r===void 0||r.videoExtensions.push(f))}let h;return s.sdp&&S4(s.sdp)&&(h=yn(u),(i=h).send&&(Vh(Ue.VIDEO,i.send.videoExtensions),Vh(Ue.AUDIO,i.send.audioExtensions)),i.recv&&(Vh(Ue.VIDEO,i.recv.videoExtensions),Vh(Ue.AUDIO,i.recv.audioExtensions)),i.sendrecv&&(Vh(Ue.VIDEO,i.sendrecv.videoExtensions),Vh(Ue.AUDIO,i.sendrecv.audioExtensions))),Wo(Wo({},c),{},{rtpCapabilities:h||u,offerSDP:s.sdp})}catch(s){throw new de($.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}var i}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&S4(this.initialOffer.sdp)&&(i=r.rtpCapabilities,s=this.localCapabilities,i.send&&(xE(Ue.VIDEO,i.send.videoExtensions,s.send.videoExtensions),xE(Ue.AUDIO,i.send.audioExtensions,s.send.audioExtensions)),i.recv&&(xE(Ue.VIDEO,i.recv.videoExtensions,s.recv.videoExtensions),xE(Ue.AUDIO,i.recv.audioExtensions,s.recv.audioExtensions))),this.remoteSDP=new Mpe(Wo(Wo({},r),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),r.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const c=this.remoteSDP.toString(),u=_4(this.initialOffer.sdp,this.extension),h=this.logSDPExchange(u||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),h==null||h(c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:c});const f=this.peerConnection.getTransceivers()[0];if(f!=null&&f.receiver&&this.tryBindTransportEvents(f.receiver),Y("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(Y("PRELOAD_MEDIA_COUNT"));const y=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:y});const _=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_)}const{preSSRCs:m}=r;if(Array.isArray(m)&&m.length>0){const{mids:y}=this.remoteSDP.batchSend(m.map(_=>({kind:_.kind,ssrcMsg:[{ssrcId:_.ssrcId,rtx:_.rtx}],mslabel:_.mslabel})));y.forEach((_,S)=>{this.preSSRCMap.set(m[S].ssrcId,_)}),await ME(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(c){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(c.toString()))}var i,s}async updateRemoteConnect(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:i}=r;this.remoteSDP.updateRemoteRTPCapabilities(i),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:s}=r;if(Array.isArray(s)&&s.length>0){const{mids:c}=this.remoteSDP.batchSend(s.map(u=>Object.assign({},{kind:u.kind,ssrcMsg:[{ssrcId:u.ssrcId,rtx:u.rtx}],mslabel:u.mslabel})));c.forEach((u,h)=>{this.preSSRCMap.set(s[h].ssrcId,u)})}await ME(this.peerConnection,this.remoteSDP,this.extension),A.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(i.toString()))}}send(r,i,s){var c=this;return wa(function*(){const u=yield vt(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[],f=PE();r.forEach(j=>{const H=c.peerConnection.addTransceiver(j._mediaStreamTrack,Wo({direction:"sendonly"},j.trackMediaType==="video"&&c.supportAV1RtpSpec&&f?{sendEncodings:[{scalabilityMode:f}]}:{}));h.push(H),j._updateRtpTransceiver(H)}),gn()&&Y("SIMULCAST")===!0&&(yield vt(c.applySimulcastForFirefox(h,r)));const m=yield vt(c.peerConnection.createOffer()),y=c.remoteSDP.predictReceivingMids(r.length),_=c.mungSendOfferSDP(m.sdp,r,y),S=Ai(_),w=y.map(j=>{const H=S.mediaDescriptions.find(K=>K.attributes.mid===j);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return h4(H,Y("USE_PUB_RTX"))});let O;try{O=yield w}catch(j){O=[],c.remoteSDP.receive(r,i,s,O);const H=c.remoteSDP.toString();throw yield vt(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield vt(c.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield vt(c.stopSending(y,!0)),j}c.remoteSDP.receive(r,i,s,O);const W=c.remoteSDP.toString(),k=c.logSDPExchange(_,"offer","local","send");return yield vt(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield vt(c.applySimulcastEncodings(h,r)),yield vt(c.applySendEncodings(h,r)),k==null||k(W),yield vt(c.peerConnection.setRemoteDescription({type:"answer",sdp:W})),h.map((j,H)=>{const K=y[H];return{localSSRC:w[H],id:K,transceiver:j}})}catch(h){throw h instanceof de?h:new de($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async createDataChannels(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(r);if(s&&s.readyState==="open")A.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const u=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof u!="number")throw new Error("create DataChannel error, because cannot get dc id");s=this.peerConnection.createDataChannel("datastream-channel",{id:u,negotiated:!0,ordered:!1,maxRetransmits:Y("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(r,s)}i.forEach(u=>{u._updateOriginDataChannel(s)});const{needExchangeSDP:c}=this.remoteSDP.sendDataChannel();if(c){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const h=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(h),A.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else A.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(s){throw s instanceof de?s:new de($.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(r){try{const i=this.dataStreamChannelMap.get(r);return i&&(i.id&&this.recoveredDataChannelIds.push(i.id),i.close()),void this.dataStreamChannelMap.delete(r)}catch(i){throw i instanceof de?i:new de($.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(i.toString()))}}async stopSending(r,i){const s=i?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(m=>r.indexOf(m.mid)!==-1);if(c.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");c.map(m=>{var y;WE(this.id+m.mid,this),m.direction="inactive",(y=m.stop)===null||y===void 0||y.call(m)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(r);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(c){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{s&&s()}}async receive(r,i,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(r,i,s,c);h&&(await ME(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP.")));const f=this.peerConnection.getTransceivers().find(m=>m.mid===u);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:u,transceiver:f}}catch(u){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async batchReceive(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:i,needExchangeSDP:s}=this.remoteSDP.batchSend(r);return s&&(await ME(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),i.map(c=>{const u=this.peerConnection.getTransceivers().find(h=>h.mid===c);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:c,transceiver:u}})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");r.forEach(u=>{Array.from(this.preSSRCMap.entries()).some(h=>{let[f,m]=h;if(m===u)return this.preSSRCMap.delete(f),!0})}),this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async muteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.mute(r);const i=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(i.toString()))}}async unmuteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.unmute(r);const i=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(i.toString()))}}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(h=>h.mid&&r.indexOf(h.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(h=>{h.direction="inactive"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(r);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(h=>h.mid&&r.indexOf(h.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(async(h,f)=>{h.direction="sendonly"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(r,this.remoteCodecs,this.store.codec);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}restartICE(r){var i=this;return wa(function*(){const s=yield vt(i.mutex.lock("From P2PConnection.restartICE"));try{if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const c=bt().supportPCSetConfiguration,u=Y("FORCE_TURN_TCP")||i.forceTurn;if(r===Fr.RELAY&&!c)return;if(c&&!u){const S=r===Fr.RELAY?"relay":"all",w=i.peerConnection.getConfiguration();w.iceTransportPolicy!==S&&(A.debug("[".concat(i.store.clientId,"] restartICE change iceTransportPolicy from [").concat(w.iceTransportPolicy,"] to [").concat(S,"]")),w.iceTransportPolicy=S,i.peerConnection.setConfiguration(w))}i.remoteSDP.updateCandidates(r);const h=yield vt(i.peerConnection.createOffer({iceRestart:!0}));if(!h.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const f=tl(h.sdp),{remoteIceParameters:m}=yield f.iceParameters;i.remoteSDP.restartICE(m);const y=i.remoteSDP.toString(),_=i.logSDPExchange(h.sdp||"","offer","local","restartICE");i.store.descriptionStart(),yield vt(i.peerConnection.setLocalDescription(h)),_==null||_(y),yield vt(i.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(c){A.warning("[".concat(i.store.clientId,"] restart ICE failed, abort operation"),c)}finally{s()}})()}close(){var r;this.peerConnection.getTransceivers().forEach(i=>{WE(this.id+i.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return Wo(Wo({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[i],[r]);this.remoteSDP.updateRecvMedia(r,i);const u=this.remoteSDP.toString(),h=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new de($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(r,i){const s=this.peerConnection.getTransceivers().filter(c=>c.mid===r);s.length===1&&(this.isVP8Simulcast(i)?gn()||await this.applySimulcastEncodings(s,[i]):await this.applySendEncodings(s,[i]))}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const s=this.peerConnection.getTransceivers().find(c=>c.mid===i);s&&await s.sender.replaceTrack(r._mediaStreamTrack)}async getSelectedCandidatePair(){const r=this.peerConnection.getReceivers();if(r.length>0&&r[0].transport&&r[0].transport.iceTransport&&r[0].transport.iceTransport.getSelectedCandidatePair&&r[0].transport.iceTransport.getSelectedCandidatePair()){const i=r[0].transport.iceTransport,{local:s,remote:c}=i.getSelectedCandidatePair();return{local:Wo(Wo({},ms),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:Wo(Wo({},ms),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r;(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=r=>{if(r&&(r.errorCode||r.errorText)){var i;const s="code: ".concat(r.errorCode,", message: ").concat(r.errorText),c=r.port?"local: ".concat(r.port):"";A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(s,"), url: ").concat(r.url||"",", host_candidate:").concat(c)),(i=this.onICECandidateError)===null||i===void 0||i.call(this,s)}},this.peerConnection.onicegatheringstatechange=r=>{r&&r.target&&"iceGatheringState"in r.target&&A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(r.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=r=>{r.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Y("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r){const i={iceServers:[]};return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Sm(r.turnServer.servers)?i.iceServers=r.turnServer.servers:(i.iceServers&&i.iceServers.push(...jg.turnServerConfigToIceServers(r.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(...jg.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),Y("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(i.iceTransportPolicy="relay")}))),Y("ENABLE_ENCODED_TRANSFORM")&&bt().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(s=>{s.security?s.tcpport&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(jh(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Y("FORCE_TURN_TCP")&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),i}tryBindTransportEvents(r){const i=r.transport;if(i){this.transportEventReceiver=r,i.onstatechange=()=>{var c;i!=null&&i.state&&((c=this.onDTLSTransportStateChange)===null||c===void 0||c.call(this,i.state))},i.onerror=c=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in c?c.error:c)};const s=i.iceTransport;s&&(s.onstatechange=()=>{const c=i==null?void 0:i.iceTransport.state;var u;c&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,c))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:c,remote:u}=s.getSelectedCandidatePair();A.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(r,i){var s,c;if(i||(i=this.peerConnection.getSenders().find(j=>j.track===r._mediaStreamTrack)),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(r))return A.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!bt().supportSetRtpSenderParameters)return A.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},h={};switch(r._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;case"balanced":u.degradationPreference="balanced"}const f=function(k,j){return k.getTransceivers().find(H=>H.sender.track===j||H.receiver.track===j)}(this.peerConnection,r._mediaStreamTrack),m=bfe(r);if(jpe(r)&&f&&i&&m&&this.getLocalVideoStats&&Oe(s=["vp8","vp9"]).call(s,this.store.codec)){var y;const k=u.degradationPreference||(Oe(y=r._hints).call(y,Yt.CUSTOM_TRACK)?Y("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(j,H,K,Q,ie,re){if(WE(j,K),ie(H),Q!=="balanced"&&Q!=="maintain-framerate"&&Q!=="maintain-resolution")return;let te=-1;q4(j,H);const he=window.setInterval(()=>{const Ne=FE.get(j);if(!Y("ENABLE_AG_ADAPTATION")||!Ne)return WE(j,K),void ie(H);const ke=re();if(ke.sendPackets>0&&ke.OutgoingAvailableBandwidth>0){if(te===-1)return void(te=Date.now());if(Date.now()-te<1e3)return;const pt=ke.sendFrameRate,mt=ke.OutgoingAvailableBandwidth,[Xt,An]=Upe(j,pt,mt,Ne.adaptationConfig,H,Q);An&&(K.qualityLimitationReason=An),Xt&&Ne.adaptationConfig.scale!==Xt.scale&&(A.debug("[".concat(j,"] applyAdaptation: ").concat(K.qualityLimitationReason,`
           sendFps `).concat(pt,", bwe ").concat(mt,", switch from ").concat(Ne.adaptationConfig.scale," to ").concat(Xt.scale," ")),Ne.adaptationConfig=sA(sA({},Ne.adaptationConfig),Xt),ie(Xt))}},Y("CHECK_LOCAL_STATS_INTERVAL")),Se=sA({},H);FE.set(j,{timer:he,adaptationConfig:Se,originConfig:H,adaptationFunc:ie}),A.debug("[".concat(j,"] start adaptation, originConfig: ").concat(JSON.stringify(H),", degradationPreference: ").concat(Q))})(this.id+f.mid,m,this,k,j=>{i&&this.updateAdaptation(i,j)},this.getLocalVideoStats.bind(this))}if(r._encoderConfig){var _;const{bitrateMax:k,frameRate:j,scaleResolutionDownBy:H}=r._encoderConfig;k&&(h.maxBitrate=1e3*k),(Oe(_=r._hints).call(_,Yt.LOW_STREAM)||r.isUseScaleResolutionDownBy)&&(j&&(h.maxFramerate=zi(j)),H&&H>=1&&(h.scaleResolutionDownBy=H))}const{maxFramerate:S}=Y("ENCODER_CONFIG_LIMIT");if(S&&typeof S=="number"&&(h.maxFramerate=h.maxFramerate?Math.min(h.maxFramerate,S):S),Y("DSCP_TYPE")&&Js()){var w;const k=Y("DSCP_TYPE");Oe(w=["very-low","low","medium","high"]).call(w,k)&&(h.networkPriority=k)}const O=i.getParameters(),W=(c=O.encodings)===null||c===void 0?void 0:c[0];gn()&&!W&&(u.encodings=[h]),W&&Object.assign(W,h),Object.assign(O,u),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(O.encodings))),await i.setParameters(O),await async function(k,j,H){try{var K;if(!bt().supportSetRtpSenderParameters||!function(he){return he==="vp9"||he==="av1"}(k)||!Y("ENABLE_SVC"))return;const Q={},ie={},re=j.getParameters(),te=(K=re.encodings)===null||K===void 0?void 0:K[0];ie.scalabilityMode=PE(H),te&&Object.assign(te,ie),Object.assign(re,Q),await j.setParameters(re),A.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(re.encodings)))}catch(Q){A.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",Q)}}(this.store.codec,i,Y("SVC_MODE"))}async updateAdaptation(r,i){var s,c;if(!r)return A.debug("[updateAdaptation] no rtpSender found");if(!bt().supportSetRtpSenderParameters)return A.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const u={},{bitrateMax:h,frameRate:f,scaleResolutionDownBy:m}=i;h&&(u.maxBitrate=1e3*h),f&&(u.maxFramerate=zi(f)),m&&m>=1&&Oe(s=["vp8","vp9"]).call(s,this.store.codec)&&(u.scaleResolutionDownBy=m);const y=r.getParameters(),_=(c=y.encodings)===null||c===void 0?void 0:c[0];_&&Object.assign(_,u),Object.assign(y,{});try{await r.setParameters(y),A.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(y.encodings)))}catch(S){!("transport"in r)||r.transport&&r.transport.state==="connected"?this.peerConnectionState!=="connected"?A.debug("[updateAdaptation] peerConnection not connected}"):A.debug("[updateAdaptation] updateRtpSenderEncodings failed",S):A.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(r,i){try{if(!bt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let s=0;s<r.length;s++){const c=r[s],u=i[s];u instanceof tn&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,c.sender)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i,s){const c=Ai(r);return i.forEach((u,h)=>{const f=s[h],m=c.mediaDescriptions.find(y=>y.attributes.mid===f);m&&(Bh(m,u),g4(m,u,this.store.codec))}),Jc(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,r,i,s)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,r,i)},this.statsFilter.onFirstVideoDecodedTimeout=r=>{var i;(i=this.onFirstVideoDecodedTimeout)===null||i===void 0||i.call(this,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(r,i){if(r.length===i.length)for(let m=0;m<r.length;m++){var s,c,u,h,f;const y=r[m],_=i[m];if(_ instanceof tn&&!Oe(s=_._hints).call(s,Yt.LOW_STREAM)&&(c=_._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=_._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=_._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=_._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const S={},w={high:1e3*(_._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{rid:"m",active:!0,maxBitrate:w.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:w.high}];const O=y.sender.getParameters();await y.sender.setParameters(Object.assign(O,S))}}}async applySimulcastEncodings(r,i){if(!gn()&&r.length===i.length)for(let s=0;s<r.length;s++){const c=i[s];if(c instanceof tn&&this.isVP8Simulcast(c)){const u=r[s],h={},f={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const m=u.sender.getParameters();await u.sender.setParameters(Object.assign(m,h))}}}isVP8Simulcast(r){var i,s,c,u,h;return!!(r instanceof tn&&Y("SIMULCAST")&&this.store.codec==="vp8"&&!Oe(i=r._hints).call(i,Yt.LOW_STREAM)&&(s=r._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((c=r._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(u=r._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=r._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(r,i,s,c){if(Y("SDP_LOGGING"))return A.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(i," SDP during P2PConnection.").concat(c,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",s==="local"?"remote":"local",c)}:void 0}async getRemoteSSRC(r){if(!this.remoteSDP)return;const i=this.remoteSDP.getSSRC(r);return i&&i.length!==0?i[0].ssrcId:void 0}setConfiguration(r){if(bt().supportPCSetConfiguration){const i=jg.resolvePCConfiguration(r);this.peerConnection.setConfiguration(i)}}},Fe(yt.prototype,"updateRemoteRTPCapabilities",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"updateRemoteRTPCapabilities"),yt.prototype),Fe(yt.prototype,"connect",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"connect"),yt.prototype),Fe(yt.prototype,"updateRemoteConnect",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"updateRemoteConnect"),yt.prototype),Fe(yt.prototype,"createDataChannels",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"createDataChannels"),yt.prototype),Fe(yt.prototype,"receive",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"receive"),yt.prototype),Fe(yt.prototype,"batchReceive",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"batchReceive"),yt.prototype),Fe(yt.prototype,"stopReceiving",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"stopReceiving"),yt.prototype),Fe(yt.prototype,"muteRemote",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"muteRemote"),yt.prototype),Fe(yt.prototype,"unmuteRemote",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"unmuteRemote"),yt.prototype),Fe(yt.prototype,"muteLocal",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"muteLocal"),yt.prototype),Fe(yt.prototype,"unmuteLocal",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"unmuteLocal"),yt.prototype),Fe(yt.prototype,"close",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"close"),yt.prototype),Fe(yt.prototype,"updateEncoderConfig",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"updateEncoderConfig"),yt.prototype),Fe(yt.prototype,"updateSendParameters",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"updateSendParameters"),yt.prototype),Fe(yt.prototype,"replaceTrack",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"replaceTrack"),yt.prototype),Fe(yt.prototype,"updateAdaptation",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"updateAdaptation"),yt.prototype),Fe(yt.prototype,"getRemoteSSRC",[yi],Object.getOwnPropertyDescriptor(yt.prototype,"getRemoteSSRC"),yt.prototype),yt);function yi(n,r,i){const s=n[r];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const c=this.mutex,u=await c.lock("From P2PConnection.".concat(r));try{for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return await s.apply(this,f)}finally{u()}},i}function dA(n,r){let i=document.createElement("video"),s=document.createElement("canvas");i.setAttribute("style","display:none"),s.setAttribute("style","display:none"),i.setAttribute("muted",""),i.muted=!0,i.setAttribute("autoplay",""),i.autoplay=!0,i.setAttribute("playsinline",""),s.width=zi(r.width),s.height=zi(r.height);const c=zi(r.framerate||15);document.body.append(i),document.body.append(s);let u=n._mediaStreamTrack;i.srcObject=new MediaStream([u]),i.play();const h=s.getContext("2d");if(!h)throw new se($.UNEXPECTED_ERROR,"can not get canvas context");const f=bt(),m=s.captureStream(f.supportRequestFrame?0:c).getVideoTracks()[0];m.canvas||(m.canvas=s),s.startCapture=()=>{if(!i)return s.stopCapture&&s.stopCapture();if(i.paused&&i.play(),i.videoHeight>2&&i.videoWidth>2){const _=i.videoWidth,S=i.videoHeight/_,w=s.width*S;Math.abs(w-s.height)>=2&&(A.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(w)),s.height=w)}h.drawImage(i,0,0,s.width,s.height),m.requestFrame&&m.requestFrame(),u!==n._mediaStreamTrack&&(u=n._mediaStreamTrack,i.srcObject=new MediaStream([u]))},s.stopCapture=TO(()=>s.startCapture&&s.startCapture(),c);const y=m.stop;return m.stop=()=>{y.call(m),i&&(i.remove(),i.srcObject=null,i=null),s&&(s.width=0,s.remove(),s.stopCapture&&s.stopCapture(),s.startCapture=void 0,s.stopCapture=void 0,s=null),A.debug("clean low stream renderer")},m}var $E=function(n){return n[n.HEIGHT=2033]="HEIGHT",n[n.FRAME_RATE=2034]="FRAME_RATE",n[n.WIDTH=2035]="WIDTH",n}($E||{}),Ln=function(n){return n[n.FRAME_RATE=2002]="FRAME_RATE",n[n.WIDTH=2003]="WIDTH",n[n.HEIGHT=2004]="HEIGHT",n[n.PACKAGE_LOST=2005]="PACKAGE_LOST",n[n.AVG_ENCODE=2007]="AVG_ENCODE",n[n.NACKS=2009]="NACKS",n[n.PLIS=2010]="PLIS",n[n.FIRS=2011]="FIRS",n[n.BITRATE=2012]="BITRATE",n[n.PACKAGE_RATE=2031]="PACKAGE_RATE",n[n.ADAPTATION=2032]="ADAPTATION",n[n.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",n[n.BANDWIDTH=2061]="BANDWIDTH",n[n.RETRANSMIT=2062]="RETRANSMIT",n[n.TARGET_ENCODED=2064]="TARGET_ENCODED",n[n.TRANSMIT=2066]="TRANSMIT",n[n.FREEZE=2082]="FREEZE",n[n.DISABLED=2095]="DISABLED",n[n.PLAYER_STATUS=2128]="PLAYER_STATUS",n[n.QP_SUM=2143]="QP_SUM",n[n.BYTES_RETRANSMIT=2173]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2172]="PACKAGES_RETRANSMIT",n[n.HUGE_FRAME_SENT=2174]="HUGE_FRAME_SENT",n[n.KEY_FRAMES_ENCODED=2207]="KEY_FRAMES_ENCODED",n}(Ln||{}),ju=function(n){return n[n.BITRATE=2069]="BITRATE",n[n.PACKAGE_LOST=2070]="PACKAGE_LOST",n[n.PACKAGE_RATE=2071]="PACKAGE_RATE",n[n.HEIGHT=2073]="HEIGHT",n[n.FRAME_RATE=2075]="FRAME_RATE",n[n.WIDTH=2077]="WIDTH",n}(ju||{}),kn=function(n){return n[n.JITTER=-1]="JITTER",n[n.PACKAGE_LOST=2014]="PACKAGE_LOST",n[n.WIDTH=2018]="WIDTH",n[n.HEIGHT=2019]="HEIGHT",n[n.FRAME_RATE=2020]="FRAME_RATE",n[n.JITTER_BUFFER=2023]="JITTER_BUFFER",n[n.CURRENT_DELAY=2024]="CURRENT_DELAY",n[n.NACKS=2026]="NACKS",n[n.PLIS=2027]="PLIS",n[n.FIRS=2028]="FIRS",n[n.BITRATE=2029]="BITRATE",n[n.PACKAGE_RATE=2078]="PACKAGE_RATE",n[n.FREEZE=2084]="FREEZE",n[n.DISABLED=2101]="DISABLED",n[n.PLAYER_STATUS=2129]="PLAYER_STATUS",n[n.QP_SUM=2144]="QP_SUM",n[n.I_FRAME_DELAY=2149]="I_FRAME_DELAY",n[n.FRAMES_DROPPED=2181]="FRAMES_DROPPED",n[n.BYTES_RETRANSMIT=2175]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2176]="PACKAGES_RETRANSMIT",n[n.PACKAGES_DISCARDED=2198]="PACKAGES_DISCARDED",n[n.AVG_DECODE=2200]="AVG_DECODE",n[n.AVG_PROCESSING_DELAY=2202]="AVG_PROCESSING_DELAY",n[n.AVG_ASSEMBLY_TIME=2203]="AVG_ASSEMBLY_TIME",n[n.AVG_INTER_FRAME_DELAY=2204]="AVG_INTER_FRAME_DELAY",n[n.KEY_FRAMES_DECODED=2206]="KEY_FRAMES_DECODED",n}(kn||{}),Vu=function(n){return n[n.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",n[n.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",n[n.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",n[n.FREEZE_TIME=2109]="FREEZE_TIME",n[n.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",n[n.FREEZE_DURATION=2156]="FREEZE_DURATION",n}(Vu||{}),Z4=function(n){return n[n.PCM_LEVEL=2104]="PCM_LEVEL",n}(Z4||{}),Ss=function(n){return n[n.PACKAGE_LOST=-1]="PACKAGE_LOST",n[n.LEVEL=2038]="LEVEL",n[n.BITRATE=2039]="BITRATE",n[n.PACKAGE_RATE=2040]="PACKAGE_RATE",n[n.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",n[n.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",n[n.FREEZE=2081]="FREEZE",n[n.DISABLED=2096]="DISABLED",n[n.BYTES_RETRANSMIT=2179]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2180]="PACKAGES_RETRANSMIT",n}(Ss||{}),Ni=function(n){return n[n.BITRATE=2044]="BITRATE",n[n.PACKAGE_LOST=2045]="PACKAGE_LOST",n[n.PACKAGE_RATE=2046]="PACKAGE_RATE",n[n.CURRENT_DELAY=2047]="CURRENT_DELAY",n[n.JITTER_BUFFER=2054]="JITTER_BUFFER",n[n.JITTER=2055]="JITTER",n[n.FREEZE=2083]="FREEZE",n[n.DISABLED=2102]="DISABLED",n[n.PCM_LEVEL=2105]="PCM_LEVEL",n[n.PLAYER_STATUS=2130]="PLAYER_STATUS",n[n.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",n[n.BYTES_RETRANSMIT=2178]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2177]="PACKAGES_RETRANSMIT",n[n.PACKAGES_DISCARDED=2199]="PACKAGES_DISCARDED",n[n.AVG_PROCESSING_DELAY=2201]="AVG_PROCESSING_DELAY",n}(Ni||{}),e5=function(n){return n[n.FREEZE_TIME=-1]="FREEZE_TIME",n[n.LEVEL=2043]="LEVEL",n}(e5||{}),vi=function(n){return n[n.RTT=2006]="RTT",n[n.CONN_TYPE=801]="CONN_TYPE",n[n.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",n}(vi||{}),HE=function(n){return n[n.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",n}(HE||{});const zE=1e3,Fpe=Math.max(6,3);function Je(n,r,i){i!=null&&Number.isFinite(i)&&(n[r]=Math.round(Math.max(0,i)))}function t5(n){const r={[vi.CONN_TYPE]:0,[vi.RTT]:n.rtt,[vi.STATS_UPDATE_INTERVAL]:n.updateInterval?Math.round(Math.max(0,n.updateInterval)):void 0};switch(n.selectedCandidatePair.localCandidate.candidateType){case"relay":{const i=n.selectedCandidatePair.localCandidate.relayProtocol;i==="udp"&&(r[vi.CONN_TYPE]=1),i==="tcp"&&(r[vi.CONN_TYPE]=3),i==="tls"&&(r[vi.CONN_TYPE]=4);break}case"srflx":r[vi.CONN_TYPE]=2;break;case"unknown":r[vi.CONN_TYPE]=5;break;default:r[vi.CONN_TYPE]=0}return r}function n5(n){let r=0;switch(n){case"none":r=0;break;case"cpu":r=1;break;case"bandwidth":r=2;break;case"other":r=3}return r}class r5 extends ln{constructor(r){super(),F(this,"store",void 0),F(this,"uploadWRTCStatsTimer",void 0),F(this,"uploadOutboundDenoiserStatsTimer",void 0),F(this,"uploadExtStatsTimer",void 0),F(this,"uploadExtUsageStatsTimer",void 0),F(this,"uploadInboundExtStatsTimer",void 0),F(this,"requestStats",void 0),F(this,"requestTransportStats",void 0),F(this,"requestLocalMedia",void 0),F(this,"requestRemoteMedia",void 0),F(this,"requestAllTracks",void 0),F(this,"requestVideoIsReady",void 0),F(this,"requestUploadStats",void 0),F(this,"requestUpload",void 0),F(this,"uploadOutboundStarted",!1),F(this,"uploadInboundStarted",!1),F(this,"uploadTransportStarted",!1),F(this,"uploadBaseStatsStarted",!1),F(this,"uploadExtensionUsageStarted",!1),F(this,"lastRecvStats",void 0),F(this,"lastSendStats",void 0),F(this,"lastRefRecvStats",void 0),F(this,"lastRefSendStats",void 0),F(this,"lastFullRecvStats",void 0),F(this,"lastFullSendStats",void 0),F(this,"needUploadRenderFreezeTime",!0),this.store=r}uploadWRTCStats(r){if(!this.requestStats||!this.requestUploadStats)return;const i=r%3==0,s=r%6==0;let c,u;if(this.uploadTransportStarted&&(c=this.requestStats(),this.store.useP2P&&(u=this.requestStats(!0))),!c&&this.uploadOutboundStarted&&(c=this.requestStats()),!u&&this.uploadInboundStarted&&(u=this.requestStats(!0)),c||u){var h;const f={};if(this.uploadTransportStarted&&c){const y=this.getTransportStats(c,u,i);y&&(f.misc=[y])}if(this.uploadOutboundStarted&&c){const y=this.getOutboundStats(c,s?this.lastFullSendStats:i?this.lastRefSendStats:this.lastSendStats,i,s);y&&(f.outbound=[y])}if(this.uploadInboundStarted&&u){const y=this.getInboundStats(u,s?this.lastFullRecvStats:i?this.lastRefRecvStats:this.lastRecvStats,i,s);y&&(f.inbound=y)}const m=(h=this.requestTransportStats)===null||h===void 0?void 0:h.call(this).connectState;m&&(Array.isArray(f.misc)?f.misc[0]&&f.misc[0].addition&&(f.misc[0].addition[HE.RTC_PEER_CONNECTION_STATE]=cO[m]):f.misc=[{addition:{[HE.RTC_PEER_CONNECTION_STATE]:cO[m]}}]),this.requestUploadStats(f)}this.lastRecvStats=u,this.lastSendStats=c,s&&(this.lastFullRecvStats=u,this.lastFullSendStats=c),i&&(this.lastRefRecvStats=u,this.lastRefSendStats=c)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let r=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var i,s;const c=(i=this.requestTransportStats)===null||i===void 0?void 0:i.call(this);return void(c&&((s=this.requestUploadStats)===null||s===void 0||s.call(this,{misc:[{addition:{[HE.RTC_PEER_CONNECTION_STATE]:cO[c.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(r),++r===Fpe+1&&(r=1)},zE)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(r,i,s){if(!this.requestStats)return;if(!s)return r.rtt==null?void 0:{addition:{[vi.RTT]:r.rtt,[vi.CONN_TYPE]:void 0,[vi.STATS_UPDATE_INTERVAL]:r.updateInterval||void 0}};const c=t5(r);if(this.store.useP2P){if(i){const u=t5(i);c[vi.CONN_TYPE]+=u[vi.CONN_TYPE]<<3}c[vi.CONN_TYPE]+=110}else c[vi.CONN_TYPE]+=100;return{addition:c}}getOutboundStats(r,i,s,c){if(!this.requestUploadStats||!this.requestLocalMedia)return;const u=this.requestLocalMedia();if(!u||u.length===0)return;let h,f,m;return u.forEach(y=>{let[_,{track:S,ssrcs:w}]=y;switch(_){case Ee.LocalVideoLowTrack:case Ee.LocalVideoTrack:if(_===Ee.LocalVideoTrack){const O=function(j,H,K,Q,ie,re){const te=H.videoSend.find(ke=>ke.ssrc===j);if(!te)return;const he={},{sentFrame:Se,inputFrame:Ne}=te;if(re&&(Je(he,Ln.QP_SUM,te.qpSumPerFrame),Ne&&Se)){const ke=Ne.frameRate,pt=Se.frameRate;he[Ln.FREEZE]=function(mt,Xt){let An=!0;return An=!(mt<=5)&&(mt<=10?Xt<3:mt<=20?Xt<4:Xt<5),An}(ke,pt)?1:0}if(ie){switch(Se&&(Je(he,Ln.HEIGHT,Se.height),Je(he,Ln.WIDTH,Se.width),Je(he,Ln.FRAME_RATE,Se.frameRate)),he[Ln.DISABLED]=Q._originMediaStreamTrack&&!Q._originMediaStreamTrack.enabled||Q._mediaStreamTrack&&!Q._mediaStreamTrack.enabled?1:0,te.adaptionChangeReason){case"none":he[Ln.ADAPTATION]=0;break;case"cpu":he[Ln.ADAPTATION]=1;break;case"bandwidth":he[Ln.ADAPTATION]=2;break;case"other":he[Ln.ADAPTATION]=3}let ke=0;te.adaptionChangeReason&&(ke+=n5(te.adaptionChangeReason)),H.qualityLimitationReason&&(ke+=n5(H.qualityLimitationReason)<<3),he[Ln.ADAPTATION]=ke,he[Ln.PLAYER_STATUS]=SO[Q._player?Q._player.videoElementStatus:"uninit"],Je(he,Ln.NACKS,te.nacksCount),Je(he,Ln.PLIS,te.plisCount),Je(he,Ln.FIRS,te.firsCount),Je(he,Ln.AVG_ENCODE,te.avgEncodeMs),Je(he,Ln.HUGE_FRAME_SENT,te.hugeFramesSent),Je(he,Ln.BYTES_RETRANSMIT,te.retransmittedBytesSent),Je(he,Ln.PACKAGES_RETRANSMIT,te.retransmittedPacketsSent),Je(he,Ln.KEY_FRAMES_ENCODED,te.keyFramesEncoded);const pt=K&&K.videoSend.find(mt=>mt.ssrc===j);if(pt){let mt=ie?zE:6e3;pt.timestamp&&te.timestamp&&(mt=te.timestamp-pt.timestamp),pt.packets!=null&&te.packets!=null&&Je(he,Ln.PACKAGE_RATE,1e3*(te.packets-pt.packets)/mt),te.packetsLost!=null&&pt.packetsLost!=null&&Je(he,Ln.PACKAGE_LOST,te.packetsLost-pt.packetsLost),pt.bytes!=null&&te.bytes!=null&&Je(he,Ln.BITRATE,8*(te.bytes-pt.bytes)/mt)}}return he}(w[0].ssrcId,r,i,S,s,c),W=S&&function(j,H,K,Q){const ie=H.videoSend.find(te=>te.ssrc===j);if(!ie)return null;const re={};if(Q){const te=ie.inputFrame,he=te&&te.height||K.videoHeight||0,Se=te&&te.width||K.videoWidth||0,Ne=te&&te.frameRate||0;Je(re,$E.HEIGHT,he),Je(re,$E.WIDTH,Se),Je(re,$E.FRAME_RATE,Ne)}return re}(w[0].ssrcId,r,S,s),k=function(j,H){const K={};return H&&(Je(K,Ln.RETRANSMIT,j.bitrate.retransmit),Je(K,Ln.TARGET_ENCODED,j.bitrate.targetEncoded),Je(K,Ln.ACTUAL_ENCODED,j.bitrate.actualEncoded),Je(K,Ln.TRANSMIT,j.bitrate.transmit),Je(K,Ln.BANDWIDTH,j.sendBandwidth)),K}(r,s);f=Object.assign({},O,W,k)}else m=function(O,W,k,j){const H=W.videoSend.find(Q=>Q.ssrc===O);if(!H)return;const K={};if(j){const Q=H.sentFrame;if(Q&&(Je(K,ju.HEIGHT,Q.height),Je(K,ju.WIDTH,Q.width),Je(K,ju.FRAME_RATE,Q.frameRate)),k){const ie=k.videoSend.find(re=>re.ssrc===O);if(ie){let re=6e3;ie.timestamp&&H.timestamp&&(re=H.timestamp-ie.timestamp),ie.packets!=null&&H.packets!=null&&Je(K,ju.PACKAGE_RATE,1e3*(H.packets-ie.packets)/re),H.packetsLost!=null&&ie.packetsLost!=null&&Je(K,ju.PACKAGE_LOST,H.packetsLost-ie.packetsLost),ie.bytes!=null&&H.bytes!=null&&Je(K,ju.BITRATE,8*(H.bytes-ie.bytes)/re)}}}return K}(w[0].ssrcId,r,i,s);break;case Ee.LocalAudioTrack:h=S&&function(O,W,k,j,H){const K=W.audioSend.find(ie=>ie.ssrc===O);if(!K)return;const Q={};if(H){Q[Ss.DISABLED]=j._originMediaStreamTrack&&!j._originMediaStreamTrack.enabled||j._mediaStreamTrack&&!j._mediaStreamTrack.enabled?1:0;const ie=100*j._source.getAccurateVolumeLevel(),re=K.inputLevel;if(re!=null){const he=Math.ceil(50*Math.log10(100*re+1));Je(Q,Ss.LEVEL,he)}Je(Q,Z4.PCM_LEVEL,ie),Je(Q,Ss.AEC_RETURN_LOSS,K.aecReturnLoss),Je(Q,Ss.AEC_RETURN_LOSS_ENH,K.aecReturnLossEnhancement),Je(Q,Ss.BYTES_RETRANSMIT,K.retransmittedBytesSent),Je(Q,Ss.PACKAGES_RETRANSMIT,K.retransmittedPacketsSent),Q[Ss.FREEZE]=0;const te=k&&k.audioSend.find(he=>he.ssrc===O);if(te){let he=6e3;te.timestamp&&K.timestamp&&(he=K.timestamp-te.timestamp),te.bytes!=null&&K.bytes!=null&&Je(Q,Ss.BITRATE,8*(K.bytes-te.bytes)/he),te.packets!=null&&K.packets!=null&&Je(Q,Ss.PACKAGE_RATE,1e3*(K.packets-te.packets)/he)}}return Q}(w[0].ssrcId,r,i,S,s)}}),{high:f,low:m,audio:h}}getInboundStats(r,i,s,c){if(!this.requestRemoteMedia)return;const u=this.requestRemoteMedia()||[],h=[];return u.forEach(f=>{let[m,y]=f;const _={peer:m.uid};if(y.has(Ue.VIDEO)&&m.videoTrack){const S=m._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(m._videoSSRC)||!1,w=m.videoTrack?function(O,W,k,j,H,K,Q,ie){const re=W.videoRecv.find(mt=>mt.ssrc===O);if(!re)return;const te={},{receivedFrame:he,outputFrame:Se,decodeFrameRate:Ne}=re,ke=k&&k.videoRecv.find(mt=>mt.ssrc===O);if(Je(te,Vu.FRAME_RATE_DECODE,Ne),re.framesRateFirefox&&Je(te,kn.FRAME_RATE,re.framesRateFirefox),he&&Je(te,kn.FRAME_RATE,he.frameRate),Je(te,kn.FRAMES_DROPPED,re.framesDroppedCount),Je(te,kn.BYTES_RETRANSMIT,re.retransmittedBytesReceived),Je(te,kn.PACKAGES_RETRANSMIT,re.retransmittedPacketsReceived),Je(te,kn.PACKAGES_DISCARDED,re.packetsDiscarded),Je(te,kn.AVG_DECODE,re.avgDecodeMs),Je(te,kn.AVG_PROCESSING_DELAY,re.avgProcessingDelayMs),Je(te,kn.AVG_ASSEMBLY_TIME,re.avgFramesAssembledFromMultiplePacketsMs),Je(te,kn.AVG_INTER_FRAME_DELAY,re.avgInterFrameDelayMs),Je(te,kn.KEY_FRAMES_DECODED,re.keyFramesDecoded),ke){const mt=W.timestamp-k.timestamp||zE*(ie?6:Q?3:1);re.packetsLost!=null&&ke.packetsLost!=null&&Je(te,kn.PACKAGE_LOST,re.packetsLost-ke.packetsLost),ke.bytes!=null&&re.bytes!=null&&Je(te,kn.BITRATE,8*(re.bytes-ke.bytes)/mt),ke.packets!=null&&re.packets!=null&&Je(te,kn.PACKAGE_RATE,1e3*(re.packets-ke.packets)/mt)}if(ie&&(Je(te,kn.QP_SUM,re.qpSumPerFrame),te[kn.FREEZE]=H&&jm.isRemoteVideoFreeze(j,re,ke)?1:0),Q){var pt;he?(Je(te,kn.HEIGHT,he.height),Je(te,kn.WIDTH,he.width)):j&&(Je(te,kn.HEIGHT,j._videoHeight||0),Je(te,kn.WIDTH,j._videoWidth||0)),Se&&Je(te,Vu.FRAME_RATE_OUTPUT,Se.frameRate);const mt=(pt=j._player)===null||pt===void 0?void 0:pt.rendFrameRate.toFixed(0);if(mt&&Je(te,Vu.FRAME_RATE_RENDER,+mt),Je(te,kn.JITTER_BUFFER,re.jitterBufferMs),Je(te,kn.CURRENT_DELAY,re.currentDelayMs),Je(te,kn.FIRS,re.firsCount),Je(te,kn.NACKS,re.nacksCount),Je(te,kn.PLIS,re.plisCount),j){te[kn.DISABLED]=j._originMediaStreamTrack.enabled&&j._mediaStreamTrack.enabled?0:1;const Xt=j._player;if(Xt){const{freezeTimeCounterList:An,renderFreezeAccTime:_n,videoElementStatus:Ei}=Xt;if(An&&An.length>0&&Je(te,Vu.FREEZE_TIME,An.splice(0,1)[0]),K&&ec.visibility==="visible"&&Ei===zr.PLAYING&&bt().supportRequestVideoFrameCallback){const pe=Math.min(6e3,_n);Xt.renderFreezeAccTime=Math.max(0,_n-pe),Je(te,Vu.FREEZE_TIME_RENDER,pe)}if(typeof re.totalFreezesDuration=="number"){const pe=ke&&ke.totalFreezesDuration?re.totalFreezesDuration-ke.totalFreezesDuration:re.totalFreezesDuration;Je(te,Vu.FREEZE_DURATION,1e3*pe)}}}if(te[kn.PLAYER_STATUS]=SO[j._player?j._player.videoElementStatus:"uninit"],ke&&re.totalInterFrameDelay!==void 0&&re.totalSquaredInterFrameDelay!==void 0&&ke.totalInterFrameDelay!==void 0&&ke.totalSquaredInterFrameDelay!==void 0){const Xt=re.totalInterFrameDelay-ke.totalInterFrameDelay,An=re.totalSquaredInterFrameDelay-ke.totalSquaredInterFrameDelay,_n=re.framesDecodeCount-ke.framesDecodeCount,Ei=Xt/_n*1e3,pe=Math.round(1e3*Math.sqrt((An-Math.pow(Xt,2)/_n)/_n));!isNaN(pe)&&Ei+pe>Math.max(3*Ei,Ei+150)&&(te[kn.I_FRAME_DELAY]=pe)}}return te}(m._videoSSRC,r,i,m.videoTrack,S===!0,this.needUploadRenderFreezeTime,s,c):void 0;w&&(_.video=w)}if(y.has(Ue.AUDIO)&&m.audioTrack){const S=m.audioTrack?function(w,O,W,k,j,H){const K=O.audioRecv.find(te=>te.ssrc===w);if(!K)return;const Q={},ie=W&&W.audioRecv.find(te=>te.ssrc===w);if(Je(Q,Ni.JITTER,K.jitterMs),Je(Q,Ni.BYTES_RETRANSMIT,K.retransmittedBytesReceived),Je(Q,Ni.PACKAGES_RETRANSMIT,K.retransmittedPacketsReceived),Je(Q,Ni.PACKAGES_DISCARDED,K.packetsDiscarded),Je(Q,Ni.AVG_PROCESSING_DELAY,K.avgProcessingDelayMs),ie){const te=O.timestamp-W.timestamp||zE*(H?6:j?3:1);K.packets!=null&&ie.packets!=null&&Je(Q,Ni.PACKAGE_RATE,1e3*(K.packets-ie.packets)/te),j&&ie.bytes!=null&&K.bytes!=null&&Je(Q,Ni.BITRATE,8*(K.bytes-ie.bytes)/te),K.packetsLost!=null&&ie.packetsLost!=null&&Je(Q,Ni.PACKAGE_LOST,K.packetsLost-ie.packetsLost)}if(H){const{receivedFrames:te,droppedFrames:he}=K;te!=null&&he!=null&&(Q[Ni.FREEZE]=(re=te)===0||100*he/re>20?1:0)}var re;if(j){const te=100*k._source.getAccurateVolumeLevel(),he=K.outputLevel;if(he!=null){const Se=Math.ceil(50*Math.log10(100*he+1));Je(Q,e5.LEVEL,Se)}if(Je(Q,Ni.PCM_LEVEL,te),k&&(Q[Ni.DISABLED]=k._originMediaStreamTrack.enabled&&k._mediaStreamTrack.enabled?0:1),Je(Q,Ni.JITTER_BUFFER,K.jitterBufferMs),Je(Q,Ni.CURRENT_DELAY,K.jitterBufferMs),Q[Ni.PLAYER_STATUS]=SO[gi.getPlayerState(k.getTrackId())],ie){const Se=K.concealedSamples-ie.concealedSamples;Se>0&&Je(Q,Ni.CONCEALED_SAMPLES,Se)}}return Q}(m._audioSSRC,r,i,m.audioTrack,s,c):void 0;S&&(_.audio=S)}(_.video||_.audio)&&h.push(_)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,h}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const r=(this.requestAllTracks()||[]).find(i=>i instanceof mE);if(r&&r._external.getDenoiserStats){const i=r._external.getDenoiserStats();i&&this.requestUpload(Im.DENOISER_STATS,i)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(r=>{r.getProcessorStats().forEach(i=>{this.requestUpload&&this.requestUpload(i.type,i.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(r=>{let[i,s]=r;s.has(Ue.VIDEO)&&i.videoTrack&&i.videoTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)}),s.has(Ue.AUDIO)&&i.audioTrack&&i.audioTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const r=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const i=Date.now(),s={connectionInterval:Y("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:i};let c=[];const u=this.requestAllTracks&&this.requestAllTracks()||[];for(const y of u)!y.muted&&y.enabled&&(c=c.concat(await y.getProcessorUsage()));const h=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[y,_]of h)_.has(Ue.VIDEO)&&y.videoTrack&&(c=c.concat(await y.videoTrack.getProcessorUsage())),_.has(Ue.AUDIO)&&y.audioTrack&&(c=c.concat(await y.audioTrack.getProcessorUsage()));if(c.length===0)return;s.details=function(y,_){const S={};for(const{id:k,value:j,level:H,direction:K}of y){var w;const Q=(w=_.get(k))!==null&&w!==void 0?w:0,ie=j===2?Q+Y("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Q;var O,W;_.set(k,ie),S[k]?(j===2&&(S[k].value=j),H>S[k].level&&(S[k].level=H),K==="remote"&&(S[k].remoteUidCount+=1),S[k].totalTs=(O=_.get(k))!==null&&O!==void 0?O:0):S[k]={value:j,level:H,remoteUidCount:K==="local"?0:1,totalTs:(W=_.get(k))!==null&&W!==void 0?W:0}}return Object.keys(S).map(k=>{const{level:j,value:H,totalTs:K}=S[k];return{id:k,level:j,value:H,totalTs:K}})}(c,r);const f=Date.now(),m=f>i?f:i+1;this.requestUpload&&this.requestUpload(Im.EXTENSION_USAGE_STATS,{usageStats:s,sendTs:m})},Y("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const Wpe=Y("ICE_RESTART_INTERVAL");let KE=new Map,Hh=new Map,il=[Fr.UDP_TCP_RELAY,Fr.TCP_RELAY,Fr.RELAY],hA=Y("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&bt().supportPCSetConfiguration;function i5(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=KE.get(n.id);i&&(window.clearTimeout(i),KE.delete(n.id));const s=Hh.get(n.id);r&&s&&s.index===il.length-1&&(A.debug("[".concat(n.id,"] reset ICE restart policy")),Hh.delete(n.id))}function a5(n,r,i){if(KE.size===0&&Hh.size===0&&(Array.isArray(Y("RESTART_SEQUENCE"))&&Y("RESTART_SEQUENCE").length>0&&!function(f,m){if(f.length!==m.length)return!1;for(let y=0;y<f.length;y+=1){const _=f[y];if(f.filter(S=>S===_).length!==m.filter(S=>S===_).length)return!1}return!0}(il,Y("RESTART_SEQUENCE"))&&(il=Y("RESTART_SEQUENCE").filter(f=>{var m;if(Oe(m=Object.values(Fr)).call(m,f))return!0}),A.debug("use reconnection policy from config distribution, queues: ".concat(il.join(" => ")))),hA=Y("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&bt().supportPCSetConfiguration),il.length===0)return void i();let s,{index:c=0,type:u}=Hh.get(n.id)||{};if(hA&&u===Fr.RELAY)return void i();let h=u&&c>=il.length-1;if(hA)u=Fr.RELAY;else{if(h)return void i();u?(c++,u=il[c]):(u=il[0],c=0)}A.debug("[".concat(n.id,"] choose ICE restart policy: ").concat(u,", index: ").concat(c)),r(u),Hh.set(n.id,{index:c,type:u}),s=window.setTimeout(()=>a5(n,r,i),Wpe),KE.set(n.id,s)}var ut;function o5(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function bs(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?o5(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):o5(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}function s5(n){var r,i,s,c=2;for(typeof Symbol<"u"&&(i=j0,s=Symbol.iterator);c--;){if(i&&(r=n[i])!=null)return r.call(n);if(s&&(r=n[s])!=null)return new qE(r.call(n));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function qE(n){function r(i){if(Object(i)!==i)return Ie.reject(new TypeError(i+" is not an object."));var s=i.done;return Ie.resolve(i.value).then(function(c){return{value:c,done:s}})}return qE=function(i){this.s=i,this.n=i.next},qE.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(i){var s=this.s.return;return s===void 0?Ie.resolve({value:i,done:!0}):r(s.apply(this.s,arguments))},throw:function(i){var s=this.s.return;return s===void 0?Ie.reject(i):r(s.apply(this.s,arguments))}},new qE(n)}let Bm=(ut=class extends ln{get state(){return this._state}set state(n){const r=this._state;this._state=n,this.emit(Ke.StateChange,r,this._state)}constructor(n,r){super(),F(this,"isPlanB",void 0),F(this,"store",void 0),F(this,"statsUploader",void 0),F(this,"connection",void 0),F(this,"localTrackMap",new Map),F(this,"remoteUserMap",new Map),F(this,"localDataChannels",[]),F(this,"remoteDataChannelMap",new Map),F(this,"pendingLocalTracks",[]),F(this,"pendingRemoteTracks",[]),F(this,"pendingLocalDataChannels",[]),F(this,"pendingRemoteDataChannels",[]),F(this,"statsCollector",void 0),F(this,"shouldForwardP2PCreation",void 0),F(this,"iceFailedCount",0),F(this,"dtlsFailedCount",0),F(this,"mutex",void 0),F(this,"_state",xt.Disconnected),F(this,"_pcStatsUploadType",Y("NEW_ICE_RESTART")?rc.FIRST_CONNECTION:rc.OLD_FIRST_CONNECTION),F(this,"_isStartRestartIce",!1),F(this,"_restartTimer",void 0),F(this,"_isTryConnecting",!1),F(this,"_iceError",null),F(this,"_forceTurn",!1),F(this,"_isWaitPcToRePub",!1),F(this,"handleMuteLocalTrack",async(i,s,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==xt.Connected)return void c(new de($.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const h=this.filterTobeMutedTracks(i);if(h.length===0)return void s();const f=h.find(y=>y[0]==="videoLowTrack");f&&f[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(h.map(y=>{let[,{id:_}]=y;return _}));const m=this.createMuteMessage(h);await Kt(this,Ke.RequestMuteLocal,m),s()}catch(h){c(h)}finally{u()}}),F(this,"handleUnmuteLocalTrack",async(i,s,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==xt.Connected)return void c(new de($.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const h=this.filterTobeUnmutedTracks(i);if(h.length===0)return void s();const f=h.find(y=>y[0]==="videoLowTrack");if(f){const y=f[1];if(y.track._originMediaStreamTrack.stop(),!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding){const _=i._mediaStreamTrack.clone();y.track._mediaStreamTrack=_,y.track._originMediaStreamTrack=_}else{const _=dA(i,bm(this,Ke.RequestLowStreamParameter));y.track._mediaStreamTrack=_,y.track._originMediaStreamTrack=_}await new Ie((_,S)=>{this.handleReplaceTrack(y.track,_,S,!0)})}await this.connection.unmuteLocal(h.map(y=>{let[,{id:_}]=y;return _}));const m=this.createUnmuteMessage(h);await Kt(this,Ke.RequestUnmuteLocal,m),s()}catch(h){c(h)}finally{u()}}),F(this,"handleUpdateVideoEncoder",async(i,s,c,u)=>{let h;u||(h=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const m=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.connection||!m||m.track!==i||this.state!==xt.Connected)return void s();const{id:y,track:_}=m;await this.connection.updateSendParameters(y,_),await this.connection.updateEncoderConfig(y,_),this.emit(Ke.UpdateVideoEncoder,_),s()}catch(m){c(m)}finally{var f;(f=h)===null||f===void 0||f()}}),F(this,"handleUpdateVideoSendParameters",async(i,s,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const h=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.connection||!h||h.track!==i||this.state!==xt.Connected)return void s();const{id:f,track:m}=h;await this.connection.updateSendParameters(f,m),s()}catch(h){c(h)}finally{u()}}),F(this,"handleReplaceMixingTrack",async(i,s,c,u)=>{if(!this.connection||this.state!==xt.Connected)return void s();const h=lA([i]);let f;A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(h.getTrackId(),"]")),typeof u=="boolean"&&u||(f=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(i,h),s()}catch(y){c(y)}finally{var m;(m=f)===null||m===void 0||m()}}),F(this,"handleReplaceTrack",async(i,s,c,u)=>{let h;A.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(i.getTrackId(),"]")),typeof u=="boolean"&&u||(h=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var f;const y=Array.from(this.localTrackMap.entries()).find(_=>{let[,{track:S}]=_;return i===S});if(!this.connection||!y||this.state!==xt.Connected)return void s();if(await((f=this.connection)===null||f===void 0?void 0:f.replaceTrack(i,y[1].id)),this.isPlanB){const _=y[1];_.id=i._mediaStreamTrack.id,this.localTrackMap.set(y[0],_)}if(y[0]===Ee.LocalVideoTrack&&!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding){const _=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(_){const S=i._mediaStreamTrack.clone();_.track._originMediaStreamTrack.stop(),_.track._mediaStreamTrack=S,_.track._originMediaStreamTrack=S,await new Ie((w,O)=>{this.handleReplaceTrack(_.track,w,O,!0)})}}s()}catch(y){c(y)}finally{var m;(m=h)===null||m===void 0||m()}}),F(this,"handleGetRTCStats",i=>{i(this.statsCollector.getRTCStats())}),F(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),F(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),F(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),F(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=n,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new r5(this.store),this.bindStatsUploaderEvents(),this.mutex=new Lr("P2PChannel-mutex",this.store.clientId),this.isPlanB=!bt().supportUnifiedPlan||Y("CHROME_FORCE_PLAN_B")&&Js(),this.shouldForwardP2PCreation=Y("FORWARD_P2P_CREATION")&&bt().supportPCSetConfiguration&&Y0(),this.shouldForwardP2PCreation&&(this.connection=GE(this.store),this.emit(Ke.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(n){var r;this.state=xt.New,this._forceTurn=J4(n),A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const i=this.shouldForwardP2PCreation&&((r=this.connection)===null||r===void 0?void 0:r.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!i||(i&&this.connection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=GE(this.store,n),this.emit(Ke.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new de($.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Y("NEW_ICE_RESTART")?rc.FIRST_CONNECTION:rc.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(n),this.connection.establishPromise}async connect(n){if(!this.connection)throw new de($.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");Y("ENABLE_PREALLOC_PC")&&this.state===xt.Connected?await this.connection.updateRemoteConnect(n):(this.store.peerConnectionStart(),await this.connection.connect(n),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=xt.Connected)}updateRemoteRTPCapabilities(n){const r=Array.from(this.localTrackMap.entries()).filter(c=>{var u;let[h]=c;return Oe(u=[Ee.LocalVideoLowTrack,Ee.LocalVideoTrack]).call(u,h)}),i=r.map(c=>{let[,{id:u}]=c;return u}),s=r.map(c=>{let[u]=c;return u});if(this.connection instanceof oc){if($e.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(s),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(n)}),!Oe(n).call(n,this.store.codec)){const c=["vp9","vp8","h264"].find(u=>Oe(n).call(n,u));c&&(this.store.codec=c,A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(c,".")))}this.connection.updateRemoteRTPCapabilities(i,n)}}async getEstablishParams(){var n;if(this.connection instanceof oc&&this.connection.peerConnectionState!=="closed"&&Oe(n=[xt.New,xt.Connected]).call(n,this.state))return this.connection.establishPromise}async publishDataChannel(n){if(!this.connection||this.state!==xt.Connected){if(this.state===xt.Disconnected)throw new de($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return n.forEach(i=>{var s;Oe(s=this.pendingLocalDataChannels).call(s,i)||this.pendingLocalDataChannels.push(i)}),[]}const r=this.filterTobePublishedDataChannels(n);return r.length===0?[]:(r.forEach(i=>{const s=Date.now();this.store.publish(i.id.toString(),"datachannel",s)}),await this.connection.createDataChannels(this.store.uid,r),r.forEach(i=>{this.localDataChannels.push(i);const s=Date.now();this.store.publish(i.id+"","datachannel",void 0,s)}),n.map(i=>({streamId:i.id,ordered:i.ordered,maxRetransmits:i.maxRetransmits,metadata:i.metadata,channelId:i._originDataChannelId})))}publish(n,r,i){var s=this;return wa(function*(){const c=yield vt(s.mutex.lock("From P2PChannel.publish"));try{var u;const h=s.connection&&Oe(u=["disconnected","failed"]).call(u,s.connection.peerConnectionState);if(!s.connection||s.state!==xt.Connected||h){if(s.state===xt.Disconnected)throw new de($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");s.throwIfTrackTypeNotMatch(n);const m=n.filter(y=>s.pendingLocalTracks.indexOf(y)===-1);return s.pendingLocalTracks=s.pendingLocalTracks.concat(m),void(h&&(s._isWaitPcToRePub=!0))}s.store.pubId=s.store.pubId+1,Mr.markPublishStart(s.store.clientId,s.store.pubId);const f=s.filterTobePublishedTracks(n,r,i);if(f.length===0)return void(yield vt(s.tryToUnmuteAudio(n)));yield*W_(s5(s.doPublish(s.connection,f)))}finally{c()}})()}doPublish(n,r){var i=this;return wa(function*(){r.forEach(w=>{let{track:O,type:W}=w;const k=Date.now();i.store.publish(O.getTrackId(),W===Ee.LocalAudioTrack?"audio":"video",k)}),i.bindLocalTrackEvents(r);const s=r.map(w=>{let{track:O}=w;return O}),c=yield vt(n.send(s,i.store.codec,i.store.audioCodec)),u=(yield vt(c.next())).value,h=i.createGatewayPublishMessage(r,u);let f;try{f=yield h}catch(w){throw c.throw(w),(w==null?void 0:w.code)===$.WS_ABORT&&r.forEach(O=>{let{track:W}=O;i.pendingLocalTracks.indexOf(W)===-1&&i.pendingLocalTracks.push(W)}),i.unbindLocalTrackEvents(r),w}const m=i.mapPubResToRemoteConfig(h,f,s),y=(yield vt(c.next(m))).value;if(i.state===xt.Disconnected)throw new de($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");Y("ENABLE_VIDEO_SEI");const _=Y("ENABLE_ENCODED_TRANSFORM"),S=Y("ENABLE_AUDIO_METADATA");s.forEach(async w=>{const O=w.getRTCRtpTransceiver();O&&_&&(w.trackMediaType===Ue.VIDEO?await kfe(O.sender,w):w.trackMediaType===Ue.AUDIO&&await Ofe(O.sender,{metadata:S?()=>{const W=w.metadata.shift();return W&&W.value}:void 0}))}),r.forEach(w=>{let{type:O}=w;i.statsCollector.addLocalStats(O)}),i.assignLocalTracks(r,y),i.statsUploader.startUploadOutboundStats(),r.forEach(w=>{let{track:O,type:W}=w;const k=Date.now();i.store.publish(O.getTrackId(),W===Ee.LocalAudioTrack?"audio":"video",void 0,k)})})()}async updateVideoStreamParameter(n,r){const i=this.localTrackMap.get(r);if(!i||!this.connection)return;if(!(i.track instanceof tn))return A.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:s}=i,c=function(u,h){const f={};return u.height&&u.width&&(f.scaleResolutionDownBy=KO(u,h)),f.maxFramerate=u.framerate?zi(u.framerate):void 0,f.maxBitrate=u.bitrate?1e3*u.bitrate:void 0,f}(n,s);if(s._encoderConfig||(s._encoderConfig={}),r!==Ee.LocalVideoLowTrack||!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding)c.scaleResolutionDownBy!=null&&(s._encoderConfig.scaleResolutionDownBy=c.scaleResolutionDownBy);else{const u=s._originMediaStreamTrack;if(!u.canvas)return A.warn("[".concat(s.getTrackId(),"] no canvas on track"));(function(h,f){const m=h.canvas;f.width&&(m.width=zi(f.width)),f.height&&(m.height=zi(f.height)),f.framerate&&(m.stopCapture&&m.stopCapture(),m.stopCapture=TO(()=>{!m.startCapture&&m.stopCapture&&m.stopCapture(),m.startCapture&&m.startCapture()},zi(f.framerate)))})(u,n)}c.maxBitrate!=null&&(s._encoderConfig.bitrateMax=c.maxBitrate/1e3),c.maxFramerate!=null&&(s._encoderConfig.frameRate&&typeof s._encoderConfig.frameRate=="object"?s._encoderConfig.frameRate.max=c.maxFramerate:s._encoderConfig.frameRate={max:c.maxFramerate}),A.debug("[".concat(s.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(s._encoderConfig))),await this.connection.updateRtpSenderEncodings(s)}publishLowStream(n){var r=this;return wa(function*(){if(!r.connection||r.state!==xt.Connected)return;const i=yield vt(r.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const c=r.localTrackMap.get(Ee.LocalVideoTrack);if(!c)throw new de($.UNEXPECTED_ERROR,"Could not find high stream");if(r.localTrackMap.has(Ee.LocalVideoLowTrack))throw new de($.UNEXPECTED_ERROR,"[".concat(r.store.clientId,"] Can't publish low stream when stream already publish"));const u=[{track:r.getLowVideoTrack(c.track,n),type:Ee.LocalVideoLowTrack}];if(yield*W_(s5(r.doPublish(r.connection,u))),c.track.muted||!c.track.enabled){var s;const h=(s=r.localTrackMap.get(Ee.LocalVideoLowTrack))===null||s===void 0?void 0:s.id;h!==void 0&&(yield vt(r.connection.muteLocal([h])))}}finally{i()}})()}async republish(){this.pendingLocalTracks.length>0&&(A.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Or(this,Ke.RequestRePublish,this.pendingLocalTracks),this.emit(Ke.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(A.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Or(this,Ke.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(n){for(let r=this.pendingRemoteTracks.length-1;r>=0;r--){const{user:i,kind:s}=this.pendingRemoteTracks[r];(s!==Ue.AUDIO||i._audio_added_&&i._audioSSRC)&&(s!==Ue.VIDEO||i._video_added_&&i._videoSSRC)||this.pendingRemoteTracks.splice(r,1)}if(n)await Or(this,Ke.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:r,kind:i}of this.pendingRemoteTracks)await this.subscribe(r,i,i===Ue.VIDEO?r._videoSSRC:r._audioSSRC);this.pendingRemoteTracks.forEach(r=>{let{user:i}=r;this.emit(Ke.MediaReconnectEnd,i.uid)}),this.pendingRemoteTracks=[]}async unpublish(n){if(!this.connection||this.state!==xt.Connected)return void n.forEach(s=>{const c=this.pendingLocalTracks.indexOf(s);c!==-1&&this.pendingLocalTracks.splice(c,1)});const r=this.filterTobeUnpublishedTracks(n);if(r.length===0)return;const i=r.find(s=>s[0]==="videoLowTrack");return i&&i[1].track.close(),this.doUnpublish(this.connection,r)}async unpublishDataChannel(n){if(!this.connection||this.state!==xt.Connected)return void n.forEach(i=>{const s=this.pendingLocalDataChannels.indexOf(i);s!==-1&&this.pendingLocalDataChannels.splice(s,1)});const r=this.filterTobeUnpublishedDataChannels(n);return r.length!==0?(r.forEach(i=>{const s=this.localDataChannels.indexOf(i);s!==-1&&this.localDataChannels.splice(s,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),r.map(i=>i.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==xt.Connected)return;const n=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(!n)return;n.track.close();const r=[[Ee.LocalVideoLowTrack,n]];return this.doUnpublish(this.connection,r)}async doUnpublish(n,r){const i=this.createGatewayUnpublishMessage(r);return await n.stopSending(r.map(s=>{let[,{id:c}]=s;return c})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(s=>{let[c,{track:u}]=s;return{type:c,track:u}})),r.forEach(s=>{let[c]=s;this.statsCollector.removeLocalStats(c)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),i}async subscribeDataChannel(n,r){if(!this.connection||this.state!==xt.Connected)throw new de($.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const i=r.filter(s=>{var c;return!((c=this.remoteDataChannelMap.get(n))!==null&&c!==void 0&&c.get(s.id))});if(i.length!==0)return await this.connection.createDataChannels(n.uid,i),i.forEach(s=>{var c;this.remoteDataChannelMap.has(n)?(c=this.remoteDataChannelMap.get(n))===null||c===void 0||c.set(s.id,s):this.remoteDataChannelMap.set(n,new Map([[s.id,s]]));const u=this.pendingRemoteDataChannels.findIndex(h=>{let{user:f,id:m}=h;return f.uid===n.uid&&m===s.id});u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),i.map(s=>s.id)}async subscribe(n,r,i,s,c){var u;if(!this.connection||this.state!==xt.Connected)throw new de($.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((u=this.remoteUserMap.get(n))!==null&&u!==void 0&&u.has(r))return;let h,f,m;const y=this.connection.getPreMedia(i);if(y)A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(i,", no need to send sub to gateway.")),m=y.transceiver,h=y.track,f=y.id;else if(c){const w=c.find(W=>{let{stream_type:k}=W;return k===r});if(!w)throw new de($.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(r," for user: ").concat(n.uid," because subscribe answer from gateway does not contain stream_type: ").concat(r,"."));const O=await this.connection.receive(r,w.ssrcs,String(n._uintid),w.attributes);this.connection instanceof oc&&(m=O.transceiver),h=O.track,f=O.id}else{const w=await this.connection.receive(r,[{ssrcId:i,rtx:s}],String(n._uintid),void 0);this.connection instanceof oc&&(m=w.transceiver),h=w.track,f=w.id}r===Ue.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(h):(n._audioTrack=new Nh(h,n.uid,n._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),m&&n._audioTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(h):(n._videoTrack=new Ih(h,n.uid,n._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),m&&n._videoTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(n,n._videoTrack)),m&&Y("ENABLE_ENCODED_TRANSFORM")&&(r==Ue.VIDEO?await kO(m.receiver,{onSei:Y("ENABLE_VIDEO_SEI")&&(w=>{var O;return(O=n._videoTrack)===null||O===void 0?void 0:O._onSei(w)})}):r==Ue.AUDIO&&await LO(m.receiver,{enableTopn:!!Y("ENABLE_AUDIO_TOPN"),enableMetadata:!!Y("ENABLE_AUDIO_METADATA"),onMetadata:w=>{this.safeEmit(Ke.AudioMetadata,w)}}));const _=this.remoteUserMap.get(n);_?_.set(r,f):this.remoteUserMap.set(n,new Map([[r,f]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats();const S=this.pendingRemoteTracks.findIndex(w=>{let{user:O,kind:W}=w;return O.uid===n.uid&&r===W});S!==-1&&(this.pendingRemoteTracks.splice(S,1),this.emit(Ke.MediaReconnectEnd,n.uid))}async massSubscribe(n){return this.massSubscribeNoLock(n)}async massSubscribeNoLock(n){if(!this.connection||this.state!==xt.Connected)throw new de($.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");n=n.filter(c=>{var u;let{user:h,mediaType:f}=c;return!((u=this.remoteUserMap.get(h))!==null&&u!==void 0&&u.has(f))});const r=[],i=new Map;n.forEach(c=>{if(!this.connection)return;const u=this.connection.getPreMedia(c.ssrcId);u?i.set(c.ssrcId,u):r.push(c)});const s=await this.connection.batchReceive(r.map(c=>{let{user:u,mediaType:h,ssrcId:f,rtxSsrcId:m}=c;return{kind:h,ssrcMsg:[{ssrcId:f,rtx:m}],mslabel:String(u._uintid)}}));r.forEach((c,u)=>{i.set(c.ssrcId,s[u])});for(const{user:c,mediaType:u,ssrcId:h}of n){const f=i.get(h);if(!f)return void A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(c.uid," subscribe data,").concat(u,", ").concat(h));const{track:m,id:y,transceiver:_}=f;_&&Y("ENABLE_ENCODED_TRANSFORM")&&(u==Ue.VIDEO?await kO(_.receiver,{onSei:Y("ENABLE_VIDEO_SEI")&&(O=>{var W;return(W=c._videoTrack)===null||W===void 0?void 0:W._onSei(O)})}):u==Ue.AUDIO&&await LO(_.receiver,{enableTopn:!!Y("ENABLE_AUDIO_TOPN"),enableMetadata:!!Y("ENABLE_AUDIO_METADATA"),onMetadata:O=>{this.safeEmit(Ke.AudioMetadata,O)}})),u===Ue.AUDIO?(c._audioTrack?c._audioTrack._updateOriginMediaStreamTrack(m):(c._audioTrack=new Nh(m,c.uid,c._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(c._audioTrack.getTrackId()))),_&&c._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(c,c._audioTrack)):(c._videoTrack?c._videoTrack._updateOriginMediaStreamTrack(m):(c._videoTrack=new Ih(m,c.uid,c._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(c._videoTrack.getTrackId()))),_&&c._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(c,c._videoTrack)),Y("ENABLE_VIDEO_SEI")&&_&&(u==Ue.VIDEO?await kO(_.receiver,{onSei:O=>{var W;(W=c._videoTrack)===null||W===void 0||W._onSei(O)}}):u==Ue.AUDIO&&await LO(_.receiver));const S=this.remoteUserMap.get(c);S?S.set(u,y):this.remoteUserMap.set(c,new Map([[u,y]])),this.statsCollector.addRemoteStats(c.uid),this.statsUploader.startUploadInboundStats();const w=this.pendingRemoteTracks.findIndex(O=>{let{user:W,kind:k}=O;return W.uid===c.uid&&u===k});w!==-1&&(this.pendingRemoteTracks.splice(w,1),this.emit(Ke.MediaReconnectEnd,c.uid))}}async unsubscribe(n,r,i){const s=this.pendingRemoteTracks.filter(h=>{let{user:f,kind:m}=h;return r!==void 0?f.uid===n.uid&&r===m:f.uid===n.uid});if(s.forEach(h=>{const f=this.pendingRemoteTracks.indexOf(h);this.pendingRemoteTracks.splice(f,1)}),this.connection&&this.state===xt.Connected||i||s.forEach(h=>{let{kind:f}=h;var m;if(f===Ue.AUDIO)(m=n._audioTrack)===null||m===void 0||m._destroy(),n._audioTrack=void 0;else if(f===Ue.VIDEO){var y;(y=n._videoTrack)===null||y===void 0||y._destroy(),n._videoTrack=void 0}}),!this.connection||this.state!==xt.Connected)return;const c=this.filterTobeUnSubscribedTracks(n,r);if(c.length===0)return;await this.connection.stopReceiving(c.map(h=>{let[,{id:f}]=h;return f}));const u=this.createUnsubscribeMessage(c);return this.withdrawRemoteTracks(c),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),c.forEach(h=>{let[f,{kind:m}]=h;var y,_;if(m===Ue.VIDEO&&f._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),m===Ue.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),i||((_=f._videoTrack)===null||_===void 0||_._destroy(),f._videoTrack=void 0);else if(m===Ue.AUDIO){var S;this.unbindRemoteTrackEvents(f._audioTrack),!i&&((S=f._audioTrack)===null||S===void 0||S._destroy(),f._audioTrack=void 0)}}),u}async unsubscribeDataChannel(n,r){if(r.forEach(c=>{const u=this.pendingRemoteDataChannels.findIndex(h=>h.id===c.id);u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),!this.connection)return;const i=this.filterTobeUnSubscribedDataChannels(n,r);if(i.length===0)return;r.forEach(c=>{c._close()});const s=this.remoteDataChannelMap.get(n);return i.forEach(c=>{s&&s.delete(c.id)}),s&&s.size===0&&(this.remoteDataChannelMap.delete(n),await this.connection.stopDataChannels(n.uid)),i.map(c=>c.id)}async massUnsubscribe(n){return this.massUnsubscribeNoLock(n)}async massUnsubscribeNoLock(n){let r=[];for(const{user:c,mediaType:u}of n){const h=this.pendingRemoteTracks.filter(f=>{let{user:m,kind:y}=f;return u!==void 0?m.uid===c.uid&&u===y:m.uid===c.uid});h.forEach(f=>{const m=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(m,1)}),r=r.concat(h)}if(!this.connection||this.state!==xt.Connected)return void r.forEach(c=>{let{user:u,kind:h}=c;var f;if(h===Ue.AUDIO)(f=u._audioTrack)===null||f===void 0||f._destroy(),u._audioTrack=void 0;else if(h===Ue.VIDEO){var m;(m=u._videoTrack)===null||m===void 0||m._destroy(),u._videoTrack=void 0}});const i=Ao(n).call(n,(c,u)=>{let{user:h,mediaType:f}=u;const m=this.filterTobeUnSubscribedTracks(h,f);return c.concat(m)},[]);if(i.length===0)return;await this.connection.stopReceiving(i.map(c=>{let[,{id:u}]=c;return u}));const s=this.createUnsubscribeAllMessage(i);return this.withdrawRemoteTracks(i),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),i.forEach(c=>{let[u,{kind:h}]=c;var f,m;if(h===Ue.VIDEO&&u._videoSSRC&&((f=this.connection)===null||f===void 0||f.setStatsRemoteVideoIsReady(u._videoSSRC,!1)),h===Ue.VIDEO)this.unbindRemoteTrackEvents(u._videoTrack),(m=u._videoTrack)===null||m===void 0||m._destroy(),u._videoTrack=void 0;else if(h===Ue.AUDIO){var y;this.unbindRemoteTrackEvents(u._audioTrack),(y=u._audioTrack)===null||y===void 0||y._destroy(),u._audioTrack=void 0}}),s}isPreSubScribe(n){return!this.connection||this.state!==xt.Connected?!1:!!this.connection.getPreMedia(n)}async muteRemote(n,r){if(!this.connection)return;const i=this.remoteUserMap.get(n);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid,"."));if(!i.get(r))return void A.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."));const s=r===Ue.VIDEO?n._videoSSRC:n._audioSSRC;s!==void 0&&this.connection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(n,r){return this.unmuteRemoteNoLock(n,r)}async unmuteRemoteNoLock(n,r){if(!this.connection)return;const i=this.remoteUserMap.get(n);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid,"."));i.get(r)||A.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."))}addAudioMetadata(n){const r=this.localTrackMap.get(Ee.LocalAudioTrack),i=r&&r.track;i&&i.metadata.push(n)}getAllTracks(n){const r=this.localTrackMap.get(Ee.LocalAudioTrack);if((r==null?void 0:r.track)instanceof qn){const i=r.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return c!==Ee.LocalAudioTrack}).filter(s=>{let[c]=s;return!(n&&c===Ee.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c}).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter(i=>{let[s]=i;return!(n&&s===Ee.LocalVideoLowTrack)}).map(i=>{let[,{track:s}]=i;return s})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(n,r,i,s,c){if(n){const h=this.localTrackMap.get(Ee.LocalAudioTrack),f=s?this.localTrackMap.get(Ee.LocalVideoLowTrack):this.localTrackMap.get(Ee.LocalVideoTrack);$e.publish(this.store.sessionId,{eventElapse:Mr.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:h==null?void 0:h.track.getTrackLabel(),videoName:f==null?void 0:f.track.getTrackLabel(),screenshare:(f==null?void 0:f.track._hints.indexOf(Yt.SCREEN_TRACK))!==-1,audio:!!h,video:!!f,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}else{var u;i||(i=[]);const h=i.find(m=>m instanceof vn),f=s?(u=this.localTrackMap.get(Ee.LocalVideoTrack))===null||u===void 0?void 0:u.track:i.find(m=>m instanceof tn);$e.publish(this.store.sessionId,{eventElapse:Mr.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:h==null?void 0:h.getTrackLabel(),videoName:f==null?void 0:f.getTrackLabel(),screenshare:(f==null?void 0:f._hints.indexOf(Yt.SCREEN_TRACK))!==-1,audio:!!h,video:!!f,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}}reportSubscribeEvent(n,r,i,s){const c=s===Ue.VIDEO?i._videoSSRC:i._audioSSRC;c&&$e.subscribe(this.store.sessionId,{succ:n,ec:r,video:s===Ue.VIDEO,audio:s===Ue.AUDIO,peerid:i.uid,subscribeRequestid:c,p2pid:this.store.p2pId,eventElapse:Mr.measureFromSubscribeStart(this.store.clientId,c),preSsrc:this.isPreSubScribe(c)})}reset(){A.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Lr("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=GE(this.store),this.emit(Ke.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const n=this.localTrackMap.get(Ee.LocalAudioTrack);if((n==null?void 0:n.track)instanceof qn){if(n.track.trackList.length>0){const r=n.track;n.track.trackList.forEach(i=>{r.removeAudioTrack(i)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=xt.Disconnected}getStats(){var n;return(n=this.connection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(n){var r;return((r=this.connection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){const n=this.localTrackMap.get(Ee.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){const n=this.localTrackMap.get(Ee.LocalVideoTrack);if(n)return{width:n.track.videoWidth||0,height:n.track.videoHeight||0}}getEncoderConfig(n){const r=this.localTrackMap.get(n);return r&&r.track instanceof tn||r&&r.track instanceof vn?r.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,r){if(!n)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(n);return!!i&&(!r||i.has(r))}async hasRemoteMediaWithLock(n,r){if(!n)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(n);return!!i&&(!r||i.has(r))}getRemoteMedia(n){var r;const i=Array.from(oa(r=this.remoteUserMap).call(r)).find(s=>s.uid===n);return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(i=>{let[s]=i;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Ee.LocalAudioTrack);return r&&n.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=om(n).call(n,(i,s)=>i.level-s.level),n}async disconnectForReconnect(){this.connection&&(A.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=xt.Reconnecting,Y("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;var i;r._videoTrack&&r._videoTrack._player&&((i=r._videoTrack._player.getVideoElement())===null||i===void 0||i.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=GE(this.store),this.emit(Ke.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var r;let[i,{track:s}]=n;switch(i){case Ee.LocalVideoTrack:Oe(r=s._hints).call(r,Yt.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case Ee.LocalAudioTrack:s instanceof qn?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case Ee.LocalVideoLowTrack:}}),this.emit(Ke.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,i]=n;Array.from(oa(i).call(i)).forEach(s=>{this.setPendingRemoteMedia(r,s)}),this.emit(Ke.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(n=>{this.pendingLocalDataChannels.push(n)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(n=>{let[r,i]=n;Array.from(oa(i).call(i)).forEach(s=>{this.setPendingRemoteDataChannel(r,s)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),A.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(n,r){for(const i of this.pendingRemoteDataChannels){const{user:s,id:c}=i;if((n instanceof rl?n.uid:n)===s.uid&&c===r)return!0}return!1}setPendingRemoteDataChannel(n,r){this.hasPendingRemoteDataChannel(n,r)||this.pendingRemoteDataChannels.push({user:n,id:r})}hasPendingRemoteMedia(n,r){for(const i of this.pendingRemoteTracks){const{user:s,kind:c}=i;if((n instanceof rl?n.uid:n)===s.uid&&r===c)return!0}return!1}setPendingRemoteMedia(n,r){this.hasPendingRemoteMedia(n,r)||this.pendingRemoteTracks.push({user:n,kind:r})}restartICE(n){var r=this;return wa(function*(){if(!r.connection||r.state!==xt.Connected)return;const i=yield vt(r.mutex.lock("From P2PChannel.restartICE"));let s;try{s=yield vt(r.connection.restartICE(n));const u=yield vt(s.next());if(u.done)return;const h=u.value,f=yield h;switch(uA(r.connection)&&r.reportPCStats(Date.now(),!1,r._pcStatsUploadType),n){case Fr.UDP_TCP_RELAY:r._pcStatsUploadType=rc.UDP_TCP_RESTART;break;case Fr.TCP_RELAY:r._pcStatsUploadType=rc.TCP_RESTART;break;case Fr.RELAY:r._pcStatsUploadType=rc.RELAY_RESTART;break;default:r._pcStatsUploadType=rc.OLD_RESTART}r._isTryConnecting=!0,s.next(f)}catch(u){var c;(c=s)===null||c===void 0||c.throw(u)}finally{i()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const n=this.connection.getStats(),r=this.localTrackMap.get(Ee.LocalVideoTrack),i=this.localTrackMap.get(Ee.LocalAudioTrack),s=n.videoSend.find(O=>O.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId)),c=n.audioSend.find(O=>O.ssrc===(i==null?void 0:i.ssrcs[0].ssrcId));if(!s||!c)return 1;const u=ia(this,Ke.NeedSignalRTT),h=s?s.rttMs:void 0,f=c?c.rttMs:void 0,m=h&&f?(h+f)/2:h||f,y=(m&&u?(m+u)/2:m||u)||0,_=100*n.sendPacketLossRate*.7/50+.3*y/1500,S=_<.17?1:_<.36?2:_<.59?3:_<.1?4:5,w=r==null?void 0:r.track;if(w&&w._encoderConfig&&w._hints.indexOf(Yt.SCREEN_TRACK)===-1){const O=w._encoderConfig.bitrateMax,W=n.bitrate.actualEncoded;if(O&&W){const k=(1e3*O-W)/(1e3*O);return F3[k<.15?0:k<.3?1:k<.45?2:k<.6?3:4][S]}}return S}getDownlinkNetworkQuality(){if(!this.connection)return 0;const n=this.connection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s]=i;const c=s._audioSSRC,u=s._videoSSRC,h=n.audioRecv.find(W=>W.ssrc===c),f=n.videoRecv.find(W=>W.ssrc===u);if(!h&&!f)return void(r+=1);const m=ia(this,Ke.NeedSignalRTT),y=n.rtt,_=(y&&m?(y+m)/2:y||m)||0,S=h?h.jitterMs:void 0,w=n.recvPacketLossRate;let O=.7*w*100/50+.3*_/1500;S&&(O=.6*w*100/50+.2*_/1500+.2*S/400),r+=O<.1?1:O<.17?2:O<.36?3:O<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(n){return new Ie((r,i)=>{this.handleMuteLocalTrack(n,r,i)})}async replaceTrack(n,r){var i;if(A.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(n.getTrackId(),"] to [").concat(r.getTrackId(),"]")),!this.connection||this.state!==xt.Connected)return;const s=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return n===h});if(!s)return;const c=s[0];if(n!==r&&(this.unbindLocalTrackEvents([{track:n,type:c}]),this.bindLocalTrackEvents([{track:r,type:c}]),s[1].track=r),await((i=this.connection)===null||i===void 0?void 0:i.replaceTrack(r,s[1].id)),this.isPlanB){const u=s[1];u.id=r._mediaStreamTrack.id,this.localTrackMap.set(c,u)}if(c===Ee.LocalVideoTrack&&!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding){const u=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(u){const h=n._mediaStreamTrack.clone();u.track._originMediaStreamTrack.stop(),u.track._mediaStreamTrack=h,u.track._originMediaStreamTrack=h,await new Ie((f,m)=>{this.handleReplaceTrack(u.track,f,m,!0)})}}}filterTobePublishedTracks(n,r,i){const s=[],c=this.getAllTracks();n=yh(n=n.filter(m=>c.indexOf(m)===-1));let u,h=!1;const f=this.localTrackMap.get(Ee.LocalAudioTrack);for(const m of n){if(m instanceof tn&&(this.localTrackMap.has(Ee.LocalVideoTrack)||h?new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:m,type:Ee.LocalVideoTrack}),h=!0),r)){const y=this.getLowVideoTrack(m,i);s.push({track:y,type:Ee.LocalVideoLowTrack})}if(m instanceof vn)if(f){const y=f.track;if(y instanceof qn)cA([m]),y.addAudioTrack(m),this.bindLocalAudioTrackEvents(m,!0);else{const _=lA([y,m]);A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(_.getTrackId(),"]")),this.replaceTrack(y,_)}}else u instanceof qn?(cA([m]),u.addAudioTrack(m)):u||!m._useAudioElement&&bt().webAudioMediaStreamDest&&!m._bypassWebAudio?u=lA(u?[m,u]:[m]):u=m}return u&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(u.getTrackId(),"]")),s.push({track:u,type:Ee.LocalAudioTrack})),s}filterTobeUnpublishedTracks(n){const r=[],i=this.getAllTracks();n=yh(n=n.filter(s=>i.indexOf(s)!==-1));for(const s of n){if(s instanceof vn){const c=this.localTrackMap.get(Ee.LocalAudioTrack);if(!c)continue;c.track instanceof qn?(c.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),c.track.trackList.length===0&&(r.push([Ee.LocalAudioTrack,c]),c.track.close())):r.push([Ee.LocalAudioTrack,c])}if(s instanceof tn){const c=this.localTrackMap.get(Ee.LocalVideoTrack);if(!c)continue;r.push([Ee.LocalVideoTrack,c]);const u=this.localTrackMap.get(Ee.LocalVideoLowTrack);u&&r.push([Ee.LocalVideoLowTrack,u])}}return r}filterTobePublishedDataChannels(n){return n=(n=yh(n)).filter(r=>this.localDataChannels.findIndex(i=>i.id===r.id)===-1)}filterTobeUnpublishedDataChannels(n){return n=(n=(n=yh(n)).filter(r=>this.localDataChannels.indexOf(r)!==-1)).filter(r=>r._originDataChannel)}bindLocalTrackEvents(n){n.forEach(r=>{let{track:i,type:s}=r;switch(s){case Ee.LocalVideoTrack:i.addListener(je.GET_STATS,this.handleGetLocalVideoStats),i.addListener(je.GET_RTC_STATS,this.handleGetRTCStats),i.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(je.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.addListener(je.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.addListener(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.bindLocalAudioTrackEvents(i);case Ee.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,r){n instanceof qn?n.trackList.forEach(i=>{i.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(je.GET_STATS,this.handleGetLocalAudioStats),i.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(je.GET_STATS,this.handleGetLocalAudioStats),n.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||(n.addListener(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.addListener(je.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(r=>{let[i,{track:s}]=r;return{track:s,type:i}})),n.forEach(r=>{let{track:i,type:s}=r;switch(s){case Ee.LocalVideoTrack:i.off(je.GET_STATS,this.handleGetLocalVideoStats),i.off(je.GET_RTC_STATS,this.handleGetRTCStats),i.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(je.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.off(je.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.off(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.unbindLocalAudioTrackEvents(i);case Ee.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof qn?n.trackList.forEach(r=>{r.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(je.GET_STATS,this.handleGetLocalAudioStats),r.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(je.GET_STATS,this.handleGetLocalAudioStats),n.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(je.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),n.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,r){r instanceof Ih&&r.addListener(je.GET_STATS,i=>{i(this.handleGetRemoteVideoStats(n))}),r instanceof Nh&&r.addListener(je.GET_STATS,i=>{i(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(je.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,i]=n;i.has(Ue.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),i.has(Ue.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(n,r){return n.map((i,s)=>{var c;let u,h,{track:f,type:m}=i;switch(m){case Ee.LocalAudioTrack:u=Dt.Audio,h={dtx:f instanceof mE&&f._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ee.LocalVideoTrack:u=Oe(c=f._hints).call(c,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High,h=bs(bs({},a4(f)),{},{codec:this.store.codec,svc_mode:PE()});break;case Ee.LocalVideoLowTrack:u=Dt.Low,h=bs(bs({},a4(f)),{},{codec:this.store.codec,svc_mode:PE()})}return{stream_type:u,attributes:h,ssrcs:r[s]}})}createGatewayUnpublishMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}assignLocalTracks(n,r){n.forEach((i,s)=>{let{track:c,type:u}=i;this.localTrackMap.set(u,{track:c,id:r[s].id,ssrcs:r[s].localSSRC})})}withdrawLocalTracks(n){n.forEach(r=>{let[i]=r;this.localTrackMap.delete(i)})}bindConnectionEvents(n){n.onConnectionStateChange=async r=>{if(A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(r,")")),this.emit(Ke.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),n instanceof oc&&i5(n,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=rc.DISCONNECTED_OR_FAILED,ia(this,Ke.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const i=this.pendingLocalTracks.map(c=>c.getTrackId()),s=this.pendingLocalDataChannels.map(c=>"dc_".concat(c.id));$e.reportApiInvoke(this.store.sessionId,{name:Wn.REPUB_AFTER_PC_CONNECTED,options:i.concat(s),tag:fn.TRACER}).onSuccess(),this.republish()}if(Y("NEW_ICE_RESTART")&&n instanceof oc&&!gn()&&!this._forceTurn){if(Oe(Q3).call(Q3,r)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const i=c=>{uA(n)&&(A.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(c)),ia(this,Ke.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ke.RequestRestartICE,c))},s=()=>{uA(n)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),A.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Ke.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{a5(n,i,s)},800))}}else{if(r==="disconnected"&&n.iceConnectionState==="disconnected")return setTimeout(()=>{n.iceConnectionState==="disconnected"&&Y("ICE_RESTART")&&ia(this,Ke.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ke.RequestRestartICE)},800),void setTimeout(()=>{n.peerConnectionState==="disconnected"&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(Ke.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);r==="failed"&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(Ke.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},n.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),$e.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:fn.TRACER}).onSuccess(),this.emit(Ke.IceConnectionStateChange,r)},n.onICETransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},n.onDTLSTransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},n.onDTLSTransportError=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},n.onFirstAudioDecoded=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(u=>u._audioSSRC===r);var c;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(c=s.audioTrack)===null||c===void 0||c.emit(wh.FIRST_FRAME_DECODED),$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_AUDIO_DECODE,on.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(c=>c._audioSSRC===r);s&&$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_AUDIO_RECEIVED,on.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(r,i,s)=>{this.reportVideoFirstFrameDecoded(r,i,s)},n.onFirstVideoReceived=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(c=>c._videoSSRC===r);s&&$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_VIDEO_RECEIVED,on.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(r,i)=>{const s=r.candidateType==="relay",c=i.candidateType==="relay";i.candidateType!=="unknown"&&s===c||this.emit(Ke.ConnectionTypeChange,s),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(el(i))," -> ").concat(JSON.stringify(el(r)),")"))},n.onSelectedRemoteCandidateChanged=(r,i)=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(el(i))," -> ").concat(JSON.stringify(el(r)),")"))},n.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},n.getLocalVideoStats=()=>{const r=this.statsCollector.getLocalVideoTrackStats(),i=this.statsCollector.getRTCStats();return bs(bs({},r),i)},n.onICECandidateError=r=>{this._iceError=r}}resetConnection(n){n instanceof oc&&function(r){Hh.delete(r.id),i5(r)}(n),n.close(),this.emit(Ke.PeerConnectionStateChange,"closed"),function(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0,r.getLocalVideoStats=void 0}(n),this._isWaitPcToRePub=!1}filterTobeMutedTracks(n){const r=[];if(this.getAllTracks().indexOf(n)===-1)return r;const i=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof vn&&(i==null?void 0:i.track)instanceof qn)return i.track.isActive||r.push([Ee.LocalAudioTrack,i]),r;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return n===u});if(s&&(r.push(s),s[0]===Ee.LocalVideoTrack)){const c=this.localTrackMap.get(Ee.LocalVideoLowTrack);c&&r.push([Ee.LocalVideoLowTrack,c])}return r}filterTobeUnmutedTracks(n){const r=[],i=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof vn&&(i==null?void 0:i.track)instanceof qn)return i.track.isActive&&r.push([Ee.LocalAudioTrack,i]),r;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return n===u});if(s)if(s[0]===Ee.LocalVideoTrack){r.push(s);const c=this.localTrackMap.get(Ee.LocalVideoLowTrack);c&&r.push([Ee.LocalVideoLowTrack,c])}else r.push(s);return r}createMuteMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}createUnmuteMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}filterTobeUnSubscribedTracks(n,r){const i=[],s=this.remoteUserMap.get(n);if(!s)return i;if(r){const c=s.get(r);if(!c)return i;i.push([n,{kind:r,id:c}])}else Array.from(s.entries()).forEach(c=>{let[u,h]=c;i.push([n,{kind:u,id:h}])});return i}filterTobeUnSubscribedDataChannels(n,r){const i=[];return r.forEach(s=>{var c;(c=this.remoteDataChannelMap.get(n))!==null&&c!==void 0&&c.has(s.id)&&i.push(s)}),i}createUnsubscribeMessage(n){const r=[];return n.forEach(i=>{let[s,{kind:c,id:u}]=i;switch(c){case Ue.VIDEO:return void(s._videoSSRC&&r.push({stream_type:Ue.VIDEO,ssrcId:s._videoSSRC}));case Ue.AUDIO:return void(s._audioSSRC&&r.push({stream_type:Ue.AUDIO,ssrcId:s._audioSSRC}))}}),r}createUnsubscribeAllMessage(n){const r=new Map;return n.forEach(i=>{let[s,{kind:c}]=i;if(r.has(s)){let u=r.get(s);c===Ue.VIDEO?u|=rr.Video:u|=rr.Audio,r.set(s,u)}else c===Ue.VIDEO?r.set(s,rr.Video):r.set(s,rr.Audio)}),{users:Array.from(r.entries()).map(i=>{let[s,c]=i;return{stream_id:s.uid,stream_type:c}})}}withdrawRemoteTracks(n){n.forEach(r=>{let[i,{kind:s}]=r;const c=this.remoteUserMap.get(i);c&&(c.delete(s),Array.from(c.entries()).length===0&&this.remoteUserMap.delete(i))})}async updateBitrateLimit(n){const r=this.localTrackMap.get(Ee.LocalVideoTrack),i=this.localTrackMap.get(Ee.LocalVideoLowTrack);r&&(await r.track.setBitrateLimit(n.uplink),await new Ie((s,c)=>{this.handleUpdateVideoEncoder(r.track,s,c,!0)})),i&&n.low_stream_uplink&&(await i.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0}),await new Ie((s,c)=>{this.handleUpdateVideoEncoder(i.track,s,c,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(n,r,i){return n.map((s,c)=>{var u;let{stream_type:h}=s;const f=(u=r.find(m=>{let{stream_type:y}=m;return h===y}))===null||u===void 0?void 0:u.attributes;if(f&&Y("DISABLE_SCREEN_SHARE_REMB")){const m=i[c]._hints;(Oe(m).call(m,Yt.SCREEN_TRACK)||Oe(m).call(m,Yt.SCREEN_LOW_TRACK))&&(f.remb=!1,A.debug("disable remb for screen share, hints:",m))}return f})}async tryToUnmuteAudio(n){for(let i=0;i<n.length;i++)if(n[i]instanceof vn){var r;const s=this.filterTobeUnmutedTracks(n[i]);if(s.length===0)continue;await((r=this.connection)===null||r===void 0?void 0:r.unmuteLocal(s.map(u=>{let[,{id:h}]=u;return h})));const c=this.createUnmuteMessage(s);return void await Kt(this,Ke.RequestUnmuteLocal,c)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var r;return!((r=this.connection)===null||r===void 0||!r.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,r)=>this.emit(Ke.RequestUpload,n,r),this.statsUploader.requestUploadStats=n=>this.emit(Ke.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var n;return{connectState:((n=this.connection)===null||n===void 0?void 0:n.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await _r(rO(this.dtlsFailedCount,Gn)),this.emit(Ke.RequestReconnect)}async reconnectP2P(){const n=Array.from(this.localTrackMap.entries()),r=this.createGatewayUnpublishMessage(n);Array.from(this.remoteUserMap.entries()),r.length>0&&await Or(this,Ke.RequestUnpublishForReconnectPC,r),this.disconnectForReconnect(),this.emit(Ke.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Ee.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof tn)}throwIfTrackTypeNotMatch(n){if(n.filter(r=>r instanceof tn).length>1)throw new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(r=>r instanceof vn).length>1&&(n.some(r=>r instanceof vn&&r._bypassWebAudio)||!bt().webAudioMediaStreamDest))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of n){if(r instanceof tn&&this.pendingLocalTracks.some(i=>i instanceof tn))throw new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof vn&&this.pendingLocalTracks.some(i=>i instanceof vn)&&(!bt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(i=>i instanceof vn&&i._bypassWebAudio)))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,r){var i;const s=!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding,c=bs(bs({},{width:160,height:120,framerate:15,bitrate:50}),r);let u;u=s?n._mediaStreamTrack.clone():dA(n,c);const h=qt(8,"track-low-"),f=new tn(u,bs(bs({},s&&{scaleResolutionDownBy:KO(c,n)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,h);return f.on(Au.TRANSCEIVER_UPDATED,m=>{n._updateRtpTransceiver(m,bh.LOW_STREAM)}),f._hints.push(Yt.LOW_STREAM),Oe(i=n._hints).call(i,Yt.SCREEN_TRACK)&&f._hints.push(Yt.SCREEN_LOW_TRACK),n.on("sei-to-send",m=>{f.emit("sei-to-send",m)}),n.addListener(je.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(n,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof oc){var c,u,h,f;const m=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:y,dtlsTransportState:_,peerConnectionState:S}=this.connection,{local:w,remote:O}=await this.connection.getSelectedCandidatePair();$e.pcStats(this.store.sessionId,{startTime:m,eventElapse:n-m||0,iceconnectionsate:y,dtlsstate:_,connectionstate:S,intSucc:r?1:2,error:this._iceError||s||"",selectedLocalCandidateProtocol:(c=w==null?void 0:w.protocol)!==null&&c!==void 0?c:"",selectedLocalCandidateType:(u=w.candidateType)!==null&&u!==void 0?u:"",selectedLocalCandidateAddress:"".concat(w.address,":").concat(w.port),selectedRemoteCandidateProtocol:(h=O.protocol)!==null&&h!==void 0?h:"",selectedRemoteCandidateType:(f=O.candidateType)!==null&&f!==void 0?f:"",selectedRemoteCandidateAddress:"".concat(O.address,":").concat(O.port),restartCnt:i,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(n,r,i,s){var c;const u=Array.from(oa(c=this.remoteUserMap).call(c)).find(h=>h._videoSSRC===n);if(u){s||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const h=this.store.keyMetrics,f=h.subscribe.find(m=>m.userId===u.uid&&m.type==="video");$e.firstRemoteVideoDecode(this.store.sessionId,nr.FIRST_VIDEO_DECODE,on.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:r,videoheight:i,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:h.requestAPEnd||0,apStart:h.requestAPStart||0,joinGwEnd:h.joinGatewayEnd||0,joinGwStart:h.joinGatewayStart||0,pcEnd:h.peerConnectionEnd||0,pcStart:h.peerConnectionStart||0,subscriberEnd:(f==null?void 0:f.subscribeEnd)||0,subscriberStart:(f==null?void 0:f.subscribeStart)||0,videoAddNotify:(f==null?void 0:f.streamAdded)||0,state:s?1:0,firstFrame:(f==null?void 0:f.firstFrame)||0})}}async remoteMediaSsrcChanged(n,r,i){if(!this.connection)return!1;const s=this.remoteUserMap.get(n);if(!s)return!1;const c=s.get(r);if(!c)return!1;const u=await this.connection.getRemoteSSRC(c);return u!==void 0&&u!==i}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[r,{track:i}]=n;r===Ee.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,bh.LOW_STREAM):i._updateRtpTransceiver(void 0)})}},Fe(ut.prototype,"startP2PConnection",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"startP2PConnection"),ut.prototype),Fe(ut.prototype,"connect",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"connect"),ut.prototype),Fe(ut.prototype,"updateRemoteRTPCapabilities",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"updateRemoteRTPCapabilities"),ut.prototype),Fe(ut.prototype,"publishDataChannel",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"publishDataChannel"),ut.prototype),Fe(ut.prototype,"unpublish",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unpublish"),ut.prototype),Fe(ut.prototype,"unpublishDataChannel",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unpublishDataChannel"),ut.prototype),Fe(ut.prototype,"unpublishLowStream",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unpublishLowStream"),ut.prototype),Fe(ut.prototype,"subscribeDataChannel",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"subscribeDataChannel"),ut.prototype),Fe(ut.prototype,"subscribe",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"subscribe"),ut.prototype),Fe(ut.prototype,"massSubscribe",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"massSubscribe"),ut.prototype),Fe(ut.prototype,"unsubscribe",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unsubscribe"),ut.prototype),Fe(ut.prototype,"unsubscribeDataChannel",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unsubscribeDataChannel"),ut.prototype),Fe(ut.prototype,"massUnsubscribe",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"massUnsubscribe"),ut.prototype),Fe(ut.prototype,"muteRemote",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"muteRemote"),ut.prototype),Fe(ut.prototype,"unmuteRemote",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"unmuteRemote"),ut.prototype),Fe(ut.prototype,"hasRemoteMediaWithLock",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"hasRemoteMediaWithLock"),ut.prototype),Fe(ut.prototype,"disconnectForReconnect",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"disconnectForReconnect"),ut.prototype),Fe(ut.prototype,"updateBitrateLimit",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"updateBitrateLimit"),ut.prototype),Fe(ut.prototype,"remoteMediaSsrcChanged",[qr],Object.getOwnPropertyDescriptor(ut.prototype,"remoteMediaSsrcChanged"),ut.prototype),ut);function qr(n,r,i){const s=n[r];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const c=this.mutex,u=await c.lock("From P2PChannel.".concat(r));try{for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return await s.apply(this,f)}finally{u()}},i}function c5(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function l5(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?c5(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):c5(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const Gpe=Date.now(),fA=new Map,YE=new Map;async function u5(n){const r=fA.get(n),i=Array.isArray(r)&&r[r.length-1],s=YE.get(n);if(!i)return void(s.isSyncing=!1);const c={uid:i.uid,payload:i.payload};s.firstRecvTs===0&&(s.firstRecvTs=i.recvTs,s.firstSendTs=i.sendTs);const u=i.sendTs-s.firstSendTs,h=u-(Date.now()-s.firstRecvTs);h>0&&(s.firstRecvTs=Date.now()-u);let f=i.mediaDelay+h;f<=0?(r.pop(),d5(i.context,c),f=0):f=Math.min(f,20),setTimeout(()=>r.length&&u5(n),f)}function d5(n,r){n.safeEmit(dt.STREAM_MESSAGE,r.uid,r.payload),n.onStreamMessage&&n.onStreamMessage(r)}function $pe(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(!n.syncWithAudio)return d5(i,{uid:n.uid,payload:n.payload});const s="".concat(i.id,"-").concat(n.uid),c=fA.get(s)||[],u=c.findIndex(y=>n.sendTs>=y.sendTs),h=l5(l5({},n),{},{context:i,mediaDelay:r,recvTs:Date.now()});u===-1?c.push(h):c.splice(u,0,h),fA.set(s,c);let f=!1;var m;YE.has(s)?f=!((m=YE.get(s))===null||m===void 0||!m.isSyncing):YE.set(s,{isSyncing:f,firstRecvTs:0,firstSendTs:0}),f||u5(s)}const Hpe=St().name;function h5(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function f5(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?h5(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):h5(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const zh="websdk_ng_cache_parameter",zpe=Y("MAX_PRELOAD_ASYNC_LENGTH"),Bu=new Map,Fu=[];let pA=null,mA=0,gA=0;const XE=new Map,Kpe=function(n,r){const i=[];let s=0;const c=async()=>{const u=i.shift();u&&await u(),i.length>0&&s<r?c():s--};return async function(){for(var u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];return new Ie(async(m,y)=>{i.push(async()=>{try{const _=await n(...h);m(_)}catch(_){y(_)}}),s<r&&(s++,c())})}}(p5,zpe),yA=mi.CancelToken.source();async function p5(n,r,i,s,c,u){try{if(!Y("ENABLE_PRELOAD"))return;if(!bt().supportWebCrypto)return void Yc(()=>{A.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!i&&i!==null)throw new de($.INVALID_PARAMS,"Invalid token: ".concat(i,". If you don not use token, set it to null"));i&&vr(i,"token",1,2047),vr(n,"appid",1,2047),RE(r),s&&OE(s);const h=Ru();A.debug("preload channel ".concat(r,", uid is ").concat(s));const f={appId:n,cname:r,token:i||n,uid:typeof s!="string"?s:null,sid:h,proxyServer:c};let m,y;typeof s=="string"?(f.stringUid=s,[y,m]=await Ie.all([Npe(s,{sid:h,appId:n},yA.token),M4(f5(f5({},f),{},{token:i||n,uid:0}),yA.token)]),f.uid=y.uid,m.gatewayInfo.uid=f.uid,m.gatewayInfo.res.uid=f.uid):(u&&(f.stringUid=u),m=await M4(f,yA.token));const _={sid:h,appId:n,cname:r,token:i||n,uid:f.stringUid||s,intUid:f.uid||m.gatewayInfo.uid,stringUid:f.stringUid,ts:Date.now(),sua:y,ap:m};await async function(S){let w;try{S.uid&&g5({appId:S.appId,cname:S.cname,token:S.token,uid:S.uid,stringUid:S.stringUid});const O=E5(S),W=await async function(j,H){try{const K=await window.crypto.subtle.importKey("raw",dB(H),"AES-GCM",!1,["encrypt"]),Q=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},K,Cu(window.btoa(JSON.stringify(j))));return Xc(new Uint8Array(Q))}catch{return}}(S,S.token||S.appId);if(!W)return;w=_5(zh);const k=w?JSON.parse(w):[];k.push({[O]:W}),k.length>Y("AP_CACHE_NUM")&&k.shift(),JE(zh,JSON.stringify(k))}catch(O){A.warn("Error caching server parameters:",O.message),JE(zh,"")}}(_),mA++}catch(h){throw gA++,function(f){pA||(pA=window.setTimeout(()=>{let y="";XE.forEach((_,S)=>{y+="".concat(S,": ").concat(_," ;")}),$e.reportApiInvoke(null,{name:Wn.PRELOAD,options:{success:mA,failed:gA,err:y}}).onError(f),mA=0,gA=0,XE.clear(),pA=null},1e4));const m=XE.get(f.code)||0;XE.set(f.code,m+1)}(h),h}}async function m5(n){try{if(Y("AP_REQUEST_DETAIL")||Y("ENABLE_ROLE_SELECT_EDGE"))return;const r=g5(n);if(!r||n.cloudProxyServer!=="disabled")return;const i=await async function(s,c){try{const u=await window.crypto.subtle.importKey("raw",dB(c),"AES-GCM",!1,["decrypt"]),h=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},u,Cu(s));return JSON.parse(window.atob(Xc(new Uint8Array(h))))}catch{return}}(r,n.token||n.appId);if(!i||!function(s,c){return s.cname===c.cname&&s.appId===c.appId&&s.token===c.token?c.stringUid?s.stringUid===c.stringUid:typeof c.uid=="number"?s.uid===c.uid:s.uid==c.uid:!1}(i,n))return;if(i&&Date.now()-i.ts<Y("AP_CACHE_LIFETIME"))return i}catch(r){A.warn("Error get preloadInfo",r.message)}}function g5(n){let r;try{if(r=_5(zh),!r)return;const i=JSON.parse(r),s=E5(n),c=function(h,f){for(let m=h.length-1;m>=0;m--)if(f(h[m]))return m;return-1}(i,h=>s in h);if(c===-1)return;const u=i.splice(c,1)[0];return JE(zh,JSON.stringify(i)),u[s]}catch(i){A.warn("Error delete preload info: ".concat(r),i.message),JE(zh,"")}}function vA(n){if(n){let r=Bu.get(n);r&&(window.clearTimeout(r),r=null,Bu.delete(n)),Oe(Fu).call(Fu,n)||n.cloudProxyServer!=="disabled"||Fu.push(n)}if(Bu.size<Y("AP_CACHE_NUM")&&Fu.length>0){const r=Fu.shift();Bu.set(r,window.setTimeout(async()=>{const{appId:i,cname:s,token:c,stringUid:u,uid:h,proxyServer:f}=r;try{await Kpe(i,s,c,h,f,u),Bu.has(r)&&vA(r)}catch(m){A.warn("update preload failed",m.message),y5(r)}},Y("AP_UPDATE_INTERVAL")))}}function y5(n){const r=Fu.indexOf(n);r!==-1&&Fu.splice(r,1);let i=Bu.get(n);i&&(window.clearTimeout(i),i=null,Bu.delete(n),vA())}function v5(n,r){const i=n.sua,s=n.ap;r&&i&&$e.reqUserAccount(n.sid,{lts:i.requestTime,elapse:i.elapse,success:!0,serverAddr:i.url,stringUid:r,uid:n.intUid,errorCode:null,extend:i.req}),$e.reportResourceTiming(n.ap.url,n.sid),$e.joinWebProxyAP(n.sid,{lts:s.requestTime,elapse:s.elapse,sucess:1,apServerAddr:s.url,turnServerAddrList:s.proxyInfo.addresses.map(c=>c.ip).join(","),eventType:"disabled",unilbsServerIds:[Dn.CHOOSE_SERVER,Dn.CLOUD_PROXY_FALLBACK].toString()}),$e.joinChooseServer(n.sid,{lts:s.requestTime,elapse:s.elapse,succ:!0,csAddr:s.url,opid:s.opid,serverList:s.gatewayInfo.gatewayAddrs.map(c=>c.address),ec:null,cid:s.gatewayInfo.cid.toString(),uid:s.gatewayInfo.uid.toString(),csIp:s.gatewayInfo.csIp,unilbsServerIds:[Dn.CHOOSE_SERVER].toString(),isHttp3:s.isHttp3})}function _5(n){return window.atob(window.localStorage.getItem(n)||"")}function JE(n,r){window.localStorage.setItem(n,window.btoa(r))}function E5(n){let r="".concat(n.appId,"_").concat(n.cname);return typeof n.uid=="string"&&(r+="_s_".concat(n.uid)),typeof n.uid=="number"&&(r+="_".concat(n.uid)),n.token&&(r+="_".concat(n.token)),vB(r)}function qpe(n){let r=function(){const i=Jpe.pop();return i?(i.offset=i.limit=0,i):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(i,s){let c=i.appId;c!==void 0&&(Mn(s,10),al(s,c));let u=i.cid;u!==void 0&&(Mn(s,16),Mn(s,u));let h=i.cname;h!==void 0&&(Mn(s,26),al(s,h));let f=i.deviceId;f!==void 0&&(Mn(s,34),al(s,f));let m=i.elapse;m!==void 0&&(Mn(s,40),ol(s,m));let y=i.fileSize;y!==void 0&&(Mn(s,48),ol(s,Kh(y)));let _=i.height;_!==void 0&&(Mn(s,56),ol(s,Kh(_)));let S=i.jpg;S!==void 0&&(Mn(s,66),Mn(s,S.length),b5(s,S));let w=i.networkType;w!==void 0&&(Mn(s,72),ol(s,Kh(w)));let O=i.osType;O!==void 0&&(Mn(s,80),ol(s,Kh(O)));let W=i.requestId;W!==void 0&&(Mn(s,90),al(s,W));let k=i.sdkVersion;k!==void 0&&(Mn(s,98),al(s,k));let j=i.sequence;j!==void 0&&(Mn(s,104),ol(s,Kh(j)));let H=i.sid;H!==void 0&&(Mn(s,114),al(s,H));let K=i.timestamp;K!==void 0&&(Mn(s,120),ol(s,K));let Q=i.uid;Q!==void 0&&(Mn(s,128),Mn(s,Q));let ie=i.vid;ie!==void 0&&(Mn(s,136),Mn(s,ie));let re=i.width;re!==void 0&&(Mn(s,144),ol(s,Kh(re)));let te=i.service;te!==void 0&&(Mn(s,152),Mn(s,te));let he=i.callbackData;he!==void 0&&(Mn(s,162),Mn(s,he.length),b5(s,he));let Se=i.ticket;Se!==void 0&&(Mn(s,170),al(s,Se));let Ne=i.vendorConfigs;Ne!==void 0&&(Mn(s,178),al(s,Ne))}(n,r),function(i){let s=i.bytes,c=i.limit;return s.length===c?s:s.subarray(0,c)}(r)}function Ype(n){return function(i){let s={};e:for(;!Qpe(i);){let c=Fm(i);switch(c>>>3){case 0:break e;case 1:s.code=Fm(i);break;case 2:s.msg=T5(i,Fm(i));break;case 3:s.requestId=T5(i,Fm(i));break;case 4:s.timestamp=Zpe(i,!1);break;default:Xpe(i,7&c)}}return s}({bytes:r=n,offset:0,limit:r.length});var r}function Xpe(n,r){switch(r){case 0:for(;128&oo(n););break;case 2:_A(n,Fm(n));break;case 5:_A(n,4);break;case 1:_A(n,8);break;default:throw new Error("Unimplemented type: "+r)}}function Kh(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}let Jpe=[];function _A(n,r){if(n.offset+r>n.limit)throw new Error("Skip past limit");n.offset+=r}function Qpe(n){return n.offset>=n.limit}function QE(n,r){let i=n.bytes,s=n.offset,c=n.limit,u=s+r;if(u>i.length){let h=new Uint8Array(2*u);h.set(i),n.bytes=h}return n.offset=u,u>c&&(n.limit=u),s}function S5(n,r){let i=n.offset;if(i+r>n.limit)throw new Error("Read past limit");return n.offset+=r,i}function b5(n,r){let i=QE(n,r.length);n.bytes.set(r,i)}function T5(n,r){let i=S5(n,r),s=String.fromCharCode,c=n.bytes,u="",h="";for(let f=0;f<r;f++){let m,y,_,S,w=c[f+i];128&w?(224&w)==192?f+1>=r?h+=u:(m=c[f+i+1],(192&m)!=128?h+=u:(S=(31&w)<<6|63&m,S<128?h+=u:(h+=s(S),f++))):(240&w)==224?f+2>=r?h+=u:(m=c[f+i+1],y=c[f+i+2],(49344&(m|y<<8))!=32896?h+=u:(S=(15&w)<<12|(63&m)<<6|63&y,S<2048||S>=55296&&S<=57343?h+=u:(h+=s(S),f+=2))):(248&w)==240?f+3>=r?h+=u:(m=c[f+i+1],y=c[f+i+2],_=c[f+i+3],(12632256&(m|y<<8|_<<16))!=8421504?h+=u:(S=(7&w)<<18|(63&m)<<12|(63&y)<<6|63&_,S<65536||S>1114111?h+=u:(S-=65536,h+=s(55296+(S>>10),56320+(1023&S)),f+=3))):h+=u:h+=s(w)}return h}function al(n,r){let i=r.length,s=0;for(let h=0;h<i;h++){let f=r.charCodeAt(h);f>=55296&&f<=56319&&h+1<i&&(f=(f<<10)+r.charCodeAt(++h)-56613888),s+=f<128?1:f<2048?2:f<65536?3:4}Mn(n,s);let c=QE(n,s),u=n.bytes;for(let h=0;h<i;h++){let f=r.charCodeAt(h);f>=55296&&f<=56319&&h+1<i&&(f=(f<<10)+r.charCodeAt(++h)-56613888),f<128?u[c++]=f:(f<2048?u[c++]=f>>6&31|192:(f<65536?u[c++]=f>>12&15|224:(u[c++]=f>>18&7|240,u[c++]=f>>12&63|128),u[c++]=f>>6&63|128),u[c++]=63&f|128)}}function oo(n){return n.bytes[S5(n,1)]}function w5(n,r){let i=QE(n,1);n.bytes[i]=r}function Fm(n){let r,i=0,s=0;do r=oo(n),i<32&&(s|=(127&r)<<i),i+=7;while(128&r);return s}function Mn(n,r){for(r>>>=0;r>=128;)w5(n,127&r|128),r>>>=7;w5(n,r)}function Zpe(n,r){let i,s=0,c=0,u=0;return i=oo(n),s=127&i,128&i&&(i=oo(n),s|=(127&i)<<7,128&i&&(i=oo(n),s|=(127&i)<<14,128&i&&(i=oo(n),s|=(127&i)<<21,128&i&&(i=oo(n),c=127&i,128&i&&(i=oo(n),c|=(127&i)<<7,128&i&&(i=oo(n),c|=(127&i)<<14,128&i&&(i=oo(n),c|=(127&i)<<21,128&i&&(i=oo(n),u=127&i,128&i&&(i=oo(n),u|=(127&i)<<7))))))))),{low:s|c<<28,high:c>>>4|u<<24,unsigned:r}}function ol(n,r){let i=r.low>>>0,s=(r.low>>>28|r.high<<4)>>>0,c=r.high>>>24,u=c===0?s===0?i<16384?i<128?1:2:i<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:c<128?9:10,h=QE(n,u),f=n.bytes;switch(u){case 10:f[h+9]=c>>>7&1;case 9:f[h+8]=u!==9?128|c:127&c;case 8:f[h+7]=u!==8?s>>>21|128:s>>>21&127;case 7:f[h+6]=u!==7?s>>>14|128:s>>>14&127;case 6:f[h+5]=u!==6?s>>>7|128:s>>>7&127;case 5:f[h+4]=u!==5?128|s:127&s;case 4:f[h+3]=u!==4?i>>>21|128:i>>>21&127;case 3:f[h+2]=u!==3?i>>>14|128:i>>>14&127;case 2:f[h+1]=u!==2?i>>>7|128:i>>>7&127;case 1:f[h]=u!==1?128|i:127&i}}const C5={},R5={},O5=4294967296,eme=18446744073709552e3,tme=eme/2;I5(0,!0);const A5=I5(0),nme=Wm(0,-2147483648,!1),rme=Wm(-1,2147483647,!1);function I5(n,r){let i,s,c;return r?(c=0<=(n>>>=0)&&n<256)&&(s=R5[n],s)?s:(i=Wm(n,0,!0),c&&(R5[n]=i),i):(c=-128<=(n|=0)&&n<128)&&(s=C5[n],s)?s:(i=Wm(n,n<0?-1:0,!1),c&&(C5[n]=i),i)}function Wm(n,r,i){return{low:0|n,high:0|r,unsigned:!!i}}function N5(n,r){if(isNaN(n))return A5;{if(n<=-9223372036854776e3)return nme;if(n+1>=tme)return rme}return n<0?A5:Wm(n%O5|0,n/O5|0,r)}function P5(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}class EA extends ln{get connectionState(){return this._connectionState}set connectionState(r){if(this._connectionState===r)return;const i=this._connectionState;this._connectionState=r,this.emit(Bo.CONNECTION_STATE_CHANGE,r,i)}get quality(){return this._quality}set quality(r){this._quality=r>1?1:r<.1?.1:r,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(r){var i;super(),F(this,"name","AgoraRTCImageModeration"),F(this,"_connectionState",Aa.CONNECTING),F(this,"_sequence",0),F(this,"_moderationStartTime",void 0),F(this,"_workerConnection",void 0),F(this,"_workerMessageLengthLimit",void 0),F(this,"_qualityRatio",void 0),F(this,"_connectInfo",void 0),F(this,"_cancelTokenSource",mi.CancelToken.source()),F(this,"_retryConfig",void 0),F(this,"_moderationInterval",void 0),F(this,"_moderationTimer",null),F(this,"_moderationMode",1),F(this,"_quality",1),F(this,"_qualityTimer",null),F(this,"_ticket",void 0),F(this,"_moderationIntervalMinimum",void 0),F(this,"_uploadFailedNum",0),F(this,"_uploadNum",0),F(this,"_uploadTimer",null),F(this,"_extraInfo",void 0),F(this,"_vendor",""),F(this,"_encoder",new TextEncoder),F(this,"_moderationId",void 0),F(this,"inspectImage",()=>{if(this.connectionState!==Aa.CONNECTED)throw new se($.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Aa.CONNECTED?this.requestToInspectImage():A.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=qt(5,"image-moderation-"),this._workerMessageLengthLimit=Y("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Y("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(i=r.interval)!==null&&i!==void 0?i:1e3,r.extraInfo&&(this._extraInfo=this._encoder.encode(r.extraInfo)),r.vendor&&(this._vendor=r.vendor),this._qualityRatio=Y("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new xm("worker-"+this._moderationId,Gn),this.on(Bo.STATE_CHANGE,(s,c)=>{A.debug("[".concat(this._moderationId,"] Moderation operation :").concat(kh[s]," ").concat(c||""))}),this.handleWorkerEvents()}async init(r,i){this.emit(Bo.STATE_CHANGE,kh.CONNECT_AP),this._connectInfo=r;const s=this._cancelTokenSource.token;return this._retryConfig=i,new Ie((c,u)=>{this.on(Bo.CONNECTION_STATE_CHANGE,(h,f)=>{h===Aa.CONNECTED&&c()}),this.requestAP(r,s,i).then(h=>{this.connectWorker(h)}).catch(h=>{u(h)})})}updateConfig(r){var i;this._moderationInterval=(i=r.interval)!==null&&i!==void 0?i:1e3,r.extraInfo&&(this._extraInfo=this._encoder.encode(r.extraInfo)),r.vendor&&(this._vendor=r.vendor),A.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(r))),this.connectionState===Aa.CONNECTED&&this.inspectImage()}async requestAP(r,i,s){const c=Y("WEBCS_DOMAIN").map(m=>"https://".concat(m,"/api/v1")),u=await function(m,y,_,S){let{appId:w,areaCode:O,cname:W,sid:k,token:j,uid:H}=y;Wh++;const K="moderation_plugin",Q={service_name:K,json_body:JSON.stringify({appId:w,areaCode:O,cname:W,command:"allocateEdge",requestId:Wh,seq:Wh,sid:k,appToken:j,ts:Date.now(),uid:H+""})};let ie,re,te=m[0];return Mo(async()=>{ie=Date.now();const he=await Fo(te,{data:Q,cancelToken:_,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(re=Date.now()-ie,he.code!==0){const ke=new se($.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+he.code,{retry:!0,responseTime:re});throw A.error(ke.toString()),ke}const Se=JSON.parse(he.json_body);if(Se.code!==200){const ke=new se($.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(Se.code,", reason: ").concat(Se.reason),{code:Se.code,responseTime:re});throw A.error(ke.toString()),ke}if(!Se.servers||!Array.isArray(Se.servers)||Se.servers.length===0){const ke=new se($.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:Se.code,responseTime:re});throw A.error(ke.toString()),ke}if(!Se.servers.some(ke=>!!ke.wss)){const ke=new se($.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:Se.code,responseTime:re});throw A.error(ke.toString()),ke}const Ne=Y("IMAGE_MODERATION_WORKER_HOST");return{addressList:Se.servers.map(ke=>{let{address:pt,wss:mt}=ke;if(pt&&mt)return"wss://".concat(pt.replace(/\./g,"-"),".").concat(Ne,":").concat(mt,"/moderation")}).filter(ke=>!!ke),workerToken:Se.workerToken,vid:Se.vid,ticket:Se.appTicket,responseTime:re}},(he,Se)=>($e.apworkerEvent(k,{success:!0,sc:200,serviceName:K,responseDetail:JSON.stringify(he.addressList),firstSuccess:Se===0,responseTime:re,serverIp:m[Se%m.length]}),!1),(he,Se)=>($e.apworkerEvent(k,{success:!1,sc:he.data&&he.data.code||200,serviceName:K,responseTime:re,serverIp:m[Se%m.length]}),!!(he.code!==$.OPERATION_ABORTED&&he.code!==$.UNEXPECTED_RESPONSE||he.data&&he.data.retry)&&(te=m[(Se+1)%m.length],!0)),S)}(c,r,i,s);this.emit(Bo.STATE_CHANGE,kh.AP_CONNECTED);const{addressList:h,ticket:f}=u;return this._ticket=f,h}async connectWorker(r){this.emit(Bo.STATE_CHANGE,kh.CONNECT_WORKER),await this._workerConnection.init(r,1e4)}handleWorkerEvents(){this._workerConnection.on(at.CONNECTED,async()=>{this.emit(Bo.STATE_CHANGE,kh.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Aa.CONNECTED}),this._workerConnection.on(at.CLOSED,()=>{this.connectionState=Aa.CLOSED}),this._workerConnection.on(at.FAILED,()=>{this.connectionState=Aa.CLOSED}),this._workerConnection.on(at.RECONNECTING,()=>{this.connectionState=this.connectionState===Aa.CONNECTED?Aa.RECONNECTING:Aa.CONNECTING}),this._workerConnection.on(at.ON_MESSAGE,async r=>{if(r.data instanceof ArrayBuffer){const i=Ype(new Uint8Array(r.data));Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(i)),this._uploadNum++,i.code===void 0||i.code===0||(this._uploadFailedNum++,A.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(i.code,", msg is ").concat(i.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{$e.reportApiInvoke(this._connectInfo.sid||null,{name:Wn.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,i.code],tag:fn.TRACER}).onError(new se($.IMAGE_MODERATION_UPLOAD_FAILED,i.msg)),this._uploadTimer=null},Y("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else A.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(at.WILL_RECONNECT,(r,i,s)=>{r==="recover"&&s(r),s("tryNext")}),this._workerConnection.on(at.REQUEST_NEW_URLS,(r,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r).catch(i)})}static intToLong(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}async requestToInspectImage(){const r=ia(this,Bo.CLIENT_LOCAL_VIDEO_TRACK),i={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(r){if(!r.isPlaying)return void(Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("Only the track being played can be inspected"));this._sequence++;const s=await this.generateRequestData(r,i);this._workerConnection.sendMessage(s,!0,!0)}else Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("Only the track being published can be inspected")}async generateRequestData(r,i){let{appId:s,cname:c,cid:u,vid:h,sid:f,uid:m}=i;const y=Date.now(),_=await r.getCurrentFrameImage("image/jpeg",this.quality),S=await aF(_,s,c),w=this._sequence+"-"+u+"-"+m+"-"+y+"-"+qt(12,""),O={appId:s,cid:u,cname:c,deviceId:"",elapse:EA.intToLong(Number(y-this._moderationStartTime)),fileSize:_.buffer.byteLength,height:_.height,width:_.width,jpg:S,networkType:6,osType:7,requestId:w,sdkVersion:"4.23.1",sequence:this._sequence,sid:f,timestamp:N5(y),uid:m,vid:h,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete O.callbackData;const W=qpe(O);if(W.byteLength<this._workerMessageLengthLimit){if(Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const k=function(j){for(var H=1;H<arguments.length;H++){var K=arguments[H]!=null?arguments[H]:{};H%2?P5(Object(K),!0).forEach(function(Q){F(j,Q,K[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(K)):P5(Object(K)).forEach(function(Q){Object.defineProperty(j,Q,Object.getOwnPropertyDescriptor(K,Q))})}return j}({},O);delete k.jpg,A.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(k))}return W}{const k=this.quality*this._qualityRatio;return this.quality=k,await this.generateRequestData(r,{appId:s,cname:c,cid:u,vid:h,sid:f,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=mi.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Aa.CLOSED,this.emit(Bo.STATE_CHANGE,kh.CLOSED)}}function x5(n){if(Bt(n.interval,"interval",1e3,1/0),n&&n.extraInfo&&n.extraInfo.length>1024)throw new se($.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(n&&n.vendor&&n.vendor.length>1024)throw new se($.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const ime={name:"ImageModeration",create:function(n){let{config:r}=n;return x5(r),new EA(r)}};var D5,L5,k5,M5,U5,j5,V5,B5,F5,W5,G5,$5,H5,z5,K5,q5,Y5,X5,J5,Q5,Z5,e6,t6,n6,r6,i6,a6,o6,s6,c6,l6,u6,d6,h6,f6,p6,m6,g6,y6,v6,_6,De;function E6(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function so(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?E6(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):E6(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}Lr.setLogger(A);let ame=(D5=Xe(),L5=Xe({argsMap:(n,r)=>{if(!Array.isArray(r)){if(!(r instanceof Rh))return[r];r=[r]}return r.map(i=>i?Object(i).toString():"null")}}),k5=Xe({argsMap:(n,r)=>(r||(r=[]),Array.isArray(r)||r.trackMediaType!==Ch.DATA?(Array.isArray(r)||(r=[r]),r.map(i=>i.getTrackId())):[r.getChannelId()])}),M5=Xe({argsMap:(n,r,i,s)=>[typeof r=="object"?r.uid:r,i,s]}),U5=Xe({argsMap:(n,r,i)=>[r,i]}),j5=Xe({argsMap:(n,r)=>r.map(i=>{let{user:s,mediaType:c}=i;return[s==null?void 0:s.uid,c]})}),V5=Xe({argsMap:(n,r,i,s)=>[typeof r=="object"?r.uid:r,i,s]}),B5=Xe({argsMap:(n,r)=>r.map(i=>{let{user:s,mediaType:c}=i;return{uid:s==null?void 0:s.uid,mediaType:c}})}),F5=Xe(),W5=Xe(),G5=Xe(),$5=Xe(),H5=Xe(),z5=Xe(),K5=Xe(),q5=Xe(),Y5=Xe(),X5=Xe(),J5=Xe(),Q5=Xe(),Z5=Xe(),e6=Xe(),t6=Xe(),n6=Xe({argsMap:(n,r)=>[r]}),r6=Xe(),i6=Xe(),a6=Xe(),o6=Xe(),s6=Xe(),c6=Xe(),l6=Xe(),u6=Xe(),d6=Xe({argsMap:(n,r)=>(Array.isArray(r)||(r=[r]),[JSON.stringify(r)])}),h6=Xe(),f6=Xe(),p6=Xe(),m6=Xe(),g6=Xe(),y6=Xe(),v6=Xe({reportResult:!0}),_6=Xe(),De=class extends ln{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var n;return((n=this._config)===null||n===void 0?void 0:n.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(n,r){let i;if(super(),F(this,"store",void 0),F(this,"_uid",void 0),F(this,"_channelName",void 0),F(this,"_uintUid",void 0),F(this,"_users",[]),F(this,"_config",void 0),F(this,"_clientId",void 0),F(this,"_appId",void 0),F(this,"_sessionId",null),F(this,"_key",void 0),F(this,"_rtmConfig",{}),F(this,"_joinInfo",void 0),F(this,"_gateway",void 0),F(this,"_statsCollector",void 0),F(this,"_configDistribute",void 0),F(this,"_leaveMutex",void 0),F(this,"_publishMutex",void 0),F(this,"_renewTokenMutex",void 0),F(this,"_subscribeMutex",void 0),F(this,"_encryptionMode","none"),F(this,"_encryptionSecret",null),F(this,"_encryptionSalt",null),F(this,"_encryptDataStream",!1),F(this,"_encryptDataStreamKey",null),F(this,"_encryptDataStreamIv",null),F(this,"_proxyServer",void 0),F(this,"_turnServer",{servers:[],mode:"auto"}),F(this,"_cloudProxyServerMode","disabled"),F(this,"_isDualStreamEnabled",!1),F(this,"_defaultStreamFallbackType",void 0),F(this,"_lowStreamParameter",void 0),F(this,"_streamFallbackTypeCacheMap",new Map),F(this,"_remoteStreamTypeCacheMap",new Map),F(this,"_axiosCancelSource",mi.CancelToken.source()),F(this,"_audioVolumeIndicationInterval",void 0),F(this,"_networkQualityInterval",void 0),F(this,"_userOfflineTimeout",void 0),F(this,"_streamRemovedTimeout",void 0),F(this,"_liveTranscodeStreamingClient",void 0),F(this,"_liveRawStreamingClient",void 0),F(this,"_channelMediaRelayClient",void 0),F(this,"_networkQualitySensitivity","normal"),F(this,"_p2pChannel",void 0),F(this,"_useLocalAccessPoint",!1),F(this,"_setLocalAPVersion",void 0),F(this,"_joinAndNotLeaveYet",!1),F(this,"_numberOfJoinCount",0),F(this,"_remoteDefaultVideoStreamType",void 0),F(this,"_inspect",void 0),F(this,"_moderation",void 0),F(this,"_license",void 0),F(this,"_pendingPublishedUsers",[]),F(this,"ntpAlignErrorCount",0),F(this,"remoteInboundOffset",0),F(this,"_peerConnectionState",void 0),F(this,"_handleLocalTrackEnable",(c,u,h)=>{this.publish(c,!1).then(u).catch(h)}),F(this,"_handleLocalTrackDisable",(c,u,h)=>{this.unpublish(c).then(u).catch(h)}),F(this,"_handleUserOnline",c=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(c.uid,this.channelName))return void A.debug("[".concat(c.uid,"] will be ignored in local"));this.isStringUID&&typeof c.uid!="string"&&A.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const u=this._users.find(h=>h.uid===c.uid);if(u)u._trust_in_room_=!0,u._is_pre_created&&(u._is_pre_created=!1,this.safeEmit(dt.USER_JOINED,u));else{const h=new rl(c.uid,c.uint_id||c.uid);this._users.push(h),A.debug("[".concat(this._clientId,"] user online"),c.uid),this.safeEmit(dt.USER_JOINED,h)}}),F(this,"_handleUserOffline",c=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(c.uid,this.channelName))return;const u=this._users.find(h=>h.uid===c.uid);u&&(this._handleRemoveStream(c),this._handleRemoveDataChannels(c),u._audio_pre_subscribed||u._video_pre_subscribed?u._is_pre_created=!0:tE(this._users,u),this._remoteStreamTypeCacheMap.delete(u.uid),this._streamFallbackTypeCacheMap.delete(u.uid),A.debug("[".concat(this._clientId,"] user offline"),c.uid,"reason:",c.reason),this.safeEmit(dt.USER_LEAVED,u,c.reason))}),F(this,"_handleAddAudioOrVideoStream",(c,u,h,f,m,y,_)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(u,this.channelName))return;const S=this._users.find(O=>O.uid===u);if(!S)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));A.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(c)),this.store.subscribe(S.uid,c,void 0,void 0,void 0,Date.now());const w=c==="audio"?S.hasAudio:S.hasVideo;S._uintid||(S._uintid=m||u),c==="audio"?S._trust_audio_stream_added_state_=!0:S._trust_video_stream_added_state_=!0,c==="audio"?(S._audio_added_=!0,h!==void 0&&(S._audioSSRC=h),f!==void 0&&(S._cname=f),y&&(S._audioOrtc=y)):(S._video_added_=!0,h!==void 0&&(S._videoSSRC=h),f!==void 0&&(S._cname=f),_!==void 0&&(S._rtxSsrcId=_),y&&(S._videoOrtc=y)),(c==="audio"?S.hasAudio:S.hasVideo)&&!w&&(A.info("[".concat(this._clientId,"] remote user ").concat(S.uid," published ").concat(c)),this.safeEmit(dt.USER_PUBLISHED,S,c)),c==="video"?$e.onGatewayStream(this._sessionId,nr.ON_ADD_VIDEO_STREAM,on.ON_ADD_VIDEO_STREAM,{peer:m||u,ssrc:S._videoSSRC}):$e.onGatewayStream(this._sessionId,nr.ON_ADD_AUDIO_STREAM,on.ON_ADD_AUDIO_STREAM,{peer:m||u,ssrc:S._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(S,c,h).then(O=>{if(O&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(S.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Bm))return this._p2pChannel.unsubscribe(S,c,!0).then(()=>this._subscribe(S,c,!0).catch(W=>{A.error("[".concat(this._clientId,"] resubscribe error"),W.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(S,c)&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(S.uid," after reconnect.")),this._subscribe(S,c,!0).catch(O=>{A.error("[".concat(this._clientId,"] resubscribe error"),O.toString())}))}),F(this,"_handleRemoveStream",c=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(c.uid,this.channelName))return;const u=this._users.find(f=>f.uid===c.uid);if(!u)return void A.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));A.debug("[".concat(this._clientId,"] stream removed with uid ").concat(c.uid));let h=()=>{};u.hasAudio&&u.hasVideo?h=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(dt.USER_UNPUBLISHED,u,"audio"),A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(dt.USER_UNPUBLISHED,u,"video")}:u.hasVideo?h=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(dt.USER_UNPUBLISHED,u,"video")}:u.hasAudio&&(h=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(dt.USER_UNPUBLISHED,u,"audio")}),u._video_pre_subscribed||u._audio_pre_subscribed||(u._trust_audio_stream_added_state_=!0,u._trust_video_stream_added_state_=!0,u._audio_added_=!1,u._video_added_=!1,this._p2pChannel instanceof Bm&&this._p2pChannel.unsubscribe(u).then(f=>{if(f)return this._gateway.unsubscribe(f,u.uid)}),u._audioSSRC=void 0,u._videoSSRC=void 0,u._audioOrtc=void 0,u._videoOrtc=void 0,u._rtxSsrcId=void 0),$e.onGatewayStream(this._sessionId,nr.ON_REMOVE_STREAM,on.ON_REMOVE_STREAM,{peer:c.uint_id||c.uid}),h()}),F(this,"_handleSetStreamLocalEnable",(c,u,h)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(u,this.channelName))return;const f=this._users.find(_=>_.uid===u);if(!f)return void A.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));A.debug("[".concat(this._clientId,"] local ").concat(c," ").concat(h?"enabled":"disabled"," with uid ").concat(u));const m=c==="audio"?f.hasAudio:f.hasVideo;if(c==="audio"){f._trust_audio_enabled_state_=!0;const _=f._audio_enabled_;if(f._audio_enabled_=h,f._audio_enabled_===_)return;{const S=f._audio_enabled_?"enable-local-audio":"disable-local-audio";A.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(u,", msg: ").concat(S)),this.safeEmit(dt.USER_INFO_UPDATED,u,S)}}else{f._trust_video_enabled_state_=!0;const _=f._video_enabled_;if(f._video_enabled_=h,f._video_enabled_===_)return;{const S=f._video_enabled_?"enable-local-video":"disable-local-video";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(S)),this.safeEmit(dt.USER_INFO_UPDATED,u,S)}}const y=c==="audio"?f.hasAudio:f.hasVideo;return m!==y?!m&&y?(A.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(c)),void this.safeEmit(dt.USER_PUBLISHED,f,c)):(c==="video"&&f._videoTrack&&f._videoTrack._destroy(),c==="audio"&&f._audioTrack,this._p2pChannel.muteRemote(f,c),A.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(c)),void this.safeEmit(dt.USER_UNPUBLISHED,f,c)):void 0}),F(this,"_handleMuteStream",(c,u,h)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Lu(c,this.channelName))return;A.debug("[".concat(this._clientId,"] receive mute message"),c,u,h);const f=this._users.find(_=>_.uid===c);if(!f)return void A.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(c));const m=u==="audio"?f.hasAudio:f.hasVideo;if(u==="audio"){f._trust_audio_mute_state_=!0;const _=f._audio_muted_;if(f._audio_muted_=h,f._audio_muted_===_)return;{const S=f._audio_muted_?"mute-audio":"unmute-audio";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(S)),this.safeEmit(dt.USER_INFO_UPDATED,c,S)}}else{f._trust_video_mute_state_=!0;const _=f._video_muted_;if(f._video_muted_=h,f._video_muted_===_)return;{const S=f._video_muted_?"mute-video":"unmute-video";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(S)),this.safeEmit(dt.USER_INFO_UPDATED,c,S)}}const y=u==="audio"?f.hasAudio:f.hasVideo;if(m!==y){if(!m&&y)return(u==="audio"?f._audioSSRC:f._videoSSRC)?(A.info("[".concat(this._clientId,"] remote user ").concat(c," published ").concat(u)),void this.safeEmit(dt.USER_PUBLISHED,f,u)):void A.warning("[".concat(this._clientId,"] remote user ").concat(c," receive ").concat(u," unmute message  before add stream message, ").concat(u," SSRC doesn't exist yet."));u==="video"&&f._videoTrack&&!f._video_pre_subscribed&&f._videoTrack._destroy(),u==="audio"&&f._audioTrack,this._p2pChannel.muteRemote(f,u),A.info("[".concat(this._clientId,"] remote user ").concat(c," unpublished ").concat(u)),this.safeEmit(dt.USER_UNPUBLISHED,f,u)}}),F(this,"_handleP2PLost",async c=>{A.debug("[".concat(this._clientId,"] receive p2p lost"),c),parseInt(c.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():A.warning("[".concat(this._clientId,"] P2PLost stream not found"),c)}),F(this,"_handleTokenWillExpire",()=>{A.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(dt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),F(this,"_handleBeforeUnload",c=>{c.type==="beforeunload"&&c.returnValue!==void 0&&c.returnValue!==""||(this.leave(),A.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),F(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(dt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const c={downlinkNetworkQuality:0,uplinkNetworkQuality:0};c.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),c.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(dt.NETWORK_QUALITY,c)}),F(this,"_handleP2PAddAudioOrVideoStream",(c,u,h,f)=>{const m=this._users.find(_=>_.uid===u);if(!m)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));A.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(c)),this.store.subscribe(m.uid,c,void 0,void 0,void 0,Date.now());const y=c==="audio"?m.hasAudio:m.hasVideo;c==="audio"?m._trust_audio_stream_added_state_=!0:m._trust_video_stream_added_state_=!0,c==="audio"?(m._audio_added_=!0,h!==void 0&&(m._audioSSRC=h),f!==void 0&&(m._audioMid=f)):(m._video_added_=!0,h!==void 0&&(m._videoSSRC=h),f!==void 0&&(m._videoMid=f)),(c==="audio"?m.hasAudio:m.hasVideo)&&!y&&(A.info("[".concat(this._clientId,"] remote user ").concat(m.uid," published ").concat(c)),this.safeEmit(dt.USER_PUBLISHED,m,c)),this._p2pChannel.hasPendingRemoteMedia(m,c)&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(m.uid," after reconnect.")),this._subscribe(m,c,!0).catch(_=>{A.error("[".concat(this._clientId,"] resubscribe error"),_.toString())}))}),this._config=n,this._clientId=r||qt(5,"client-"),this.store=new Qhe(n.codec,n.audioCodec,n.mode,this._clientId),this._leaveMutex=new Lr("client-leave",this._clientId),this._publishMutex=new Lr("client-publish",this._clientId),this._renewTokenMutex=new Lr("client-renewtoken",this._clientId),this._subscribeMutex=new Lr("client-subscribe",this._clientId),this.store.clientCreated(),n.proxyServer&&this.setProxyServer(n.proxyServer,!0),n.turnServer&&this.setTurnServer(n.turnServer,!0),A.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Ca," build: ").concat(fO,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),n.clientRoleOptions)try{eO(n.clientRoleOptions),i=Object.assign({},n.clientRoleOptions)}catch(c){A.warning("[".concat(this._clientId,"] ").concat(c.toString()))}var s;this._statsCollector=new jm(this.store),this._statsCollector.onStatsException=(c,u,h)=>{A.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(c,", msg: ").concat(u,", uid: ").concat(h)),this.safeEmit(dt.EXCEPTION,{code:c,msg:u,uid:h})},this._statsCollector.onUploadPublishDuration=(c,u,h,f)=>{const m=this._users.find(y=>y.uid===c);m&&$e.peerPublishStatus(this._sessionId,{subscribeElapse:f,audioPublishDuration:u,videoPublishDuration:h,peer:m._uintid})},this.store.useP2P=n.mode==="p2p",this._gateway=new Cpe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:n.websocketRetryConfig||Gn,httpRetryConfig:n.httpRetryConfig||Gn,forceWaitGatewayResponse:n.forceWaitGatewayResponse===void 0||n.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:n.role,clientRoleOptions:i}),this._configDistribute=new Lpe(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(s={store:this.store,statsCollector:this._statsCollector},nl("P2PChannel").create(s)),this._handleP2PEvents()):this._p2pChannel=new Bm(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(n,r,i,s,c){let u=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],h=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Ut("JOIN_GATEWAY_USE_443PORT_ONLY",u),Ut("JOIN_GATEWAY_USE_DUAL_DOMAIN",h);const f=this._gateway.signal.websocket;return f instanceof HO&&(f.use443PortOnly=u,f.tryDoubleDomain=h),async function(m,y,_){X_.get(m)||X_.set(m,[]),J_.get(m)||J_.set(m,y),fs.get(m)||fs.set(m,0);const S=X_.get(m),w=J_.get(m);if(!S||!w)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(fs.get(m)===w){const H=ym();S.push(H),await H.promise}fs.set(m,fs.get(m)+1);for(var O=arguments.length,W=new Array(O>3?O-3:0),k=3;k<O;k++)W[k-3]=arguments[k];const j=await _(...W);return fs.set(m,fs.get(m)-1),fs.get(m)===w-1&&S.length>0&&(S[0].resolve(),S.shift()),fs.get(m)===0&&(X_.set(m,[]),J_.set(m,0),fs.set(m,0)),j}("client.join",Y("JOIN_MAX_CONCURRENCY"),this.join.bind(this),n,r,i,s,c)}async join(n,r,i,s,c){const u=++this._numberOfJoinCount;this.store.joinStart(),s&&(this.store.uid=s);const h=(iE||iE||(iE=(window.location.protocol.split(":")[0]||"").toUpperCase(),iE))==="HTTPS",f=SB()?window.isSecureContext:"Browser Not Support";(!SB()&&!h||!window.isSecureContext)&&A.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),A.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),$e.setAppId(n);try{if(!i&&i!==null)throw new se($.INVALID_PARAMS,"Invalid token: ".concat(i,". If you don not use token, set it to null"));i&&vr(i,"token",1,2047),vr(n,"appid",1,2047),RE(r),s&&OE(s),c&&vr(c,"optionalInfo",1,2047)}catch(k){throw $e.reportApiInvoke(Ru(),{name:Wn.JOIN,options:[n,r,i,s],states:{isHttps:h,isSecureContext:f},tag:fn.TRACER}).onError(k),k}if(this._leaveMutex.isLocked&&(A.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),A.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const k=new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw $e.reportApiInvoke(Ru(),{name:Wn.JOIN,options:[n,r,i,s],states:{isHttps:h,isSecureContext:f},tag:fn.TRACER}).onError(k),k}this._gateway.state="CONNECTING";const m=await m5({appId:n,cname:r,uid:s,stringUid:typeof s=="string"?s:void 0,token:i||n,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const y=(m==null?void 0:m.sid)||Ru();A.info("[".concat(this._clientId,"] start join channel ").concat(r,", join number: ").concat(u)),this._sessionId||(this._sessionId=y,this.store.sessionId=this._sessionId);const _=$e.reportApiInvoke(y,{id:this._clientId,name:Wn.JOIN,options:[n,r,i,s],states:{isHttps:h,isSecureContext:f},tag:fn.TRACER}),S=so(so(so({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:n,sid:this._sessionId,cname:r,uid:typeof s!="string"?s:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:i||n,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:c,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!m},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:Y("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(S.setLocalAPVersion=this._setLocalAPVersion),typeof s=="string"&&(S.stringUid=s,this._uintUid?(S.uid=this._uintUid,this._uintUid=void 0):S.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(S.aesmode=this._encryptionMode,S.aespassword=await(async k=>{const j=function(){const ie=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),re=new Uint8Array(new ArrayBuffer(ie.length));for(let te=0;te<ie.length;te+=1)re[te]=ie.charCodeAt(te);return re}(),H=await window.crypto.subtle.importKey("spki",j,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),K=Q0(k),Q=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},H,K);return function(ie){let re="";for(let te=0;te<ie.length;te+=1)re+=String.fromCharCode(ie[te]);return window.btoa(re)}(new Uint8Array(Q))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(S.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const k=new TextEncoder,j=Y("USE_PURE_ENCRYPTION_MASTER_KEY")?k.encode(S.appId+this._encryptionSecret+this._encryptionSecret):k.encode(S.appId+S.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(H,K,Q){const ie=await window.crypto.subtle.importKey("raw",K,"PBKDF2",!1,["deriveBits","deriveKey"]),re=H==="aes-128-gcm2"?128:256,te=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:Q},ie,re+96);return new Uint8Array(te).subarray(re/8)}(this._encryptionMode,j,Cu(this._encryptionSalt)),this._encryptDataStreamKey=await async function(H,K,Q){const ie=await window.crypto.subtle.importKey("raw",K,"PBKDF2",!1,["deriveBits","deriveKey"]),re=H==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:Q},ie,{name:"AES-GCM",length:re},!0,["encrypt","decrypt"])}(this._encryptionMode,j,Cu(this._encryptionSalt))}else f?A.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):A.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,A.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:r,appId:n,stringUid:S.stringUid});const w=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&w===this._sessionId&&$e.joinChannelTimeout(this._sessionId,5)},5e3);try{var O;let k;const j=S.cloudProxyServer;if(Oe(O=["proxy3","proxy4","proxy5"]).call(O,j)){const re=Y("PROXY_SERVER_TYPE3");Array.isArray(re)?S.proxyServer=re[0]:S.proxyServer=re}if($e.setProxyServer(S.proxyServer),A.setProxyServer(S.proxyServer),this.store.requestAPStart(),m){if(A.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(S.stringUid?", ".concat(S.stringUid," => ").concat(m.intUid):""," ")),S.stringUid&&!S.uid&&(S.uid=m.intUid),k={gatewayInfo:m.ap.gatewayInfo},Y("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&S.turnServer.mode==="auto")if(m.ap.proxyInfo.addresses.length===0)A.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const re=(await s4(m.ap.proxyInfo,m.ap.gatewayInfo.uid)).map(te=>({turnServerURL:te.address,tcpport:te.tcpport||Ar.tcpport,udpport:te.udpport||Ar.udpport,username:te.username||Ar.username,password:te.password||Ar.password,forceturn:!1,security:!0}));S.turnServer={mode:"manual",servers:re}}v5(m,S.stringUid)}else{if(S.stringUid&&!S.uid){let re;[re,k]=await Ie.all([k4(S.stringUid,S,this._axiosCancelSource.token,this._config.httpRetryConfig||Gn,this.store),L4(S,this._axiosCancelSource.token,this._config.httpRetryConfig||Gn,!0,this.store)]),A.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(S.stringUid," => ").concat(re)),S.uid=re,k.gatewayInfo.uid=re,k.gatewayInfo.res.uid=re}else k=await L4(S,this._axiosCancelSource.token,this._config.httpRetryConfig||Gn,!0,this.store);if(!this._joinAndNotLeaveYet)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(S,this._axiosCancelSource.token),this._configDistribute.on(Nm.UPDATE_BITRATE_LIMIT,re=>{this._p2pChannel.updateBitrateLimit(re)}),this._configDistribute.on(Nm.UPDATE_CLIENT_ROLE_OPTIONS,re=>{this._setClientRoleOptions(re)})},0),this._key=i||n;const H=k.gatewayInfo,K=S.uid?S.uid:H.uid;this._joinInfo=so(so({},S),{},{cid:H.cid,uid:K,vid:H.vid,apResponse:H.res,apGatewayAddress:H.apGatewayAddress,uni_lbs_ip:H.uni_lbs_ip,gatewayAddrs:H.gatewayAddrs}),this.store.intUid=K,this.store.cid=H.cid;const Q=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));_.onSuccess(Q),this._appId=n,this._channelName=S.cname,this._uid=Q,this.store.uid=Q,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Cr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const ie=S.stringUid?"string uid: ".concat(S.stringUid,",uid: ").concat(S.uid):"uid: ".concat(this._uid);return A.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(r,",").concat(ie)),setTimeout(()=>{A.startUpload()},5e3),this.store.joinEnd(),W=this,Oe(Du).call(Du,W)||Du.push(W),this._cloudProxyServerMode==="disabled"&&bt().supportWebCrypto&&Y("ENABLE_PRELOAD")&&vA(this._joinInfo),Q}catch(k){const j=Array.isArray(k)?k[0]:k;throw j&&j.code===$.OPERATION_ABORTED?A.warning("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),j):A.error("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),j),j.code!==$.OPERATION_ABORTED&&this._numberOfJoinCount===u&&(this._gateway.state="DISCONNECTED",this._reset()),_.onError(j),j}var W}_joinGateway(){if(!this._joinInfo||!this._key)throw new se($.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!Y("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){A.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Cr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(r){const i=Du.indexOf(r);i!==-1&&Du.splice(i,1)}(this),this._statsCollector.stopUpdateStats();const n=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return A.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void n();await this._gateway.leave(this.connectionState!=="CONNECTED",Pt.LEAVE),A.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),n()}async publish(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(n)){if(!(n instanceof Rh))return this._publishDataChannel(n);n=[n]}if(n.length===0)throw new se($.INVALID_PARAMS,"param list is empty");const i=n;if(this._gateway.role==="audience")throw new se($.INVALID_OPERATION,"audience can not publish stream");for(const c of i){if(!(c instanceof Rh))throw new se($.INVALID_PARAMS,"parameter is not local track");if(!c._enabled&&r)throw new se($.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(c.getTrackId()))}A.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(i.map(c=>"".concat(c.getTrackId()," "))));const s=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),r&&i.forEach(c=>{const u=this._configDistribute.getBitrateLimit();c instanceof tn&&u&&c.setBitrateLimit(u.uplink)});try{await this._publishHighStream(i),A.info("[".concat(this._clientId,"] Publish success, id ").concat(i.map(c=>"".concat(c.getTrackId()," "))))}catch(c){throw A.error("[".concat(this._clientId,"] publish error"),c.toString()),c}finally{s()}}async _publishDataChannel(n){Bt(n.id,"id",0,65535,!0),Qs(n.ordered,"ordered"),vr(n.metadata,"metadata",0,512),A.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(n.id));const r=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(c=>c.id===n.id)!==-1)throw new se($.INVALID_PARAMS,"Invalid id: ".concat(n.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new se($.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Y("FORCE_TURN")&&!Y("TURN_ENABLE_TCP")&&!Y("TURN_ENABLE_UDP"))throw new se($.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const i=function(c){return C4(c,!1)}(n),s=await this._p2pChannel.publishDataChannel([i]);if(s.length>0){if(typeof i._originDataChannelId!="number")throw A.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new se($.CREATE_DATACHANNEL_ERROR);try{await Ie.all(s.map(c=>this._uid&&this._gateway.publishDataChannel(this._uid,c,!0))),await i._waitTillOpen()}catch(c){if(c.code!==$.DISCONNECT_P2P)throw c}}return A.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(i.id)),i}catch(i){throw A.error("[".concat(this._clientId,"] publish datachannels error"),i.toString()),i}finally{r()}}async unpublish(n){if(!this._joinInfo||this._uid===void 0)throw new se($.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let r=[];if(n)if(Array.isArray(n))r=n;else{if(!(n instanceof Rh))return this._unpublishDataChannel([n]);r=[n]}else this.store.useP2P||await this._unpublishDataChannel(),r=this._p2pChannel.getAllTracks(!0);A.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(r.map(s=>"".concat(s.getTrackId()," "))," "));const i=await this._publishMutex.lock();try{if(this.store.useP2P){const s=await this._p2pChannel.unpublish(r);s&&await this._gateway.sendExtensionMessage(On.UNPUBLISH,{unpubMsg:s},!0)}else{const s=await this._p2pChannel.unpublish(r);s&&await this._gateway.unpublish(s,this._uid),A.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(r.map(c=>"".concat(c.getTrackId()))))}}catch(s){throw A.error("[".concat(this._clientId,"] unpublish error"),s.toString()),s}finally{i&&i()}}async _unpublishDataChannel(n){n!==void 0&&n.length!==0||(n=this._p2pChannel.getAllDataChannels()),A.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(n.map(i=>"".concat(i.id," "))," "));const r=await this._publishMutex.lock();try{const i=await this._p2pChannel.unpublishDataChannel(n);i&&await this._gateway.unpublishDataChannel(i),A.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(n.map(s=>"".concat(s.id))))}catch(i){throw A.error("[".concat(this._clientId,"] unpublish dataChannel error"),i.toString()),i}finally{r&&r()}}async subscribe(n,r,i){if(!(n instanceof rl)){const s=this.remoteUsers.find(c=>c.uid===n);if(!s)throw new se($.INVALID_REMOTE_USER,"user is not in the channel");n=s}return r==="datachannel"?this._subscribeDataChannel(n,i):this._subscribe(n,r)}async presubscribe(n,r){if(Jn(r,"mediaType",["audio","video"]),this.store.useP2P)throw new se($.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new se($.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const i=r===Ue.AUDIO,s=r===Ue.VIDEO,c=await this._subscribeMutex.lock();try{const{ssrcId:u,ortc:h,rtxSsrcId:f,cname:m,uint_id:y}=await this._gateway.presubscribe(n,r,!0);if(u==null)throw new se($.UNEXPECTED_RESPONSE,"no ssrc id");let _=this._users.find(w=>w.uid===n);_||(_=new rl(n,y||n),_._is_pre_created=!0,this._users.push(_)),m&&(_._cname=m),_._uintid||(_._uintid=y||n),i&&(_._audioSSRC=u,_._audio_pre_subscribed=!0,h&&(_._audioOrtc=h)),s&&(_._videoSSRC=u,_._video_pre_subscribed=!0,h&&(_._videoOrtc=h),f!=null&&(_._rtxSsrcId=f)),A.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(u)),await this._p2pChannel.subscribe(_,r,u,f,h);const S=i?_._audioTrack:_._videoTrack;if(!S)throw new se($.UNEXPECTED_ERROR,"can not find remote track in user");return i&&(_._trust_audio_stream_added_state_=!0,_._audio_added_=!0),s&&(_._trust_video_stream_added_state_=!0,_._video_added_=!0),S}catch(u){throw A.error("[".concat(this._clientId,"] presub user ").concat(n," error"),u),u}finally{c()}}async _subscribeDataChannel(n,r){var i;if(Bt(r,"channelId",0,65535,!0),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===n))throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),new se($.INVALID_REMOTE_USER,"user is not in the channel");if(!n.hasAudio&&!n.hasVideo&&n._dataChannels.length===0)throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),new se($.INVALID_REMOTE_USER,"user is not published");const c=(i=n._dataChannels)===null||i===void 0?void 0:i.find(f=>f.id===r);if(!c)throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, remote datachannel is not published")),new se($.REMOTE_USER_IS_NOT_PUBLISHED);const u=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: datachannel"));try{const f=await this._p2pChannel.subscribeDataChannel(n,[c]);if(f&&Oe(f).call(f,c.id))try{var h;if(typeof c._originDataChannelId!="number")throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, cannot get RTCDatachannel")),new se($.CREATE_DATACHANNEL_ERROR);const m={id:c.id,datachannelId:c._originDataChannelId,ordered:c.ordered,maxRetransmits:c.maxRetransmits,metadata:(h=c.metadata)!==null&&h!==void 0?h:""};await this._gateway.subscribeDataChannel(n.uid,m,!0),await c._waitTillOpen()}catch(m){if((m==null?void 0:m.code)!==$.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(n,[c]),m;await this._p2pChannel.unsubscribeDataChannel(n,[c]),this._p2pChannel.setPendingRemoteDataChannel(n,c.id)}return A.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: datachannel")),c}finally{u()}}async _p2pSubscribe(n,r,i){if(Jn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(u=>u===n)){const u=new se($.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),u}if(!n.hasAudio&&!n.hasVideo){const u=new se($.INVALID_REMOTE_USER,"user is not published");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),u}if(!i&&(r==="audio"&&!n.hasAudio||r==="video"&&!n.hasVideo)){const u=new se($.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(r,", remote track is not published")),u}const c=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,r))await this._p2pChannel.unmuteRemote(n,r);else try{const h=r==="audio"?n._audioSSRC:n._videoSSRC,f=r==="audio"?n._audioMid:n._videoMid;this.store.subscribe(n.uid,r,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(n,r,h,f)}catch(h){throw h}A.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(h=>{A.warning("[".concat(this._clientId,"] auto set fallback failed"),h)});const u=r==="audio"?n._audioTrack:n._videoTrack;if(!u)throw new se($.UNEXPECTED_ERROR,"can not find remote track in user object");return u}catch(u){throw A.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),u),u}finally{c()}}async _subscribe(n,r,i){if(this.store.useP2P)return this._p2pSubscribe(n,r);if(Jn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(y=>y===n)){const y=new se($.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),y}if(!n.hasAudio&&!n.hasVideo){const y=new se($.INVALID_REMOTE_USER,"user is not published");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),y}if(!(i||(r!=="audio"||n.hasAudio&&n._audioSSRC!==void 0)&&(r!=="video"||n.hasVideo&&n._videoSSRC!==void 0))){const y=new se($.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(r,", remote track is not published")),y}let c=r==="audio"?n._audioSSRC:n._videoSSRC,u=r==="audio"?n._audioOrtc:n._videoOrtc,h=r==="video"?n._rtxSsrcId:void 0,f={stream_type:r==="audio"?Ue.AUDIO:Ue.VIDEO,ssrcId:c};const m=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,r))await this._p2pChannel.unmuteRemote(n,r);else try{const _=r==="audio"?n._audioSSRC:n._videoSSRC;_!==void 0&&_!==c&&(c=_,u=r==="audio"?n._audioOrtc:n._videoOrtc,h=r==="video"?n._rtxSsrcId:void 0,f={stream_type:r==="audio"?Ue.AUDIO:Ue.VIDEO,ssrcId:c}),Mr.markSubscribeStart(this.store.clientId,c),this.store.subscribe(n.uid,r,Date.now()),await this._p2pChannel.subscribe(n,r,c,h,u);try{this._p2pChannel.isPreSubScribe(c)||await this._gateway.subscribe(n.uid,f,!0)}catch(S){if((S==null?void 0:S.code)!==$.WS_ABORT)throw await this._p2pChannel.unsubscribe(n,r),S;await this._p2pChannel.unsubscribe(n,r,!0),this._p2pChannel.setPendingRemoteMedia(n,r)}this.store.subscribe(n.uid,r,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,n,r)}catch(_){throw this._p2pChannel.reportSubscribeEvent(!1,_==null?void 0:_.code,n,r),_}A.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(_=>{A.warning("[".concat(this._clientId,"] auto set fallback failed"),_)});const y=r==="audio"?n._audioTrack:n._videoTrack;if(!y)throw new se($.UNEXPECTED_ERROR,"can not find remote track in user object");return y}catch(y){throw A.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),y),y}finally{m()}}async massSubscribe(n){if(Zs(n,"subscribeList"),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=Date.now(),i=new Map,s=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"]start massSubscribe user ").concat(n.map(f=>{let{user:m,mediaType:y}=f;return"user: ".concat(m==null?void 0:m.uid,", mediaType: ").concat(y)}).join("; ")));const c=(n=[...n]).map(f=>{let{user:m,mediaType:y}=f;return{user:m,mediaType:y}}),u=await this._p2pChannel.globalLock();try{var h;for(let m=n.length-1;m>=0;m--){const y=n[m],{user:_,mediaType:S}=y;if(Jn(S,"mediaType",["audio","video"]),!_){const k=new se($.INVALID_PARAMS,"user property does not exist in subscribeList item");throw A.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),k}if(!this._users.find(k=>k===_)){const k=new se($.INVALID_REMOTE_USER,"user is not in the channel");A.error("[".concat(this._clientId,"] can not massSubscribe ").concat(_.uid,", this user is not in the channel")),c[m].error=k,n.splice(m,1);continue}if(S==="audio"&&(!_.hasAudio||_._audioSSRC===void 0)||S==="video"&&(!_.hasVideo||_._videoSSRC===void 0)){const k=new se($.REMOTE_USER_IS_NOT_PUBLISHED);A.error("[".concat(this._clientId,"] can not subscribe ").concat(_.uid," with mediaType ").concat(S,", remote user is not published")),c[m].error=k,n.splice(m,1);continue}const O=rr.Video|rr.LwoVideo,W=i.get(_);if(W){if(S==="video"?W&O:W&rr.Audio){n.splice(m,1),A.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(_.uid,", mediaType:").concat(S," twice"));continue}i.set(_,W|(S==="video"?O:rr.Audio))}else i.set(_,S==="video"?O:rr.Audio)}for(let m=n.length-1;m>=0;m--){const y=n[m],{user:_,mediaType:S}=y,w=rr.Video|rr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(_,S)){await this._p2pChannel.unmuteRemoteNoLock(_,S);const O=i.get(_);i.set(_,S==="video"?O^w:O^rr.Audio),n.splice(m,1)}}this.store.massSubscribe(n.map(m=>({userId:m.user.uid,type:m.mediaType})),r);let f=Ao(h=Array.from(i.entries())).call(h,(m,y)=>{let[_,S]=y;if(S===0)return m;const w={stream_id:_.uid,stream_type:S};return S&rr.Audio&&(w.audio_ssrc=_._audioSSRC),S&rr.Video&&(w.video_ssrc=_._videoSSRC),m.push(w),m},[]);try{n.length>0&&await this._p2pChannel.massSubscribeNoLock(n.map(y=>{let{user:_,mediaType:S}=y;return{user:_,mediaType:S,ssrcId:S===Ue.VIDEO?_._videoSSRC:_._audioSSRC,rtxSsrcId:S===Ue.VIDEO?_._rtxSsrcId:void 0}}));const m=new Map;if(f=f.filter(y=>y.video_ssrc&&!this._p2pChannel.isPreSubScribe(y.video_ssrc)||y.audio_ssrc&&!this._p2pChannel.isPreSubScribe(y.audio_ssrc)||!y.video_ssrc&&!y.audio_ssrc),f.length>0){const y=await this._gateway.subscribeAll(f,!0);((y==null?void 0:y.users)||[]).forEach(_=>{let{stream_id:S,video_error_code:w,audio_error_code:O,error_code:W}=_;(w||O||W)&&m.set(S,{video_error_code:w,audio_error_code:O,error_code:W})})}if(Array.from(m.entries()).length>0){const y=[];Array.from(m.entries()).forEach(_=>{let[S,w]=_;const O=this.remoteUsers.find(W=>W.uid===S);if(O){let W;w.error_code||w.video_error_code&&w.audio_error_code?W=void 0:w.video_error_code?W=Ue.VIDEO:w.audio_error_code&&(W=Ue.AUDIO),y.push({user:O,mediaType:W})}}),y.length>0&&await this._p2pChannel.massUnsubscribeNoLock(y)}for(const y of c){const _=m.get(y.user.uid);if(_){const S=_.error_code||y.mediaType==="audio"&&_.audio_error_code||y.mediaType==="video"&&_.video_error_code;if(S){const w=Pm(S);A.error("user:".concat(y.user.uid," mediaType:").concat(y.mediaType," has massSubscribe error ").concat(w.desc)),y.error=new se($.SUBSCRIBE_FAILED,"code ".concat(S,": ").concat(w.desc))}}y.error||(y.mediaType==="video"?y.track=y.user.videoTrack:y.track=y.user.audioTrack)}return this.store.massSubscribe(c.filter(y=>!y.error).map(y=>({userId:y.user.uid,type:y.mediaType})),void 0,Date.now()),c.forEach(y=>{var _;$e.subscribe(this.store.sessionId,{succ:!!y.error,ec:((_=y.error)===null||_===void 0?void 0:_.code)||null,video:y.mediaType===Ue.VIDEO,audio:y.mediaType===Ue.AUDIO,peerid:y.user.uid,subscribeRequestid:y.mediaType===Ue.VIDEO?y.user._videoSSRC:y.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-r),preSsrc:this._p2pChannel.isPreSubScribe(y.user._videoSSRC)},!0)}),A.info("[".concat(this._clientId,"] massSubscribe success ").concat(n.map(y=>{let{user:_,mediaType:S}=y;return"user: ".concat(_==null?void 0:_.uid,", mediaType: ").concat(S)}).join("; "))),c}catch(m){throw await this._p2pChannel.massUnsubscribeNoLock(n),m}}finally{u(),s()}}async unsubscribe(n,r,i){if(!(n instanceof rl)){const u=this.remoteUsers.find(h=>h.uid===n);if(!u)throw new se($.INVALID_REMOTE_USER,"user is not in the channel");n=u}if(r||this.store.useP2P){if(r==="datachannel")return this._unsubscribeDataChannel(n,i)}else await this._unsubscribeDataChannel(n,i);if(r&&Jn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===n)){const u=new se($.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),u}A.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: ").concat(r));const c=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(n,r);else{const u=await this._p2pChannel.unsubscribe(n,r);u&&await this._gateway.unsubscribe(u,n.uid),r&&r!=="audio"||(n._audio_pre_subscribed=!1),r&&r!=="video"||(n._video_pre_subscribed=!1),n._is_pre_created&&tE(this._users,n),A.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(n.uid,", mediaType: ").concat(r))}}catch(u){if(u.code===$.DISCONNECT_P2P)return void A.warning("disconnecting p2p, abort unsubscribe request.");throw A.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),u.toString()),u}finally{c()}}async _unsubscribeDataChannel(n,r){if(r&&Bt(r,"id",0,65535,!0),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(c=>c===n)){const c=new se($.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),c}let s;if(typeof r=="number"){const c=n._dataChannels.find(u=>u.id===r);c&&(s=[c])}else s=n._dataChannels;if(s===void 0){const c=new se($.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid," with channelId ").concat(r,", remote datachannel is not published")),c}A.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(s.map(c=>c.id)));try{const c=await this._p2pChannel.unsubscribeDataChannel(n,s);c&&await this._gateway.unsubscribeDataChannel(c,n.uid),A.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(c))}catch(c){if(c.code===$.DISCONNECT_P2P)return void A.warning("disconnecting p2p, abort unsubscribe request.");throw A.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),c.toString()),c}}async massUnsubscribe(n){if(Zs(n,"unsubscribeList"),!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");A.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(n.map(i=>{let{user:s,mediaType:c}=i;return"user: ".concat(s==null?void 0:s.uid,", mediaType: ").concat(c,";")}).join())),n=[...n];const r=new Map;for(let i=n.length-1;i>=0;i--){const{user:s,mediaType:c}=n[i];if(!s){const f=new se($.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw A.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),f}if(Jn(c,"mediaType",["video","audio",void 0]),!this._users.find(f=>f===s)){A.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(s.uid,", user is not in the channel")),n.splice(i,1);continue}const h=rr.Video|rr.LwoVideo;if(r.has(s)){const f=r.get(s);let m;switch(c){case"video":m=f&h;break;case"audio":m=f&rr.Audio;break;default:m=f&(rr.Audio|h)}if(m){A.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(s.uid,",mediaType:").concat(c," twice.")),n.splice(i,1);continue}c?c==="audio"?r.set(s,f|rr.Audio):c==="video"&&r.set(s,f|h):r.set(s,f|rr.Audio|h)}else c?c==="audio"?r.set(s,rr.Audio):c==="video"&&r.set(s,h):r.set(s,rr.Audio|h)}try{const i=await this._p2pChannel.massUnsubscribe(n);i&&await this._gateway.massUnsubscribe(i),A.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(n.map(s=>{let{user:c,mediaType:u}=s;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(u,";")}).join()))}catch(i){if(i.code===$.DISCONNECT_P2P)return void A.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw A.error("[".concat(this._clientId,"] massUnsubscribe error"),i.toString()),i}}async setLowStreamParameter(n){(function(i){if(!i)throw new de($.INVALID_PARAMS);hn(i.width)||X0(i.width,"streamParameter.width"),hn(i.height)||X0(i.height,"streamParameter.height"),hn(i.framerate)||X0(i.framerate,"streamParameter.framerate"),hn(i.bitrate)||Bt(i.bitrate,"streamParameter.bitrate")})(n),(!n.width&&n.height||n.width&&!n.height)&&A.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),A.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(n));const r=this._configDistribute.getLowStreamConfigDistribute();if(r&&r.bitrate&&n.bitrate&&r.bitrate<n.bitrate&&(n.bitrate=r.bitrate),this._lowStreamParameter=n,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(n,Ee.LocalVideoLowTrack)}async enableDualStream(){if(!bt().supportDualStream)throw $e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new se($.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new se($.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(n){throw $e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),n}this._isDualStreamEnabled=!0,$e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),A.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new se($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Ee.LocalVideoLowTrack))try{const n=await this._p2pChannel.unpublishLowStream();n&&await this._gateway.unpublish(n,this._joinInfo.stringUid||this._joinInfo.uid)}catch(n){throw $e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),n}this._isDualStreamEnabled=!1,$e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),A.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(n,r){if(function(s){Jn(s,"role",["audience","host"])}(n),r&&eO(r),this.mode==="rtc"||this.mode==="p2p")throw A.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new se($.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(r&&r.level&&n==="host")throw new se($.INVALID_OPERATION,"host mode can not set audience latency level");if(n==="audience"&&this._p2pChannel.hasLocalMedia())throw new se($.INVALID_OPERATION,"can not set client role to audience when publishing stream");const i=this._config.role;this._joinInfo&&(this._joinInfo.role=n),n!==i&&Y("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(n,r),this._config.role=n,this._gateway.reconnect("recover",Rr.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(n,r),this._config.role=n),A.info("[".concat(this._clientId,"] set client role to ").concat(n,", level: ").concat(r&&r.level))}async _setClientRoleOptions(n){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let r=!1;try{n&&eO(n),await this._gateway.setClientRole(this._config.role,n),r=!0}catch{}finally{A.info("[".concat(this._clientId,"] set client role options ").concat(r?"succeed":"failed",", options is ").concat(n))}}getRemoteInboundOffset(){var n;const r=(n=this._p2pChannel.getStats())===null||n===void 0?void 0:n.audioSend[0];if(!r||!r.timestamp)return 0;const i=r.timestamp-Date.now();return Math.abs(i)>1e3+r.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?i:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(n,r){if(vr(n,"proxyServer"),!r){if(this.connectionState!=="DISCONNECTED")throw new se($.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new se($.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=n,$e.setProxyServer(this._proxyServer),A.setProxyServer(this._proxyServer),A.info("[".concat(this._clientId,"] Set proxy server ").concat(r?"by initialize call":""," success."))}setTurnServer(n,r){if(Array.isArray(n)||(n=[n]),!r){if(this.connectionState!=="DISCONNECTED")throw new se($.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new se($.INVALID_OPERATION,"You have already set the proxy")}if(Sm(n))return this._turnServer={servers:n,mode:"original-manual"},void A.info("[".concat(this._clientId,"] Set original turnserver ").concat(r?"by initialize call":""," success: ").concat(n.map(i=>i.urls).join(","),"."));n.forEach(i=>lB(i)),this._turnServer={servers:n,mode:"manual"},A.info("[".concat(this._clientId,"] Set turnserver ").concat(r?"by initialize call":""," success."))}setLicense(n){if(this.connectionState!=="DISCONNECTED")throw new se($.INVALID_OPERATION,"you should set license before join channel");if(vr(n,"license",32,32),!/^[A-Za-z\d]+$/.test(n))throw new se($.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=n,A.info("[".concat(this._clientId,"] set license success"),n)}startProxyServer(n){if(this.connectionState!=="DISCONNECTED")throw new se($.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new se($.INVALID_OPERATION,"You have already set the proxy");const r=[3,4,5];let i;switch(n===void 0&&(n=3),n){case 1:case 2:throw new se($.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:i="proxy3";break;case 4:i="proxy4";break;case 5:i="proxy5";break;default:throw new se($.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")))}this._cloudProxyServerMode=i,this.store.cloudProxyServerMode=i,A.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new se($.INVALID_OPERATION,"Stop proxy server after leave channel");$e.setProxyServer(),A.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",A.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(n){if(!n.accessPoints)throw new se($.INVALID_PARAMS,"accessPoints is required.");Zs(n.accessPoints.serverList,"accessPoints.serverList"),vr(n.accessPoints.domain,"accessPoints.domain");const r=(w,O)=>{Bt(w,O,0,65535,!0)};let i=443;if(n.accessPoints.port&&(r(n.accessPoints.port,"accessPoints.port"),i=n.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new se($.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Y("CLOSE_AFB_FOR_LOCAL_AP")&&(Ut("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Ut("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const s=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,c=n.accessPoints.domain,u=n.accessPoints.serverList.map(w=>s.test(w)?"".concat(w.replace(/\./g,"-"),".").concat(c):w),h=u.map(w=>"".concat(w,":").concat(i));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Ut("WEBCS_DOMAIN",h),Ut("WEBCS_DOMAIN_BACKUP_LIST",h),Ut("GATEWAY_DOMAINS",[c]),n.report&&n.report.hostname&&Array.isArray(n.report.hostname)&&n.report.hostname.length?(Zs(n.report.hostname,"report.hostname"),Ut("EVENT_REPORT_DOMAIN",n.report.hostname[0]),Ut("EVENT_REPORT_BACKUP_DOMAIN",n.report.hostname[1]||n.report.hostname[0])):(Ut("EVENT_REPORT_DOMAIN",u[0]),Ut("EVENT_REPORT_BACKUP_DOMAIN",u[1]||u[0]));let f=6443;n.report&&n.report.port&&(r(n.report.port,"report.port"),f=n.report.port),Ut("STATS_COLLECTOR_PORT",f),n.report?Ut("ENABLE_EVENT_REPORT",!0):Ut("ENABLE_EVENT_REPORT",!1);let m="";n.log&&n.log.hostname&&Array.isArray(n.log.hostname)&&n.log.hostname.length?(Zs(n.log.hostname,"log.hostname"),m=n.log.hostname[0]):m=u[0];let y=6444;n.log&&n.log.port&&(r(n.log.port,"log.port"),y=n.log.port),Ut("LOG_UPLOAD_SERVER","".concat(m,":").concat(y));let _=[];n.cds&&n.cds.hostname&&Array.isArray(n.cds.hostname)&&n.cds.hostname.length?(Zs(n.cds.hostname,"cds.hostname"),_=n.cds.hostname):_=u;let S=443;n.cds&&n.cds.port&&(r(n.cds.port,"cds.port"),S=n.cds.port),Ut("CDS_AP",_.map(w=>"".concat(w,":").concat(S))),n.cds?Ut("ENABLE_CONFIG_DISTRIBUTE",!0):Ut("ENABLE_CONFIG_DISTRIBUTE",!1),A.info("set local access point v2 success")}setLocalAccessPoints(n,r){if(Zs(n,"serverList"),vr(r,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new se($.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const i=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;n=n.map(s=>i.test(s)?"".concat(s.replace(/\./g,"-"),".").concat(r):s),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Ut("WEBCS_DOMAIN",n),Ut("WEBCS_DOMAIN_BACKUP_LIST",n),Ut("GATEWAY_DOMAINS",[r]),Ut("EVENT_REPORT_DOMAIN",n[0]),Ut("EVENT_REPORT_BACKUP_DOMAIN",n[1]||n[0]),Ut("LOG_UPLOAD_SERVER","".concat(n[0],":6444")),A.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(n){if(Jn(n,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=n,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(n),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(r){throw A.error("[".concat(this._clientId,"] set default remote video stream type error"),r.toString()),r}else A.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(n))}async setRemoteVideoStreamType(n,r){Jn(r,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(n,r),setTimeout(()=>{const i=this._users.find(s=>s.uid===n);i&&i.videoTrack&&i.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(i){throw A.error("[".concat(this._clientId,"] set remote video stream type error"),i.toString()),i}A.info("[".concat(this._clientId,"] set remote ").concat(n," video stream type to ").concat(r)),this._remoteStreamTypeCacheMap.set(n,r)}async setStreamFallbackOption(n,r){Jn(r,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(n,r)}catch(i){throw A.error("[".concat(this._clientId,"] set stream fallback option"),i.toString()),i}A.info("[".concat(this._clientId,"] set remote ").concat(n," stream fallback type to ").concat(r)),this._streamFallbackTypeCacheMap.set(n,r)}setEncryptionConfig(n,r,i,s){(function(u){Jn(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(n),vr(r,"secret");const c=["aes-128-gcm2","aes-256-gcm2"];if(Oe(c).call(c,n)){if(!i||!(i instanceof Uint8Array&&i.length===32))throw new se($.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(i)throw new se($.INVALID_PARAMS,"current encrypt mode does not need salt");if(s){if(Qs(s,"encryptDataStream"),!Oe(c).call(c,n))throw new se($.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(r)||A.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=n,this._encryptionSecret=r,i&&(this._encryptionSalt=Xc(i))}async renewToken(n){if(vr(n,"token",1,2047),!this._key||!this._joinInfo)throw new se($.INVALID_OPERATION,"renewToken should not be called before user join");const r=this._key;this._key=n,this._joinInfo&&(this._joinInfo.token=n);const i=await this._renewTokenMutex.lock();try{if(Y("USE_NEW_TOKEN")){A.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const s=await Dpe(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gn);A.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:n,ticket:s})}else A.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:n});A.debug("[".concat(this._clientId,"] renewToken success"))}catch(s){throw this._key=r,this._joinInfo.token=r,A.error("[".concat(this._clientId,"] renewToken failed"),s.toString()),s}finally{i()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?A.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const n=this._p2pChannel.getAudioLevels();this.safeEmit(dt.VOLUME_INDICATOR,n)},Y("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const n=this._statsCollector.getRTCStats(),r=this._gateway.getInChannelInfo();return n.Duration=Math.round(r.duration/1e3),n}async startLiveStreaming(n,r){if(!r){if(this.codec!=="h264")throw new se($.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new se($.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(n)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(n))throw new se($.LIVE_STREAMING_TASK_CONFLICT);const i=r?tc.TRANSCODE:tc.RAW;return this._createLiveStreamingClient(i).startLiveStreamingTask(n,i)}setLiveTranscoding(n){return this._createLiveStreamingClient(tc.TRANSCODE).setTranscodingConfig(n)}async stopLiveStreaming(n){const r=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(i=>i&&i.hasUrl(n));if(!r.length)throw new se($.INVALID_PARAMS,"can not find live streaming url to stop");await Ie.all(r.map(i=>i&&i.stopLiveStreamingTask(n)))}async startChannelMediaRelay(n){W4(n),await this._createChannelMediaRelayClient().startChannelMediaRelay(n)}async updateChannelMediaRelay(n){W4(n),await this._createChannelMediaRelayClient().updateChannelMediaRelay(n)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(n){this._p2pChannel instanceof Bm&&this._p2pChannel.addAudioMetadata(n)}async sendStreamMessage(n){var r;let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new se($.INVALID_OPERATION,"can not send data stream, not joined");if((typeof n=="string"||n instanceof Uint8Array)&&(n={payload:n}),typeof n.payload=="string"){const c=new TextEncoder;n.payload=c.encode(n.payload)}let s=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Oe(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)&&(s=!0,n.payload=await async function(c,u,h){var f;const m=Ao(f=Array.from(h)).call(f,(k,j)=>k+j,0),y={serverTs:0,seq:Zhe++,length:h.length,checkSum:m},_=new Uint8Array(yB(m,2)),S=new ArrayBuffer(10),w=new DataView(S);w.setUint32(0,y.serverTs),w.setUint16(4,y.seq),w.setUint16(6,y.length),w.setUint16(8,y.checkSum);const O=16-h.length%16;h=hB(h,new Uint8Array(O));const W=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c,tagLength:128,additionalData:_},u,h);return hB(new Uint8Array(S),new Uint8Array(W))}(this._encryptDataStreamIv,this._encryptDataStreamKey,n.payload)),new Blob([n.payload]).size>1024)throw new se($.INVALID_PARAMS,s?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(Qe.DATA_STREAM,{payload:Xc(n.payload),syncWithAudio:n.syncWithAudio,sendTs:Date.now()-Gpe},!i)}sendMetadata(n){if(!this._joinInfo)throw new se($.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([n]).size>1024)throw new se($.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Qe.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Xc(n)})}async sendCustomReportMessage(n){if(Array.isArray(n)||(n=[n]),n.forEach(cfe),!this._joinInfo)throw new se($.INVALID_OPERATION,"can not send custom report, not joined");await $e.sendCustomReportMessage(this._joinInfo.sid,n)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(n,r){Jn(r.spatialLayer,"spatialLayer",[0,1,2,3]),Jn(r.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(n,r)}catch(i){throw A.error("[".concat(this._clientId,"] pick SVC layer failed"),i.toString()),i}}async setRTMConfig(n){const{apRTM:r=!1,rtmFlag:i}=n;if(Qs(r,"apRTM"),Bt(i,"rtmFlag",0),this._rtmConfig.apRTM=r,this._rtmConfig.rtmFlag=i,A.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(n)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=r,this._joinInfo.rtmFlag=i,this._gateway.setRTM2Flag(i)}_reset(){if(A.debug("[".concat(this._clientId,"] reset client")),function(n){const r=Dh.indexOf(n);r!==-1&&Dh.splice(r,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=mi.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&y5(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&$e.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(n=>{n._audioTrack&&n._audioTrack._destroy(),n._videoTrack&&n._videoTrack._destroy(),n._dataChannels&&(n._dataChannels.forEach(r=>r._close()),n._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Lr("client-publish",this._clientId),this._subscribeMutex=new Lr("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(n,r){var i;const s=n||Ru();n?A.debug("[".concat(this._clientId,"] new Session ").concat(s)):A.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(s));const c=n?"":this._sessionId||"";this._sessionId=s,this.store.sessionId=s,$e.addSid(s);const u={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(r==null?void 0:r.stringUid)||((i=this._joinInfo)===null||i===void 0?void 0:i.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:c,clientRole:this.role==="audience"?2:1};$e.sessionInit(this._sessionId,so({cname:r.channel,appid:r.appId},u)),this._joinInfo&&(this._joinInfo.sid=s),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=s)}async _publishHighStream(n){if(!this._joinInfo||this._uid===void 0)throw new se($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Y("FORCE_TURN")&&!Y("TURN_ENABLE_TCP")&&!Y("TURN_ENABLE_UDP"))throw new se($.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");A.debug("[".concat(this._clientId,"] publish high stream"));try{const i=await this._p2pChannel.publish(n,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const s=(await i.next()).value;if(s){try{await this._gateway.sendExtensionMessage(On.PUBLISH,s,!0)}catch(c){throw i.throw(c),c}await i.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const s=(await i.next()).value;if(s){var r;let c;try{c=await this._gateway.publish(this._uid,s,!0)}catch(u){if(u.code!==$.DISCONNECT_P2P)throw i.throw(u),u}await i.next(((r=c)===null||r===void 0?void 0:r.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const c of n)c instanceof tn&&c._encoderConfig&&this._gateway.setVideoProfile(c._encoderConfig).catch(u=>{A.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!c.muted&&c.enabled||await this._p2pChannel.muteLocalTrack(c)}}catch(i){if(this._p2pChannel.reportPublishEvent(!1,i==null?void 0:i.code,n),(i==null?void 0:i.code)===$.WS_ABORT)return;throw i}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new se($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new se($.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));A.debug("[".concat(this._clientId,"] publish low stream"));const n=this._configDistribute.getLowStreamConfigDistribute();n&&n.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&n.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=n.bitrate));try{const i=await this._p2pChannel.publishLowStream(this._lowStreamParameter),s=(await i.next()).value;if(s){var r;let c;try{c=await this._gateway.publish(this._uid,s,!0)}catch(u){if(u.code!==$.DISCONNECT_P2P)throw i.throw(u),u}i.next(((r=c)===null||r===void 0?void 0:r.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(i){if(this._p2pChannel.reportPublishEvent(!1,i==null?void 0:i.code,void 0,!0),(i==null?void 0:i.code)===$.WS_ABORT)return;throw i}}_createLiveStreamingClient(n){const r=()=>{if(!this._joinInfo||!this._appId)return new se($.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const i=(s={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},nl("LiveStreaming").create(s));var s;return i.onLiveStreamError=(c,u)=>{$e.reportApiInvoke(this._sessionId,{name:Wn.ON_LIVE_STREAM_ERROR,options:[c,u],tag:fn.TRACER}).onSuccess(),this.safeEmit(dt.LIVE_STREAMING_ERROR,c,u)},i.onLiveStreamWarning=(c,u)=>{$e.reportApiInvoke(this._sessionId,{name:Wn.ON_LIVE_STREAM_WARNING,options:[c,u],tag:fn.TRACER}).onSuccess(),this.safeEmit(dt.LIVE_STREAMING_WARNING,c,u)},i.on(GO.REQUEST_WORKER_MANAGER_LIST,(c,u,h)=>{if(!this._joinInfo)return h(new se($.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(f,m,y,_){const S=Y("UAP_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(w=>m.proxyServer?"https://".concat(m.proxyServer,"/ap/?url=").concat(w+"/api/v1?action=uap"):"https://".concat(w,"/api/v1?action=uap"));return await Ope(S,f,m,y,_)})(c,this._joinInfo,this._axiosCancelSource.token,Gn).then(u).catch(h)}),i};return n===tc.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||r(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||r(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new se($.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:r,sendResolutionHeight:i}=this.getLocalVideoStats(),s=(n={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:r,height:i}},nl("ChannelMediaRelay").create(n));s.on("state",c=>{c===Ii.RELAY_STATE_FAILURE&&s&&s.dispose(),this.safeEmit(dt.CHANNEL_MEDIA_RELAY_STATE,c)}),s.on("event",c=>{this.safeEmit(dt.CHANNEL_MEDIA_RELAY_EVENT,c)}),this._channelMediaRelayClient=s,this._statsCollector.onStatsChanged=(c,u)=>{var h;c==="resolution"&&((h=this._channelMediaRelayClient)===null||h===void 0||h.setVideoProfile(u))}}var n;return this._channelMediaRelayClient}_handleUpdateDataChannel(n,r){const{added:i,deleted:s}=n,c=[];if(r){const u=[];this._users.forEach(h=>{h._dataChannels.forEach(f=>{i.every(m=>m.uid!==h._uintid||m.stream_id!==f.id)&&u.push({uid:h._uintid,stream_id:f.id,ordered:f.ordered,max_retrans_times:f.maxRetransmits,metadata:f.metadata})})}),u.length>0&&this._handleUpdateDataChannel({added:[],deleted:u})}Array.isArray(i)&&i.length>0&&i.forEach(u=>{const{uid:h,stream_id:f,ordered:m,max_retrans_times:y,metadata:_}=u,S=this._users.find(w=>w._uintid===h);if(!S)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(A.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(h)),Oe(c).call(c,S)||c.push(S),S._uintid||(S._uintid=h),S._dataChannels.findIndex(w=>w.id===u.stream_id)===-1){const w={id:f,ordered:!!m,maxRetransmits:y,metadata:_},O=function(W){return C4(W,!0)}(w);S._dataChannels.push(O),A.info("[".concat(this._clientId,"] remote user ").concat(S.uid," published datachannel")),r||this.safeEmit(dt.USER_PUBLISHED,S,"datachannel",w)}this._p2pChannel.hasPendingRemoteDataChannel(S,u.stream_id)&&(A.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(S.uid," after reconnect.")),this._subscribeDataChannel(S,u.stream_id).catch(w=>{A.error("[".concat(this._clientId,"] resubscribe datachannel error"),w.toString())}))}),r&&(this.safeEmit(dt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(s)&&s.length>0&&s.forEach(u=>{const{uid:h,stream_id:f}=u,m=this._users.find(_=>_._uintid===h);if(!m)return void A.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const y=m._dataChannels.find(_=>_.id===u.stream_id);y&&(A.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(h)),this._p2pChannel.unsubscribeDataChannel(m,[y]).then(_=>{if(m._dataChannels=m._dataChannels.filter(S=>S!==y),_)return this._gateway.unsubscribeDataChannel(_,m.uid)}),A.info("[".concat(this._clientId,"] remote user ").concat(h," unpublished datachannel ,id:").concat(y.id)),this.safeEmit(dt.USER_UNPUBLISHED,m,"datachannel",y._config))})}_handleRemoveDataChannels(n){const r=this._users.find(i=>i.uid===n.uid);if(r){if(r._dataChannels!==void 0&&r._dataChannels.length>0){A.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(n.uid));const i=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished datachannel")),r._dataChannels.forEach(s=>{this.safeEmit(dt.USER_UNPUBLISHED,r,"datachannel",s._config)})};this._p2pChannel.unsubscribeDataChannel(r,r._dataChannels).then(s=>{if(s)return this._gateway.unsubscribeDataChannel(s,r.uid)}),i()}}else A.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(dr.UPDATE_GATEWAY_CONFIG,()=>{(function(){let n;try{n=window.localStorage.getItem("websdk_ng_global_parameter")}catch(r){return void A.error("Error loading sdk config",r.message)}if(n)try{const r=JSON.parse(window.atob(n)),i=Date.now();Object.keys(r).forEach(s=>{const{value:c,type:u,expires:h}=r[s];h&&h<=i||u||MO()||!Object.prototype.hasOwnProperty.call(sE,s)||(Uo[s]=c,un[s]=c,A.debug("Update gateway parameters from config distribute",s,c))})}catch(r){A.error("Error update config from local cache",r.message)}})()}),this._gateway.on(dr.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(dr.CONNECTION_STATE_CHANGE,(n,r,i)=>{var s;if(i===Pt.FALLBACK)return;const c=()=>{this.safeEmit(dt.CONNECTION_STATE_CHANGE,n,r,i)};if($e.reportApiInvoke(this._sessionId||((s=this._gateway.joinInfo)===null||s===void 0?void 0:s.sid)||null,{name:Wn.CONNECTION_STATE_CHANGE,options:[n,r,i],tag:fn.TRACER}).onSuccess(JSON.stringify({cur:n,prev:r,reason:i})),A.info("[".concat(this._clientId,"] signal connection state change: ").concat(r," -> ").concat(n)),n==="DISCONNECTED")return this._reset(),void c();if(n==="RECONNECTING")this._users.forEach(h=>{h._trust_in_room_=!1,h._trust_audio_enabled_state_=!1,h._trust_video_enabled_state_=!1,h._trust_audio_mute_state_=!1,h._trust_video_mute_state_=!1,h._trust_audio_stream_added_state_=!1,h._trust_video_stream_added_state_=!1,h._is_pre_created||(h._audio_pre_subscribed||(h._audioSSRC=void 0,h._audioOrtc=void 0),h._video_pre_subscribed||(h._videoSSRC=void 0,h._videoOrtc=void 0,h._rtxSsrcId=void 0),h._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(n==="CONNECTED"){var u;this._streamFallbackTypeCacheMap.forEach((h,f)=>{this._gateway.setStreamFallbackOption(f,h).catch(m=>{A.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),m)})}),this._remoteStreamTypeCacheMap.forEach((h,f)=>{this._gateway.setRemoteVideoStreamType(f,h).catch(m=>{A.warning("[".concat(this._clientId,"] auto set remote stream type failed"),m)})}),this._remoteDefaultVideoStreamType!==void 0&&((u=this._joinInfo)===null||u===void 0?void 0:u.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{A.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(h=>{A.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(h))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(h=>!h._trust_in_room_).forEach(h=>{A.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(h.uid)),this._handleUserOffline({uid:h.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(h=>{h._trust_audio_mute_state_||(A.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(h.uid)),this._handleMuteStream(h.uid,Ue.AUDIO,!1)),h._trust_video_mute_state_||(A.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(h.uid)),this._handleMuteStream(h.uid,Ue.VIDEO,!1)),h._trust_audio_enabled_state_||(A.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(h.uid)),this._handleSetStreamLocalEnable("audio",h.uid,!0)),h._trust_video_enabled_state_||(A.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(h.uid)),this._handleSetStreamLocalEnable("video",h.uid,!0)),h._trust_video_stream_added_state_||(A.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(h.uid)),this._handleResetAddStream(h,"video")),h._trust_audio_stream_added_state_||(A.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(h.uid)),this._handleResetAddStream(h,"audio")),h._video_added_||h._audio_added_||(A.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(h.uid)),this._handleRemoveStream({uid:h.uid,uint_id:h._uintid}))}))},1e3))}c()}),this._gateway.on(dr.REQUEST_NEW_GATEWAY_LIST,async(n,r)=>{if(!this._joinInfo)return r(new se($.UNEXPECTED_ERROR,"can not recover, no join info"));try{let i;const s=await m5(so(so({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));s?(i=s.ap,v5(s),this._joinInfo.preload=!0):(i=await aA(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gn,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=i.gatewayInfo.res,this._joinInfo.gatewayAddrs=i.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=i.gatewayInfo.uni_lbs_ip);const c=[];i.gatewayInfo.gatewayAddrs.forEach(u=>{let{address:h}=u;const[f,m]=h.split(":");this._joinInfo&&this._joinInfo.proxyServer?c.push({proxy:this._joinInfo.proxyServer,host:f,port:m}):c.push({host:f,port:m})}),n(c)}catch(i){r(i)}}),this._gateway.on(dr.NETWORK_QUALITY,n=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(dt.NETWORK_QUALITY,n)}),this._gateway.on(dr.STREAM_TYPE_CHANGE,(n,r)=>{this.safeEmit(dt.STREAM_TYPE_CHANGED,n,r),$e.reportApiInvoke(this._sessionId,{name:Wn.STREAM_TYPE_CHANGE,options:[n,r],tag:fn.TRACER}).onSuccess(JSON.stringify({uid:n,streamType:r}))}),this._gateway.on(dr.IS_P2P_DISCONNECTED,n=>{this._p2pChannel.isP2PDisconnected()?n(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?n(!1):n(!0)}),this._gateway.on(dr.REQUEST_P2P_CONNECTION_PARAMS,async(n,r,i)=>{try{let s=await this._p2pChannel.getEstablishParams();Y("ENABLE_PREALLOC_PC")&&s||(s=await this._p2pChannel.startP2PConnection(n)),r(s)}catch(s){i(s)}}),this._gateway.on(dr.JOIN_RESPONSE,(n,r)=>{if(this.store.useP2P)return;let i;n.attributes?i=n.attributes.userAttributes.preSubSsrcs:A.debug("no attributes in joinResponse");const s=f4(n.ortc,r,i);this._p2pChannel.connect(s)}),this._gateway.on(dr.PRE_CONNECT_PC,async n=>{const{candidates:r,fingerprint:i}=n;if(this._joinInfo&&r.length>0&&!this._p2pChannel.isPlanB){var s;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:c,cid:u}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(u,"_").concat(c),icePwd:"".concat(u,"_").concat(c)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(s=Y("FINGERPRINT"))!==null&&s!==void 0?s:i}]},candidates:r,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(ft.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ft.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ft.ON_ADD_AUDIO_STREAM,n=>this._handleAddAudioOrVideoStream("audio",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc)),this._gateway.signal.on(ft.ON_ADD_VIDEO_STREAM,n=>this._handleAddAudioOrVideoStream("video",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc,n.rtxSsrcId)),this._gateway.signal.on(ft.ON_REMOTE_DATASTREAM_UPDATE,n=>{this._handleUpdateDataChannel(n)}),this._gateway.signal.on(ft.ON_REMOTE_FULL_DATASTREAM_INFO,n=>{this._handleUpdateDataChannel({added:n.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(ft.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ft.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ft.MUTE_AUDIO,n=>this._handleMuteStream(n.uid,Ue.AUDIO,!0)),this._gateway.signal.on(ft.UNMUTE_AUDIO,n=>this._handleMuteStream(n.uid,Ue.AUDIO,!1)),this._gateway.signal.on(ft.MUTE_VIDEO,n=>this._handleMuteStream(n.uid,Ue.VIDEO,!0)),this._gateway.signal.on(ft.UNMUTE_VIDEO,n=>this._handleMuteStream(n.uid,Ue.VIDEO,!1)),this._gateway.signal.on(ft.RECEIVE_METADATA,n=>{const r=Cu(n.metadata);this.safeEmit(dt.RECEIVE_METADATA,n.uid,r)}),this._gateway.signal.on(ft.ON_DATA_STREAM,async n=>{var r;if(!n)return;let i=Cu(n.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Oe(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)){if(n.payload.length<10)throw new se($.UNEXPECTED_RESPONSE,"payload length ".concat(n.payload.length," is less than header length ").concat(10));i=await async function(u,h,f){const m=f.subarray(0,10),y=m.slice(8,10),_=(y[0]<<8)+y[1],S=(m[6]<<8)+m[7],w=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u,tagLength:128,additionalData:new Uint8Array(yB(_,2))},h,f.subarray(10));return new Uint8Array(w).subarray(0,S)}(this._encryptDataStreamIv,this._encryptDataStreamKey,i)}let s=0;if(n.ordered||n.syncWithAudio){const c=this._p2pChannel.getStats(),u=this.remoteUsers.find(f=>f.uid===n.uid),h=c==null?void 0:c.audioRecv.find(f=>f.ssrc===(u==null?void 0:u._audioSSRC));s=h==null?void 0:h.jitterBufferMs}(s==null||Number.isNaN(s))&&(s=0),$pe(so(so({},n),{},{payload:i}),s,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(ft.ON_CRYPT_ERROR,()=>{Yc(()=>{A.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(dt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ft.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ft.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{A.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Pt.TOKEN_EXPIRE),this.safeEmit(dt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(ft.ON_STREAM_FALLBACK_UPDATE,n=>{A.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(n.stream_id,", attr: ").concat(n.stream_type)),this.safeEmit(dt.STREAM_FALLBACK,n.stream_id,n.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(ft.ON_PUBLISH_STREAM,n=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:n.proxy})),A.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(n))))}),this._gateway.signal.on(ft.ENABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!0)}),this._gateway.signal.on(ft.DISABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!1)}),this._gateway.signal.on(et.REQUEST_TIMEOUT,(n,r)=>{if(this._joinInfo)switch(n){case Qe.PUBLISH:{if(!r)return;const c=r.ortc;if(c){var i,s;const u=c.some(m=>{let{stream_type:y}=m;return y===Dt.Audio}),h=c.some(m=>{let{stream_type:y}=m;return y!==Dt.Audio}),f=c.some(m=>{let{stream_type:y}=m;return y===Dt.Screen||y===Dt.ScreenLow});r.state==="offer"&&$e.publish(this._joinInfo.sid,{eventElapse:Mr.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:$.TIMEOUT,audio:u,video:h,p2pid:r.p2p_id,publishRequestid:this.store.pubId,screenshare:f,audioName:u?(i=c.find(m=>{let{stream_type:y}=m;return y===Dt.Audio}))===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId.toString():void 0,videoName:h?(s=c.find(m=>{let{stream_type:y}=m;return y!==Dt.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0})}break}case Qe.SUBSCRIBE:r&&$e.subscribe(this._joinInfo.sid,{succ:!1,ec:$.TIMEOUT,audio:r.stream_type===Ue.AUDIO,video:r.stream_type===Ue.VIDEO,peerid:r.stream_id,subscribeRequestid:r.ssrcId,p2pid:this.store.p2pId,eventElapse:Mr.measureFromSubscribeStart(this.store.clientId,r.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(r.ssrcId)})}}),this._gateway.signal.on(ft.ON_P2P_OK,n=>{this.uid,this._uid}),this._gateway.signal.on(ft.ON_PUBLISHED_USER_LIST,n=>{if(n==null||!n.users)return;Y("BLOCK_LOCAL_CLIENT")&&(n.users=n.users.filter(s=>!Lu(s.string_id||s.stream_id,this.channelName)));const r=[],i=[];for(const s of n.users){let c=this._users.find(_=>_._uintid===s.stream_id);c?c._trust_in_room_=!0:(c=new rl(s.string_id||s.stream_id,s.stream_id),this._users.push(c),this.getListeners(dt.PUBLISHED_USER_LIST).length===0&&(A.debug("[".concat(this._clientId,"] user online"),s.stream_id),this.safeEmit(dt.USER_JOINED,c)));const u=rr.Audio&s.stream_type,h=(rr.Video|rr.LwoVideo)&s.stream_type,f=!!(65280&s.stream_type),m=u&&c.hasAudio,y=h&&c.hasVideo;h&&(c._trust_video_stream_added_state_=!0,c._video_added_=!0,c._videoSSRC=s.video_ssrc,c._rtxSsrcId=s.video_rtx),u&&(c._trust_audio_stream_added_state_=!0,c._audio_added_=!0,c._audioSSRC=s.audio_ssrc),u&&!m&&this.getListeners(dt.PUBLISHED_USER_LIST).length===0&&(A.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published audio")),this.safeEmit(dt.USER_PUBLISHED,c,"audio")),h&&!y&&this.getListeners(dt.PUBLISHED_USER_LIST).length===0&&(A.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published video")),this.safeEmit(dt.USER_PUBLISHED,c,"video")),(u&&!m||h&&!y||f)&&r.push(c),h&&this._p2pChannel.hasPendingRemoteMedia(c,"video")&&i.push({user:c,mediaType:"video"}),u&&this._p2pChannel.hasPendingRemoteMedia(c,"audio")&&i.push({user:c,mediaType:"audio"})}i.length>0&&(A.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(i.map(s=>"user: ".concat(s.user.uid,", mediaType: ").concat(s.mediaType)).join("; ")," ")),this.massSubscribe(i).catch(s=>{A.error("[".concat(this._clientId,"] mass resubscribe error"),s.toString())})),this.getListeners(dt.PUBLISHED_USER_LIST).length>0?Y("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=r:(A.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(r.map(s=>s.uid).join(", "))),this.safeEmit(dt.PUBLISHED_USER_LIST,r)):A.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(r.map(s=>s.uid).join(", ")))}),this._gateway.signal.on(ft.ON_RTP_CAPABILITY_CHANGE,n=>{const{video_codec:r}=n;this._p2pChannel instanceof Bm&&this._p2pChannel.updateRemoteRTPCapabilities(r.map(i=>i.toLowerCase()).filter(i=>{var s;return Oe(s=Object.keys(cE)).call(s,i)}))})}_handleP2PEvents(){this._gateway.signal.on(ft.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(On.PUBLISH,(n,r,i)=>{const{uid:s}=n;n.forEach(c=>{const{kind:u,ssrcs:h,mid:f,isMuted:m}=c;this._handleP2PAddAudioOrVideoStream(u,s,h[0].ssrcId,f);const y=this._users.find(_=>_.uid===s);return y&&this.store.useP2P?this._p2pChannel.mockSubscribe(y,u,h[0].ssrcId,f).then(()=>{r()}).catch(i):r(),this._handleMuteStream(s,u,!!m)})}),this._gateway.signal.on(On.CALL,async(n,r,i)=>{if(this.store.useP2P)try{var s;r(await this._p2pChannel.startP2P({turnServer:(s=this._joinInfo)===null||s===void 0?void 0:s.turnServer},n))}catch(c){i(c)}}),this._gateway.signal.on(et.P2P_CONNECTION,async n=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(n)}),this._gateway.signal.on(On.UNPUBLISH,async(n,r,i)=>{if(this.store.useP2P){const{unpubMsg:s,uid:c}=n,u=this._users.find(h=>h.uid===c);if(!u)return A.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(c)),void r();try{s.forEach(async h=>{let{stream_type:f}=h;const m=f===Dt.Audio?Ue.AUDIO:Ue.VIDEO;await this._p2pChannel.unsubscribe(u,m),this._handleMuteStream(c,m,!0)}),r()}catch(h){i(h)}}}),this._gateway.signal.on(On.CONTROL,async(n,r)=>{const{action:i}=n;switch(i){case Zc.MUTE_LOCAL_VIDEO:this._handleMuteStream(r,Ue.VIDEO,!0);break;case Zc.MUTE_LOCAL_AUDIO:this._handleMuteStream(r,Ue.AUDIO,!0);break;case Zc.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",r),this._handleMuteStream(r,Ue.VIDEO,!1);break;case Zc.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",r),this._handleMuteStream(r,Ue.AUDIO,!1)}}),this._gateway.signal.on(On.RESTART_ICE,async(n,r,i)=>{if(this.store.useP2P)try{const{direction:s,iceParameter:c}=n;s!==oi.SEND_ONLY||c?r(await this._p2pChannel.restartICE(s,c)):(this._p2pChannel.handleDisconnect(s),r())}catch(s){i(s)}}),this._gateway.signal.on(On.CANDIDATE,n=>{if(this.store.useP2P){const{candidate:r,direction:i}=n;this._p2pChannel.addRemoteCandidate(r,i)}}),this._p2pChannel.on(Ke.RequestP2PRestartICE,async(n,r,i)=>{try{const{direction:s}=n;r(await this._gateway.sendExtensionMessage(On.RESTART_ICE,n,s===oi.SEND_ONLY))}catch(s){i(s)}}),this._p2pChannel.on(Ke.LocalCandidate,n=>{this._gateway.sendExtensionMessage(On.CANDIDATE,JSON.stringify(n),!0)}),this._p2pChannel.on(Ke.RequestP2PMuteLocal,async(n,r,i)=>{try{await this._gateway.sendExtensionMessage(On.CONTROL,n,!0),r()}catch(s){i(s)}}),this._p2pChannel.on(Ke.RequestP2PUnmuteRemote,async(n,r,i)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(s){s.code===$.DISCONNECT_P2P?r():i(s)}else r()}),this._p2pChannel.on(Ke.RequestP2PMuteRemote,async(n,r,i)=>{if(this._joinInfo)try{await this._gateway.muteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(s){s.code===$.DISCONNECT_P2P?r():i(s)}else r()}),this._p2pChannel.on(Ke.StateChange,(n,r)=>{r===xt.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Ke.PeerConnectionStateChange,n=>{const r=this._peerConnectionState;n!==r&&(this.safeEmit(dt.PEERCONNECTION_STATE_CHANGE,n,r),this._peerConnectionState=n)}),this._p2pChannel.on(Ke.RequestMuteLocal,async(n,r,i)=>{if(this._joinInfo)try{await this._gateway.muteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(s){s.code===$.DISCONNECT_P2P?r():i(s)}else r()}),this._p2pChannel.on(Ke.RequestUnmuteLocal,async(n,r,i)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(s){s.code===$.DISCONNECT_P2P?r():i(s)}else r()}),this._p2pChannel.on(Ke.RequestRePublish,(n,r,i)=>{this.publish(n,!1).then(r).catch(i)}),this._p2pChannel.on(Ke.RequestRePublishDataChannel,(n,r,i)=>{Ie.all(n.map(async s=>{const c=await this._p2pChannel.publishDataChannel([s]);try{c.forEach(u=>{this._uid&&this._gateway.publishDataChannel(this._uid,u,!0)})}catch(u){if(u.code!==$.DISCONNECT_P2P)throw u}})).then(r).catch(i)}),this._p2pChannel.on(Ke.RequestReSubscribe,async(n,r,i)=>{try{for(const{user:s,kind:c}of n)c===Ue.VIDEO?await this.subscribe(s,"video"):await this.subscribe(s,"audio");r()}catch(s){i(s)}}),this._p2pChannel.on(Ke.RequestUpload,(n,r)=>{this._gateway.upload(n,r)}),this._p2pChannel.on(Ke.RequestUploadStats,n=>{this._gateway.uploadWRTCStats(n)}),this._p2pChannel.on(Ke.MediaReconnectStart,n=>{this.safeEmit(dt.MEDIA_RECONNECT_START,n)}),this._p2pChannel.on(Ke.MediaReconnectEnd,n=>{this.safeEmit(dt.MEDIA_RECONNECT_END,n)}),this._p2pChannel.on(Ke.NeedSignalRTT,n=>{n(this._gateway.getSignalRTT())}),this._p2pChannel.on(Ke.RequestRestartICE,async n=>{if(this.store.useP2P)return;const r=await this._p2pChannel.restartICE(n),i=await r.next();if(i.done)return;const s=i.value;let c;try{c=await this._gateway.restartICE({iceParameters:s})}catch(h){return void r.throw(h)}const{iceParameters:u}=function(h){const f=h.iceParameters;return{iceParameters:{iceUfrag:f.iceUfrag,icePwd:f.icePwd}}}(c);await r.next({remoteIceParameters:u})}),this._p2pChannel.on(Ke.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Ke.RequestReconnectPC,async()=>{var n;const{iceParameters:r,dtlsParameters:i,rtpCapabilities:s}=await this._p2pChannel.startP2PConnection({turnServer:(n=this._joinInfo)===null||n===void 0?void 0:n.turnServer}),{gatewayEstablishParams:c,gatewayAddress:u}=await this._gateway.reconnectPC({iceParameters:r,dtlsParameters:i,rtpCapabilities:s}),h=f4(c,u);await this._p2pChannel.connect(h),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Ke.RequestUnpublishForReconnectPC,async(n,r,i)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(n,this._uid),r()):i()}),this._p2pChannel.on(Ke.P2PLost,()=>{this.safeEmit(dt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Ke.UpdateVideoEncoder,n=>{n._encoderConfig&&this._gateway.setVideoProfile(n._encoderConfig)}),this._p2pChannel.on(Ke.ConnectionTypeChange,n=>{this.safeEmit(dt.IS_USING_CLOUD_PROXY,n)}),this._p2pChannel.on(Ke.RequestLowStreamParameter,n=>{n(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Ke.QueryClientConnectionState,n=>{n(this.connectionState)}),this._p2pChannel.on(Ke.AudioMetadata,n=>{this.safeEmit(dt.AUDIO_METADATA,n)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(n){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const i=(r={config:n},nl("ContentInspect").create(r));this._inspect=i,this.handleVideoInspectEvents(i);const{appId:s,cname:c,sid:u,token:h,uid:f,cid:m,vid:y}=this._joinInfo;await i.init({appId:s,areaCode:"",cname:c,sid:u,token:h,uid:f,cid:m,vid:y?Number(y):0},Gn)}catch(i){throw Array.isArray(i)?i[0]:i}var r}handleVideoInspectEvents(n){n.on(hr.CONNECTION_STATE_CHANGE,(r,i)=>{if(this.safeEmit(dt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,r,i),i===ro.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(dt.CONTENT_INSPECT_ERROR,new se($.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));n.inspectImage()}}),n.on(hr.INSPECT_RESULT,(r,i)=>{var s;if((i==null?void 0:i.code)===$.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return A.debug("Stop inspect content because that has left channel"),this==null||(s=this._inspect)===null||s===void 0||s.close(),void(this._inspect=void 0);this.safeEmit(dt.CONTENT_INSPECT_RESULT,r,i)}),n.on(hr.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(i=>i.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(n){throw Array.isArray(n)?n[0]:n}}async setImageModeration(n,r){if(Qs(n,"enabled"),n){if(!r)throw new se($.INVALID_PARAMS,"config is required");if(x5(r),!this._joinInfo)throw new se($.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(r);else{const s=(i={config:r},nl("ImageModeration").create(i));this._moderation=s,this.handleImageModerationEvents(s);const{appId:c,cname:u,sid:h,token:f,uid:m,cid:y,vid:_}=this._joinInfo;await s.init({appId:c,areaCode:"",cname:u,sid:h,token:f,uid:m,cid:y,vid:_?Number(_):0},Gn)}}catch(s){throw Array.isArray(s)?s[0]:s}}else{var i;if(!this._moderation)throw new se($.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}}handleImageModerationEvents(n){n.on(Bo.CONNECTION_STATE_CHANGE,(r,i)=>{if(this.safeEmit(dt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,r,i),r===Aa.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new se($.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");n.inspectImage()}}),n.on(Bo.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(i=>i.trackMediaType==="video")[0])})}setP2PTransport(n){if(function(r){Jn(r,"transport",["default","auto","relay","sd-rtn"])}(n),this.mode!=="p2p")throw new se($.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=n,A.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(n))}getJoinChannelServiceRecords(){return A.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(n){Qs(n,"enabled"),Ut("ENABLE_PUBLISH_AUDIO_FILTER",n),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(n)}_handleResetAddStream(n,r){switch(r){case"audio":n._audio_added_=!1,n._trust_audio_stream_added_state_=!0;break;case"video":n._video_added_=!1,n._trust_video_stream_added_state_=!0}}},Fe(De.prototype,"leave",[D5],Object.getOwnPropertyDescriptor(De.prototype,"leave"),De.prototype),Fe(De.prototype,"publish",[L5],Object.getOwnPropertyDescriptor(De.prototype,"publish"),De.prototype),Fe(De.prototype,"unpublish",[k5],Object.getOwnPropertyDescriptor(De.prototype,"unpublish"),De.prototype),Fe(De.prototype,"subscribe",[M5],Object.getOwnPropertyDescriptor(De.prototype,"subscribe"),De.prototype),Fe(De.prototype,"presubscribe",[U5],Object.getOwnPropertyDescriptor(De.prototype,"presubscribe"),De.prototype),Fe(De.prototype,"massSubscribe",[j5],Object.getOwnPropertyDescriptor(De.prototype,"massSubscribe"),De.prototype),Fe(De.prototype,"unsubscribe",[V5],Object.getOwnPropertyDescriptor(De.prototype,"unsubscribe"),De.prototype),Fe(De.prototype,"massUnsubscribe",[B5],Object.getOwnPropertyDescriptor(De.prototype,"massUnsubscribe"),De.prototype),Fe(De.prototype,"setLowStreamParameter",[F5],Object.getOwnPropertyDescriptor(De.prototype,"setLowStreamParameter"),De.prototype),Fe(De.prototype,"enableDualStream",[W5],Object.getOwnPropertyDescriptor(De.prototype,"enableDualStream"),De.prototype),Fe(De.prototype,"disableDualStream",[G5],Object.getOwnPropertyDescriptor(De.prototype,"disableDualStream"),De.prototype),Fe(De.prototype,"setClientRole",[$5],Object.getOwnPropertyDescriptor(De.prototype,"setClientRole"),De.prototype),Fe(De.prototype,"_setClientRoleOptions",[H5],Object.getOwnPropertyDescriptor(De.prototype,"_setClientRoleOptions"),De.prototype),Fe(De.prototype,"setProxyServer",[z5],Object.getOwnPropertyDescriptor(De.prototype,"setProxyServer"),De.prototype),Fe(De.prototype,"setTurnServer",[K5],Object.getOwnPropertyDescriptor(De.prototype,"setTurnServer"),De.prototype),Fe(De.prototype,"setLicense",[q5],Object.getOwnPropertyDescriptor(De.prototype,"setLicense"),De.prototype),Fe(De.prototype,"startProxyServer",[Y5],Object.getOwnPropertyDescriptor(De.prototype,"startProxyServer"),De.prototype),Fe(De.prototype,"stopProxyServer",[X5],Object.getOwnPropertyDescriptor(De.prototype,"stopProxyServer"),De.prototype),Fe(De.prototype,"setLocalAccessPointsV2",[J5],Object.getOwnPropertyDescriptor(De.prototype,"setLocalAccessPointsV2"),De.prototype),Fe(De.prototype,"setLocalAccessPoints",[Q5],Object.getOwnPropertyDescriptor(De.prototype,"setLocalAccessPoints"),De.prototype),Fe(De.prototype,"setRemoteDefaultVideoStreamType",[Z5],Object.getOwnPropertyDescriptor(De.prototype,"setRemoteDefaultVideoStreamType"),De.prototype),Fe(De.prototype,"setRemoteVideoStreamType",[e6],Object.getOwnPropertyDescriptor(De.prototype,"setRemoteVideoStreamType"),De.prototype),Fe(De.prototype,"setStreamFallbackOption",[t6],Object.getOwnPropertyDescriptor(De.prototype,"setStreamFallbackOption"),De.prototype),Fe(De.prototype,"setEncryptionConfig",[n6],Object.getOwnPropertyDescriptor(De.prototype,"setEncryptionConfig"),De.prototype),Fe(De.prototype,"renewToken",[r6],Object.getOwnPropertyDescriptor(De.prototype,"renewToken"),De.prototype),Fe(De.prototype,"enableAudioVolumeIndicator",[i6],Object.getOwnPropertyDescriptor(De.prototype,"enableAudioVolumeIndicator"),De.prototype),Fe(De.prototype,"startLiveStreaming",[a6],Object.getOwnPropertyDescriptor(De.prototype,"startLiveStreaming"),De.prototype),Fe(De.prototype,"setLiveTranscoding",[o6],Object.getOwnPropertyDescriptor(De.prototype,"setLiveTranscoding"),De.prototype),Fe(De.prototype,"stopLiveStreaming",[s6],Object.getOwnPropertyDescriptor(De.prototype,"stopLiveStreaming"),De.prototype),Fe(De.prototype,"startChannelMediaRelay",[c6],Object.getOwnPropertyDescriptor(De.prototype,"startChannelMediaRelay"),De.prototype),Fe(De.prototype,"updateChannelMediaRelay",[l6],Object.getOwnPropertyDescriptor(De.prototype,"updateChannelMediaRelay"),De.prototype),Fe(De.prototype,"stopChannelMediaRelay",[u6],Object.getOwnPropertyDescriptor(De.prototype,"stopChannelMediaRelay"),De.prototype),Fe(De.prototype,"sendCustomReportMessage",[d6],Object.getOwnPropertyDescriptor(De.prototype,"sendCustomReportMessage"),De.prototype),Fe(De.prototype,"pickSVCLayer",[h6],Object.getOwnPropertyDescriptor(De.prototype,"pickSVCLayer"),De.prototype),Fe(De.prototype,"setRTMConfig",[f6],Object.getOwnPropertyDescriptor(De.prototype,"setRTMConfig"),De.prototype),Fe(De.prototype,"enableContentInspect",[p6],Object.getOwnPropertyDescriptor(De.prototype,"enableContentInspect"),De.prototype),Fe(De.prototype,"disableContentInspect",[m6],Object.getOwnPropertyDescriptor(De.prototype,"disableContentInspect"),De.prototype),Fe(De.prototype,"setImageModeration",[g6],Object.getOwnPropertyDescriptor(De.prototype,"setImageModeration"),De.prototype),Fe(De.prototype,"setP2PTransport",[y6],Object.getOwnPropertyDescriptor(De.prototype,"setP2PTransport"),De.prototype),Fe(De.prototype,"getJoinChannelServiceRecords",[v6],Object.getOwnPropertyDescriptor(De.prototype,"getJoinChannelServiceRecords"),De.prototype),Fe(De.prototype,"setPublishAudioFilterEnabled",[_6],Object.getOwnPropertyDescriptor(De.prototype,"setPublishAudioFilterEnabled"),De.prototype),De);class Gm{constructor(r,i){F(this,"id",0),F(this,"element",void 0),F(this,"peerPair",void 0),F(this,"context",void 0),F(this,"audioPlayerElement",void 0),F(this,"audioTrack",void 0),Gm.count+=1,this.id=Gm.count,this.element=r,this.context=i}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=r=>{const i=document.createElement("audio");i.srcObject=new MediaStream([r.track]),i.play(),this.audioPlayerElement=i}}async switchSdp(){if(!this.peerPair)return;const r=async(s,c)=>{const u=c==="offer"?await s.createOffer():await s.createAnswer();return await s.setLocalDescription(u),s.iceGatheringState==="complete"?s.localDescription:new Ie(h=>{s.onicegatheringstatechange=()=>{s.iceGatheringState==="complete"&&h(s.localDescription)}})},i=async(s,c)=>await s.setRemoteDescription(c);try{const s=await r(this.peerPair[0],"offer");await i(this.peerPair[1],s);const c=await r(this.peerPair[1],"answer");await i(this.peerPair[0],c)}catch(s){throw new se($.LOCAL_AEC_ERROR,s.toString()).print()}}async getTracksFromMediaElement(r){if(this.audioTrack)return this.audioTrack;let i;try{r instanceof HTMLVideoElement&&(r.captureStream?r.captureStream():r.mozCaptureStream()),i=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(r).connect(i)}catch(c){throw new se($.LOCAL_AEC_ERROR,c.toString()).print()}if(!i)throw new se($.LOCAL_AEC_ERROR,"no dest node when local aec").print();const s=i.stream.getAudioTracks()[0];return this.audioTrack=s,s}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const r=this.element,i=await this.getTracksFromMediaElement(r);this.peerPair&&this.peerPair[0].addTrack(i),await this.switchSdp()}close(){A.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(r=>{r.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var S6,ZE;F(Gm,"count",0);const ome=window.AudioContext||window.webkitAudioContext,sme=new(S6=Xe({report:$e}),Fe((ZE=class{constructor(){F(this,"units",[]),F(this,"context",void 0)}processExternalMediaAEC(n){if(!this._doesEnvironmentNeedAEC())return A.debug("the system does not need to process local aec"),-1;this.context||(this.context=new ome);let r=this.units.find(i=>i&&i.getElement()===n);return r||(r=new Gm(n,this.context),this.units.push(r)),r.startEchoCancellation(),A.debug("start processing local audio echo cancellation, id is",r.id),r.id}_doesEnvironmentNeedAEC(){return St().name!==Nt.SAFARI}}).prototype,"processExternalMediaAEC",[S6],Object.getOwnPropertyDescriptor(ZE.prototype,"processExternalMediaAEC"),ZE.prototype),ZE);function b6(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function T6(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?b6(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):b6(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}const SA=window||document;function w6(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!SA)return;const i=$n._cspEventHandlerPointer;if(i&&r)return void console.error(i,r);const s=c=>{if(!(c&&c.blockedURI&&($n.onSecurityPolicyViolation||$n.getListeners(_s.SECURITY_POLICY_VIOLATION).length>0)))return;const u=c.blockedURI;Y("CSP_DETECTED_HOSTNAME_LIST").some(h=>Oe(u).call(u,h))&&($n.onSecurityPolicyViolation&&typeof $n.onSecurityPolicyViolation=="function"&&$n.onSecurityPolicyViolation(c),$n.getListeners(_s.SECURITY_POLICY_VIOLATION).length>0&&$n.safeEmit(_s.SECURITY_POLICY_VIOLATION,c))};i&&SA.removeEventListener("securitypolicyviolation",i),(r||n&&typeof n=="function"||$n.getListeners(_s.SECURITY_POLICY_VIOLATION).length>0)&&SA.addEventListener("securitypolicyviolation",s),$n._cspEventHandlerPointer=s}var cme=R,lme=dV,C6=RegExp.prototype,ume=function(n){return n===C6||cme(C6,n)?lme(n):n.flags},Yr=l(ume);function qh(n){let r=n.length;for(;--r>=0;)n[r]=0}const bA=256,R6=286,$m=30,Hm=15,TA=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),eS=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),dme=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),O6=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sc=new Array(576);qh(sc);const zm=new Array(60);qh(zm);const Km=new Array(512);qh(Km);const qm=new Array(256);qh(qm);const wA=new Array(29);qh(wA);const tS=new Array($m);function CA(n,r,i,s,c){this.static_tree=n,this.extra_bits=r,this.extra_base=i,this.elems=s,this.max_length=c,this.has_stree=n&&n.length}let A6,I6,N6;function RA(n,r){this.dyn_tree=n,this.max_code=0,this.stat_desc=r}qh(tS);const P6=n=>n<256?Km[n]:Km[256+(n>>>7)],Ym=(n,r)=>{n.pending_buf[n.pending++]=255&r,n.pending_buf[n.pending++]=r>>>8&255},pa=(n,r,i)=>{n.bi_valid>16-i?(n.bi_buf|=r<<n.bi_valid&65535,Ym(n,n.bi_buf),n.bi_buf=r>>16-n.bi_valid,n.bi_valid+=i-16):(n.bi_buf|=r<<n.bi_valid&65535,n.bi_valid+=i)},Ts=(n,r,i)=>{pa(n,i[2*r],i[2*r+1])},x6=(n,r)=>{let i=0;do i|=1&n,n>>>=1,i<<=1;while(--r>0);return i>>>1},D6=(n,r,i)=>{const s=new Array(16);let c,u,h=0;for(c=1;c<=Hm;c++)h=h+i[c-1]<<1,s[c]=h;for(u=0;u<=r;u++){let f=n[2*u+1];f!==0&&(n[2*u]=x6(s[f]++,f))}},L6=n=>{let r;for(r=0;r<R6;r++)n.dyn_ltree[2*r]=0;for(r=0;r<$m;r++)n.dyn_dtree[2*r]=0;for(r=0;r<19;r++)n.bl_tree[2*r]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},k6=n=>{n.bi_valid>8?Ym(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},M6=(n,r,i,s)=>{const c=2*r,u=2*i;return n[c]<n[u]||n[c]===n[u]&&s[r]<=s[i]},OA=(n,r,i)=>{const s=n.heap[i];let c=i<<1;for(;c<=n.heap_len&&(c<n.heap_len&&M6(r,n.heap[c+1],n.heap[c],n.depth)&&c++,!M6(r,s,n.heap[c],n.depth));)n.heap[i]=n.heap[c],i=c,c<<=1;n.heap[i]=s},U6=(n,r,i)=>{let s,c,u,h,f=0;if(n.sym_next!==0)do s=255&n.pending_buf[n.sym_buf+f++],s+=(255&n.pending_buf[n.sym_buf+f++])<<8,c=n.pending_buf[n.sym_buf+f++],s===0?Ts(n,c,r):(u=qm[c],Ts(n,u+bA+1,r),h=TA[u],h!==0&&(c-=wA[u],pa(n,c,h)),s--,u=P6(s),Ts(n,u,i),h=eS[u],h!==0&&(s-=tS[u],pa(n,s,h)));while(f<n.sym_next);Ts(n,256,r)},AA=(n,r)=>{const i=r.dyn_tree,s=r.stat_desc.static_tree,c=r.stat_desc.has_stree,u=r.stat_desc.elems;let h,f,m,y=-1;for(n.heap_len=0,n.heap_max=573,h=0;h<u;h++)i[2*h]!==0?(n.heap[++n.heap_len]=y=h,n.depth[h]=0):i[2*h+1]=0;for(;n.heap_len<2;)m=n.heap[++n.heap_len]=y<2?++y:0,i[2*m]=1,n.depth[m]=0,n.opt_len--,c&&(n.static_len-=s[2*m+1]);for(r.max_code=y,h=n.heap_len>>1;h>=1;h--)OA(n,i,h);m=u;do h=n.heap[1],n.heap[1]=n.heap[n.heap_len--],OA(n,i,1),f=n.heap[1],n.heap[--n.heap_max]=h,n.heap[--n.heap_max]=f,i[2*m]=i[2*h]+i[2*f],n.depth[m]=(n.depth[h]>=n.depth[f]?n.depth[h]:n.depth[f])+1,i[2*h+1]=i[2*f+1]=m,n.heap[1]=m++,OA(n,i,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((_,S)=>{const w=S.dyn_tree,O=S.max_code,W=S.stat_desc.static_tree,k=S.stat_desc.has_stree,j=S.stat_desc.extra_bits,H=S.stat_desc.extra_base,K=S.stat_desc.max_length;let Q,ie,re,te,he,Se,Ne=0;for(te=0;te<=Hm;te++)_.bl_count[te]=0;for(w[2*_.heap[_.heap_max]+1]=0,Q=_.heap_max+1;Q<573;Q++)ie=_.heap[Q],te=w[2*w[2*ie+1]+1]+1,te>K&&(te=K,Ne++),w[2*ie+1]=te,ie>O||(_.bl_count[te]++,he=0,ie>=H&&(he=j[ie-H]),Se=w[2*ie],_.opt_len+=Se*(te+he),k&&(_.static_len+=Se*(W[2*ie+1]+he)));if(Ne!==0){do{for(te=K-1;_.bl_count[te]===0;)te--;_.bl_count[te]--,_.bl_count[te+1]+=2,_.bl_count[K]--,Ne-=2}while(Ne>0);for(te=K;te!==0;te--)for(ie=_.bl_count[te];ie!==0;)re=_.heap[--Q],re>O||(w[2*re+1]!==te&&(_.opt_len+=(te-w[2*re+1])*w[2*re],w[2*re+1]=te),ie--)}})(n,r),D6(i,y,n.bl_count)},j6=(n,r,i)=>{let s,c,u=-1,h=r[1],f=0,m=7,y=4;for(h===0&&(m=138,y=3),r[2*(i+1)+1]=65535,s=0;s<=i;s++)c=h,h=r[2*(s+1)+1],++f<m&&c===h||(f<y?n.bl_tree[2*c]+=f:c!==0?(c!==u&&n.bl_tree[2*c]++,n.bl_tree[32]++):f<=10?n.bl_tree[34]++:n.bl_tree[36]++,f=0,u=c,h===0?(m=138,y=3):c===h?(m=6,y=3):(m=7,y=4))},V6=(n,r,i)=>{let s,c,u=-1,h=r[1],f=0,m=7,y=4;for(h===0&&(m=138,y=3),s=0;s<=i;s++)if(c=h,h=r[2*(s+1)+1],!(++f<m&&c===h)){if(f<y)do Ts(n,c,n.bl_tree);while(--f!=0);else c!==0?(c!==u&&(Ts(n,c,n.bl_tree),f--),Ts(n,16,n.bl_tree),pa(n,f-3,2)):f<=10?(Ts(n,17,n.bl_tree),pa(n,f-3,3)):(Ts(n,18,n.bl_tree),pa(n,f-11,7));f=0,u=c,h===0?(m=138,y=3):c===h?(m=6,y=3):(m=7,y=4)}};let B6=!1;const F6=(n,r,i,s)=>{pa(n,0+(s?1:0),3),k6(n),Ym(n,i),Ym(n,~i),i&&n.pending_buf.set(n.window.subarray(r,r+i),n.pending),n.pending+=i};var hme=n=>{B6||((()=>{let r,i,s,c,u;const h=new Array(16);for(s=0,c=0;c<28;c++)for(wA[c]=s,r=0;r<1<<TA[c];r++)qm[s++]=c;for(qm[s-1]=c,u=0,c=0;c<16;c++)for(tS[c]=u,r=0;r<1<<eS[c];r++)Km[u++]=c;for(u>>=7;c<$m;c++)for(tS[c]=u<<7,r=0;r<1<<eS[c]-7;r++)Km[256+u++]=c;for(i=0;i<=Hm;i++)h[i]=0;for(r=0;r<=143;)sc[2*r+1]=8,r++,h[8]++;for(;r<=255;)sc[2*r+1]=9,r++,h[9]++;for(;r<=279;)sc[2*r+1]=7,r++,h[7]++;for(;r<=287;)sc[2*r+1]=8,r++,h[8]++;for(D6(sc,287,h),r=0;r<$m;r++)zm[2*r+1]=5,zm[2*r]=x6(r,5);A6=new CA(sc,TA,257,R6,Hm),I6=new CA(zm,eS,0,$m,Hm),N6=new CA(new Array(0),dme,0,19,7)})(),B6=!0),n.l_desc=new RA(n.dyn_ltree,A6),n.d_desc=new RA(n.dyn_dtree,I6),n.bl_desc=new RA(n.bl_tree,N6),n.bi_buf=0,n.bi_valid=0,L6(n)},fme=(n,r,i,s)=>{let c,u,h=0;n.level>0?(n.strm.data_type===2&&(n.strm.data_type=(f=>{let m,y=4093624447;for(m=0;m<=31;m++,y>>>=1)if(1&y&&f.dyn_ltree[2*m]!==0)return 0;if(f.dyn_ltree[18]!==0||f.dyn_ltree[20]!==0||f.dyn_ltree[26]!==0)return 1;for(m=32;m<bA;m++)if(f.dyn_ltree[2*m]!==0)return 1;return 0})(n)),AA(n,n.l_desc),AA(n,n.d_desc),h=(f=>{let m;for(j6(f,f.dyn_ltree,f.l_desc.max_code),j6(f,f.dyn_dtree,f.d_desc.max_code),AA(f,f.bl_desc),m=18;m>=3&&f.bl_tree[2*O6[m]+1]===0;m--);return f.opt_len+=3*(m+1)+5+5+4,m})(n),c=n.opt_len+3+7>>>3,u=n.static_len+3+7>>>3,u<=c&&(c=u)):c=u=i+5,i+4<=c&&r!==-1?F6(n,r,i,s):n.strategy===4||u===c?(pa(n,2+(s?1:0),3),U6(n,sc,zm)):(pa(n,4+(s?1:0),3),((f,m,y,_)=>{let S;for(pa(f,m-257,5),pa(f,y-1,5),pa(f,_-4,4),S=0;S<_;S++)pa(f,f.bl_tree[2*O6[S]+1],3);V6(f,f.dyn_ltree,m-1),V6(f,f.dyn_dtree,y-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,h+1),U6(n,n.dyn_ltree,n.dyn_dtree)),L6(n),s&&k6(n)},pme=(n,r,i)=>(n.pending_buf[n.sym_buf+n.sym_next++]=r,n.pending_buf[n.sym_buf+n.sym_next++]=r>>8,n.pending_buf[n.sym_buf+n.sym_next++]=i,r===0?n.dyn_ltree[2*i]++:(n.matches++,r--,n.dyn_ltree[2*(qm[i]+bA+1)]++,n.dyn_dtree[2*P6(r)]++),n.sym_next===n.sym_end),mme=n=>{pa(n,2,3),Ts(n,256,sc),(r=>{r.bi_valid===16?(Ym(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=255&r.bi_buf,r.bi_buf>>=8,r.bi_valid-=8)})(n)},gme={_tr_init:hme,_tr_stored_block:F6,_tr_flush_block:fme,_tr_tally:pme,_tr_align:mme},Xm=(n,r,i,s)=>{let c=65535&n,u=n>>>16&65535,h=0;for(;i!==0;){h=i>2e3?2e3:i,i-=h;do c=c+r[s++]|0,u=u+c|0;while(--h);c%=65521,u%=65521}return c|u<<16};const yme=new Uint32Array((()=>{let n,r=[];for(var i=0;i<256;i++){n=i;for(var s=0;s<8;s++)n=1&n?3988292384^n>>>1:n>>>1;r[i]=n}return r})());var ci=(n,r,i,s)=>{const c=yme,u=s+i;n^=-1;for(let h=s;h<u;h++)n=n>>>8^c[255&(n^r[h])];return~n},Wu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Yh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:vme,_tr_stored_block:IA,_tr_flush_block:_me,_tr_tally:sl,_tr_align:Eme}=gme,{Z_NO_FLUSH:cl,Z_PARTIAL_FLUSH:Sme,Z_FULL_FLUSH:bme,Z_FINISH:co,Z_BLOCK:W6,Z_OK:_i,Z_STREAM_END:G6,Z_STREAM_ERROR:ws,Z_DATA_ERROR:Tme,Z_BUF_ERROR:NA,Z_DEFAULT_COMPRESSION:wme,Z_FILTERED:Cme,Z_HUFFMAN_ONLY:nS,Z_RLE:Rme,Z_FIXED:Ome,Z_DEFAULT_STRATEGY:Ame,Z_UNKNOWN:Ime,Z_DEFLATED:rS}=Yh,Gu=258,Cs=262,Xh=42,$u=113,Jm=666,Hu=(n,r)=>(n.msg=Wu[r],r),$6=n=>2*n-(n>4?9:0),ll=n=>{let r=n.length;for(;--r>=0;)n[r]=0},Nme=n=>{let r,i,s,c=n.w_size;r=n.hash_size,s=r;do i=n.head[--s],n.head[s]=i>=c?i-c:0;while(--r);r=c,s=r;do i=n.prev[--s],n.prev[s]=i>=c?i-c:0;while(--r)};let ul=(n,r,i)=>(r<<n.hash_shift^i)&n.hash_mask;const Na=n=>{const r=n.state;let i=r.pending;i>n.avail_out&&(i=n.avail_out),i!==0&&(n.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+i),n.next_out),n.next_out+=i,r.pending_out+=i,n.total_out+=i,n.avail_out-=i,r.pending-=i,r.pending===0&&(r.pending_out=0))},Pa=(n,r)=>{_me(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,r),n.block_start=n.strstart,Na(n.strm)},wn=(n,r)=>{n.pending_buf[n.pending++]=r},Qm=(n,r)=>{n.pending_buf[n.pending++]=r>>>8&255,n.pending_buf[n.pending++]=255&r},PA=(n,r,i,s)=>{let c=n.avail_in;return c>s&&(c=s),c===0?0:(n.avail_in-=c,r.set(n.input.subarray(n.next_in,n.next_in+c),i),n.state.wrap===1?n.adler=Xm(n.adler,r,c,i):n.state.wrap===2&&(n.adler=ci(n.adler,r,c,i)),n.next_in+=c,n.total_in+=c,c)},H6=(n,r)=>{let i,s,c=n.max_chain_length,u=n.strstart,h=n.prev_length,f=n.nice_match;const m=n.strstart>n.w_size-Cs?n.strstart-(n.w_size-Cs):0,y=n.window,_=n.w_mask,S=n.prev,w=n.strstart+Gu;let O=y[u+h-1],W=y[u+h];n.prev_length>=n.good_match&&(c>>=2),f>n.lookahead&&(f=n.lookahead);do if(i=r,y[i+h]===W&&y[i+h-1]===O&&y[i]===y[u]&&y[++i]===y[u+1]){u+=2,i++;do;while(y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&u<w);if(s=Gu-(w-u),u=w-Gu,s>h){if(n.match_start=r,h=s,s>=f)break;O=y[u+h-1],W=y[u+h]}}while((r=S[r&_])>m&&--c!=0);return h<=n.lookahead?h:n.lookahead},Jh=n=>{const r=n.w_size;let i,s,c;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=r+(r-Cs)&&(n.window.set(n.window.subarray(r,r+r-s),0),n.match_start-=r,n.strstart-=r,n.block_start-=r,n.insert>n.strstart&&(n.insert=n.strstart),Nme(n),s+=r),n.strm.avail_in===0)break;if(i=PA(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=i,n.lookahead+n.insert>=3)for(c=n.strstart-n.insert,n.ins_h=n.window[c],n.ins_h=ul(n,n.ins_h,n.window[c+1]);n.insert&&(n.ins_h=ul(n,n.ins_h,n.window[c+3-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<Cs&&n.strm.avail_in!==0)},z6=(n,r)=>{let i,s,c,u=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,h=0,f=n.strm.avail_in;do{if(i=65535,c=n.bi_valid+42>>3,n.strm.avail_out<c||(c=n.strm.avail_out-c,s=n.strstart-n.block_start,i>s+n.strm.avail_in&&(i=s+n.strm.avail_in),i>c&&(i=c),i<u&&(i===0&&r!==co||r===cl||i!==s+n.strm.avail_in)))break;h=r===co&&i===s+n.strm.avail_in?1:0,IA(n,0,0,h),n.pending_buf[n.pending-4]=i,n.pending_buf[n.pending-3]=i>>8,n.pending_buf[n.pending-2]=~i,n.pending_buf[n.pending-1]=~i>>8,Na(n.strm),s&&(s>i&&(s=i),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+s),n.strm.next_out),n.strm.next_out+=s,n.strm.avail_out-=s,n.strm.total_out+=s,n.block_start+=s,i-=s),i&&(PA(n.strm,n.strm.output,n.strm.next_out,i),n.strm.next_out+=i,n.strm.avail_out-=i,n.strm.total_out+=i)}while(h===0);return f-=n.strm.avail_in,f&&(f>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=f&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-f,n.strm.next_in),n.strstart),n.strstart+=f,n.insert+=f>n.w_size-n.insert?n.w_size-n.insert:f),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),h?4:r!==cl&&r!==co&&n.strm.avail_in===0&&n.strstart===n.block_start?2:(c=n.window_size-n.strstart,n.strm.avail_in>c&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,c+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),c>n.strm.avail_in&&(c=n.strm.avail_in),c&&(PA(n.strm,n.window,n.strstart,c),n.strstart+=c,n.insert+=c>n.w_size-n.insert?n.w_size-n.insert:c),n.high_water<n.strstart&&(n.high_water=n.strstart),c=n.bi_valid+42>>3,c=n.pending_buf_size-c>65535?65535:n.pending_buf_size-c,u=c>n.w_size?n.w_size:c,s=n.strstart-n.block_start,(s>=u||(s||r===co)&&r!==cl&&n.strm.avail_in===0&&s<=c)&&(i=s>c?c:s,h=r===co&&n.strm.avail_in===0&&i===s?1:0,IA(n,n.block_start,i,h),n.block_start+=i,Na(n.strm)),h?3:1)},xA=(n,r)=>{let i,s;for(;;){if(n.lookahead<Cs){if(Jh(n),n.lookahead<Cs&&r===cl)return 1;if(n.lookahead===0)break}if(i=0,n.lookahead>=3&&(n.ins_h=ul(n,n.ins_h,n.window[n.strstart+3-1]),i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),i!==0&&n.strstart-i<=n.w_size-Cs&&(n.match_length=H6(n,i)),n.match_length>=3)if(s=sl(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do n.strstart++,n.ins_h=ul(n,n.ins_h,n.window[n.strstart+3-1]),i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!=0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=ul(n,n.ins_h,n.window[n.strstart+1]);else s=sl(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(s&&(Pa(n,!1),n.strm.avail_out===0))return 1}return n.insert=n.strstart<2?n.strstart:2,r===co?(Pa(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(Pa(n,!1),n.strm.avail_out===0)?1:2},Qh=(n,r)=>{let i,s,c;for(;;){if(n.lookahead<Cs){if(Jh(n),n.lookahead<Cs&&r===cl)return 1;if(n.lookahead===0)break}if(i=0,n.lookahead>=3&&(n.ins_h=ul(n,n.ins_h,n.window[n.strstart+3-1]),i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,i!==0&&n.prev_length<n.max_lazy_match&&n.strstart-i<=n.w_size-Cs&&(n.match_length=H6(n,i),n.match_length<=5&&(n.strategy===Cme||n.match_length===3&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){c=n.strstart+n.lookahead-3,s=sl(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=c&&(n.ins_h=ul(n,n.ins_h,n.window[n.strstart+3-1]),i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!=0);if(n.match_available=0,n.match_length=2,n.strstart++,s&&(Pa(n,!1),n.strm.avail_out===0))return 1}else if(n.match_available){if(s=sl(n,0,n.window[n.strstart-1]),s&&Pa(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(s=sl(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,r===co?(Pa(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(Pa(n,!1),n.strm.avail_out===0)?1:2};function Rs(n,r,i,s,c){this.good_length=n,this.max_lazy=r,this.nice_length=i,this.max_chain=s,this.func=c}const Zm=[new Rs(0,0,0,0,z6),new Rs(4,4,8,4,xA),new Rs(4,5,16,8,xA),new Rs(4,6,32,32,xA),new Rs(4,4,16,16,Qh),new Rs(8,16,32,32,Qh),new Rs(8,16,128,128,Qh),new Rs(8,32,128,256,Qh),new Rs(32,128,258,1024,Qh),new Rs(32,258,258,4096,Qh)];function Pme(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=rS,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ll(this.dyn_ltree),ll(this.dyn_dtree),ll(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ll(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ll(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const eg=n=>{if(!n)return 1;const r=n.state;return!r||r.strm!==n||r.status!==Xh&&r.status!==57&&r.status!==69&&r.status!==73&&r.status!==91&&r.status!==103&&r.status!==$u&&r.status!==Jm?1:0},K6=n=>{if(eg(n))return Hu(n,ws);n.total_in=n.total_out=0,n.data_type=Ime;const r=n.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?57:r.wrap?Xh:$u,n.adler=r.wrap===2?0:1,r.last_flush=-2,vme(r),_i},q6=n=>{const r=K6(n);return r===_i&&(i=>{i.window_size=2*i.w_size,ll(i.head),i.max_lazy_match=Zm[i.level].max_lazy,i.good_match=Zm[i.level].good_length,i.nice_match=Zm[i.level].nice_length,i.max_chain_length=Zm[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0})(n.state),r},Y6=(n,r,i,s,c,u)=>{if(!n)return ws;let h=1;if(r===wme&&(r=6),s<0?(h=0,s=-s):s>15&&(h=2,s-=16),c<1||c>9||i!==rS||s<8||s>15||r<0||r>9||u<0||u>Ome||s===8&&h!==1)return Hu(n,ws);s===8&&(s=9);const f=new Pme;return n.state=f,f.strm=n,f.status=Xh,f.wrap=h,f.gzhead=null,f.w_bits=s,f.w_size=1<<f.w_bits,f.w_mask=f.w_size-1,f.hash_bits=c+7,f.hash_size=1<<f.hash_bits,f.hash_mask=f.hash_size-1,f.hash_shift=~~((f.hash_bits+3-1)/3),f.window=new Uint8Array(2*f.w_size),f.head=new Uint16Array(f.hash_size),f.prev=new Uint16Array(f.w_size),f.lit_bufsize=1<<c+6,f.pending_buf_size=4*f.lit_bufsize,f.pending_buf=new Uint8Array(f.pending_buf_size),f.sym_buf=f.lit_bufsize,f.sym_end=3*(f.lit_bufsize-1),f.level=r,f.strategy=u,f.method=i,q6(n)};var xme=(n,r)=>{if(eg(n)||r>W6||r<0)return n?Hu(n,ws):ws;const i=n.state;if(!n.output||n.avail_in!==0&&!n.input||i.status===Jm&&r!==co)return Hu(n,n.avail_out===0?NA:ws);const s=i.last_flush;if(i.last_flush=r,i.pending!==0){if(Na(n),n.avail_out===0)return i.last_flush=-1,_i}else if(n.avail_in===0&&$6(r)<=$6(s)&&r!==co)return Hu(n,NA);if(i.status===Jm&&n.avail_in!==0)return Hu(n,NA);if(i.status===Xh&&i.wrap===0&&(i.status=$u),i.status===Xh){let c=rS+(i.w_bits-8<<4)<<8,u=-1;if(u=i.strategy>=nS||i.level<2?0:i.level<6?1:i.level===6?2:3,c|=u<<6,i.strstart!==0&&(c|=32),c+=31-c%31,Qm(i,c),i.strstart!==0&&(Qm(i,n.adler>>>16),Qm(i,65535&n.adler)),n.adler=1,i.status=$u,Na(n),i.pending!==0)return i.last_flush=-1,_i}if(i.status===57){if(n.adler=0,wn(i,31),wn(i,139),wn(i,8),i.gzhead)wn(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),wn(i,255&i.gzhead.time),wn(i,i.gzhead.time>>8&255),wn(i,i.gzhead.time>>16&255),wn(i,i.gzhead.time>>24&255),wn(i,i.level===9?2:i.strategy>=nS||i.level<2?4:0),wn(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(wn(i,255&i.gzhead.extra.length),wn(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=ci(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(wn(i,0),wn(i,0),wn(i,0),wn(i,0),wn(i,0),wn(i,i.level===9?2:i.strategy>=nS||i.level<2?4:0),wn(i,3),i.status=$u,Na(n),i.pending!==0)return i.last_flush=-1,_i}if(i.status===69){if(i.gzhead.extra){let c=i.pending,u=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+u>i.pending_buf_size;){let f=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+f),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>c&&(n.adler=ci(n.adler,i.pending_buf,i.pending-c,c)),i.gzindex+=f,Na(n),i.pending!==0)return i.last_flush=-1,_i;c=0,u-=f}let h=new Uint8Array(i.gzhead.extra);i.pending_buf.set(h.subarray(i.gzindex,i.gzindex+u),i.pending),i.pending+=u,i.gzhead.hcrc&&i.pending>c&&(n.adler=ci(n.adler,i.pending_buf,i.pending-c,c)),i.gzindex=0}i.status=73}if(i.status===73){if(i.gzhead.name){let c,u=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(n.adler=ci(n.adler,i.pending_buf,i.pending-u,u)),Na(n),i.pending!==0)return i.last_flush=-1,_i;u=0}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,wn(i,c)}while(c!==0);i.gzhead.hcrc&&i.pending>u&&(n.adler=ci(n.adler,i.pending_buf,i.pending-u,u)),i.gzindex=0}i.status=91}if(i.status===91){if(i.gzhead.comment){let c,u=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(n.adler=ci(n.adler,i.pending_buf,i.pending-u,u)),Na(n),i.pending!==0)return i.last_flush=-1,_i;u=0}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,wn(i,c)}while(c!==0);i.gzhead.hcrc&&i.pending>u&&(n.adler=ci(n.adler,i.pending_buf,i.pending-u,u))}i.status=103}if(i.status===103){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Na(n),i.pending!==0))return i.last_flush=-1,_i;wn(i,255&n.adler),wn(i,n.adler>>8&255),n.adler=0}if(i.status=$u,Na(n),i.pending!==0)return i.last_flush=-1,_i}if(n.avail_in!==0||i.lookahead!==0||r!==cl&&i.status!==Jm){let c=i.level===0?z6(i,r):i.strategy===nS?((u,h)=>{let f;for(;;){if(u.lookahead===0&&(Jh(u),u.lookahead===0)){if(h===cl)return 1;break}if(u.match_length=0,f=sl(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,f&&(Pa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===co?(Pa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Pa(u,!1),u.strm.avail_out===0)?1:2})(i,r):i.strategy===Rme?((u,h)=>{let f,m,y,_;const S=u.window;for(;;){if(u.lookahead<=Gu){if(Jh(u),u.lookahead<=Gu&&h===cl)return 1;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=3&&u.strstart>0&&(y=u.strstart-1,m=S[y],m===S[++y]&&m===S[++y]&&m===S[++y])){_=u.strstart+Gu;do;while(m===S[++y]&&m===S[++y]&&m===S[++y]&&m===S[++y]&&m===S[++y]&&m===S[++y]&&m===S[++y]&&m===S[++y]&&y<_);u.match_length=Gu-(_-y),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=3?(f=sl(u,1,u.match_length-3),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(f=sl(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),f&&(Pa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===co?(Pa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Pa(u,!1),u.strm.avail_out===0)?1:2})(i,r):Zm[i.level].func(i,r);if(c!==3&&c!==4||(i.status=Jm),c===1||c===3)return n.avail_out===0&&(i.last_flush=-1),_i;if(c===2&&(r===Sme?Eme(i):r!==W6&&(IA(i,0,0,!1),r===bme&&(ll(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Na(n),n.avail_out===0))return i.last_flush=-1,_i}return r!==co?_i:i.wrap<=0?G6:(i.wrap===2?(wn(i,255&n.adler),wn(i,n.adler>>8&255),wn(i,n.adler>>16&255),wn(i,n.adler>>24&255),wn(i,255&n.total_in),wn(i,n.total_in>>8&255),wn(i,n.total_in>>16&255),wn(i,n.total_in>>24&255)):(Qm(i,n.adler>>>16),Qm(i,65535&n.adler)),Na(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?_i:G6)},Dme=(n,r)=>{let i=r.length;if(eg(n))return ws;const s=n.state,c=s.wrap;if(c===2||c===1&&s.status!==Xh||s.lookahead)return ws;if(c===1&&(n.adler=Xm(n.adler,r,i,0)),s.wrap=0,i>=s.w_size){c===0&&(ll(s.head),s.strstart=0,s.block_start=0,s.insert=0);let m=new Uint8Array(s.w_size);m.set(r.subarray(i-s.w_size,i),0),r=m,i=s.w_size}const u=n.avail_in,h=n.next_in,f=n.input;for(n.avail_in=i,n.next_in=0,n.input=r,Jh(s);s.lookahead>=3;){let m=s.strstart,y=s.lookahead-2;do s.ins_h=ul(s,s.ins_h,s.window[m+3-1]),s.prev[m&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=m,m++;while(--y);s.strstart=m,s.lookahead=2,Jh(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,n.next_in=h,n.input=f,n.avail_in=u,s.wrap=c,_i},tg={deflateInit:(n,r)=>Y6(n,r,rS,15,8,Ame),deflateInit2:Y6,deflateReset:q6,deflateResetKeep:K6,deflateSetHeader:(n,r)=>eg(n)||n.state.wrap!==2?ws:(n.state.gzhead=r,_i),deflate:xme,deflateEnd:n=>{if(eg(n))return ws;const r=n.state.status;return n.state=null,r===$u?Hu(n,Tme):_i},deflateSetDictionary:Dme,deflateInfo:"pako deflate (from Nodeca project)"};const Lme=(n,r)=>Object.prototype.hasOwnProperty.call(n,r);var X6=function(n){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const i=r.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const s in i)Lme(i,s)&&(n[s]=i[s])}}return n},J6=n=>{let r=0;for(let s=0,c=n.length;s<c;s++)r+=n[s].length;const i=new Uint8Array(r);for(let s=0,c=0,u=n.length;s<u;s++){let h=n[s];i.set(h,c),c+=h.length}return i};let Q6=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Q6=!1}const ng=new Uint8Array(256);for(let n=0;n<256;n++)ng[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;ng[254]=ng[254]=1;var DA=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let r,i,s,c,u,h=n.length,f=0;for(c=0;c<h;c++)i=n.charCodeAt(c),(64512&i)==55296&&c+1<h&&(s=n.charCodeAt(c+1),(64512&s)==56320&&(i=65536+(i-55296<<10)+(s-56320),c++)),f+=i<128?1:i<2048?2:i<65536?3:4;for(r=new Uint8Array(f),u=0,c=0;u<f;c++)i=n.charCodeAt(c),(64512&i)==55296&&c+1<h&&(s=n.charCodeAt(c+1),(64512&s)==56320&&(i=65536+(i-55296<<10)+(s-56320),c++)),i<128?r[u++]=i:i<2048?(r[u++]=192|i>>>6,r[u++]=128|63&i):i<65536?(r[u++]=224|i>>>12,r[u++]=128|i>>>6&63,r[u++]=128|63&i):(r[u++]=240|i>>>18,r[u++]=128|i>>>12&63,r[u++]=128|i>>>6&63,r[u++]=128|63&i);return r},kme=(n,r)=>{const i=r||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,r));let s,c;const u=new Array(2*i);for(c=0,s=0;s<i;){let h=n[s++];if(h<128){u[c++]=h;continue}let f=ng[h];if(f>4)u[c++]=65533,s+=f-1;else{for(h&=f===2?31:f===3?15:7;f>1&&s<i;)h=h<<6|63&n[s++],f--;f>1?u[c++]=65533:h<65536?u[c++]=h:(h-=65536,u[c++]=55296|h>>10&1023,u[c++]=56320|1023&h)}}return((h,f)=>{if(f<65534&&h.subarray&&Q6)return String.fromCharCode.apply(null,h.length===f?h:h.subarray(0,f));let m="";for(let y=0;y<f;y++)m+=String.fromCharCode(h[y]);return m})(u,c)},Mme=(n,r)=>{(r=r||n.length)>n.length&&(r=n.length);let i=r-1;for(;i>=0&&(192&n[i])==128;)i--;return i<0||i===0?r:i+ng[n[i]]>r?i:r},Z6=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const eW=Object.prototype.toString,{Z_NO_FLUSH:Ume,Z_SYNC_FLUSH:jme,Z_FULL_FLUSH:Vme,Z_FINISH:Bme,Z_OK:iS,Z_STREAM_END:Fme,Z_DEFAULT_COMPRESSION:Wme,Z_DEFAULT_STRATEGY:Gme,Z_DEFLATED:$me}=Yh;function rg(n){this.options=X6({level:Wme,method:$me,chunkSize:16384,windowBits:15,memLevel:8,strategy:Gme},n||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Z6,this.strm.avail_out=0;let i=tg.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(i!==iS)throw new Error(Wu[i]);if(r.header&&tg.deflateSetHeader(this.strm,r.header),r.dictionary){let s;if(s=typeof r.dictionary=="string"?DA(r.dictionary):eW.call(r.dictionary)==="[object ArrayBuffer]"?new Uint8Array(r.dictionary):r.dictionary,i=tg.deflateSetDictionary(this.strm,s),i!==iS)throw new Error(Wu[i]);this._dict_set=!0}}function LA(n,r){const i=new rg(r);if(i.push(n,!0),i.err)throw i.msg||Wu[i.err];return i.result}rg.prototype.push=function(n,r){const i=this.strm,s=this.options.chunkSize;let c,u;if(this.ended)return!1;for(u=r===~~r?r:r===!0?Bme:Ume,typeof n=="string"?i.input=DA(n):eW.call(n)==="[object ArrayBuffer]"?i.input=new Uint8Array(n):i.input=n,i.next_in=0,i.avail_in=i.input.length;;)if(i.avail_out===0&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),(u===jme||u===Vme)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(c=tg.deflate(i,u),c===Fme)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),c=tg.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===iS;if(i.avail_out!==0){if(u>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(i.avail_in===0)break}else this.onData(i.output)}return!0},rg.prototype.onData=function(n){this.chunks.push(n)},rg.prototype.onEnd=function(n){n===iS&&(this.result=J6(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var Hme={Deflate:rg,deflate:LA,deflateRaw:function(n,r){return(r=r||{}).raw=!0,LA(n,r)},gzip:function(n,r){return(r=r||{}).gzip=!0,LA(n,r)},constants:Yh};const aS=16209;var zme=function(n,r){let i,s,c,u,h,f,m,y,_,S,w,O,W,k,j,H,K,Q,ie,re,te,he,Se,Ne;const ke=n.state;i=n.next_in,Se=n.input,s=i+(n.avail_in-5),c=n.next_out,Ne=n.output,u=c-(r-n.avail_out),h=c+(n.avail_out-257),f=ke.dmax,m=ke.wsize,y=ke.whave,_=ke.wnext,S=ke.window,w=ke.hold,O=ke.bits,W=ke.lencode,k=ke.distcode,j=(1<<ke.lenbits)-1,H=(1<<ke.distbits)-1;e:do{O<15&&(w+=Se[i++]<<O,O+=8,w+=Se[i++]<<O,O+=8),K=W[w&j];t:for(;;){if(Q=K>>>24,w>>>=Q,O-=Q,Q=K>>>16&255,Q===0)Ne[c++]=65535&K;else{if(!(16&Q)){if(64&Q){if(32&Q){ke.mode=16191;break e}n.msg="invalid literal/length code",ke.mode=aS;break e}K=W[(65535&K)+(w&(1<<Q)-1)];continue t}for(ie=65535&K,Q&=15,Q&&(O<Q&&(w+=Se[i++]<<O,O+=8),ie+=w&(1<<Q)-1,w>>>=Q,O-=Q),O<15&&(w+=Se[i++]<<O,O+=8,w+=Se[i++]<<O,O+=8),K=k[w&H];;){if(Q=K>>>24,w>>>=Q,O-=Q,Q=K>>>16&255,16&Q){if(re=65535&K,Q&=15,O<Q&&(w+=Se[i++]<<O,O+=8,O<Q&&(w+=Se[i++]<<O,O+=8)),re+=w&(1<<Q)-1,re>f){n.msg="invalid distance too far back",ke.mode=aS;break e}if(w>>>=Q,O-=Q,Q=c-u,re>Q){if(Q=re-Q,Q>y&&ke.sane){n.msg="invalid distance too far back",ke.mode=aS;break e}if(te=0,he=S,_===0){if(te+=m-Q,Q<ie){ie-=Q;do Ne[c++]=S[te++];while(--Q);te=c-re,he=Ne}}else if(_<Q){if(te+=m+_-Q,Q-=_,Q<ie){ie-=Q;do Ne[c++]=S[te++];while(--Q);if(te=0,_<ie){Q=_,ie-=Q;do Ne[c++]=S[te++];while(--Q);te=c-re,he=Ne}}}else if(te+=_-Q,Q<ie){ie-=Q;do Ne[c++]=S[te++];while(--Q);te=c-re,he=Ne}for(;ie>2;)Ne[c++]=he[te++],Ne[c++]=he[te++],Ne[c++]=he[te++],ie-=3;ie&&(Ne[c++]=he[te++],ie>1&&(Ne[c++]=he[te++]))}else{te=c-re;do Ne[c++]=Ne[te++],Ne[c++]=Ne[te++],Ne[c++]=Ne[te++],ie-=3;while(ie>2);ie&&(Ne[c++]=Ne[te++],ie>1&&(Ne[c++]=Ne[te++]))}break}if(64&Q){n.msg="invalid distance code",ke.mode=aS;break e}K=k[(65535&K)+(w&(1<<Q)-1)]}}break}}while(i<s&&c<h);ie=O>>3,i-=ie,O-=ie<<3,w&=(1<<O)-1,n.next_in=i,n.next_out=c,n.avail_in=i<s?s-i+5:5-(i-s),n.avail_out=c<h?h-c+257:257-(c-h),ke.hold=w,ke.bits=O};const oS=15,Kme=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),qme=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Yme=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Xme=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ig=(n,r,i,s,c,u,h,f)=>{const m=f.bits;let y,_,S,w,O,W,k=0,j=0,H=0,K=0,Q=0,ie=0,re=0,te=0,he=0,Se=0,Ne=null;const ke=new Uint16Array(16),pt=new Uint16Array(16);let mt,Xt,An,_n=null;for(k=0;k<=oS;k++)ke[k]=0;for(j=0;j<s;j++)ke[r[i+j]]++;for(Q=m,K=oS;K>=1&&ke[K]===0;K--);if(Q>K&&(Q=K),K===0)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(H=1;H<K&&ke[H]===0;H++);for(Q<H&&(Q=H),te=1,k=1;k<=oS;k++)if(te<<=1,te-=ke[k],te<0)return-1;if(te>0&&(n===0||K!==1))return-1;for(pt[1]=0,k=1;k<oS;k++)pt[k+1]=pt[k]+ke[k];for(j=0;j<s;j++)r[i+j]!==0&&(h[pt[r[i+j]]++]=j);if(n===0?(Ne=_n=h,W=20):n===1?(Ne=Kme,_n=qme,W=257):(Ne=Yme,_n=Xme,W=0),Se=0,j=0,k=H,O=u,ie=Q,re=0,S=-1,he=1<<Q,w=he-1,n===1&&he>852||n===2&&he>592)return 1;for(;;){mt=k-re,h[j]+1<W?(Xt=0,An=h[j]):h[j]>=W?(Xt=_n[h[j]-W],An=Ne[h[j]-W]):(Xt=96,An=0),y=1<<k-re,_=1<<ie,H=_;do _-=y,c[O+(Se>>re)+_]=mt<<24|Xt<<16|An;while(_!==0);for(y=1<<k-1;Se&y;)y>>=1;if(y!==0?(Se&=y-1,Se+=y):Se=0,j++,--ke[k]==0){if(k===K)break;k=r[i+h[j]]}if(k>Q&&(Se&w)!==S){for(re===0&&(re=Q),O+=H,ie=k-re,te=1<<ie;ie+re<K&&(te-=ke[ie+re],!(te<=0));)ie++,te<<=1;if(he+=1<<ie,n===1&&he>852||n===2&&he>592)return 1;S=Se&w,c[S]=Q<<24|ie<<16|O-u}}return Se!==0&&(c[O+Se]=k-re<<24|64<<16),f.bits=Q,0};const{Z_FINISH:tW,Z_BLOCK:Jme,Z_TREES:sS,Z_OK:zu,Z_STREAM_END:Qme,Z_NEED_DICT:Zme,Z_STREAM_ERROR:lo,Z_DATA_ERROR:nW,Z_MEM_ERROR:rW,Z_BUF_ERROR:ege,Z_DEFLATED:iW}=Yh,cS=16180,lS=16190,cc=16191,kA=16192,MA=16194,uS=16199,dS=16200,UA=16206,fr=16209,aW=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function tge(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ku=n=>{if(!n)return 1;const r=n.state;return!r||r.strm!==n||r.mode<cS||r.mode>16211?1:0},oW=n=>{if(Ku(n))return lo;const r=n.state;return n.total_in=n.total_out=r.total=0,n.msg="",r.wrap&&(n.adler=1&r.wrap),r.mode=cS,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(852),r.distcode=r.distdyn=new Int32Array(592),r.sane=1,r.back=-1,zu},sW=n=>{if(Ku(n))return lo;const r=n.state;return r.wsize=0,r.whave=0,r.wnext=0,oW(n)},cW=(n,r)=>{let i;if(Ku(n))return lo;const s=n.state;return r<0?(i=0,r=-r):(i=5+(r>>4),r<48&&(r&=15)),r&&(r<8||r>15)?lo:(s.window!==null&&s.wbits!==r&&(s.window=null),s.wrap=i,s.wbits=r,sW(n))},lW=(n,r)=>{if(!n)return lo;const i=new tge;n.state=i,i.strm=n,i.window=null,i.mode=cS;const s=cW(n,r);return s!==zu&&(n.state=null),s};let jA,VA,uW=!0;const nge=n=>{if(uW){jA=new Int32Array(512),VA=new Int32Array(32);let r=0;for(;r<144;)n.lens[r++]=8;for(;r<256;)n.lens[r++]=9;for(;r<280;)n.lens[r++]=7;for(;r<288;)n.lens[r++]=8;for(ig(1,n.lens,0,288,jA,0,n.work,{bits:9}),r=0;r<32;)n.lens[r++]=5;ig(2,n.lens,0,32,VA,0,n.work,{bits:5}),uW=!1}n.lencode=jA,n.lenbits=9,n.distcode=VA,n.distbits=5},dW=(n,r,i,s)=>{let c;const u=n.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),s>=u.wsize?(u.window.set(r.subarray(i-u.wsize,i),0),u.wnext=0,u.whave=u.wsize):(c=u.wsize-u.wnext,c>s&&(c=s),u.window.set(r.subarray(i-s,i-s+c),u.wnext),(s-=c)?(u.window.set(r.subarray(i-s,i),0),u.wnext=s,u.whave=u.wsize):(u.wnext+=c,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=c))),0};var rge=(n,r)=>{let i,s,c,u,h,f,m,y,_,S,w,O,W,k,j,H,K,Q,ie,re,te,he,Se=0;const Ne=new Uint8Array(4);let ke,pt;const mt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ku(n)||!n.output||!n.input&&n.avail_in!==0)return lo;i=n.state,i.mode===cc&&(i.mode=kA),h=n.next_out,c=n.output,m=n.avail_out,u=n.next_in,s=n.input,f=n.avail_in,y=i.hold,_=i.bits,S=f,w=m,he=zu;e:for(;;)switch(i.mode){case cS:if(i.wrap===0){i.mode=kA;break}for(;_<16;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(2&i.wrap&&y===35615){i.wbits===0&&(i.wbits=15),i.check=0,Ne[0]=255&y,Ne[1]=y>>>8&255,i.check=ci(i.check,Ne,2,0),y=0,_=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&y)<<8)+(y>>8))%31){n.msg="incorrect header check",i.mode=fr;break}if((15&y)!==iW){n.msg="unknown compression method",i.mode=fr;break}if(y>>>=4,_-=4,te=8+(15&y),i.wbits===0&&(i.wbits=te),te>15||te>i.wbits){n.msg="invalid window size",i.mode=fr;break}i.dmax=1<<i.wbits,i.flags=0,n.adler=i.check=1,i.mode=512&y?16189:cc,y=0,_=0;break;case 16181:for(;_<16;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(i.flags=y,(255&Yr(i))!==iW){n.msg="unknown compression method",i.mode=fr;break}if(57344&Yr(i)){n.msg="unknown header flags set",i.mode=fr;break}i.head&&(i.head.text=y>>8&1),512&Yr(i)&&4&i.wrap&&(Ne[0]=255&y,Ne[1]=y>>>8&255,i.check=ci(i.check,Ne,2,0)),y=0,_=0,i.mode=16182;case 16182:for(;_<32;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.head&&(i.head.time=y),512&Yr(i)&&4&i.wrap&&(Ne[0]=255&y,Ne[1]=y>>>8&255,Ne[2]=y>>>16&255,Ne[3]=y>>>24&255,i.check=ci(i.check,Ne,4,0)),y=0,_=0,i.mode=16183;case 16183:for(;_<16;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.head&&(i.head.xflags=255&y,i.head.os=y>>8),512&Yr(i)&&4&i.wrap&&(Ne[0]=255&y,Ne[1]=y>>>8&255,i.check=ci(i.check,Ne,2,0)),y=0,_=0,i.mode=16184;case 16184:if(1024&Yr(i)){for(;_<16;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.length=y,i.head&&(i.head.extra_len=y),512&Yr(i)&&4&i.wrap&&(Ne[0]=255&y,Ne[1]=y>>>8&255,i.check=ci(i.check,Ne,2,0)),y=0,_=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&Yr(i)&&(O=i.length,O>f&&(O=f),O&&(i.head&&(te=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(s.subarray(u,u+O),te)),512&Yr(i)&&4&i.wrap&&(i.check=ci(i.check,s,O,u)),f-=O,u+=O,i.length-=O),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&Yr(i)){if(f===0)break e;O=0;do te=s[u+O++],i.head&&te&&i.length<65536&&(i.head.name+=String.fromCharCode(te));while(te&&O<f);if(512&Yr(i)&&4&i.wrap&&(i.check=ci(i.check,s,O,u)),f-=O,u+=O,te)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&Yr(i)){if(f===0)break e;O=0;do te=s[u+O++],i.head&&te&&i.length<65536&&(i.head.comment+=String.fromCharCode(te));while(te&&O<f);if(512&Yr(i)&&4&i.wrap&&(i.check=ci(i.check,s,O,u)),f-=O,u+=O,te)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&Yr(i)){for(;_<16;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(4&i.wrap&&y!==(65535&i.check)){n.msg="header crc mismatch",i.mode=fr;break}y=0,_=0}i.head&&(i.head.hcrc=Yr(i)>>9&1,i.head.done=!0),n.adler=i.check=0,i.mode=cc;break;case 16189:for(;_<32;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}n.adler=i.check=aW(y),y=0,_=0,i.mode=lS;case lS:if(i.havedict===0)return n.next_out=h,n.avail_out=m,n.next_in=u,n.avail_in=f,i.hold=y,i.bits=_,Zme;n.adler=i.check=1,i.mode=cc;case cc:if(r===Jme||r===sS)break e;case kA:if(i.last){y>>>=7&_,_-=7&_,i.mode=UA;break}for(;_<3;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}switch(i.last=1&y,y>>>=1,_-=1,3&y){case 0:i.mode=16193;break;case 1:if(nge(i),i.mode=uS,r===sS){y>>>=2,_-=2;break e}break;case 2:i.mode=16196;break;case 3:n.msg="invalid block type",i.mode=fr}y>>>=2,_-=2;break;case 16193:for(y>>>=7&_,_-=7&_;_<32;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if((65535&y)!=(y>>>16^65535)){n.msg="invalid stored block lengths",i.mode=fr;break}if(i.length=65535&y,y=0,_=0,i.mode=MA,r===sS)break e;case MA:i.mode=16195;case 16195:if(O=i.length,O){if(O>f&&(O=f),O>m&&(O=m),O===0)break e;c.set(s.subarray(u,u+O),h),f-=O,u+=O,m-=O,h+=O,i.length-=O;break}i.mode=cc;break;case 16196:for(;_<14;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(i.nlen=257+(31&y),y>>>=5,_-=5,i.ndist=1+(31&y),y>>>=5,_-=5,i.ncode=4+(15&y),y>>>=4,_-=4,i.nlen>286||i.ndist>30){n.msg="too many length or distance symbols",i.mode=fr;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;_<3;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.lens[mt[i.have++]]=7&y,y>>>=3,_-=3}for(;i.have<19;)i.lens[mt[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,ke={bits:i.lenbits},he=ig(0,i.lens,0,19,i.lencode,0,i.work,ke),i.lenbits=ke.bits,he){n.msg="invalid code lengths set",i.mode=fr;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;Se=i.lencode[y&(1<<i.lenbits)-1],j=Se>>>24,H=Se>>>16&255,K=65535&Se,!(j<=_);){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(K<16)y>>>=j,_-=j,i.lens[i.have++]=K;else{if(K===16){for(pt=j+2;_<pt;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(y>>>=j,_-=j,i.have===0){n.msg="invalid bit length repeat",i.mode=fr;break}te=i.lens[i.have-1],O=3+(3&y),y>>>=2,_-=2}else if(K===17){for(pt=j+3;_<pt;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}y>>>=j,_-=j,te=0,O=3+(7&y),y>>>=3,_-=3}else{for(pt=j+7;_<pt;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}y>>>=j,_-=j,te=0,O=11+(127&y),y>>>=7,_-=7}if(i.have+O>i.nlen+i.ndist){n.msg="invalid bit length repeat",i.mode=fr;break}for(;O--;)i.lens[i.have++]=te}}if(i.mode===fr)break;if(i.lens[256]===0){n.msg="invalid code -- missing end-of-block",i.mode=fr;break}if(i.lenbits=9,ke={bits:i.lenbits},he=ig(1,i.lens,0,i.nlen,i.lencode,0,i.work,ke),i.lenbits=ke.bits,he){n.msg="invalid literal/lengths set",i.mode=fr;break}if(i.distbits=6,i.distcode=i.distdyn,ke={bits:i.distbits},he=ig(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,ke),i.distbits=ke.bits,he){n.msg="invalid distances set",i.mode=fr;break}if(i.mode=uS,r===sS)break e;case uS:i.mode=dS;case dS:if(f>=6&&m>=258){n.next_out=h,n.avail_out=m,n.next_in=u,n.avail_in=f,i.hold=y,i.bits=_,zme(n,w),h=n.next_out,c=n.output,m=n.avail_out,u=n.next_in,s=n.input,f=n.avail_in,y=i.hold,_=i.bits,i.mode===cc&&(i.back=-1);break}for(i.back=0;Se=i.lencode[y&(1<<i.lenbits)-1],j=Se>>>24,H=Se>>>16&255,K=65535&Se,!(j<=_);){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(H&&!(240&H)){for(Q=j,ie=H,re=K;Se=i.lencode[re+((y&(1<<Q+ie)-1)>>Q)],j=Se>>>24,H=Se>>>16&255,K=65535&Se,!(Q+j<=_);){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}y>>>=Q,_-=Q,i.back+=Q}if(y>>>=j,_-=j,i.back+=j,i.length=K,H===0){i.mode=16205;break}if(32&H){i.back=-1,i.mode=cc;break}if(64&H){n.msg="invalid literal/length code",i.mode=fr;break}i.extra=15&H,i.mode=16201;case 16201:if(i.extra){for(pt=i.extra;_<pt;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.length+=y&(1<<i.extra)-1,y>>>=i.extra,_-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;Se=i.distcode[y&(1<<i.distbits)-1],j=Se>>>24,H=Se>>>16&255,K=65535&Se,!(j<=_);){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(!(240&H)){for(Q=j,ie=H,re=K;Se=i.distcode[re+((y&(1<<Q+ie)-1)>>Q)],j=Se>>>24,H=Se>>>16&255,K=65535&Se,!(Q+j<=_);){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}y>>>=Q,_-=Q,i.back+=Q}if(y>>>=j,_-=j,i.back+=j,64&H){n.msg="invalid distance code",i.mode=fr;break}i.offset=K,i.extra=15&H,i.mode=16203;case 16203:if(i.extra){for(pt=i.extra;_<pt;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}i.offset+=y&(1<<i.extra)-1,y>>>=i.extra,_-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){n.msg="invalid distance too far back",i.mode=fr;break}i.mode=16204;case 16204:if(m===0)break e;if(O=w-m,i.offset>O){if(O=i.offset-O,O>i.whave&&i.sane){n.msg="invalid distance too far back",i.mode=fr;break}O>i.wnext?(O-=i.wnext,W=i.wsize-O):W=i.wnext-O,O>i.length&&(O=i.length),k=i.window}else k=c,W=h-i.offset,O=i.length;O>m&&(O=m),m-=O,i.length-=O;do c[h++]=k[W++];while(--O);i.length===0&&(i.mode=dS);break;case 16205:if(m===0)break e;c[h++]=i.length,m--,i.mode=dS;break;case UA:if(i.wrap){for(;_<32;){if(f===0)break e;f--,y|=s[u++]<<_,_+=8}if(w-=m,n.total_out+=w,i.total+=w,4&i.wrap&&w&&(n.adler=i.check=Yr(i)?ci(i.check,c,w,h-w):Xm(i.check,c,w,h-w)),w=m,4&i.wrap&&(Yr(i)?y:aW(y))!==i.check){n.msg="incorrect data check",i.mode=fr;break}y=0,_=0}i.mode=16207;case 16207:if(i.wrap&&Yr(i)){for(;_<32;){if(f===0)break e;f--,y+=s[u++]<<_,_+=8}if(4&i.wrap&&y!==(4294967295&i.total)){n.msg="incorrect length check",i.mode=fr;break}y=0,_=0}i.mode=16208;case 16208:he=Qme;break e;case fr:he=nW;break e;case 16210:return rW;default:return lo}return n.next_out=h,n.avail_out=m,n.next_in=u,n.avail_in=f,i.hold=y,i.bits=_,(i.wsize||w!==n.avail_out&&i.mode<fr&&(i.mode<UA||r!==tW))&&dW(n,n.output,n.next_out,w-n.avail_out),S-=n.avail_in,w-=n.avail_out,n.total_in+=S,n.total_out+=w,i.total+=w,4&i.wrap&&w&&(n.adler=i.check=Yr(i)?ci(i.check,c,w,n.next_out-w):Xm(i.check,c,w,n.next_out-w)),n.data_type=i.bits+(i.last?64:0)+(i.mode===cc?128:0)+(i.mode===uS||i.mode===MA?256:0),(S===0&&w===0||r===tW)&&he===zu&&(he=ege),he},lc={inflateReset:sW,inflateReset2:cW,inflateResetKeep:oW,inflateInit:n=>lW(n,15),inflateInit2:lW,inflate:rge,inflateEnd:n=>{if(Ku(n))return lo;let r=n.state;return r.window&&(r.window=null),n.state=null,zu},inflateGetHeader:(n,r)=>{if(Ku(n))return lo;const i=n.state;return 2&i.wrap?(i.head=r,r.done=!1,zu):lo},inflateSetDictionary:(n,r)=>{const i=r.length;let s,c,u;return Ku(n)?lo:(s=n.state,s.wrap!==0&&s.mode!==lS?lo:s.mode===lS&&(c=1,c=Xm(c,r,i,0),c!==s.check)?nW:(u=dW(n,r,i,i),u?(s.mode=16210,rW):(s.havedict=1,zu)))},inflateInfo:"pako inflate (from Nodeca project)"},ige=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const hW=Object.prototype.toString,{Z_NO_FLUSH:age,Z_FINISH:oge,Z_OK:ag,Z_STREAM_END:BA,Z_NEED_DICT:FA,Z_STREAM_ERROR:sge,Z_DATA_ERROR:fW,Z_MEM_ERROR:cge}=Yh;function og(n){this.options=X6({chunkSize:65536,windowBits:15,to:""},n||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),!(r.windowBits>=0&&r.windowBits<16)||n&&n.windowBits||(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(15&r.windowBits||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Z6,this.strm.avail_out=0;let i=lc.inflateInit2(this.strm,r.windowBits);if(i!==ag)throw new Error(Wu[i]);if(this.header=new ige,lc.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=DA(r.dictionary):hW.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(i=lc.inflateSetDictionary(this.strm,r.dictionary),i!==ag)))throw new Error(Wu[i])}function WA(n,r){const i=new og(r);if(i.push(n),i.err)throw i.msg||Wu[i.err];return i.result}og.prototype.push=function(n,r){const i=this.strm,s=this.options.chunkSize,c=this.options.dictionary;let u,h,f;if(this.ended)return!1;for(h=r===~~r?r:r===!0?oge:age,hW.call(n)==="[object ArrayBuffer]"?i.input=new Uint8Array(n):i.input=n,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),u=lc.inflate(i,h),u===FA&&c&&(u=lc.inflateSetDictionary(i,c),u===ag?u=lc.inflate(i,h):u===fW&&(u=FA));i.avail_in>0&&u===BA&&i.state.wrap>0&&n[i.next_in]!==0;)lc.inflateReset(i),u=lc.inflate(i,h);switch(u){case sge:case fW:case FA:case cge:return this.onEnd(u),this.ended=!0,!1}if(f=i.avail_out,i.next_out&&(i.avail_out===0||u===BA))if(this.options.to==="string"){let m=Mme(i.output,i.next_out),y=i.next_out-m,_=kme(i.output,m);i.next_out=y,i.avail_out=s-y,y&&i.output.set(i.output.subarray(m,m+y),0),this.onData(_)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(u!==ag||f!==0){if(u===BA)return u=lc.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(i.avail_in===0)break}}return!0},og.prototype.onData=function(n){this.chunks.push(n)},og.prototype.onEnd=function(n){n===ag&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=J6(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var lge={Inflate:og,inflate:WA,inflateRaw:function(n,r){return(r=r||{}).raw=!0,WA(n,r)},ungzip:WA,constants:Yh};const{Deflate:T8e,deflate:uge,deflateRaw:w8e,gzip:C8e}=Hme,{Inflate:R8e,inflate:dge,inflateRaw:O8e,ungzip:A8e}=lge;var hge=uge,fge=dge,pW=function(n){return n[n.ONE_BYTE=0]="ONE_BYTE",n[n.TWO_BYTE=1]="TWO_BYTE",n}(pW||{});class pge{constructor(){F(this,"_sequence",0),F(this,"_startTime",Date.now()),F(this,"isUseOneByte",!0)}get startTime(){const r=Date.now()-this._startTime;return r<Math.pow(2,16)?r:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(r){const i={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:r};if(r.byteLength>128){const f=new Uint8Array(4);f.set([1,0,0,0]);const m={id:0,length:4,data:f.buffer},y={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[m]};i.commonPacketHeader.extension=1,i.extension=y,i.payload=this.compress(r),i.commonPacketHeader.length=8+(i.extension.length+2)+i.payload.byteLength}else i.commonPacketHeader.length=8+i.payload.byteLength;Y("SHOW_DATASTREAM2_LOG")&&A.debug("send data header: ".concat(JSON.stringify(i.commonPacketHeader)));const s=new ArrayBuffer(i.commonPacketHeader.length),c=new Uint8Array(s),u=new DataView(s);let h=0;if(u.setUint16(h,i.commonPacketHeader.extension<<15|i.commonPacketHeader.reserved<<14|i.commonPacketHeader.length,!0),h+=2,u.setUint32(h,i.commonPacketHeader.sequence,!0),h+=4,u.setUint16(h,i.commonStreamHeader,!0),h+=2,i.extension){const f=this.serializeExtension(i.extension);c.set(new Uint8Array(f),h),h+=f.byteLength}if(c.set(new Uint8Array(i.payload),h),h+=i.payload.byteLength,h!==i.commonPacketHeader.length)throw Error("serialize error!");return s}deserialize(r){if(r.byteLength<4)return new ArrayBuffer(0);const i=new DataView(r);let s=0;const c=i.getUint16(s,!0);s+=2;const u={length:16383&c,reserved:(16384&c)>>14,extension:(32768&c)>>15,sequence:i.getUint16(s+2,!0)<<16|i.getUint16(s,!0)};let h,f;if(s+=4,Y("SHOW_DATASTREAM2_LOG")&&A.debug("receive data header: ".concat(JSON.stringify(u))),i.getUint16(s,!0),s+=2,u.extension){f=this.deserializeExtension(r.slice(s)),s+=2+f.length,h=r.slice(s);let m=!1;if(f.datas.length>0){const y=f.datas.find(_=>_.id===0);y&&(m=!(1&~new DataView(y.data).getUint32(0,!0)))}h=m?this.decompress(h):h}else h=r.slice(8);return h}serializeExtension(r){const{profile:i,length:s,datas:c}=r,u=new ArrayBuffer(s+2),h=new Uint8Array(u),f=new DataView(u);let m=0;if(f.setUint8(m++,i),f.setUint8(m++,s),c.forEach(y=>{i?(f.setUint8(m++,y.id),f.setUint8(m++,y.length),h.set(new Uint8Array(y.data),m),m+=y.data.byteLength):(f.setUint8(m++,y.id|y.length<<4),h.set(new Uint8Array(y.data),m),m+=y.data.byteLength)}),m!==s+2)throw Error("serialize extension error, is ".concat(m,"!==").concat(s+2));return u}deserializeExtension(r){const i=new DataView(r);let s=0;const c=i.getUint8(s);s++;const u=i.getUint8(s);s++;const h=c===pW.TWO_BYTE,f=[],m=new DataView(r,2);let y=0;for(;y<u;){let _=0,S=0,w=new ArrayBuffer(0);h?(_=m.getUint8(y),y++,S=m.getUint8(y),y++):(_=15&m.getUint8(y),S=m.getUint8(y)>>4,y++),S>0&&(w=m.buffer.slice(y+2,y+2+S),y+=w.byteLength),f.push({id:_,length:S,data:w})}if(y!==u)throw Error("parse error");return{profile:c,length:u,datas:f}}decompress(r){return fge(new Uint8Array(r))}compress(r){return hge(new Uint8Array(r))}}const mge={name:"DataStream",create:(n,r)=>{const i=r?new Cfe(n):new Rfe(n);return i.useDataStream(new pge),i}};class gge extends ln{constructor(r,i,s){super(),F(this,"ws",void 0),F(this,"requestId",1),F(this,"heartBeatTimer",void 0),F(this,"joinInfo",void 0),F(this,"clientId",void 0),F(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),F(this,"onClose",c=>{this.emit("close"),this.dispose()}),F(this,"onMessage",c=>{const u=JSON.parse(c.data);if(!u||u.command!=="serverResponse"||!u.requestId)return u&&u.command==="serverStatus"&&u.serverStatus&&u.serverStatus.command?(this.emit("status",u.serverStatus),void this.emit(u.serverStatus.command,u.serverStatus)):void 0;this.emit("req_".concat(u.requestId),u)}),this.joinInfo=r,this.clientId=i,this.ws=new xm("cross-channel-".concat(this.clientId),s),this.ws.on(at.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(at.CONNECTED,this.onOpen),this.ws.on(at.ON_MESSAGE,this.onMessage),this.ws.on(at.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(r){const i=this.requestId++;return r.requestId=i,r.seq=i,this.ws.sendMessage(r),i}waitStatus(r){return new Ie((i,s)=>{const c=window.setTimeout(()=>{s(new se($.TIMEOUT,"wait status timeout, status: ".concat(r)))},5e3);this.once(r,u=>{window.clearTimeout(c),u.state&&u.state!==0?s(new se($.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(r))):i(void 0)}),this.once("dispose",()=>{window.clearTimeout(c),s(new se($.WS_ABORT))})})}async request(r){if(this.ws.state==="closed")throw new se($.WS_DISCONNECT);const i=()=>new Ie((h,f)=>{this.ws.once(at.CLOSED,()=>f(new se($.WS_ABORT))),this.ws.once(at.CONNECTED,h)});this.ws.state!=="connected"&&await i();const s=this.sendMessage(r),c=new Ie((h,f)=>{const m=()=>{f(new se($.WS_ABORT))};this.ws.once(at.RECONNECTING,m),this.ws.once(at.CLOSED,m),this.once("req_".concat(s),h),_r(3e3).then(()=>{this.removeAllListeners("req_".concat(s)),this.ws.off(at.RECONNECTING,m),this.ws.off(at.CLOSED,m),f(new se($.TIMEOUT,"cross channel ws request timeout"))})}),u=await c;if(!u||u.code!==200)throw new se($.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(u)));return u}async connect(r){this.ws.removeAllListeners(at.REQUEST_NEW_URLS),this.ws.on(at.REQUEST_NEW_URLS,i=>{i(r)}),await this.ws.init(r)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(r){const i=this.requestId++;return r.requestId=i,this.ws.sendMessage(r),i}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class yge extends ln{set state(r){r!==this._state&&(r!==Ii.RELAY_STATE_FAILURE&&(this.errorCode=Lh.RELAY_OK),this.emit("state",r,this.errorCode),this._state=r)}get state(){return this._state}constructor(r,i,s,c,u){super(),F(this,"joinInfo",void 0),F(this,"sid",void 0),F(this,"clientId",void 0),F(this,"cancelToken",mi.CancelToken.source()),F(this,"workerToken",void 0),F(this,"requestId",0),F(this,"signal",void 0),F(this,"prevChannelMediaConfig",void 0),F(this,"httpRetryConfig",void 0),F(this,"_resolution",void 0),F(this,"_state",Ii.RELAY_STATE_IDLE),F(this,"errorCode",Lh.RELAY_OK),F(this,"onStatus",h=>{A.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(h))),h&&h.command&&(h.command==="onAudioPacketReceived"&&this.emit("event",nc.PACKET_RECEIVED_AUDIO_FROM_SRC),h.command==="onVideoPacketReceived"&&this.emit("event",nc.PACKET_RECEIVED_VIDEO_FROM_SRC),h.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=Lh.SRC_TOKEN_EXPIRED,this.state=Ii.RELAY_STATE_FAILURE),h.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=Lh.DEST_TOKEN_EXPIRED,this.state=Ii.RELAY_STATE_FAILURE))}),F(this,"onReconnect",async()=>{A.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",nc.NETWORK_DISCONNECTED),this.state=Ii.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(h=>{this.state!==Ii.RELAY_STATE_IDLE&&(A.error("auto restart channel media relay failed",h.toString()),this.errorCode=Lh.SERVER_CONNECTION_LOST,this.state=Ii.RELAY_STATE_FAILURE)})}),this.joinInfo=r,this.clientId=i,this.sid=Ru(),this.signal=new gge(this.joinInfo,this.clientId,s),this.httpRetryConfig=c,this._resolution=u}async startChannelMediaRelay(r){if(this.state!==Ii.RELAY_STATE_IDLE)throw new se($.INVALID_OPERATION);this.state=Ii.RELAY_STATE_CONNECTING,await this.connect(),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(r)}catch(i){throw i.data&&i.data.serverResponse&&i.data.serverResponse.command==="SetSourceChannel"?new se($.CROSS_CHANNEL_FAILED_JOIN_SRC):i.data&&i.data.serverResponse&&i.serverResponse.command==="SetDestChannelStatus"?new se($.CROSS_CHANNEL_FAILED_JOIN_DEST):i.data&&i.data.serverResponse&&i.serverResponse.command==="StartPacketTransfer"?new se($.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):i}this.prevChannelMediaConfig=r}async updateChannelMediaRelay(r){if(this.state!==Ii.RELAY_STATE_RUNNING)throw new se($.INVALID_OPERATION);await this.sendUpdateMessage(r),this.prevChannelMediaConfig=r}async setVideoProfile(r){if(this._resolution=r,this.state!==Ii.RELAY_STATE_RUNNING)throw new se($.INVALID_OPERATION);const i=this.genMessage(si.SetVideoProfile);await this.signal.request(i),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),A.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Ii.RELAY_STATE_IDLE,this.dispose()}dispose(){A.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=mi.CancelToken.source(),this.state=Ii.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const r=await xpe(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=r.workerToken,await this.signal.connect(r.addressList),this.emit("event",nc.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(r){const i=this.genMessage(si.StopPacketTransfer);await this.signal.request(i),await this.signal.waitStatus("Normal Quit"),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const s=this.genMessage(si.SetSdkProfile,r);await this.signal.request(s),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const c=this.genMessage(si.SetSourceChannel,r);await this.signal.request(c),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",nc.PACKET_JOINED_SRC_CHANNEL),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const u=this.genMessage(si.SetSourceUserId,r);await this.signal.request(u),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const h=this.genMessage(si.SetDestChannel,r);await this.signal.request(h),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",nc.PACKET_JOINED_DEST_CHANNEL),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const f=this.genMessage(si.StartPacketTransfer,r);await this.signal.request(f),this.emit("event",nc.PACKET_SENT_TO_DEST_CHANNEL),this.state=Ii.RELAY_STATE_RUNNING,A.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(r){const i=this.genMessage(si.UpdateDestChannel,r);await this.signal.request(i),this.emit("event",nc.PACKET_UPDATE_DEST_CHANNEL),A.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const r=this.genMessage(si.StopPacketTransfer);await this.signal.request(r),A.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(r,i){const s=[],c=[],u=[];this.requestId+=1;const h={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Ca,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};h.sdkVersion==="4.23.1"&&(h.sdkVersion="0.0.1");let f=null,m=null;switch(r){case si.SetSdkProfile:return h.clientRequest={command:"SetSdkProfile",type:"multi_channel"},h;case si.SetSourceChannel:if(m=i&&i.getSrcChannelMediaInfo(),!m)throw new se($.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceChannel",uid:"0",channelName:m.channelName,token:m.token||this.joinInfo.appId},h;case si.SetSourceUserId:if(m=i&&i.getSrcChannelMediaInfo(),!m)throw new se($.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceUserId",uid:m.uid+""},h;case si.SetDestChannel:if(f=i&&i.getDestChannelMediaInfo(),!f)throw new se($.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(y=>{s.push(y.channelName),c.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),h.clientRequest={command:"SetDestChannel",channelName:s,uid:c,token:u},h;case si.StartPacketTransfer:return h.clientRequest={command:"StartPacketTransfer"},h;case si.Reconnect:return h.clientRequest={command:"Reconnect"},h;case si.StopPacketTransfer:return h.clientRequest={command:"StopPacketTransfer"},h;case si.UpdateDestChannel:if(f=i&&i.getDestChannelMediaInfo(),!f)throw new se($.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(y=>{s.push(y.channelName),c.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),h.clientRequest={command:"UpdateDestChannel",channelName:s,uid:c,token:u},h;case si.SetVideoProfile:h.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return h}}const vge={name:"ChannelMediaRelay",create:function(n){return new yge(n.joinInfo,n.clientId,n.websocketRetryConfig||Gn,n.httpRetryConfig||Gn,n.resolution)}};function mW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function sg(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?mW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):mW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class _ge extends ln{constructor(r,i,s,c){super(),F(this,"spec",void 0),F(this,"token",void 0),F(this,"websocket",void 0),F(this,"pingpongTimer",void 0),F(this,"reconnectMode","retry"),F(this,"serviceMode",void 0),F(this,"reqId",0),F(this,"commandReqId",0),F(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),F(this,"handleWebSocketMessage",u=>{if(!u.data)return;const h=JSON.parse(u.data);h.requestId?this.emit("@".concat(h.requestId,"-").concat(h.sid),h):($e.workerEvent(this.spec.sid,{actionType:"status",serverCode:h.code,workerType:this.serviceMode===tc.TRANSCODE?1:2}),this.emit(Qc.PUBLISH_STREAM_STATUS,h))}),this.spec=i,this.token=r,this.serviceMode=c,this.websocket=new xm("live-streaming",s),this.websocket.on(at.CONNECTED,this.handleWebSocketOpen),this.websocket.on(at.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(at.REQUEST_NEW_URLS,(u,h)=>{Or(this,Qc.REQUEST_NEW_ADDRESS).then(u).catch(h)}),this.websocket.on(at.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(r){return this.websocket.init(r)}async request(r,i,s,c){this.reqId+=1,r==="request"&&(this.commandReqId+=1);const u=this.commandReqId,h=this.reqId;if(!h||!this.websocket)throw new se($.UNEXPECTED_ERROR);const f=sg({command:r,sdkVersion:Ca==="4.23.1"?"0.0.1":Ca,seq:h,requestId:h,allocate:s,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},i);if(this.websocket.state==="closed")throw new se($.WS_DISCONNECT);const m=()=>new Ie((w,O)=>{this.websocket.once(at.CLOSED,()=>O(new se($.WS_ABORT))),this.websocket.once(at.CONNECTED,w)});this.websocket.state!=="connected"&&await m(),f.clientRequest&&(f.clientRequest.workerToken=this.token);const y=new Ie((w,O)=>{const W=()=>{O(new se($.WS_ABORT))};this.websocket.once(at.RECONNECTING,W),this.websocket.once(at.CLOSED,W),this.once("@".concat(h,"-").concat(this.spec.sid),k=>{w(k)})});c&&$e.workerEvent(this.spec.sid,sg(sg({},c),{},{requestId:u,actionType:"request",payload:JSON.stringify(i.clientRequest),serverCode:0,code:0}));const _=Date.now();this.websocket.sendMessage(f);let S=null;try{S=await y}catch(w){if(this.websocket.state==="closed")throw w;return await m(),await this.request(r,i,s)}return c&&$e.workerEvent(this.spec.sid,sg(sg({},c),{},{requestId:u,actionType:"response",payload:JSON.stringify(S.serverResponse),serverCode:S.code,success:S.code===200,responseTime:Date.now()-_})),S.code!==200&&this.handleResponseError(S),S}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const r=Ca==="4.23.1"?"0.0.1":Ca;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:r,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(r){switch(r.code){case Yn.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void A.warning("live stream response already exists stream");case Yn.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Yn.LIVE_STREAM_RESPONSE_BAD_STREAM:case Yn.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new se($.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:r.code}).throw();case Yn.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(r.serverResponse.command==="UnpublishStream")return;throw new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Yn.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new se($.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:r.code}).throw();case Yn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const i=new se($.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Qc.WARNING,i,r.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const i=new se($.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Qc.WARNING,i,r.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Yn.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new se($.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:r.code}).throw();case Yn.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const i=new se($.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Qc.WARNING,i,r.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:r.code}).throw();case Yn.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Yn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Yn.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(r.serverResponse.command==="UnpublishStream")return;throw new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Yn.ERROR_FAIL_SEND_MESSAGE:if(r.serverResponse.command==="UnpublishStream")return;if(r.serverResponse.command==="UpdateTranscoding"||r.serverResponse.command==="ControlStream")return new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:r.code}).throw();throw new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Yn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new se($.LIVE_STREAMING_CDN_ERROR,"",{code:r.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(rE)},6e3)}}function gW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function Pi(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?gW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):gW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class Ege extends ln{constructor(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gn,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gn;super(),F(this,"onLiveStreamWarning",void 0),F(this,"onLiveStreamError",void 0),F(this,"spec",void 0),F(this,"retryTimeout",1e4),F(this,"connection",void 0),F(this,"httpRetryConfig",void 0),F(this,"wsRetryConfig",void 0),F(this,"streamingTasks",new Map),F(this,"isStartingStreamingTask",!1),F(this,"taskMutex",new Lr("live-streaming")),F(this,"cancelToken",mi.CancelToken.source()),F(this,"transcodingConfig",void 0),F(this,"uapResponse",void 0),F(this,"lastTaskId",1),F(this,"statusError",new Map),this.spec=r,this.httpRetryConfig=s,this.wsRetryConfig=i}async setTranscodingConfig(r){const i=Pi(Pi({},hpe),r);i.videoCodecProfile!==66&&i.videoCodecProfile!==77&&i.videoCodecProfile!==100&&(A.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(i.videoCodecProfile," -> 100")),i.videoCodecProfile=100),i.transcodingUsers||(i.transcodingUsers=i.userConfigs),i.transcodingUsers&&(i.transcodingUsers=i.transcodingUsers.map(h=>Pi(Pi(Pi({},dpe),h),{},{zOrder:h.zOrder?h.zOrder+1:1}))),function(h){hn(h.width)||Bt(h.width,"config.width",0,1e4),hn(h.height)||Bt(h.height,"config.height",0,1e4),hn(h.videoBitrate)||Bt(h.videoBitrate,"config.videoBitrate",1,1e6),hn(h.videoFrameRate)||Bt(h.videoFrameRate,"config.videoFrameRate"),hn(h.lowLatency)||Qs(h.lowLatency,"config.lowLatency"),hn(h.audioSampleRate)||Jn(h.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),hn(h.audioBitrate)||Bt(h.audioBitrate,"config.audioBitrate",1,128),hn(h.audioChannels)||Jn(h.audioChannels,"config.audioChannels",[1,2,3,4,5]),hn(h.videoGop)||Bt(h.videoGop,"config.videoGop"),hn(h.videoCodecProfile)||Jn(h.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),hn(h.userCount)||Bt(h.userCount,"config.userCount",0,17),hn(h.backgroundColor)||Bt(h.backgroundColor,"config.backgroundColor",0,16777215),hn(h.userConfigExtraInfo)||vr(h.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),h.transcodingUsers&&!hn(h.transcodingUsers)&&(Zs(h.transcodingUsers,"config.transcodingUsers"),h.transcodingUsers.forEach((f,m)=>{OE(f.uid),hn(f.x)||Bt(f.x,"transcodingUser[".concat(m,"].x"),0,1e4),hn(f.y)||Bt(f.y,"transcodingUser[".concat(m,"].y"),0,1e4),hn(f.width)||Bt(f.width,"transcodingUser[".concat(m,"].width"),0,1e4),hn(f.height)||Bt(f.height,"transcodingUser[".concat(m,"].height"),0,1e4),hn(f.zOrder)||Bt(f.zOrder-1,"transcodingUser[".concat(m,"].zOrder"),0,100),hn(f.alpha)||Bt(f.alpha,"transcodingUser[".concat(m,"].alpha"),0,1,!1)})),hn(h.watermark)||WO(h.watermark,"watermark"),hn(h.backgroundImage)||WO(h.backgroundImage,"backgroundImage"),h.images&&!hn(h.images)&&(Zs(h.images,"config.images"),h.images.forEach((f,m)=>{WO(f,"images[".concat(m,"]"))}))}(i);const s=[];i.images&&s.push(...i.images.map(h=>Pi(Pi(Pi({},FO),h),{},{zOrder:255}))),i.backgroundImage&&(s.push(Pi(Pi(Pi({},FO),i.backgroundImage),{},{zOrder:0})),delete i.backgroundImage),i.watermark&&(s.push(Pi(Pi(Pi({},FO),i.watermark),{},{zOrder:255})),delete i.watermark),i.images=s,i.transcodingUsers&&(i.userConfigs=i.transcodingUsers.map(h=>Pi({},h)),i.userCount=i.transcodingUsers.length,delete i.transcodingUsers);const c=(i.userConfigs||[]).map(h=>typeof h.uid=="number"?Ie.resolve(h.uid):k4(h.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await Ie.all(c)).forEach((h,f)=>{i.userConfigs&&i.userConfigs[f]&&(i.userConfigs[f].uid=h)}),this.transcodingConfig=i,this.connection)try{var u;const h=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(na(u=this.streamingTasks).call(u)).map(f=>f.taskId).join("#")});A.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(h.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(h){if(!h.data||!h.data.retry)throw h;h.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(f=>{A.warning("[".concat(this.spec.clientId,"] live streaming receive error"),h.toString(),"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,h).then(()=>{A.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(f.url," success"))}).catch(m=>{A.error("[".concat(this.spec.clientId,"] live streaming republish failed"),f.url,m.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,m)})})}}async startLiveStreamingTask(r,i,s){if(!this.transcodingConfig&&i===tc.TRANSCODE)throw new se($.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const c={command:"PublishStream",ts:Date.now(),url:r,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};A.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(r,", mode: ").concat(i));const u=await this.taskMutex.lock();if(!this.connection&&s)return void u();if(this.streamingTasks.get(r)&&!s)return u(),new se($.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(i))}catch(f){throw u(),f}switch(i){case tc.TRANSCODE:c.transcodingConfig=Pi({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(c.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const h=this.lastTaskId++;try{const f=new Ie((y,_)=>{_r(this.retryTimeout).then(()=>{if(s)return _(s);const S=this.statusError.get(r);return S?(this.statusError.delete(r),_(S)):void 0})}),m=await Ie.race([this.connection.request("request",{clientRequest:c},!0,{url:r,command:"PublishStream",workerType:i===tc.TRANSCODE?1:2,requestByUser:!s,tid:h.toString()}),f]);this.isStartingStreamingTask=!1,A.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(m.code)),this.streamingTasks.set(r,{clientRequest:c,mode:i,url:r,taskId:h}),u()}catch(f){if(u(),this.isStartingStreamingTask=!1,!f.data||!f.data.retry||s)throw f;return f.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(r,i,f)):await this.startLiveStreamingTask(r,i,f)}}stopLiveStreamingTask(r){return new Ie((i,s)=>{const c=this.streamingTasks.get(r);if(!c||!this.connection)return new se($.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const u=c.mode;c.abortTask=()=>{A.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(r),i()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:c.url}},!1,{url:r,command:"UnPublishStream",workerType:u===tc.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(h=>{A.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(h.code)),this.streamingTasks.delete(r),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),i()}).catch(s)})}resetAllTask(){var r;const i=Array.from(na(r=this.streamingTasks).call(r));this.terminate();for(const s of i)this.startLiveStreamingTask(s.url,s.mode).catch(c=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,c)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=mi.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(r){if(this.connection)throw new se($.UNEXPECTED_ERROR,"live streaming connection has already connected");const i=await Or(this,GO.REQUEST_WORKER_MANAGER_LIST,r);return this.uapResponse=i,this.connection=new _ge(i.workerToken,this.spec,this.wsRetryConfig,r),this.connection.on(Qc.WARNING,(s,c)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(c,s)),this.connection.on(Qc.PUBLISH_STREAM_STATUS,s=>this.handlePublishStreamServer(s)),this.connection.on(Qc.REQUEST_NEW_ADDRESS,(s,c)=>{if(!this.connection)return c(new se($.UNEXPECTED_ERROR,"can not get new live streaming address list"));Or(this,GO.REQUEST_WORKER_MANAGER_LIST,r).then(u=>{this.uapResponse=u,s(u.addressList)}).catch(c)}),await this.connection.init(i.addressList),this.connection}handlePublishStreamServer(r){const i=r.serverStatus&&r.serverStatus.url||"empty_url",s=this.streamingTasks.get(i),c=r.reason;switch(r.code){case Yn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const h=new se($.LIVE_STREAMING_CDN_ERROR,"",{code:r.code});if(s)return A.error(h.toString()),this.onLiveStreamError&&this.onLiveStreamError(i,h);if(!this.isStartingStreamingTask)return;this.statusError.set(i,h)}case Yn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const h=new se($.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,c);return this.onLiveStreamWarning&&this.onLiveStreamWarning(i,h)}case Yn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Yn.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var u;if(!this.connection)return;this.connection.tryNextAddress();const h=Array.from(na(u=this.streamingTasks).call(u));for(const f of h)f.abortTask?f.abortTask():(A.warning("[".concat(this.spec.clientId,"] publish stream status code"),r.code,"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,new se($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:r.code})).then(()=>{A.debug("[".concat(this.spec.clientId,"] republish live stream success"),f.url)}).catch(m=>{A.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,m)}));return}}}hasUrl(r){return this.streamingTasks.has(r)}}const Sge={name:"LiveStreaming",create:function(n){return new Ege(n.joinInfo,n.websocketRetryConfig||Gn,n.httpRetryConfig||Gn)}};function bge(n){let r=_W();return function(i,s){let c=i.appId;c!==void 0&&(Mt(s,10),Os(s,c));let u=i.cid;u!==void 0&&(Mt(s,16),Mt(s,u));let h=i.cname;h!==void 0&&(Mt(s,26),Os(s,h));let f=i.deviceId;f!==void 0&&(Mt(s,34),Os(s,f));let m=i.elapse;m!==void 0&&(Mt(s,40),dl(s,m));let y=i.fileSize;y!==void 0&&(Mt(s,48),dl(s,Zh(y)));let _=i.height;_!==void 0&&(Mt(s,56),dl(s,Zh(_)));let S=i.jpg;S!==void 0&&(Mt(s,66),Mt(s,S.length),function(Ei,pe){let we=ef(Ei,pe.length);Ei.bytes.set(pe,we)}(s,S));let w=i.networkType;w!==void 0&&(Mt(s,72),dl(s,Zh(w)));let O=i.osType;O!==void 0&&(Mt(s,80),dl(s,Zh(O)));let W=i.requestId;W!==void 0&&(Mt(s,90),Os(s,W));let k=i.sdkVersion;k!==void 0&&(Mt(s,98),Os(s,k));let j=i.sequence;j!==void 0&&(Mt(s,104),dl(s,Zh(j)));let H=i.sid;H!==void 0&&(Mt(s,114),Os(s,H));let K=i.timestamp;K!==void 0&&(Mt(s,120),dl(s,K));let Q=i.uid;Q!==void 0&&(Mt(s,128),Mt(s,Q));let ie=i.vid;ie!==void 0&&(Mt(s,136),Mt(s,ie));let re=i.width;re!==void 0&&(Mt(s,144),dl(s,Zh(re)));let te=i.service;te!==void 0&&(Mt(s,152),Mt(s,te));let he=i.callbackData;he!==void 0&&(Mt(s,162),Os(s,he));let Se=i.jpgEncryption;Se!==void 0&&(Mt(s,168),Mt(s,Se));let Ne=i.requestType;Ne!==void 0&&(Mt(s,176),Mt(s,Ne));let ke=i.scorePorn;ke!==void 0&&(Mt(s,185),KA(s,ke));let pt=i.scoreSexy;pt!==void 0&&(Mt(s,193),KA(s,pt));let mt=i.scoreNeutral;mt!==void 0&&(Mt(s,201),KA(s,mt));let Xt=i.scene;Xt!==void 0&&(Mt(s,208),Mt(s,Xt));let An=i.ossFilePrefix;An!==void 0&&(Mt(s,218),Os(s,An));let _n=i.serviceVendor;if(_n!==void 0)for(let Ei of _n){Mt(s,226);let pe=_W();Cge(Ei,pe),Mt(s,pe.limit),Ige(s,pe),Age(pe)}}(n,r),function(i){let s=i.bytes,c=i.limit;return s.length===c?s:s.subarray(0,c)}(r)}function Tge(n){return function(i){let s={};e:for(;!EW(i);){let c=As(i);switch(c>>>3){case 0:break e;case 1:s.code=As(i);break;case 2:s.msg=SW(i,As(i));break;case 3:{let u=Rge(i);s.data=wge(i),i.limit=u;break}default:yW(i,7&c)}}return s}({bytes:r=n,offset:0,limit:r.length});var r}function wge(n){let r={};e:for(;!EW(n);){let i=As(n);switch(i>>>3){case 0:break e;case 1:r.requestId=SW(n,As(n));break;case 2:r.requestType=As(n)>>>0;break;case 3:r.scorePorn=zA(n);break;case 4:r.scoreSexy=zA(n);break;case 5:r.scoreNeutral=zA(n);break;case 6:r.requestScene=As(n)>>>0;break;case 7:r.scene=As(n)>>>0;break;default:yW(n,7&i)}}return r}function Cge(n,r){let i=n.service;i!==void 0&&(Mt(r,8),Mt(r,i));let s=n.vendor;s!==void 0&&(Mt(r,16),Mt(r,s));let c=n.token;c!==void 0&&(Mt(r,26),Os(r,c));let u=n.callbackUrl;u!==void 0&&(Mt(r,34),Os(r,u))}function Rge(n){let r=As(n),i=n.limit;return n.limit=n.offset+r,i}function yW(n,r){switch(r){case 0:for(;128&bW(n););break;case 2:$A(n,As(n));break;case 5:$A(n,4);break;case 1:$A(n,8);break;default:throw new Error("Unimplemented type: "+r)}}let Oge=new Float32Array(1);new Uint8Array(Oge.buffer);let GA=new Float64Array(1),xi=new Uint8Array(GA.buffer);function Zh(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}let vW=[];function _W(){const n=vW.pop();return n?(n.offset=n.limit=0,n):{bytes:new Uint8Array(64),offset:0,limit:0}}function Age(n){vW.push(n)}function $A(n,r){if(n.offset+r>n.limit)throw new Error("Skip past limit");n.offset+=r}function EW(n){return n.offset>=n.limit}function ef(n,r){let i=n.bytes,s=n.offset,c=n.limit,u=s+r;if(u>i.length){let h=new Uint8Array(2*u);h.set(i),n.bytes=h}return n.offset=u,u>c&&(n.limit=u),s}function HA(n,r){let i=n.offset;if(i+r>n.limit)throw new Error("Read past limit");return n.offset+=r,i}function SW(n,r){let i=HA(n,r),s=String.fromCharCode,c=n.bytes,u="",h="";for(let f=0;f<r;f++){let m,y,_,S,w=c[f+i];128&w?(224&w)==192?f+1>=r?h+=u:(m=c[f+i+1],(192&m)!=128?h+=u:(S=(31&w)<<6|63&m,S<128?h+=u:(h+=s(S),f++))):(240&w)==224?f+2>=r?h+=u:(m=c[f+i+1],y=c[f+i+2],(49344&(m|y<<8))!=32896?h+=u:(S=(15&w)<<12|(63&m)<<6|63&y,S<2048||S>=55296&&S<=57343?h+=u:(h+=s(S),f+=2))):(248&w)==240?f+3>=r?h+=u:(m=c[f+i+1],y=c[f+i+2],_=c[f+i+3],(12632256&(m|y<<8|_<<16))!=8421504?h+=u:(S=(7&w)<<18|(63&m)<<12|(63&y)<<6|63&_,S<65536||S>1114111?h+=u:(S-=65536,h+=s(55296+(S>>10),56320+(1023&S)),f+=3))):h+=u:h+=s(w)}return h}function Os(n,r){let i=r.length,s=0;for(let h=0;h<i;h++){let f=r.charCodeAt(h);f>=55296&&f<=56319&&h+1<i&&(f=(f<<10)+r.charCodeAt(++h)-56613888),s+=f<128?1:f<2048?2:f<65536?3:4}Mt(n,s);let c=ef(n,s),u=n.bytes;for(let h=0;h<i;h++){let f=r.charCodeAt(h);f>=55296&&f<=56319&&h+1<i&&(f=(f<<10)+r.charCodeAt(++h)-56613888),f<128?u[c++]=f:(f<2048?u[c++]=f>>6&31|192:(f<65536?u[c++]=f>>12&15|224:(u[c++]=f>>18&7|240,u[c++]=f>>12&63|128),u[c++]=f>>6&63|128),u[c++]=63&f|128)}}function Ige(n,r){let i=ef(n,r.limit),s=n.bytes,c=r.bytes;for(let u=0,h=r.limit;u<h;u++)s[u+i]=c[u]}function bW(n){return n.bytes[HA(n,1)]}function TW(n,r){let i=ef(n,1);n.bytes[i]=r}function zA(n){let r=HA(n,8),i=n.bytes;return xi[0]=i[r++],xi[1]=i[r++],xi[2]=i[r++],xi[3]=i[r++],xi[4]=i[r++],xi[5]=i[r++],xi[6]=i[r++],xi[7]=i[r++],GA[0]}function KA(n,r){let i=ef(n,8),s=n.bytes;GA[0]=r,s[i++]=xi[0],s[i++]=xi[1],s[i++]=xi[2],s[i++]=xi[3],s[i++]=xi[4],s[i++]=xi[5],s[i++]=xi[6],s[i++]=xi[7]}function As(n){let r,i=0,s=0;do r=bW(n),i<32&&(s|=(127&r)<<i),i+=7;while(128&r);return s}function Mt(n,r){for(r>>>=0;r>=128;)TW(n,127&r|128),r>>>=7;TW(n,r)}function dl(n,r){let i=r.low>>>0,s=(r.low>>>28|r.high<<4)>>>0,c=r.high>>>24,u=c===0?s===0?i<16384?i<128?1:2:i<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:c<128?9:10,h=ef(n,u),f=n.bytes;switch(u){case 10:f[h+9]=c>>>7&1;case 9:f[h+8]=u!==9?128|c:127&c;case 8:f[h+7]=u!==8?s>>>21|128:s>>>21&127;case 7:f[h+6]=u!==7?s>>>14|128:s>>>14&127;case 6:f[h+5]=u!==6?s>>>7|128:s>>>7&127;case 5:f[h+4]=u!==5?128|s:127&s;case 4:f[h+3]=u!==4?i>>>21|128:i>>>21&127;case 3:f[h+2]=u!==3?i>>>14|128:i>>>14&127;case 2:f[h+1]=u!==2?i>>>7|128:i>>>7&127;case 1:f[h]=u!==1?128|i:127&i}}function wW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}const Nge=new Map([["moderation",1],["supervise",2]]);class Pge extends ln{get connectionState(){return this._connectionState}set connectionState(r){if(this._connectionState===r)return;const i=this._connectionState;this._connectionState=r,this.emit(hr.CONNECTION_STATE_CHANGE,i,r)}get inspectType(){return this._inspectType}set inspectType(r){var i;this._inspectMode=Ao(i=r.map(s=>Nge.get(s)||0)).call(i,(s,c)=>s+c),this._inspectType=r}get quality(){return this._quality}set quality(r){this._quality=r>1?1:r<.1?.1:r,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(r){super(),F(this,"name","AgoraRTCVideoContentInspect"),F(this,"_connectionState",ro.CONNECTING),F(this,"_innerConnectionState",void 0),F(this,"sequence",0),F(this,"inspectStartTime",void 0),F(this,"workerManagerConnection",void 0),F(this,"workerConnection",void 0),F(this,"workerMessageLengthLimit",void 0),F(this,"inspectIntervalMinimum",void 0),F(this,"qualityRatio",void 0),F(this,"_connectInfo",void 0),F(this,"_cancelTokenSource",mi.CancelToken.source()),F(this,"_retryConfig",void 0),F(this,"wmSequence",0),F(this,"inspectInterval",void 0),F(this,"inspectTimer",null),F(this,"ossFilePrefix",void 0),F(this,"extraInfo",void 0),F(this,"_inspectType",void 0),F(this,"_inspectMode",void 0),F(this,"_quality",1),F(this,"qualityTimer",null),F(this,"_inspectId",void 0),F(this,"_needWorkUrlOnly",!1),F(this,"inspectImage",()=>{if(this.connectionState!==ro.CONNECTED)throw new se($.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===ro.CONNECTED?this.requestToInspectImage():A.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=qt(5,"inspect-"),this.workerMessageLengthLimit=Y("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Y("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Y("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=r.interval,this.ossFilePrefix=r.ossFilePrefix,this.extraInfo=r.extraInfo,this.inspectType=r.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new xm("worker-manager-"+this._inspectId,Gn),this.on(hr.STATE_CHANGE,(i,s)=>{this._innerConnectionState=i,A.debug("[".concat(this._inspectId,"] Inspect operation :").concat(io[i]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new xm("worker-"+this._inspectId,Gn),this.handleWorkerEvents()}async init(r,i){this.emit(hr.STATE_CHANGE,io.CONNECT_AP),this._connectInfo=r;const s=this._cancelTokenSource.token;return this._retryConfig=i,new Ie((c,u)=>{this.on(hr.CONNECTION_STATE_CHANGE,(h,f)=>{f===ro.CONNECTED&&c()}),this.requestAP(r,s,i).then(h=>{this.connectWorkerManager(h)}).catch(h=>{u(h)})})}async requestAP(r,i,s){const c=Y("WEBCS_DOMAIN").map(f=>"https://".concat(f,"/api/v1")),u=await function(f,m,y,_){let{appId:S,areaCode:w,cname:O,sid:W,token:k,uid:j}=m;Wh++;const H="image_moderation_api",K={service_name:H,json_body:JSON.stringify({appId:S,areaCode:w,cname:O,command:"allocateEdge",requestId:Wh,seq:Wh,sid:W,token:k,ts:Date.now(),uid:j+""})};let Q,ie,re=f[0];return Mo(async()=>{Q=Date.now();const te=await Fo(re,{data:K,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ie=Date.now()-Q,te.code!==0){const ke=new se($.UNEXPECTED_RESPONSE,"image inspect ap error, code"+te.code,{retry:!0,responseTime:ie});throw A.error(ke.toString()),ke}const he=JSON.parse(te.json_body);if(he.code!==200){const ke=new se($.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(he.code,", reason: ").concat(he.reason),{code:he.code,responseTime:ie});throw A.error(ke.toString()),ke}if(!he.servers||!Array.isArray(he.servers)||he.servers.length===0){const ke=new se($.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:he.code,responseTime:ie});throw A.error(ke.toString()),ke}const Se=Y("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ne=Y("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:he.servers.map(ke=>{let{address:pt,wss:mt}=ke;if(pt&&mt)return"wss://".concat(pt.replace(/\./g,"-"),".").concat(Se,":").concat(Ne||mt)}).filter(ke=>!!ke),workerToken:he.workerToken,vid:he.vid,responseTime:ie}},(te,he)=>($e.apworkerEvent(W,{success:!0,sc:200,serviceName:H,responseDetail:JSON.stringify(te.addressList),firstSuccess:he===0,responseTime:ie,serverIp:f[he%f.length]}),!1),(te,he)=>($e.apworkerEvent(W,{success:!1,sc:te.data&&te.data.code||200,serviceName:H,responseTime:ie,serverIp:f[he%f.length]}),!!(te.code!==$.OPERATION_ABORTED&&te.code!==$.UNEXPECTED_RESPONSE||te.data&&te.data.retry)&&(re=f[(he+1)%f.length],!0)),_)}(c,r,i,s);this.emit(hr.STATE_CHANGE,io.AP_CONNECTED);const{addressList:h}=u;return this.wmSequence++,h}async connectWorkerManager(r){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=i,this.emit(hr.STATE_CHANGE,io.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(r,1e4)}async connectWorker(r){await this.workerConnection.init([r])}handleWorkerManagerEvents(){this.workerManagerConnection.on(at.CONNECTED,async()=>{this.emit(hr.STATE_CHANGE,io.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.1",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(at.CLOSED,()=>{this._innerConnectionState<io.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(at.FAILED,()=>{this._innerConnectionState<io.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(at.RECONNECTING,()=>{this._innerConnectionState<io.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(at.ON_MESSAGE,async r=>{this.emit(hr.STATE_CHANGE,io.GET_WORKER_MANAGER_RESPONSE);const i=this.workerManagerConnection.url;this.workerManagerConnection.close();const s=JSON.parse(r.data);if(s.code!==200)throw A.error("[".concat(this._inspectId,"] Unexpected code ").concat(s.code," from worker manager")),new se($.UNEXPECTED_RESPONSE,"response code of worker is unexpected",s);if(!(s.serverResponse&&s.serverResponse.portWss&&i))throw A.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(s))),new se($.UNEXPECTED_RESPONSE,"response content of worker is unexpected",s);{const c=Y("VIDEO_INSPECT_WORKER_PORT")||s.serverResponse.portWss,u=i.replace(/:\d+\/?$/,":".concat(c));this.emit(hr.STATE_CHANGE,io.CONNECT_WORKER,u),this._needWorkUrlOnly?this.emit(hr.REQUEST_NEW_WORKER_URL,u):await this.connectWorker(u)}}),this.workerManagerConnection.on(at.WILL_RECONNECT,(r,i,s)=>{s(r)}),this.workerManagerConnection.on(at.REQUEST_NEW_URLS,(r,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r).catch(i)})}handleWorkerEvents(){this.workerConnection.on(at.CONNECTED,async()=>{this.emit(hr.STATE_CHANGE,io.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=ro.CONNECTED}),this.workerConnection.on(at.ON_MESSAGE,async r=>{if(r.data instanceof ArrayBuffer){const s=Tge(new Uint8Array(r.data));if(Y("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&A.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(s)),s.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(hr.INSPECT_RESULT,void 0,void 0);if(s.data&&s.data.scorePorn&&s.data.scoreSexy&&s.data.scoreNeutral){var i;const c={porn:s.data.scorePorn,sexy:s.data.scoreSexy,neutral:s.data.scoreNeutral},u=Ao(i=Object.keys(c)).call(i,(f,m)=>c[f]>c[m]?f:m,"porn"),h=Object.keys(c).find(f=>f===u);this.emit(hr.INSPECT_RESULT,h)}else this.emit(hr.INSPECT_RESULT,void 0,new se($.UNEXPECTED_RESPONSE,s.code+"","There is an unexpected data on message"))}else this.emit(hr.INSPECT_RESULT,void 0,new se($.UNEXPECTED_RESPONSE,s.code+"",s.msg))}else A.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(hr.INSPECT_RESULT,void 0,new se($.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(at.CLOSED,()=>{this.connectionState=ro.CLOSED}),this.workerConnection.on(at.FAILED,()=>{this.connectionState=ro.CLOSED}),this.workerConnection.on(at.RECONNECTING,()=>{this.connectionState=this.connectionState===ro.CONNECTED?ro.RECONNECTING:ro.CONNECTING}),this.workerConnection.on(at.WILL_RECONNECT,(r,i,s)=>{r==="recover"&&s(r),s("tryNext")}),this.workerConnection.on(at.REQUEST_NEW_URLS,(r,i)=>{this.workerManagerConnection.close(),this.once(hr.REQUEST_NEW_WORKER_URL,s=>{r([s])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(s=>{this.connectWorkerManager(s,!0)}).catch(s=>{i(s)})})}async requestToInspectImage(){this.sequence++;const r=ia(this,hr.CLIENT_LOCAL_VIDEO_TRACK),i={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(r){if(!r.isPlaying)return void this.emit(hr.INSPECT_RESULT,void 0,new se($.INVALID_OPERATION,"Only the track being played can be inspected"));const s=await this.generateRequestData(r,i);this.workerConnection.sendMessage(s,!0,!0)}else this.emit(hr.INSPECT_RESULT,void 0,new se($.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(r,i){let{appId:s,cname:c,cid:u,vid:h,sid:f,uid:m}=i;const y=Date.now(),_=await r.getCurrentFrameImage("image/jpeg",this.quality),S=await aF(_,s,c),w=this.sequence+"-"+u+"-"+m+"-"+y+"-"+qt(12,""),O={appId:s,cid:u,cname:c,deviceId:"",elapse:(W=Number(y-this.inspectStartTime),{low:W|=0,high:W>>31,unsigned:W>=0}),fileSize:S.byteLength,jpgEncryption:2,height:_.height,width:_.width,jpg:S,networkType:6,osType:7,requestId:w,sdkVersion:"4.23.1",sequence:this.sequence,sid:f,timestamp:N5(y),uid:m,vid:h,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var W;this.extraInfo===void 0&&delete O.callbackData,this.ossFilePrefix===void 0&&delete O.ossFilePrefix;const k=bge(O);if(k.byteLength<this.workerMessageLengthLimit){if(Y("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const j=function(H){for(var K=1;K<arguments.length;K++){var Q=arguments[K]!=null?arguments[K]:{};K%2?wW(Object(Q),!0).forEach(function(ie){F(H,ie,Q[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(Q)):wW(Object(Q)).forEach(function(ie){Object.defineProperty(H,ie,Object.getOwnPropertyDescriptor(Q,ie))})}return H}({},O);delete j.jpg,A.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(j))}return k}{const j=this.quality*this.qualityRatio;return this.quality=j,await this.generateRequestData(r,{appId:s,cname:c,cid:u,vid:h,sid:f,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=mi.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=ro.CLOSED,this.emit(hr.STATE_CHANGE,io.CLOSED)}}const xge={name:"ContentInspect",create:function(n){let{config:r}=n;return function(i){if(!i)throw new se($.INVALID_PARAMS,"inspectConfig is necessary.");if(!i.inspectType||!Array.isArray(i.inspectType))throw new se($.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const s=[...new Set(i.inspectType)];s.forEach(c=>{var u;if(!Oe(u=["supervise","moderation"]).call(u,c))throw new se($.INVALID_PARAMS,"".concat(c," is not a valid inspect type."))}),i.inspectType=s}if(i&&i.extraInfo&&i.extraInfo.length>1024)throw new se($.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(r),new Pge(r)}};var CW=l(er.Object.getOwnPropertySymbols),Dge=kt,Lge=lC.indexOf,kge=Av,qA=le([].indexOf),RW=!!qA&&1/qA([1],1,-0)<0;Dge({target:"Array",proto:!0,forced:RW||!kge("indexOf")},{indexOf:function(n){var r=arguments.length>1?arguments[1]:void 0;return RW?qA(this,n,r)||0:Lge(this,n,r)}});var Mge=za("Array","indexOf"),Uge=R,jge=Mge,YA=Array.prototype,Vge=function(n){var r=n.indexOf;return n===YA||Uge(YA,n)&&r===YA.indexOf?jge:r},OW=l(Vge);function Bge(n,r){if(n==null)return{};var i,s,c=function(h,f){if(h==null)return{};var m,y,_={},S=$3(h);for(y=0;y<S.length;y++)m=S[y],OW(f).call(f,m)>=0||(_[m]=h[m]);return _}(n,r);if(CW){var u=CW(n);for(s=0;s<u.length;s++)i=u[s],OW(r).call(r,i)>=0||Object.prototype.propertyIsEnumerable.call(n,i)&&(c[i]=n[i])}return c}let AW=class{get localCapabilities(){return yn(this._localCapabilities)}get rtpCapabilities(){return yn(this._rtpCapabilities)}get candidates(){return yn(this._candidates)}get iceParameters(){return yn(this._iceParameters)}get dtlsParameters(){return yn(this._dtlsParameters)}constructor(n){F(this,"sessionDesc",void 0),F(this,"_localCapabilities",void 0),F(this,"_rtpCapabilities",void 0),F(this,"_candidates",void 0),F(this,"_iceParameters",void 0),F(this,"_dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname","o/i14u9pJrxRKAsu"),F(this,"firefoxSsrcMidMap",new Map),n=yn(n);const{remoteIceParameters:r,remoteDtlsParameters:i,candidates:s,remoteRTPCapabilities:c,localCapabilities:u,direction:h,setup:f,videoCodec:m,audioCodec:y}=n;let _;this.setup=f,_=h===oi.RECEIVE_ONLY?Ai(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):Ai(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=c,this._candidates=s,this._iceParameters=r,this._dtlsParameters=i,this._localCapabilities=u;const S=h===oi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,w=h===oi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,O=h===oi.RECEIVE_ONLY?c.send.videoCodecs:km(Ue.VIDEO,S,w,m),W=h===oi.RECEIVE_ONLY?c.send.audioCodecs:km(Ue.AUDIO,S,w,y);for(const k of _.mediaDescriptions)k.attributes.iceUfrag=r.iceUfrag,k.attributes.icePwd=r.icePwd,k.attributes.fingerprints=i.fingerprints,k.attributes.candidates=s,k.attributes.setup=this.setup,k.media.mediaType==="application"&&(k.attributes.sctpPort="5000"),k.media.mediaType==="video"&&(k.media.fmts=O.map(j=>j.payloadType.toString(10)),k.attributes.payloads=O,k.attributes.extmaps=S.videoExtensions),k.media.mediaType==="audio"&&(k.media.fmts=W.map(j=>j.payloadType.toString(10)),k.attributes.payloads=W,k.attributes.extmaps=S.audioExtensions,Fh(k));this.sessionDesc=_,this.currentMidIndex=_.mediaDescriptions.length-1}toString(){return Jc(this.sessionDesc)}hasMid(n){return Array.isArray(n)?n.every(r=>this.hasMid(r)):this.sessionDesc.mediaDescriptions.some(r=>r.attributes.mid===n)}send(n,r,i,s,c){i=i.replace(/ /g,"-");const{ssrcs:u,ssrcGroups:h}=ku(r,this.cname,Y("SYNC_GROUP")?i:void 0),f=this.findPreloadMediaDesc(u);if(f){if(gn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,f.attributes.mid),c&&(c.twcc||c.remb)){const m=this.sessionDesc.mediaDescriptions.indexOf(f);return this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(f,c),{mid:f.attributes.mid,needExchangeSDP:!0}}return{mid:f.attributes.mid,needExchangeSDP:!1}}{const m=this.findAvailableMediaIndex(n,u,s);let y;return m===-1?(y=this.createOrRecycleSendMedia(n,u,h,"sendonly",s,c),this.updateBundleMids()):(y=yn(this.sessionDesc.mediaDescriptions[m]),y.attributes.direction="sendonly",y.attributes.ssrcs=u,y.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(y,c)),gn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,y.attributes.mid),{needExchangeSDP:!0,mid:y.attributes.mid}}}stopSending(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>i.attributes.mid&&n.indexOf(i.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(i=>{i.attributes.ssrcs=[]}),this.updateBundleMids()}receive(n,r,i){const s=[];return n.forEach(c=>{const u=c._mediaStreamTrack.kind,h=this.findAvailableRecvMediaIndex(u);let f,m=!1;h===-1?(m=!0,f=this.createOrRecycleRecvMedia(c,[],"recvonly",r,i),this.updateBundleMids()):(f=yn(this.sessionDesc.mediaDescriptions[h]),f.attributes.direction="recvonly"),s.push({mid:f.attributes.mid,needCreateTransceiver:m})}),s}stopReceiving(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>n.indexOf(i.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(i=>{i.media.port="0",i.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(n){const{foundation:r,protocol:i,address:s,port:c,type:u,relatedAddress:h,relatedPort:f,priority:m}=new RTCIceCandidate(n),y={foundation:r??"",componentId:"1",transport:i??"",priority:m?m+"":"",connectionAddress:s??"",port:c?c+"":"",type:u?u+"":"",relAddr:h??"",relPort:f?f+"":"",extension:{}};this.candidates.some(_=>_.priority===y.priority&&_.connectionAddress===y.connectionAddress&&_.port===y.port)||(this._candidates.push(y),this.sessionDesc.mediaDescriptions.forEach(_=>{_.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(n,r,i,s,c){const u=n._mediaStreamTrack.kind,h=this.rtpCapabilities.recv,f=km(u,h,this.localCapabilities.send,u===Ue.AUDIO?c:s),m=u===Ue.VIDEO?h.videoExtensions:h.audioExtensions,y="".concat(++this.currentMidIndex);let _={media:{mediaType:u,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(w=>w.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};_=this.mungRecvMediaDsec(_,n);const S=this.findFirstClosedMedia(u);if(S){const w=this.sessionDesc.mediaDescriptions.indexOf(S);this.sessionDesc.mediaDescriptions[w]=_}else this.sessionDesc.mediaDescriptions.push(_);return _}muteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>Oe(n).call(n,i.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="inactive"})}unmuteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(i=>Oe(n).call(n,i.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="recvonly"})}findAvailableMediaIndex(n,r,i){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const c=s.media.mediaType===n&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(gn()){if(c){const u=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(u||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!u||u!==s.attributes.mid)}return!1}return c&&s.attributes.mid===i})}findAvailableRecvMediaIndex(n){return this.sessionDesc.mediaDescriptions.findIndex(r=>{const i=r.media.mediaType===n&&r.media.port!=="0"&&(r.attributes.direction==="recvonly"||r.attributes.direction==="sendrecv");return r.attributes.mid!=="0"&&r.attributes.mid!=="1"&&i})}predictReceivingMids(n){const r=[];for(let i=0;i<n;i++)r.push((this.currentMidIndex+i+1).toString(10));return r}restartICE(n){n=yn(n),this._iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=n.iceUfrag,r.attributes.icePwd=n.icePwd})}createOrRecycleSendMedia(n,r,i,s,c,u){const h=this.rtpCapabilities.send,f=n===Ue.VIDEO?h.videoCodecs:h.audioCodecs,m=n===Ue.VIDEO?h.videoExtensions:h.audioExtensions;gn()&&(c="".concat(++this.currentMidIndex));let y={media:{mediaType:n,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(S=>S.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:c}};y=this.mungSendMediaDesc(y,u);const _=this.findFirstClosedMedia(n);if(_){const S=this.sessionDesc.mediaDescriptions.indexOf(_);this.sessionDesc.mediaDescriptions[S]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}mungRecvMediaDsec(n,r,i){const s=yn(n);return qO(s),Bh(s,r),YO(s,r),m4(s),LE(s,i,this.localCapabilities.send),s}mungSendMediaDesc(n,r){const i=yn(n);return LE(i,r,this.localCapabilities.recv),Fh(i),i}updateRecvMedia(n,r){const i=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===n);if(i!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],r);this.sessionDesc.mediaDescriptions[i]=s}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(n=>n.media.port!=="0").map(n=>n.attributes.mid)}findPreloadMediaDesc(n){return this.sessionDesc.mediaDescriptions.find(r=>{var i;return((i=r.attributes)===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId)===n[0].ssrcId})}findFirstClosedMedia(n){return this.sessionDesc.mediaDescriptions.find(r=>gn()?r.media.port==="0"&&r.media.mediaType===n:r.media.port==="0")}};const Fge=["sdp"];var Qt;function IW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function hl(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?IW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):IW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let NW=(Qt=class cf extends X3{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var r,i;return(r=(i=this.peerConnection.getReceivers()[0])===null||i===void 0||(i=i.transport)===null||i===void 0?void 0:i.state)!==null&&r!==void 0?r:null}get localCodecs(){return[]}set isInRestartIce(r){this._isInRestartIce=r}get isInRestartIce(){return this._isInRestartIce}constructor(r,i,s){super(r,i),F(this,"direction",void 0),F(this,"name",void 0),F(this,"store",void 0),F(this,"spec",void 0),F(this,"peerConnection",void 0),F(this,"initialOffer",void 0),F(this,"transport",void 0),F(this,"statsFilter",void 0),F(this,"localCandidateCount",0),F(this,"_isInRestartIce",!1),F(this,"mutex",void 0),F(this,"onLocalCandidate",void 0),F(this,"remoteSDP",void 0),F(this,"pendingCandidates",[]),F(this,"localCapabilities",void 0),F(this,"isReady",!1),F(this,"restartCnt",0),F(this,"curTurnServerIndex",0),this.store=i,this.spec=r,this.mutex=new Lr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(cf.resolvePCConfiguration(r,i.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=s??oi.SEND_ONLY,this.name=this.direction===oi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=lO(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,gn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(r){try{const i=await y4();if(this.localCapabilities=kE(i),r){const{sdp:s}=r,c=Bge(r,Fge),u=function(){const _={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},S=Lm(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),w={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},O={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},W={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(S,_,"videoExtensions",w,O,W),ao(S,_,"videoCodecs",w,O,W),ao(S,_,"audioExtensions",w,O,W),ao(S,_,"audioCodecs",w,O,W),Y("RAISE_H264_BASELINE_PRIORITY")){const k=W.videoCodecs.findIndex(j=>j.rtpMap&&j.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&j.fmtp&&j.fmtp.parameters["profile-level-id"]==="42001f");if(k!==-1){const j=W.videoCodecs.findIndex(H=>H.rtpMap&&H.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(j<k){A.debug("raising H264 baseline profile priority");const H=W.videoCodecs[k];W.videoCodecs.splice(k,1),W.videoCodecs.splice(j,0,H)}j!==-1&&Y("FILTER_SEND_H264_BASELINE")&&(w.videoCodecs=w.videoCodecs.filter(H=>!(H.rtpMap&&H.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&H.fmtp&&H.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:w,recv:O,sendrecv:W}}({},{},s);this.remoteSDP=new AW({remoteIceParameters:c.iceParameters,remoteDtlsParameters:c.dtlsParameters,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const h=await this.peerConnection.createAnswer();if(!h.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const f=tl(h.sdp);await this.peerConnection.setLocalDescription(h);const m=await v4({},{},h.sdp);this.localCapabilities=kE(m);const y=this.peerConnection.getTransceivers()[0];return y!=null&&y.receiver&&y.receiver.transport&&this.tryBindTransportEvents(y.receiver.transport),hl(hl({},f),{},{sdp:h.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=tl(s.sdp);return this.initialOffer=s,hl(hl({},c),{},{sdp:s.sdp})}}catch(i){throw new de($.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:i,iceParameters:s,dtlsParameters:c}=r,u=await v4({},{},i);this.remoteSDP=new AW({remoteIceParameters:s,remoteDtlsParameters:c,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const h=this.peerConnection.getTransceivers()[0];h!=null&&h.sender&&h.sender.transport&&this.tryBindTransportEvents(h.sender.transport)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}}async addRemoteCandidate(r){try{r&&this.pendingCandidates.push(r),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(i=>{this.peerConnection.addIceCandidate(i)}),this.pendingCandidates=[])}catch(i){throw new de($.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(i.toString()))}}send(r,i,s){var c=this;return wa(function*(){const u=yield vt(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[],f=c.remoteSDP.receive(r,i,s);r.forEach((j,H)=>{if(f[H].needCreateTransceiver){const K=c.peerConnection.addTransceiver(j._mediaStreamTrack,{direction:"sendonly"});h.push(K),j._updateRtpTransceiver(K)}else{const K=c.peerConnection.getTransceivers().find(Q=>Q.mid===f[H].mid);if(!K)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(f[H].mid));h.push(K),j._updateRtpTransceiver(K)}}),gn()&&Y("SIMULCAST")===!0&&(yield vt(c.applySimulcastForFirefox(h,r)));const m=f.map(j=>j.mid),y=yield vt(c.peerConnection.createOffer()),_=c.mungSendOfferSDP(y.sdp,r,m),S=Ai(_),w=m.map(j=>{const H=S.mediaDescriptions.find(K=>K.attributes.mid===j);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return h4(H,Y("USE_PUB_RTX"))}),O=h.map((j,H)=>{const K=m[H];return{localSSRC:w[H],id:K}});yield vt(c.peerConnection.setLocalDescription({type:"offer",sdp:_}));try{yield O}catch(j){const H=c.remoteSDP.toString();throw yield vt(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield vt(c.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield vt(c.stopSending(m,!0)),j}yield vt(c.applySimulcastEncodings(h,r)),yield vt(c.applySendEncodings(h,r));const W=c.remoteSDP.toString(),k=c.logSDPExchange(_,"offer","local","send");return k==null||k(W),yield vt(c.setRemoteDescription({type:"answer",sdp:W})),h.map((j,H)=>{const K=m[H];return{localSSRC:w[H],id:K}})}catch(h){throw h instanceof de?h:new de($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(r,i){const s=i?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(m=>r.indexOf(m.mid)!==-1);if(c.length!==r.length)throw new Error("Transceivers' length (".concat(c.length,") doesn't match mids' length (").concat(r.length,") when trying to call P2PConnection.stopSending."));c.map(m=>{var y;m.direction="inactive",(y=m.stop)===null||y===void 0||y.call(m)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(r);const f=this.remoteSDP.toString();h==null||h(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(c){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{s&&s()}}async receive(r,i,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(r,i,s,c);if(h){const m=this.remoteSDP.toString(),y=this.logSDPExchange(m,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:m});const _=await this.peerConnection.createAnswer(),S=this.mungReceiveAnswerSDP(_.sdp,u,r);y==null||y(S||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:S}),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP."))}else A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(m=>m.mid===u);if(!f||f.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,mid:f.mid,transceiver:f}}catch(u){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async mockReceive(r,i,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(r,i,s,c);if(h){const f=this.remoteSDP.toString(),m=this.logSDPExchange(f,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:f});const y=await this.peerConnection.createAnswer(),_=this.mungReceiveAnswerSDP(y.sdp,u,r);m==null||m(_||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:_}),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP."))}else A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," no need to exchange SDP."))}catch(u){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:i});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async restartICE(r){try{if(this.store.p2pTransport===Ou.Auto&&(this.store.p2pTransport=Ou.SdRtn,bt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(cf.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,bt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(cf.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!r){this.restartCnt++,this.isReady=!1;const i=await this.peerConnection.createOffer({iceRestart:!0});if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:s}=tl(i.sdp);return this.store.descriptionStart(),this.direction===oi.SEND_ONLY&&await this.peerConnection.setLocalDescription(i),s}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(r),this.store.descriptionStart(),this.direction===oi.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const i=await this.peerConnection.createAnswer();if(!i.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:s}=tl(i.sdp);return await this.peerConnection.setLocalDescription(i),s}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}close(){var r;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[i],[r]);this.remoteSDP.updateRecvMedia(r,i);const u=this.remoteSDP.toString(),h=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new de($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(r,i){const s=this.peerConnection.getTransceivers().filter(c=>c.mid===r);s.length===1&&(this.isVP8Simulcast(i)?gn()||await this.applySimulcastEncodings(s,[i]):await this.applySendEncodings(s,[i]))}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const s=this.peerConnection.getTransceivers().find(c=>c.mid===i);s&&await s.sender.replaceTrack(r._mediaStreamTrack)}async getSelectedCandidatePair(){const r=this.peerConnection.getReceivers();if(r.length>0&&r[0].transport&&r[0].transport.iceTransport&&r[0].transport.iceTransport.getSelectedCandidatePair&&r[0].transport.iceTransport.getSelectedCandidatePair()){const i=r[0].transport.iceTransport,{local:s,remote:c}=i.getSelectedCandidatePair();return{local:hl(hl({},ms),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:hl(hl({},ms),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r,i;Oe(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=r=>{if(r.candidate){var i;r.candidate.candidate&&((i=this.onLocalCandidate)===null||i===void 0||i.call(this,r.candidate.toJSON())),this.localCandidateCount+=1}else A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c={iceServers:[]};var u;return r.iceServers?c.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Sm(r.turnServer.servers)?c.iceServers=r.turnServer.servers:(c.iceServers&&c.iceServers.push(...cf.turnServerConfigToIceServers(r.turnServer.servers,i,s)),Y("USE_TURN_SERVER_OF_GATEWAY")&&c.iceServers&&r.turnServer.serversFromGateway&&c.iceServers.push(...cf.turnServerConfigToIceServers(r.turnServer.serversFromGateway,i,s)),Oe(u=[Ou.Relay,Ou.SdRtn]).call(u,i)&&(c.iceTransportPolicy="relay"),Y("FORCE_TURN_TCP")?c.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(h=>{h.forceturn&&(c.iceTransportPolicy="relay")}))),Y("ENABLE_ENCODED_TRANSFORM")&&bt().supportWebRTCEncodedTransform&&(c.encodedInsertableStreams=!0),A.debug("P2PConnection p2pTransport is ".concat(i)),c}static turnServerConfigToIceServers(r,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c=[],u=r.filter(f=>f.tcpport);A.debug("P2PConnection turnServers is ".concat(u,", current index is ").concat(s));const h=u.length>s?u[s]:u[0];switch(i){case Ou.SdRtn:const f=r.filter(y=>{var _;return Oe(_=y.username).call(_,"glb:")&&y.turnServerURL==y.turnServerURL}),m=f.length>s?f[s]:f[0];m&&(c.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(jh(m.turnServerURL),":").concat(m.tcpport,"?transport=udp")}),c.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(jh(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;case Ou.Relay:h&&(c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(jh(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}));break;default:h&&(c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(jh(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"stun:".concat(h.turnServerURL,":").concat(h.tcpport)}))}return c}tryBindTransportEvents(r){if(r){this.transport=r,r.onstatechange=()=>{var s;r!=null&&r.state&&((s=this.onDTLSTransportStateChange)===null||s===void 0||s.call(this,r.state))},r.onerror=s=>{var c;(c=this.onDTLSTransportError)===null||c===void 0||c.call(this,"error"in s?s.error:s)};const i=r.iceTransport;i&&(i.onstatechange=()=>{const s=r==null?void 0:r.iceTransport.state;var c;s&&((c=this.onICETransportStateChange)===null||c===void 0||c.call(this,s))},i.getSelectedCandidatePair&&(i.onselectedcandidatepairchange=()=>{if(i.getSelectedCandidatePair()){const{local:s,remote:c}=i.getSelectedCandidatePair();A.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:s.type,protocol:s.protocol}),", remote ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(r,i){var s;if(i||(i=this.peerConnection.getSenders().find(_=>_.track===r._mediaStreamTrack)),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(r))return A.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!bt().supportSetRtpSenderParameters)return A.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const c={},u={};switch(r._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(r._encoderConfig){var h;const{bitrateMax:_,frameRate:S,scaleResolutionDownBy:w}=r._encoderConfig;_&&(u.maxBitrate=1e3*_),Oe(h=r._hints).call(h,Yt.LOW_STREAM)&&(S&&(u.maxFramerate=zi(S)),w&&w>=1&&(u.scaleResolutionDownBy=w))}if(Y("DSCP_TYPE")&&Js()){var f;const _=Y("DSCP_TYPE");Oe(f=["very-low","low","medium","high"]).call(f,_)&&(u.networkPriority=_)}const m=i.getParameters(),y=(s=m.encodings)===null||s===void 0?void 0:s[0];gn()&&!y&&(c.encodings=[u]),y&&Object.assign(y,u),Object.assign(m,c),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await i.setParameters(m)}async applySendEncodings(r,i){try{if(!bt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let s=0;s<r.length;s++){const c=r[s],u=i[s];u instanceof tn&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,c.sender)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i,s){const c=Ai(r);return i.forEach((u,h)=>{const f=s[h],m=c.mediaDescriptions.find(y=>y.attributes.mid===f);m&&(Bh(m,u),g4(m,u,this.store.codec))}),Jc(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,r,i,s)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,r,i)},this.statsFilter.onFirstVideoDecodedTimeout=r=>{var i;(i=this.onFirstVideoDecodedTimeout)===null||i===void 0||i.call(this,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(r,i){if(r.length===i.length)for(let m=0;m<r.length;m++){var s,c,u,h,f;const y=r[m],_=i[m];if(_ instanceof tn&&!Oe(s=_._hints).call(s,Yt.LOW_STREAM)&&(c=_._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=_._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=_._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=_._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const S={},w={high:1e3*(_._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{rid:"m",active:!0,maxBitrate:w.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:w.high}];const O=y.sender.getParameters();await y.sender.setParameters(Object.assign(O,S))}}}async applySimulcastEncodings(r,i){if(!gn()&&r.length===i.length)for(let s=0;s<r.length;s++){const c=i[s];if(c instanceof tn&&this.isVP8Simulcast(c)){const u=r[s],h={},f={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const m=u.sender.getParameters();await u.sender.setParameters(Object.assign(m,h))}}}isVP8Simulcast(r){var i,s,c,u,h;return!!(r instanceof tn&&Y("SIMULCAST")&&this.store.codec==="vp8"&&!Oe(i=r._hints).call(i,Yt.LOW_STREAM)&&(s=r._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((c=r._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(u=r._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=r._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(r,i,s,c){if(Y("SDP_LOGGING"))return A.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(i," SDP during P2PConnection.").concat(c,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",s==="local"?"remote":"local",c)}:void 0}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(h=>h.mid&&r.indexOf(h.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(h=>{h.direction="inactive"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(r);const u=this.remoteSDP.toString();c==null||c(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(h=>h.mid&&r.indexOf(h.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(async h=>{h.direction="sendonly"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(r);const u=this.remoteSDP.toString();c==null||c(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}async getRemoteSSRC(r,i){var s,c;if(i=(s=i)!==null&&s!==void 0?s:(c=this.currentRemoteDescription)===null||c===void 0?void 0:c.sdp){var u;const h=(u=Ai(i).mediaDescriptions.find(f=>f.attributes.mid===r))===null||u===void 0?void 0:u.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}async setRemoteDescription(r){var i;await this.peerConnection.setRemoteDescription(r),Oe(i=["connected","completed"]).call(i,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(r,i,s){const c=Ai(r),u=c.mediaDescriptions.find(h=>h.attributes.mid===i);return u&&s===Ue.AUDIO&&u.media.mediaType==="audio"&&Fh(u),Jc(c)}},Fe(Qt.prototype,"establish",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"establish"),Qt.prototype),Fe(Qt.prototype,"connect",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"connect"),Qt.prototype),Fe(Qt.prototype,"receive",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"receive"),Qt.prototype),Fe(Qt.prototype,"mockReceive",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"mockReceive"),Qt.prototype),Fe(Qt.prototype,"stopReceiving",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"stopReceiving"),Qt.prototype),Fe(Qt.prototype,"restartICE",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"restartICE"),Qt.prototype),Fe(Qt.prototype,"close",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"close"),Qt.prototype),Fe(Qt.prototype,"updateEncoderConfig",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"updateEncoderConfig"),Qt.prototype),Fe(Qt.prototype,"updateSendParameters",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"updateSendParameters"),Qt.prototype),Fe(Qt.prototype,"replaceTrack",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"replaceTrack"),Qt.prototype),Fe(Qt.prototype,"muteLocal",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"muteLocal"),Qt.prototype),Fe(Qt.prototype,"unmuteLocal",[uo],Object.getOwnPropertyDescriptor(Qt.prototype,"unmuteLocal"),Qt.prototype),Qt);function uo(n,r,i){const s=n[r];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const c=this.mutex,u=await c.lock("From P2PConnection.".concat(r));try{for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return await s.apply(this,f)}finally{u()}},i}let Go=function(n){return n.SEND_ONLY="SEND_ONLY",n.RECEIVE_ONLY="RECEIVE_ONLY",n}({});var PW,xW,DW,LW,kW,MW,UW,jW,VW,BW,FW,cn;function WW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function hS(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?WW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):WW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let Wge=(PW=$o(Go.SEND_ONLY),xW=$o(Go.SEND_ONLY),DW=$o(),LW=$o(Go.RECEIVE_ONLY),kW=$o(Go.RECEIVE_ONLY),MW=$o(Go.RECEIVE_ONLY),UW=$o(Go.RECEIVE_ONLY),jW=$o(Go.RECEIVE_ONLY),VW=$o(Go.RECEIVE_ONLY),BW=$o(),FW=$o(Go.RECEIVE_ONLY),cn=class extends ln{get state(){return this._state}set state(n){const r=this._state;this._state=n,this.emit(Ke.StateChange,r,this._state)}constructor(n,r){super(),F(this,"isPlanB",!1),F(this,"store",void 0),F(this,"statsUploader",void 0),F(this,"sendConnection",void 0),F(this,"recvConnection",void 0),F(this,"localTrackMap",new Map),F(this,"remoteUserMap",new Map),F(this,"localDataChannels",[]),F(this,"pendingLocalTracks",[]),F(this,"pendingRemoteTracks",[]),F(this,"statsCollector",void 0),F(this,"dtlsFailedCount",0),F(this,"sendMutex",void 0),F(this,"recvMutex",void 0),F(this,"_state",xt.Disconnected),F(this,"_restartStates",["disconnected","failed"]),F(this,"reconnectInterval",void 0),F(this,"uploadUnplinkStarted",!1),F(this,"uploadDownlinkStarted",!1),F(this,"uplinkStateUploadInterval",void 0),F(this,"downlinkStatsUploadInterval",void 0),F(this,"handleMuteLocalTrack",async(i,s,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==xt.Connected)return void c(new de($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const m=this.filterTobeMutedTracks(i);if(m.length===0)return void s();const y=m.find(O=>O[0]==="videoLowTrack");y&&y[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(m.map(O=>{let[,{id:W}]=O;return W}));let _=!1;var h,f;i.trackMediaType==="video"?_=!((h=this.localTrackMap.get(Ee.LocalAudioTrack))===null||h===void 0||!h.track._muted):_=((f=this.localTrackMap.get(Ee.LocalVideoTrack))===null||f===void 0?void 0:f.id)===void 0;const S=this.createMuteMessage(m);await Kt(this,Ke.RequestMuteLocal,S);const w=i.trackMediaType==="video"?Zc.MUTE_LOCAL_VIDEO:Zc.MUTE_LOCAL_AUDIO;await Kt(this,Ke.RequestP2PMuteLocal,{action:w,message:S,isMuteAll:_}),s()}catch(m){c(m)}finally{u()}}),F(this,"handleUnmuteLocalTrack",async(i,s,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==xt.Connected)return void c(new de($.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const h=this.filterTobeUnmutedTracks(i);if(h.length===0)return void s();await this.sendConnection.unmuteLocal(h.map(y=>{let[,{id:_}]=y;return _}));const f=this.createUnmuteMessage(h),m=i.trackMediaType==="video"?Zc.UNMUTE_LOCAL_VIDEO:Zc.UNMUTE_LOCAL_AUDIO;await Kt(this,Ke.RequestP2PMuteLocal,{action:m,message:f}),s()}catch(h){c(h)}finally{u()}}),F(this,"handleUpdateVideoEncoder",async(i,s,c,u)=>{let h;typeof u=="boolean"&&u||(h=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const m=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.sendConnection||!m||m.track!==i||this.state!==xt.Connected)return void s();const{id:y,track:_}=m;y&&(await this.sendConnection.updateSendParameters(y,_),await this.sendConnection.updateEncoderConfig(y,_),this.emit(Ke.UpdateVideoEncoder,_)),s()}catch(m){c(m)}finally{var f;(f=h)===null||f===void 0||f()}}),F(this,"handleUpdateVideoSendParameters",async(i,s,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const h=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.sendConnection||!h||h.track!==i||this.state!==xt.Connected)return void s();const{id:f,track:m}=h;f&&await this.sendConnection.updateSendParameters(f,m),s()}catch(h){c(h)}finally{u()}}),F(this,"handleReplaceTrack",async(i,s,c,u)=>{let h;A.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(i.getTrackId(),"]")),typeof u=="boolean"&&u||(h=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var f;const y=Array.from(this.localTrackMap.entries()).find(_=>{let[,{track:S}]=_;return i===S});if(!this.sendConnection||!y||y[1].id===void 0||this.state!==xt.Connected)return void s();if(await((f=this.sendConnection)===null||f===void 0?void 0:f.replaceTrack(i,y[1].id)),y[0]===Ee.LocalVideoTrack&&bt().supportDualStreamEncoding){const _=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(_){const S=i._mediaStreamTrack.clone();_.track._originMediaStreamTrack.stop(),_.track._mediaStreamTrack=S,_.track._originMediaStreamTrack=S,await new Ie((w,O)=>{this.handleReplaceTrack(_.track,w,O,!0)})}}s()}catch(y){c(y)}finally{var m;(m=h)===null||m===void 0||m()}}),F(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),F(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),F(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),F(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=n,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new r5(n),this.bindStatsUploaderEvents(),this.sendMutex=new Lr("P2PChannel2-send-mutex",n.clientId),this.recvMutex=new Lr("P2PChannel2-recv-mutex",n.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(i=>{i&&(i.iceConnectionState!=="disconnected"&&i.iceConnectionState!=="failed"||this.handleDisconnect(i.direction))})},Y("ICE_RESTART_INTERVAL"))}async startP2PConnection(n,r){throw new de($.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(n){throw new de($.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(n,r){let i;try{if(r){this.recvConnection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),i=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new NW(n,this.store,oi.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const s=await this.recvConnection.establish(r);return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}{this.state=xt.New,this.sendConnection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),i=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new NW(n,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const s=await this.sendConnection.establish();return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}}finally{i&&i()}}async p2pConnect(n){if(!this.sendConnection)throw new de($.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(n),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=xt.Connected}async addRemoteCandidate(n,r){if(r===oi.RECEIVE_ONLY){if(!this.sendConnection)throw new de($.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(n)}else{if(!this.recvConnection)throw new de($.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(n)}}publish(n,r,i){var s=this;return wa(function*(){const c=yield vt(s.sendMutex.lock("From P2PChannel.publish"));try{if(!s.sendConnection||s.state!==xt.Connected){s.throwIfTrackTypeNotMatch(n);const y=n.filter(_=>s.pendingLocalTracks.indexOf(_)===-1);return void(s.pendingLocalTracks=s.pendingLocalTracks.concat(y))}s.store.pubId=s.store.pubId+1,Mr.markPublishStart(s.store.clientId,s.store.pubId);const u=s.filterTobePublishedTracks(n,r,i);if(u.length===0)return void(yield vt(s.tryToUnmuteAudio(n)));u.forEach(y=>{let{track:_,type:S}=y;const w=Date.now();s.store.publish(_.getTrackId(),S===Ee.LocalAudioTrack?"audio":"video",w)}),s.bindLocalTrackEvents(u);const h=yield vt(s.sendConnection.send(u.map(y=>{let{track:_}=y;return _}),s.store.codec,s.store.audioCodec)),f=(yield vt(h.next())).value,m=s.createGatewayPublishMessage(u,f);try{yield m}catch(y){throw h.throw(y),(y==null?void 0:y.code)===$.WS_ABORT&&u.forEach(_=>{let{track:S}=_;s.pendingLocalTracks.indexOf(S)===-1&&s.pendingLocalTracks.push(S)}),s.unbindLocalTrackEvents(u),y}yield vt(h.next()),u.forEach(y=>{let{type:_}=y;s.statsCollector.addLocalStats(_)}),s.statsUploader.startUploadOutboundStats(),s.assignLocalTracks(u,f),u.forEach(y=>{let{track:_,type:S}=y;const w=Date.now();s.store.publish(_.getTrackId(),S===Ee.LocalAudioTrack?"audio":"video",void 0,w)}),s.startUploadUplinkState()}finally{c()}})()}async unpublish(n){if(!this.sendConnection||this.state!==xt.Connected)return void(n.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(c=>!Oe(n).call(n,c)));const r=this.filterTobeUnpublishedTracks(n);if(r.length===0)return;const i=r.find(c=>c[0]==="videoLowTrack");i&&i[1].track.close();const s=this.createGatewayUnpublishMessage(r);if(await this.sendConnection.stopSending(r.map(c=>{let[,{id:u}]=c;return u})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(c=>{let[u,{track:h}]=c;return{type:u,track:h}})),r.forEach(c=>{let[u]=c;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===xt.Connected)return i&&i[1].track.close(),s;n.forEach(c=>{const u=this.pendingLocalTracks.indexOf(c);u!==-1&&this.pendingLocalTracks.splice(u,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const n=()=>{const r=[],i=[];Array.from(this.localTrackMap.entries()).forEach(s=>{let[c,{track:u,ssrcs:h}]=s;const f={stream_type:Vpe(u,c),ssrcs:h};u._muted||!u._enabled?r.push(f):i.push(f)}),r.length>0&&r.forEach(s=>{Kt(this,Ke.RequestMuteLocal,[s])}),i.length>0&&i.forEach(s=>{Kt(this,Ke.RequestUnmuteLocal,[s])})};n(),this.uplinkStateUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(n){return wa(function*(){throw new de($.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(A.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Or(this,Ke.RequestRePublish,this.pendingLocalTracks),this.emit(Ke.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new de($.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(n,r,i,s){var c;if(!this.recvConnection)throw new de($.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((c=this.remoteUserMap.get(n))!==null&&c!==void 0&&c.has(r))return;const{track:u,mid:h,transceiver:f}=await this.recvConnection.receive(r,[{ssrcId:i}],String(n.uid),s);r===Ue.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(u):(n._audioTrack=new Nh(u,n.uid,n._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),f&&n._audioTrack._updateRtpTransceiver(f),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoSSRC=i,n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(u):(n._videoTrack=new Ih(u,n.uid,n._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),f&&n._videoTrack._updateRtpTransceiver(f),this.bindRemoteTrackEvents(n,n._videoTrack));const m=this.remoteUserMap.get(n);m?m.set(r,h):this.remoteUserMap.set(n,new Map([[r,h]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const y=this.pendingRemoteTracks.findIndex(_=>{let{user:S,kind:w}=_;return S.uid===n.uid&&r===w});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(Ke.MediaReconnectEnd,n.uid))}async mockSubscribe(n,r,i,s){if(!this.recvConnection)throw new de($.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(r,[{ssrcId:i}],String(n.uid),s)}async unsubscribe(n,r,i){const s=this.pendingRemoteTracks.filter(u=>{let{user:h,kind:f}=u;return r!==void 0?h.uid===n.uid&&r===f:h.uid===n.uid});if(s.forEach(u=>{const h=this.pendingRemoteTracks.indexOf(u);this.pendingRemoteTracks.splice(h,1)}),this.recvConnection||i||s.forEach(u=>{let{kind:h}=u;var f;if(h===Ue.AUDIO)(f=n._audioTrack)===null||f===void 0||f._destroy(),n._audioTrack=void 0;else if(h===Ue.VIDEO){var m;(m=n._videoTrack)===null||m===void 0||m._destroy(),n._videoTrack=void 0}}),!this.recvConnection)return;const c=this.filterTobeUnSubscribedTracks(n,r);c.length!==0&&(await this.recvConnection.stopReceiving(c.map(u=>{let[,{id:h}]=u;return h})),this.withdrawRemoteTracks(c),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),c.forEach(u=>{let[h,{kind:f}]=u;var m,y;if(f===Ue.VIDEO&&h._videoSSRC&&((m=this.recvConnection)===null||m===void 0||m.setStatsRemoteVideoIsReady(h._videoSSRC,!1)),f===Ue.VIDEO)this.unbindRemoteTrackEvents(h._videoTrack),i||((y=h._videoTrack)===null||y===void 0||y._destroy(),h._videoTrack=void 0);else if(f===Ue.AUDIO){var _;this.unbindRemoteTrackEvents(h._audioTrack),!i&&((_=h._audioTrack)===null||_===void 0||_._destroy(),h._audioTrack=void 0)}}),c.forEach(u=>{let[,{kind:h}]=u;Kt(this,Ke.RequestP2PMuteRemote,h)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const n=()=>Array.from(this.remoteUserMap.entries()).forEach(r=>{let[,i]=r;[Ue.VIDEO,Ue.AUDIO].forEach(s=>{i.has(s)?Kt(this,Ke.RequestP2PUnmuteRemote,s):Kt(this,Ke.RequestP2PMuteRemote,s)})});n(),this.downlinkStatsUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(n){throw new de($.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(n){throw new de($.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(n){throw new de($.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(n){throw new de($.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(n,r){if(!this.recvConnection)return;const i=this.remoteUserMap.get(n);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid,"."));if(!i.get(r))return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."));const s=r===Ue.VIDEO?n._videoSSRC:n._audioSSRC;s!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(n,r){return this.unmuteRemoteNoLock(n,r)}async unmuteRemoteNoLock(n,r){if(!this.recvConnection)return;const i=this.remoteUserMap.get(n);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid,"."));i.get(r)||A.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."))}getAllTracks(n){const r=this.localTrackMap.get(Ee.LocalAudioTrack);if((r==null?void 0:r.track)instanceof qn){const i=r.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return c!==Ee.LocalAudioTrack}).filter(s=>{let[c]=s;return!(n&&c===Ee.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c}).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter(i=>{let[s]=i;return!(n&&s===Ee.LocalVideoLowTrack)}).map(i=>{let[,{track:s}]=i;return s})}reportPublishEvent(n,r,i,s,c){if(n){const h=this.localTrackMap.get(Ee.LocalAudioTrack),f=s?this.localTrackMap.get(Ee.LocalVideoLowTrack):this.localTrackMap.get(Ee.LocalVideoTrack);$e.publish(this.store.sessionId,{eventElapse:Mr.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:h==null?void 0:h.track.getTrackLabel(),videoName:f==null?void 0:f.track.getTrackLabel(),screenshare:(f==null?void 0:f.track._hints.indexOf(Yt.SCREEN_TRACK))!==-1,audio:!!h,video:!!f,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}else{var u;i||(i=[]);const h=i.find(m=>m instanceof vn),f=s?(u=this.localTrackMap.get(Ee.LocalVideoTrack))===null||u===void 0?void 0:u.track:i.find(m=>m instanceof tn);$e.publish(this.store.sessionId,{eventElapse:Mr.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:h==null?void 0:h.getTrackLabel(),videoName:f==null?void 0:f.getTrackLabel(),screenshare:(f==null?void 0:f._hints.indexOf(Yt.SCREEN_TRACK))!==-1,audio:!!h,video:!!f,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}}reportSubscribeEvent(n,r,i,s){const c=s===Ue.VIDEO?i._videoSSRC:i._audioSSRC;c&&$e.subscribe(this.store.sessionId,{succ:n,ec:r,video:s===Ue.VIDEO,audio:s===Ue.AUDIO,peerid:i.uid,subscribeRequestid:s===Ue.VIDEO?i._videoSSRC:i._audioSSRC,p2pid:this.store.p2pId,eventElapse:Mr.measureFromSubscribeStart(this.store.clientId,c)})}reset(){A.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Lr("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Lr("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const n=this.localTrackMap.get(Ee.LocalAudioTrack);if((n==null?void 0:n.track)instanceof qn){if(n.track.trackList.length>0){const r=n.track;n.track.trackList.forEach(i=>{r.removeAudioTrack(i)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=xt.Disconnected}getStats(n){var r,i;return n?(i=this.recvConnection)===null||i===void 0?void 0:i.getStats():(r=this.sendConnection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(n){var r;return((r=this.recvConnection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){const n=this.localTrackMap.get(Ee.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){const n=this.localTrackMap.get(Ee.LocalVideoTrack);if(n)return{width:n.track.videoWidth||0,height:n.track.videoHeight||0}}getEncoderConfig(n){const r=this.localTrackMap.get(n);return r&&r.track instanceof tn||r&&r.track instanceof vn?r.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,r){if(!n)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(n);return!!i&&(!r||i.has(r))}async hasRemoteMediaWithLock(n,r){if(!n)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(n);return!!i&&(!r||i.has(r))}getRemoteMedia(n){var r;const i=Array.from(oa(r=this.remoteUserMap).call(r)).find(s=>s.uid===n);return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(i=>{let[s]=i;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Ee.LocalAudioTrack);return r&&n.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=om(n).call(n,(i,s)=>i.level-s.level),n}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(A.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=xt.Reconnecting,Y("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;var i;r._videoTrack&&r._videoTrack._player&&((i=r._videoTrack._player.getVideoElement())===null||i===void 0||i.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var r;let[i,{track:s}]=n;switch(i){case Ee.LocalVideoTrack:Oe(r=s._hints).call(r,Yt.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case Ee.LocalAudioTrack:s instanceof qn?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case Ee.LocalVideoLowTrack:}}),this.emit(Ke.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,i]=n;Array.from(oa(i).call(i)).forEach(s=>{this.setPendingRemoteMedia(r,s)}),this.emit(Ke.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),A.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(n,r){for(const i of this.pendingRemoteTracks){const{user:s,kind:c}=i;if((n instanceof rl?n.uid:n)===s.uid&&r===c)return!0}return!1}setPendingRemoteMedia(n,r){this.hasPendingRemoteMedia(n,r)||this.pendingRemoteTracks.push({user:n,kind:r})}async restartICE(n,r){let i,s;if(n===oi.SEND_ONLY){if(!this.sendConnection)throw new de($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");i=await this.sendMutex.lock("From P2PChannel.restartICE"),s=this.sendConnection}else{if(!this.recvConnection)throw new de($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");i=await this.recvMutex.lock("From P2PChannel.restartICE"),s=this.recvConnection}try{if(r){const c=await s.restartICE(r);return s.isInRestartIce=!1,c}{const c=await s.restartICE();if(c){const u=await Or(this,Ke.RequestP2PRestartICE,{direction:oi.RECEIVE_ONLY,iceParameter:c});await s.restartICE(u),s.isInRestartIce=!1}}}finally{i()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const n=this.sendConnection.getStats(),r=this.localTrackMap.get(Ee.LocalVideoTrack),i=this.localTrackMap.get(Ee.LocalAudioTrack),s=n.videoSend.find(O=>{var W;return O.ssrc===(r==null||(W=r.ssrcs)===null||W===void 0?void 0:W[0].ssrcId)}),c=n.audioSend.find(O=>{var W;return O.ssrc===(i==null||(W=i.ssrcs)===null||W===void 0?void 0:W[0].ssrcId)});if(!s||!c)return 1;const u=ia(this,Ke.NeedSignalRTT),h=s?s.rttMs:void 0,f=c?c.rttMs:void 0,m=h&&f?(h+f)/2:h||f,y=(m&&u?(m+u)/2:m||u)||0,_=100*n.sendPacketLossRate*.7/50+.3*y/1500,S=_<.17?1:_<.36?2:_<.59?3:_<.1?4:5,w=r==null?void 0:r.track;if(w&&w._encoderConfig&&w._hints.indexOf(Yt.SCREEN_TRACK)===-1){const O=w._encoderConfig.bitrateMax,W=n.bitrate.actualEncoded;if(O&&W){const k=(1e3*O-W)/(1e3*O);return F3[k<.15?0:k<.3?1:k<.45?2:k<.6?3:4][S]}}return S}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const n=this.recvConnection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s]=i;const c=s._audioSSRC,u=s._videoSSRC,h=n.audioRecv.find(W=>W.ssrc===c),f=n.videoRecv.find(W=>W.ssrc===u);if(!h&&!f)return void(r+=1);const m=ia(this,Ke.NeedSignalRTT),y=n.rtt,_=(y&&m?(y+m)/2:y||m)||0,S=h?h.jitterMs:void 0,w=n.recvPacketLossRate;let O=.7*w*100/50+.3*_/1500;S&&(O=.6*w*100/50+.2*_/1500+.2*S/400),r+=O<.1?1:O<.17?2:O<.36?3:O<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(n){return new Ie((r,i)=>{this.handleMuteLocalTrack(n,r,i)})}filterTobePublishedTracks(n,r,i){const s=[],c=bt(),u=this.getAllTracks();n=yh(n=n.filter(m=>u.indexOf(m)===-1));let h=!1,f=!1;for(const m of n){if(m instanceof tn&&(this.localTrackMap.has(Ee.LocalVideoTrack)||h?new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:m,type:Ee.LocalVideoTrack}),h=!0),r)){const y=this.getLowVideoTrack(m,i);s.push({track:y,type:Ee.LocalVideoLowTrack})}if(m instanceof vn){const y=this.localTrackMap.get(Ee.LocalAudioTrack);if(y){if(!(y.track instanceof qn))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(m._bypassWebAudio)throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(m),this.bindLocalAudioTrackEvents(m,!0)}else if(f){const _=s.find(S=>{let{type:w}=S;return w===Ee.LocalAudioTrack});if(!(_.track instanceof qn))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(m._bypassWebAudio)throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_.track.addAudioTrack(m)}else{if(!c.webAudioMediaStreamDest||m instanceof qn||m._bypassWebAudio)s.push({track:m,type:Ee.LocalAudioTrack});else{const _=new qn;_.addAudioTrack(m),s.push({track:_,type:Ee.LocalAudioTrack})}f=!0}}}return s}filterTobeUnpublishedTracks(n){const r=[],i=this.getAllTracks();n=yh(n=n.filter(s=>i.indexOf(s)!==-1));for(const s of n){if(s instanceof vn){const c=this.localTrackMap.get(Ee.LocalAudioTrack);if(!c)continue;c.track instanceof qn?(c.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),c.track.trackList.length===0&&(r.push([Ee.LocalAudioTrack,c]),c.track.close())):r.push([Ee.LocalAudioTrack,c])}if(s instanceof tn){const c=this.localTrackMap.get(Ee.LocalVideoTrack);if(!c)continue;r.push([Ee.LocalVideoTrack,c]);const u=this.localTrackMap.get(Ee.LocalVideoLowTrack);u&&r.push([Ee.LocalVideoLowTrack,u])}}return r}bindLocalTrackEvents(n){n.forEach(r=>{let{track:i,type:s}=r;switch(s){case Ee.LocalVideoTrack:i.addListener(je.GET_STATS,this.handleGetLocalVideoStats),i.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(je.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.addListener(je.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.addListener(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.bindLocalAudioTrackEvents(i);case Ee.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,r){n instanceof qn?n.trackList.forEach(i=>{i.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(je.GET_STATS,this.handleGetLocalAudioStats),i.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(je.GET_STATS,this.handleGetLocalAudioStats),n.addListener(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||n.addListener(je.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(r=>{let[i,{track:s}]=r;return{track:s,type:i}})),n.forEach(r=>{let{track:i,type:s}=r;switch(s){case Ee.LocalVideoTrack:i.off(je.GET_STATS,this.handleGetLocalVideoStats),i.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(je.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.off(je.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.off(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.unbindLocalAudioTrackEvents(i);case Ee.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof qn?n.trackList.forEach(r=>{r.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(je.GET_STATS,this.handleGetLocalAudioStats),r.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(je.GET_STATS,this.handleGetLocalAudioStats),n.off(je.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(je.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(je.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(je.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(je.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,r){r instanceof Ih&&r.addListener(je.GET_STATS,i=>{i(this.handleGetRemoteVideoStats(n))}),r instanceof Nh&&r.addListener(je.GET_STATS,i=>{i(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(je.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,i]=n;i.has(Ue.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),i.has(Ue.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(n,r){return n.map((i,s)=>{var c;let u,{track:h,type:f}=i;switch(f){case Ee.LocalAudioTrack:u=Dt.Audio;break;case Ee.LocalVideoTrack:u=Oe(c=h._hints).call(c,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:u=Dt.Low}return{kind:f===Ee.LocalAudioTrack?Ue.AUDIO:Ue.VIDEO,stream_type:u,mid:r[s].id,ssrcs:r[s].localSSRC,isMuted:h.muted||!h.enabled}})}createGatewayUnpublishMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}assignLocalTracks(n,r){n.forEach((i,s)=>{let{track:c,type:u}=i;this.localTrackMap.set(u,{track:c,id:r[s].id,ssrcs:r[s].localSSRC})})}withdrawLocalTracks(n){n.forEach(r=>{let[i]=r;this.localTrackMap.delete(i)})}bindConnectionEvents(n){n.onConnectionStateChange=async r=>{var i;A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(n.name,".onConnectionStateChange(").concat(r,")")),this.emit(Ke.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(n.isInRestartIce=!1),Oe(i=this._restartStates).call(i,r)&&!n.isInRestartIce&&(r==="disconnected"&&await _r(800),n.iceConnectionState!=="disconnected"&&n.iceConnectionState!=="failed"||this.handleDisconnect(n.direction))},n.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),$e.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:fn.TRACER}).onSuccess(),this.emit(Ke.IceConnectionStateChange,r)},n.onICETransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},n.onDTLSTransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},n.onDTLSTransportError=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},n.onFirstAudioDecoded=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(u=>u._audioSSRC===r);var c;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(c=s.audioTrack)===null||c===void 0||c.emit(wh.FIRST_FRAME_DECODED),$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_AUDIO_DECODE,on.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(c=>c._audioSSRC===r);s&&$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_AUDIO_RECEIVED,on.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(r,i,s)=>{this.reportVideoFirstFrameDecoded(r,i,s)},n.onFirstVideoReceived=r=>{var i;const s=Array.from(oa(i=this.remoteUserMap).call(i)).find(c=>c._videoSSRC===r);s&&$e.firstRemoteFrame(this.store.sessionId,nr.FIRST_VIDEO_RECEIVED,on.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(r,i)=>{const s=r.candidateType==="relay",c=i.candidateType==="relay";i.candidateType!=="unknown"&&s===c||this.emit(Ke.ConnectionTypeChange,s),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(el(i))," -> ").concat(JSON.stringify(el(r)),")"))},n.onSelectedRemoteCandidateChanged=(r,i)=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(el(i))," -> ").concat(JSON.stringify(el(r)),")"))},n.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},n.onLocalCandidate=r=>{this.emit(Ke.LocalCandidate,{candidate:r,direction:n.direction})}}unbindConnectionEvents(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0,n.onLocalCandidate=void 0}async handleDisconnect(n){const r=n===oi.SEND_ONLY?this.sendConnection:this.recvConnection;r&&!r.isInRestartIce&&(r.isInRestartIce=!0,A.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(r.name,"] start use restartICE")),n===oi.SEND_ONLY?this.restartICE(n):Or(this,Ke.RequestP2PRestartICE,{direction:oi.SEND_ONLY}))}filterTobeMutedTracks(n){const r=[];if(this.getAllTracks().indexOf(n)===-1)return r;const i=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof vn&&(i==null?void 0:i.track)instanceof qn)return i.track.isActive||r.push([Ee.LocalAudioTrack,i]),r;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return n===u});if(s&&(r.push(s),s[0]===Ee.LocalVideoTrack)){const c=this.localTrackMap.get(Ee.LocalVideoLowTrack);c&&r.push([Ee.LocalVideoLowTrack,c])}return r}filterTobeUnmutedTracks(n){const r=[],i=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof vn&&(i==null?void 0:i.track)instanceof qn)return i.track.isActive&&r.push([Ee.LocalAudioTrack,i]),r;const s=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return n===u});if(s)if(s[0]===Ee.LocalVideoTrack){r.push(s);const c=this.localTrackMap.get(Ee.LocalVideoLowTrack);c&&r.push([Ee.LocalVideoLowTrack,c])}else r.push(s);return r}createMuteMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}createUnmuteMessage(n){return n.map(r=>{var i;let s,[c,{track:u,ssrcs:h,id:f}]=r;switch(c){case Ee.LocalAudioTrack:s=Dt.Audio;break;case Ee.LocalVideoTrack:s=Oe(i=u._hints).call(i,Yt.SCREEN_TRACK)?Dt.Screen:Dt.High;break;case Ee.LocalVideoLowTrack:s=Dt.Low}return{stream_type:s,ssrcs:h,mid:f}})}filterTobeUnSubscribedTracks(n,r){const i=[],s=this.remoteUserMap.get(n);if(!s)return i;if(r){const c=s.get(r);if(!c)return i;i.push([n,{kind:r,id:c}])}else Array.from(s.entries()).forEach(c=>{let[u,h]=c;i.push([n,{kind:u,id:h}])});return i}createUnsubscribeMessage(n){const r=[];return n.forEach(i=>{let[s,{kind:c,id:u}]=i;switch(c){case Ue.VIDEO:return void(s._videoSSRC&&r.push({stream_type:Ue.VIDEO,ssrcId:s._videoSSRC}));case Ue.AUDIO:return void(s._audioSSRC&&r.push({stream_type:Ue.AUDIO,ssrcId:s._audioSSRC}))}}),r}withdrawRemoteTracks(n){n.forEach(r=>{let[i,{kind:s}]=r;const c=this.remoteUserMap.get(i);c&&(c.delete(s),Array.from(c.entries()).length===0&&this.remoteUserMap.delete(i))})}async updateBitrateLimit(n){const r=this.localTrackMap.get(Ee.LocalVideoTrack),i=this.localTrackMap.get(Ee.LocalVideoLowTrack);r&&(await r.track.setBitrateLimit(n.uplink),await new Ie((s,c)=>{this.handleUpdateVideoEncoder(r.track,s,c,!0)})),i&&n.low_stream_uplink&&(await i.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0}),await new Ie((s,c)=>{this.handleUpdateVideoEncoder(i.track,s,c,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const n=this.sendConnection.peerConnectionState,r=this.recvConnection.peerConnectionState;return n!=="connected"&&r!=="connected"}return!0}async tryToUnmuteAudio(n){for(let r=0;r<n.length;r++)if(n[r]instanceof vn){const i=this.filterTobeUnmutedTracks(n[r]);if(i.length===0)continue;const s=this.createUnmuteMessage(i);return void await Kt(this,Ke.RequestUnmuteLocal,s)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=n=>this.getStats(n),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(n=>{let[,{ssrcs:r}]=n;return!!r}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var r;return!((r=this.recvConnection)===null||r===void 0||!r.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,r)=>this.emit(Ke.RequestUpload,n,r),this.statsUploader.requestUploadStats=n=>this.emit(Ke.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await _r(rO(this.dtlsFailedCount,Gn)),this.emit(Ke.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Ee.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof tn)}throwIfTrackTypeNotMatch(n){if(n.filter(r=>r instanceof tn).length>1)throw new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(r=>r instanceof vn).length>1&&(n.some(r=>r instanceof vn&&r._bypassWebAudio)||!bt().webAudioMediaStreamDest))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of n){if(r instanceof tn&&this.pendingLocalTracks.some(i=>i instanceof tn))throw new de($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof vn&&this.pendingLocalTracks.some(i=>i instanceof vn)&&(!bt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(i=>i instanceof vn&&i._bypassWebAudio)))throw new de($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,r){const i=!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&bt().supportDualStreamEncoding,s=hS(hS({},{width:160,height:120,framerate:15,bitrate:50}),r);let c;c=i?n._mediaStreamTrack.clone():dA(n,s);const u=qt(8,"track-low-"),h=new tn(c,hS(hS({},i&&{scaleResolutionDownBy:KO(s,n)}),{},{frameRate:s.framerate,bitrateMax:s.bitrate,bitrateMin:s.bitrate}),void 0,void 0,u);return h.on(Au.TRANSCEIVER_UPDATED,f=>{n._updateRtpTransceiver(f,bh.LOW_STREAM)}),h._hints.push(Yt.LOW_STREAM),n.addListener(je.NEED_CLOSE,()=>{h.close()}),h}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(n,r,i,s){var c;const u=Array.from(oa(c=this.remoteUserMap).call(c)).find(h=>h._videoSSRC===n);if(u){s||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const h=this.store.keyMetrics,f=h.subscribe.find(m=>m.userId===u.uid&&m.type==="video");$e.firstRemoteVideoDecode(this.store.sessionId,nr.FIRST_VIDEO_DECODE,on.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:r,videoheight:i,subscribeElapse:Mr.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:h.requestAPEnd||0,apStart:h.requestAPStart||0,joinGwEnd:h.joinGatewayEnd||0,joinGwStart:h.joinGatewayStart||0,pcEnd:h.peerConnectionEnd||0,pcStart:h.peerConnectionStart||0,subscriberEnd:(f==null?void 0:f.subscribeEnd)||0,subscriberStart:(f==null?void 0:f.subscribeStart)||0,videoAddNotify:(f==null?void 0:f.streamAdded)||0,state:s?1:0})}}async remoteMediaSsrcChanged(n,r,i){if(!this.recvConnection)return!1;const s=this.remoteUserMap.get(n);if(!s)return!1;const c=s.get(r);if(!c)return!1;const u=await this.recvConnection.getRemoteSSRC(c);return u!==void 0&&u!==i}isPreSubScribe(n){return!1}async publishDataChannel(n){throw new de($.NOT_SUPPORTED)}async unpublishDataChannel(n){throw new de($.NOT_SUPPORTED)}async subscribeDataChannel(n,r){throw new de($.NOT_SUPPORTED)}async unsubscribeDataChannel(n,r){throw new de($.NOT_SUPPORTED)}hasPendingRemoteDataChannel(n,r){throw new de($.NOT_SUPPORTED)}setPendingRemoteDataChannel(n,r){throw new de($.NOT_SUPPORTED)}async preConnect(n){throw new de($.NOT_SUPPORTED)}getEstablishParams(){throw new de($.NOT_SUPPORTED)}async reSubscribe(n){throw new de($.NOT_SUPPORTED)}async updateVideoStreamParameter(n,r){throw new de($.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[r,{track:i}]=n;r===Ee.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,bh.LOW_STREAM):i._updateRtpTransceiver(void 0)})}},Fe(cn.prototype,"p2pConnect",[PW],Object.getOwnPropertyDescriptor(cn.prototype,"p2pConnect"),cn.prototype),Fe(cn.prototype,"unpublish",[xW],Object.getOwnPropertyDescriptor(cn.prototype,"unpublish"),cn.prototype),Fe(cn.prototype,"unpublishLowStream",[DW],Object.getOwnPropertyDescriptor(cn.prototype,"unpublishLowStream"),cn.prototype),Fe(cn.prototype,"subscribe",[LW],Object.getOwnPropertyDescriptor(cn.prototype,"subscribe"),cn.prototype),Fe(cn.prototype,"mockSubscribe",[kW],Object.getOwnPropertyDescriptor(cn.prototype,"mockSubscribe"),cn.prototype),Fe(cn.prototype,"unsubscribe",[MW],Object.getOwnPropertyDescriptor(cn.prototype,"unsubscribe"),cn.prototype),Fe(cn.prototype,"muteRemote",[UW],Object.getOwnPropertyDescriptor(cn.prototype,"muteRemote"),cn.prototype),Fe(cn.prototype,"unmuteRemote",[jW],Object.getOwnPropertyDescriptor(cn.prototype,"unmuteRemote"),cn.prototype),Fe(cn.prototype,"hasRemoteMediaWithLock",[VW],Object.getOwnPropertyDescriptor(cn.prototype,"hasRemoteMediaWithLock"),cn.prototype),Fe(cn.prototype,"disconnectForReconnect",[BW],Object.getOwnPropertyDescriptor(cn.prototype,"disconnectForReconnect"),cn.prototype),Fe(cn.prototype,"remoteMediaSsrcChanged",[FW],Object.getOwnPropertyDescriptor(cn.prototype,"remoteMediaSsrcChanged"),cn.prototype),cn);function $o(n){return function(r,i,s){const c=r[i];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){for(var u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];switch(n){case Go.SEND_ONLY:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(i));try{return await c.apply(this,h)}finally{m()}}case Go.RECEIVE_ONLY:{const m=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await c.apply(this,h)}finally{m()}}default:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(i)),y=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await c.apply(this,h)}finally{m(),y()}}}},s}}class qu extends ln{constructor(r,i){super(),F(this,"signal",void 0),F(this,"token",void 0),F(this,"tokenTimeout",void 0),F(this,"tokenInterval",void 0),F(this,"_sequence",0),F(this,"userMap",new Map),F(this,"encoder",new TextEncoder),this.signal=r,this.token=i;const s=()=>{this.signal.connectionState===Jt.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(s,1e3):this.tokenInterval=window.setTimeout(s,3*Y("P2P_TOKEN_INTERVAL"))};s()}async send(r,i,s,c,u){var h,f,m;if(this.userMap.size===0)return;const y=Array.from(na(h=this.userMap).call(h))[0].token;typeof i!="string"&&(i=JSON.stringify(i)),c=(f=c)!==null&&f!==void 0?f:qt(6,""),u=(m=u)!==null&&m!==void 0?m:this._sequence++;const _={_id:c,_type:r,_seq:u,_message:i,token:"".concat(this.token,"_").concat(y)};Y("SHOW_P2P_LOG")&&A.debug("send message",_,"noNeedResponse : ".concat(s)),this.splitMessage(JSON.stringify(_)).forEach(w=>{this.signal.request(Qe.DATA_STREAM,{payload:Xc(this.encoder.encode(w))})});const S=new Ie((w,O)=>{const W=window.setTimeout(()=>{this.off("res-@".concat(c,"_ack"),k),this.off("res-@".concat(c),H),this.off(Mh.ABORT,j),A.debug("[external-signal] request timeout, type: ".concat(r,", requestId: ").concat(c)),this.userMap.size===0?O(new de($.INVALID_REMOTE_USER)):O(new de($.TIMEOUT))},Y("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),k=()=>{W&&window.clearTimeout(W),this.off(Mh.ABORT,j),s&&w()},j=()=>{W&&window.clearTimeout(W),this.off("res-@".concat(c,"_ack"),k),this.off("res-@".concat(c),H),O(new de($.EXTERNAL_SIGNAL_ABORT,"type: ".concat(r,", requestId: ").concat(c)))};this.once(Mh.ABORT,j),this.once("res-@".concat(c,"_ack"),k);const H=(Q,ie)=>{K=!0,W&&window.clearTimeout(W),this.off("res-@".concat(c,"_ack"),k),this.off(Mh.ABORT,j),Q==="success"?w(ie):O(new de($.P2P_MESSAGE_FAILED,"request ".concat(r," failed, requestId: ").concat(c)))};let K=!1;s||(this.once("res-@".concat(c),H),_r(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{K||A.warning("external_signal request timeout, type: ".concat(r,", requestId: ").concat(c,", ").concat(_))}))});try{return await S}catch(w){if(w.code===$.TIMEOUT)return await this.send(r,i,s,c,u);throw w}}onMessage(r){var i;const{_uid:s}=r;let c,u=this.userMap.get(s);if(u)c=u.splitMessageMap;else{if(this.userMap.size>0||!("_type"in r)||r._type!==On.CHECK)return;const{token:y}=r;c=new Map,u={uid:s,isStart:!0,token:y,splitMessageMap:c,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(s,u),this.signal.emit(ft.ON_USER_ONLINE,{uid:s}),this.handleUserOnline()}if("id"in r&&"total"in r){var h;const{id:y,total:_}=r,S=(h=c.get(y))!==null&&h!==void 0?h:[];if(S.push(r),c.has(y)||c.set(y,S),S.length!==_)return;{const w=om(S).call(S,(O,W)=>O.index-W.index).map(O=>O.payload).join("");c.delete(y),(r=JSON.parse(w))._uid=s}}const{_type:f,token:m}=r;if(Oe(i=[On.ACK,On.CHECK]).call(i,f))return f===On.CHECK&&this.handleCheckToken(u,m),void this.receiveMessage(r);m==="".concat(u.token,"_").concat(this.token)?this.handleReceivedMessage(r):A.debug('Receive unexpected message", '.concat(m,", cur_token: ").concat(u.token,"_").concat(this.token),r)}check(){const r={_id:qt(6,""),token:this.token,_type:On.CHECK};Y("SHOW_P2P_LOG")&&A.debug("send message",r),this.signal.request(Qe.DATA_STREAM,{payload:Xc(this.encoder.encode(JSON.stringify(r)))})}ack(r){const i={_id:r,_type:On.ACK,token:this.token};Y("SHOW_P2P_LOG")&&A.debug("send message",i),this.signal.request(Qe.DATA_STREAM,{payload:Xc(this.encoder.encode(JSON.stringify(i)))})}response(r,i,s){this.send(On.RESPONSE,JSON.stringify({success:!s,message:i}),!0,r)}handleReceivedMessage(r){const i=()=>{this.userMap.forEach(y=>{const{receivedMessagesMap:_,nextExpectedSequenceNumber:S}=y;for(;_.has(S);){const w=_.get(S);_.delete(S),this.receiveMessage(w),y.nextExpectedSequenceNumber++}})};if(!r)return void i();const{_uid:s,_seq:c}=r,u=this.userMap.get(s),{receivedMessagesMap:h,isStart:f,nextExpectedSequenceNumber:m}=u;if(c<m)return this.ack(r._id),void A.debug("[external-signal] receive old message, seq: ".concat(c,", ").concat(r._message));h.set(c,r),f&&c===m&&(this.receiveMessage(r),h.delete(m),u.nextExpectedSequenceNumber++,i())}receiveMessage(r){const{_id:i,_type:s,_message:c,_uid:u}=r;if(Y("SHOW_P2P_LOG")&&A.debug("receive message",r),i){let h;switch(r._type!==On.ACK&&(c&&(h=JSON.parse(c)),this.ack(r._id)),r._type){case On.CANDIDATE:case On.CONTROL:this.signal.emit(s,h,u);break;case On.PUBLISH:case On.UNPUBLISH:case On.RESTART_ICE:case On.CALL:h.uid=u,Or(this.signal,s,h).then(f=>{this.response(r._id,f)}).catch(()=>{this.response(r._id,void 0,!0)});break;case On.ACK:this.getListeners("res-@".concat(i,"_ack")).length>0&&this.emit("res-@".concat(i,"_ack"));break;case On.RESPONSE:{const{success:f,message:m}=h;this.emit("res-@".concat(i),f?"success":"failed",m);break}}}}splitMessage(r){if(r.length<qu.MAX_MESSAGE_SIZE)return[r];const i=[],{remoteToken:s}=JSON.parse(r),c=qt(6,"");let u=0,h=800;const f=Math.ceil(r.length/h);for(;r.length>0;){u++;const m={id:c,index:u,total:f,payload:r.slice(0,h),token:"".concat(this.token,"_").concat(s)};JSON.stringify(m).length>qu.MAX_MESSAGE_SIZE?h-=50:(i.push(m),r=r.slice(h))}return i.map(m=>JSON.stringify(m))}handleCheckToken(r,i){return r.token!==i?(A.debug("token changed, from ".concat(r.token," to ").concat(i)),this.reset(r.uid,i),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{A.debug("token timeout, ".concat(i)),this.reset(r.uid)},Y("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const r=await Or(this.signal,On.CALL,void 0),i=await this.send(On.CALL,r);this.signal.emit(et.P2P_CONNECTION,i,!0)}async reset(r,i){const s=this.userMap.get(r);s&&(this.emit(Mh.ABORT),this.signal.emit(ft.ON_USER_OFFLINE,{uid:s.uid,reason:fpe.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),i||(A.debug("change local token from ".concat(i," to ").concat(i)),this.token=qt(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Mh.ABORT)}}F(qu,"MAX_SIZE",1),F(qu,"MAX_MESSAGE_SIZE",1024);class Gge extends ln{get connectionState(){return this._connectionState}set connectionState(r){r!==this._connectionState&&(this._connectionState=r,r===Jt.CONNECTED?this.emit(et.WS_CONNECTED):r===Jt.RECONNECTING?this.emit(et.WS_RECONNECTING,this._websocketReconnectReason):r===Jt.CLOSED&&this.emit(et.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(r,i){super(),F(this,"_disconnectedReason",void 0),F(this,"_websocketReconnectReason",void 0),F(this,"_connectionState",Jt.CLOSED),F(this,"reconnectToken",void 0),F(this,"p2pToken",void 0),F(this,"websocket",void 0),F(this,"openConnectionTime",void 0),F(this,"clientId",void 0),F(this,"lastMsgTime",Date.now()),F(this,"uploadCache",[]),F(this,"uploadCacheInterval",void 0),F(this,"rttRolling",new EB(5)),F(this,"pingpongTimer",void 0),F(this,"pingpongTimeoutCount",0),F(this,"joinResponse",void 0),F(this,"multiIpOption",void 0),F(this,"initError",void 0),F(this,"spec",void 0),F(this,"store",void 0),F(this,"_external_signal",void 0),F(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(et.ON_BINARY_DATA,s.data);const c=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const u="res-@".concat(c._id);this.emit(u,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){switch(c._type){case ft.ON_DATA_STREAM:return void this.handleDataStream(c._message);case ft.MUTE_AUDIO:case ft.MUTE_VIDEO:case ft.ON_P2P_LOST:case ft.ON_USER_ONLINE:return;case ft.ON_USER_OFFLINE:const{uid:u}=c._message;return A.debug("[".concat(this.clientId,"] user-offline uid: ").concat(u)),void this._external_signal.reset(u)}if(this.emit(c._type,c._message),c._type===ft.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===ft.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(Pt.UID_BANNED);break;case 15:this.close(Pt.IP_BANNED);break;case 16:this.close(Pt.CHANNEL_BANNED)}if(c._type===ft.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case Ye.ERR_LICENSE_MISSING:this.close(Pt.LICENSE_MISSING);break;case Ye.ERR_LICENSE_EXPIRED:this.close(Pt.LICENSE_EXPIRED);break;case Ye.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Pt.LICENSE_MINUTES_EXCEEDED);break;case Ye.ERR_LICENSE_PERIOD_INVALID:this.close(Pt.LICENSE_PERIOD_INVALID);break;case Ye.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Pt.LICENSE_MULTIPLE_SDK_SERVICE);break;case Ye.ERR_LICENSE_ILLEGAL:this.close(Pt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=r.clientId,this.spec=r,this.store=i,this.websocket=new HO("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Jt.CONNECTED&&this.reconnect("retry",Rr.OFFLINE)}),this.p2pToken=qt(6,""),this._external_signal=new qu(this,this.p2pToken)}async request(r,i,s,c){const u=qt(6,""),h={_id:u,_type:r,_message:i},f=this.websocket.connectionID,m=()=>new Ie((W,k)=>{if(this.connectionState===Jt.CONNECTED)return W();const j=()=>{this.off(et.WS_CLOSED,H),W()},H=()=>{this.off(et.WS_CONNECTED,j),k(new de($.WS_ABORT))};this.once(et.WS_CONNECTED,j),this.once(et.WS_CLOSED,H)});if(this.connectionState!==Jt.CONNECTING&&this.connectionState!==Jt.RECONNECTING||r===Qe.JOIN||r===Qe.REJOIN||await m(),this.websocket.sendMessage(h,!0),c)return;const y=new Ie((W,k)=>{let j=!1;const H=(Q,ie)=>{j=!0,W({isSuccess:Q==="success",message:ie||{}}),this.off(et.WS_CLOSED,K),this.off(et.WS_RECONNECTING,K),this.emit(et.REQUEST_SUCCESS,r,i)};this.once("res-@".concat(u),H);const K=()=>{k(new de($.WS_ABORT,"type: ".concat(r))),this.off(et.WS_CLOSED,K),this.off(et.WS_RECONNECTING,K),this.off("res-@".concat(u),H)};this.once(et.WS_CLOSED,K),this.once(et.WS_RECONNECTING,K),_r(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||j||(A.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(r)),this.emit(et.REQUEST_TIMEOUT,r,i))})});let _=null;try{_=await y}catch(W){if(this.connectionState===Jt.CLOSED||r===Qe.LEAVE)throw new de($.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?W.throw():r===Qe.JOIN||r===Qe.REJOIN?null:(await m(),await this.request(r,i))}if(_.isSuccess)return _.message;const S=Number(_.message.error_code||_.message.code),w=Pm(S),O=new de($.UNEXPECTED_RESPONSE,"".concat(w.desc,": ").concat(_.message.error_str),{code:S,data:_.message,desc:w.desc});return w.action==="success"?_.message:(A.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(r,", error_code: ").concat(S,", message: ").concat(w.desc,", action: ").concat(w.action)),S===Ye.ERR_TOO_MANY_BROADCASTERS?((r===Qe.JOIN||r===Qe.REJOIN)&&(this.initError=O,this.close()),O.throw()):w.action==="failed"?O.throw():w.action==="quit"?(this.initError=O,this.close(),O.throw()):(S===Ye.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_.message.option,A.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Rr.MULTI_IP)):this.reconnect(w.action,Rr.SERVER_ERROR),r===Qe.JOIN||r===Qe.REJOIN?null:await this.request(r,i)))}waitMessage(r,i){return new Ie(s=>{const c=u=>{(!i||i(u))&&(this.off(r,c),s(u))};this.on(r,c)})}uploadWRTCStats(r){if(!this.store.sessionId)return void A.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const i={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:r};this.upload(Im.WRTC_STATS,i)}upload(r,i){const s={_type:r,_message:i};try{this.websocket.sendMessage(s)}catch{const u=Y("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Jt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Y("UPLOAD_CACHE_INTERVAL")||2e3))}}send(r,i){const s={_type:r,_message:i};this.websocket.sendMessage(s)}async sendExtensionMessage(r,i,s){return await this._external_signal.send(r,i,s)}init(r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ie((i,s)=>{this.once(et.WS_CONNECTED,()=>i(this.joinResponse)),this.once(et.WS_CLOSED,()=>s(this.initError||new de($.WS_ABORT))),this.connectionState=Jt.CONNECTING,this.websocket.init(r).catch(s)})}close(r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=r||Pt.LEAVE,this.connectionState=Jt.CLOSED,A.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=qt(6,""),this._external_signal.clear(),this._external_signal=new qu(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(et.ABORT_P2P_EXECUTION);const r=await Or(this,et.REQUEST_JOIN_INFO),i=await this.request(Qe.JOIN,r);if(!i)return this.emit(et.REPORT_JOIN_GATEWAY,$.TIMEOUT,this.url||""),!1;this.joinResponse=i,this.emit(et.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Jt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(r,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(r,i)}handleDataStream(r){try{var i;const s=Cu(r.payload),c=new TextDecoder().decode(s),u=JSON.parse(c);"total"in u&&"id"in u||Oe(i=Object.values(On)).call(i,u._type)?(u._uid=r.uid,this._external_signal.onMessage(u)):this.emit(ft.ON_DATA_STREAM,r)}catch{this.emit(ft.ON_DATA_STREAM,r)}}handleNotification(r){A.debug("[".concat(this.clientId,"] receive notification: "),r);const i=Pm(r.code);if(i.action!=="success"){if(i.action!=="failed")return i.action==="quit"?(i.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Pt.UID_BANNED),void this.close()):void this.reconnect(i.action,Rr.SERVER_ERROR);A.error("[".concat(this.clientId,"] ignore error: "),i.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const r=Y("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=r&&(A.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>Y("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Rr.TIMEOUT):this.request(Qe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-i;this.rttRolling.add(s),Y("REPORT_STATS")&&this.send(Qe.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWebsocketEvents(){this.websocket.on(at.RECONNECT_CREATE_CONNECTION,r=>{this.emit(et.WS_RECONNECT_CREATE_CONNECTION,r)}),this.websocket.on(at.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(at.CLOSED,()=>{this.connectionState=Jt.CLOSED}),this.websocket.on(at.FAILED,()=>{this._disconnectedReason=Pt.NETWORK_ERROR,this.connectionState=Jt.CLOSED}),this.websocket.on(at.RECONNECTING,r=>{this._websocketReconnectReason=r,this.joinResponse=void 0,this.connectionState===Jt.CONNECTED?this.connectionState=Jt.RECONNECTING:this.connectionState=Jt.CONNECTING}),this.websocket.on(at.WILL_RECONNECT,(r,i,s)=>{r!=="retry"?(A.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(r)),this.reconnectToken=void 0):A.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),s(r)}),this.websocket.on(at.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(r=>{if(this.emit(et.REPORT_JOIN_GATEWAY,r,this.url||""),r instanceof de&&r.code===$.UNEXPECTED_RESPONSE&&r.data.code===Ye.ERR_NO_AUTHORIZED)return A.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Rr.SERVER_ERROR);A.error("[".concat(this.clientId,"] join gateway request failed"),r.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Rr.SERVER_ERROR):(this.initError=r,this.close())})}),this.websocket.on(at.REQUEST_NEW_URLS,(r,i)=>{Or(this,et.REQUEST_RECOVER,this.multiIpOption).then(r).catch(i)}),this.websocket.on(at.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ft.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const $ge={name:"P2PChannel",create:function(n){let{store:r,statsCollector:i}=n;return new Wge(r,i)},createSubmodule:function(n){let{store:r,spec:i}=n;return new Gge(i,r)}};function GW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function $W(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?GW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):GW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}class Hge{constructor(r){F(this,"sessionDesc",void 0),F(this,"localCapabilities",void 0),F(this,"rtpCapabilities",void 0),F(this,"candidates",void 0),F(this,"_originCandidates",void 0),F(this,"iceParameters",void 0),F(this,"dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname",void 0),r=yn(r);const{iceParameters:i,dtlsParameters:s,candidates:c,rtpCapabilities:u,setup:h,localCapabilities:f,sdkCodec:m,cname:y}=r,_=Ai(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=u,this.candidates=c,this._originCandidates=yn(c),this.iceParameters=i,this.dtlsParameters=s,this.setup=h,this.localCapabilities=f,this.cname=y;for(let S=0;S<_.mediaDescriptions.length;S++){const w=_.mediaDescriptions[S];if(w.attributes.iceUfrag=i.iceUfrag,w.attributes.icePwd=i.icePwd,w.attributes.fingerprints=s.fingerprints,w.attributes.candidates=c,w.attributes.setup=h,w.media.mediaType==="video"){w.media.fmts=u.videoCodecs.map(W=>W.payloadType.toString(10));let O=u.videoCodecs.filter(W=>{var k,j;return(k=W.rtpMap)===null||k===void 0?void 0:Oe(j=k.encodingName.toLowerCase()).call(j,m)});O.length===0&&(O=u.videoCodecs),w.attributes.payloads=O,w.attributes.extmaps=u.videoExtensions}w.media.mediaType==="audio"&&(w.media.fmts=u.audioCodecs.map(O=>O.payloadType.toString(10)),w.attributes.payloads=u.audioCodecs,w.attributes.extmaps=u.audioExtensions),_.mediaDescriptions[S]=this.mungMediaDesc(w)}this.sessionDesc=_,this.currentMidIndex=_.mediaDescriptions.length-1}toString(){return Jc(this.sessionDesc)}send(r,i,s){const{ssrcs:c,ssrcGroups:u}=ku(i,this.cname),h=this.sessionDesc.mediaDescriptions.find(y=>r===Ue.VIDEO?y.media.mediaType==="video":y.media.mediaType==="audio"),f=c[0].attributes.label,m=c[0].attributes.mslabel;return h.attributes.ssrcs=h.attributes.ssrcs.concat(c),h.attributes.ssrcGroups=h.attributes.ssrcGroups.concat(u),{id:f,mslabel:m}}batchSend(r){return r.map(i=>{let{kind:s,ssrcMsg:c}=i;return this.send(s,c,void 0)})}stopSending(r){this.sessionDesc.mediaDescriptions.forEach(i=>{const s=[],c=[],u=[];i.attributes.ssrcs.forEach(h=>{Oe(r).call(r,h.attributes.label||"")?u.push(h):s.push(h)}),i.attributes.ssrcGroups.forEach(h=>{var f;Oe(f=u.map(m=>m.ssrcId)).call(f,h.ssrcIds[0])||c.push(h)}),i.attributes.ssrcs=s,i.attributes.ssrcGroups=c})}mute(r){const i=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===r);if(!i)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.mute."));i.attributes.direction="inactive"}unmute(r){const i=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===r);if(!i)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.unmute."));i.attributes.direction="sendonly"}receive(r,i,s){r.forEach((c,u)=>{const h=c._mediaStreamTrack,f=this.sessionDesc.mediaDescriptions.findIndex(y=>y.attributes.mid===h.kind),m=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[f],c);this.sessionDesc.mediaDescriptions[f]=m})}stopReceiving(r){}updateCandidates(r){const i=this._originCandidates.filter(c=>c.transport==="udp"),s=[];if(i.forEach(c=>{s.push($W($W({},c),{},{foundation:"tcpcandidate",priority:Number(c.priority)-1+"",transport:"tcp",port:Number(c.port)+90+""}))}),i.length!==0){switch(r){case Fr.TCP_RELAY:this.candidates=s;break;case Fr.UDP_TCP_RELAY:case Fr.RELAY:this.candidates=[...i,...s];break;default:this.candidates=i}for(const c of this.sessionDesc.mediaDescriptions)c.attributes.candidates=this.candidates}}restartICE(r){r=yn(r),this.iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=r.iceUfrag,i.attributes.icePwd=r.icePwd})}predictReceivingMids(r){const i=[];for(let s=0;s<r;s++)i.push((this.currentMidIndex+s+1).toString(10));return i}mungRecvMediaDsec(r,i){const s=yn(r);return Bh(s,i),YO(s,i),s}updateRecvMedia(r,i){const s=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===r);if(s!==-1){const c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],i);this.sessionDesc.mediaDescriptions[s]=c}}bumpMid(r){this.currentMidIndex+=r}updateTrackLabel(r,i,s){const c=this.sessionDesc.mediaDescriptions.find(h=>r===Ue.VIDEO?h.attributes.mid==="video":h.attributes.mid==="audio");if(c){const h=c.attributes.ssrcs.find(f=>f.attributes.label===i);var u;h&&(h.attributes.label=s,(u=h.attributes.msid)===null||u===void 0||u.replace(i,s))}}mungMediaDesc(r){const i=yn(r);return qO(i),function(s){const c=s.attributes.extmaps.find(u=>DE(u.extensionName));c&&s.attributes.extmaps.splice(s.attributes.extmaps.indexOf(c),1),s.attributes.payloads.forEach(u=>{const h=u.rtcpFeedbacks.findIndex(f=>f.type==="transport-cc");h!==-1&&u.rtcpFeedbacks.splice(h,1)})}(i),i}getSSRC(r){for(const i of this.sessionDesc.mediaDescriptions)for(const s of i.attributes.ssrcs)if(s.attributes.label===r)return[s]}}var Gt;function HW(n,r){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,s)}return i}function fS(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?HW(Object(i),!0).forEach(function(s){F(n,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):HW(Object(i)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(i,s))})}return n}let zge=(Gt=class Vg extends J3{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var i;return Oe(i=Object.keys(cE)).call(i,r)}))]}constructor(r,i){super(r,i),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"remoteSDP",void 0),F(this,"initialOffer",void 0),F(this,"statsFilter",void 0),F(this,"useRTX",!1),F(this,"localCapabilities",void 0),F(this,"localCandidateCount",0),F(this,"allCandidatesReceived",!1),F(this,"establishPromise",void 0),F(this,"mutex",void 0),this.store=i,this.mutex=new Lr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(Vg.resolvePCConfiguration(r),{optional:[{googDscp:!0}]}),this.statsFilter=lO(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,gn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const r=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const i=tl(r.sdp),s=Lm(r.sdp,{filterRTX:!this.useRTX,filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=s,this.initialOffer=r,fS(fS({},i),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:s},offerSDP:r.sdp})}catch(r){throw new de($.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async updateRemoteConnect(){}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new Hge(fS(fS({},r),{},{rtpCapabilities:r.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const i=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}}async updateRemoteRTPCapabilities(r,i){throw new de($.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(r){}send(r,i){var s=this;return wa(function*(){const c=yield vt(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=r.map(w=>s.peerConnection.addTrack(w._mediaStreamTrack)),h=yield vt(s.peerConnection.createOffer()),f=Ai(h.sdp),m=r.map(w=>{const O=w._mediaStreamTrack,W=f.mediaDescriptions.find(k=>k.attributes.mid===O.kind);if(!W)throw new Error("Cannot extract ssrc from mediaDescription.");return function(k,j,H){const K=k.attributes.ssrcs.filter(ie=>ie.attributes.label===j),Q=k.attributes.ssrcGroups;if(K.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(Q&&K.length>1){const ie=Q.find(re=>re.ssrcIds.indexOf(K[0].ssrcId)!==-1);return ie?[{ssrcId:ie.ssrcIds[0],rtx:H?ie.ssrcIds[1]:void 0}]:[{ssrcId:K[0].ssrcId}]}return[{ssrcId:K[0].ssrcId}]}(W,O.id,s.useRTX)});let y;try{y=yield m}catch(w){throw u.forEach(O=>{Cr()&&O.replaceTrack(null),s.peerConnection.removeTrack(O)}),w}const _=s.mungSendOfferSDP(h.sdp,r);s.remoteSDP.receive(r,i,y);const S=s.remoteSDP.toString();return yield vt(s.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield vt(s.applySendEncodings(u,r)),yield vt(s.peerConnection.setRemoteDescription({type:"answer",sdp:S})),r.map((w,O)=>{const W=w._mediaStreamTrack.id;return{localSSRC:m[O],id:W}})}catch(u){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{c()}})()}async stopSending(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const i=this.peerConnection.getSenders().filter(u=>{var h;return r.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");i.map(u=>{Cr()&&u.replaceTrack(null),this.peerConnection.removeTrack(u)});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.remoteSDP.stopReceiving(r);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(i.toString()))}}async receive(r,i,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{id:u,mslabel:h}=this.remoteSDP.send(r,i,c),f=new Ie((_,S)=>{const w=setTimeout(()=>{S(new Error("Cannot receive track, id: ".concat(u)))},1e4),O=W=>{const k=St();if((k.name==="Safari"&&Number(k.version)===11||ri())&&W.track.id!==u&&W.streams[0].id===h){var j;const H=W.streams[0].getTracks()[0];return(j=this.remoteSDP)===null||j===void 0||j.updateTrackLabel(r,u,W.track.id),this.peerConnection.removeEventListener("track",O),clearTimeout(w),void _(H)}if(W.track.id===u)return this.peerConnection.removeEventListener("track",O),clearTimeout(w),void _(W.track)};this.peerConnection.addEventListener("track",O)}),m=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:m});const y=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(y),{track:await f,id:u}}catch(u){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async muteRemote(r){}async unmuteRemote(r){}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getSenders().filter(s=>{var c;return r.indexOf(((c=s.track)===null||c===void 0?void 0:c.id)||"")!==-1});if(i.length!==r.length)throw new Error("sender' length doesn't match mids' length.");i.map(s=>{if(Cr()&&s.track)s.track.enabled=!1;else{const c=s.getParameters();c.encodings.forEach(u=>u.active=!1),s.setParameters(c)}})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getSenders().filter(u=>{var h;return r.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(i.length!==r.length)throw new Error("Senders' length doesn't match mids' length.");i.map(async u=>{if(Cr()&&u.track)u.track.enabled=!0;else{const h=u.getParameters();h.encodings.forEach(f=>f.active=!0),await u.setParameters(h)}});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}restartICE(r){var i=this;return wa(function*(){const s=yield vt(i.mutex.lock("From P2PConnection.restartICE"));try{if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const c=bt().supportPCSetConfiguration;if(r===Fr.RELAY&&!c)return;if(c){const y=i.peerConnection.getConfiguration(),_=r===Fr.RELAY?"relay":"all";y.iceTransportPolicy!==_&&(A.debug("[".concat(i.store.clientId,"] restartICE change iceTransportPolicy from [").concat(y.iceTransportPolicy,"] to [").concat(_,"]")),y.iceTransportPolicy=_,i.peerConnection.setConfiguration(y))}r!==Fr.RELAY&&i.remoteSDP.updateCandidates(r);const u=yield vt(i.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const h=tl(u.sdp),{remoteIceParameters:f}=yield h.iceParameters;i.remoteSDP.restartICE(f);const m=i.remoteSDP.toString();yield vt(i.peerConnection.setLocalDescription(u)),yield vt(i.peerConnection.setRemoteDescription({type:"answer",sdp:m}))}catch(c){A.warning("[".concat(i.store.clientId,"] restart ICE failed, abort operation"),c)}finally{s()}})()}close(){var r;this.peerConnection.close(),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[i]);this.remoteSDP.updateRecvMedia(i._mediaStreamTrack.kind,i);const u=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new de($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(r,i){const s=this.peerConnection.getSenders().filter(c=>{var u;return((u=c.track)===null||u===void 0?void 0:u.id)===r});s.length===1&&await this.applySendEncodings(s,[i])}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const s=this.peerConnection.getSenders().find(c=>{var u;return((u=c.track)===null||u===void 0?void 0:u.id)===i});s&&await s.replaceTrack(r._mediaStreamTrack)}createDataChannels(r,i){throw new de($.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(r){throw new de($.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r;(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=r=>{r.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Y("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r){const i={iceServers:[],sdpSemantics:"plan-b"};return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Sm(r.turnServer.servers)?i.iceServers=r.turnServer.servers:(i.iceServers&&i.iceServers.push(...Vg.turnServerConfigToIceServers(r.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(...Vg.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(i.iceTransportPolicy="relay")}))),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(s=>{s.security?s.tcpport&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),i}async updateRtpSenderEncodings(r,i){var s;if(i||(i=this.peerConnection.getSenders().find(y=>{var _;return((_=y.track)===null||_===void 0?void 0:_.id)===r._mediaStreamTrack.id})),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(!bt().supportSetRtpSenderParameters)return A.warn("Browser not support set rtp-sender parameters");const c={},u={};if(r instanceof tn)switch(r._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(Y("DSCP_TYPE")&&Js()){var h;const y=Y("DSCP_TYPE");Oe(h=["very-low","low","medium","high"]).call(h,y)&&(u.networkPriority=y)}const f=i.getParameters(),m=(s=f.encodings)===null||s===void 0?void 0:s[0];m&&Object.assign(m,u),Object.assign(f,c),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(f.encodings))),await i.setParameters(f)}async applySendEncodings(r,i){try{if(!bt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let s=0;s<r.length;s++){const c=r[s],u=i[s];c&&u&&await this.updateRtpSenderEncodings(u,c)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i){const s=Ai(r);return i.forEach((c,u)=>{const h=c._mediaStreamTrack,f=s.mediaDescriptions.find(m=>m.attributes.mid===h.kind);f&&Bh(f,c)}),Jc(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,r,i,s)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,r,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const i=this.remoteSDP.batchSend(r).map((u,h)=>{let{id:f,mslabel:m}=u;const{kind:y}=r[h];return new Ie((_,S)=>{const w=setTimeout(()=>{S(new Error("Cannot receive track, id: ".concat(f)))},1e4),O=W=>{const k=St();if(k.name==="Safari"&&Number(k.version)===11&&W.track.id!==f&&W.streams[0].id===m){var j;const H=W.streams[0].getTracks()[0];return(j=this.remoteSDP)===null||j===void 0||j.updateTrackLabel(y,f,W.track.id),this.peerConnection.removeEventListener("track",O),clearTimeout(w),void _({track:H,id:f})}if(W.track.id===f)return this.peerConnection.removeEventListener("track",O),clearTimeout(w),void _({track:W.track,id:f})};this.peerConnection.addEventListener("track",O)})}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const c=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(c),await Ie.all(i)}catch(i){throw new de($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}}async getRemoteSSRC(r){if(!this.remoteSDP)return;const i=this.remoteSDP.getSSRC(r);return i==null?void 0:i[0].ssrcId}setConfiguration(r){if(bt().supportPCSetConfiguration){const i=Vg.resolvePCConfiguration(r);this.peerConnection.setConfiguration(i)}}},Fe(Gt.prototype,"connect",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"connect"),Gt.prototype),Fe(Gt.prototype,"stopSending",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"stopSending"),Gt.prototype),Fe(Gt.prototype,"receive",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"receive"),Gt.prototype),Fe(Gt.prototype,"stopReceiving",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"stopReceiving"),Gt.prototype),Fe(Gt.prototype,"muteRemote",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"muteRemote"),Gt.prototype),Fe(Gt.prototype,"unmuteRemote",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"unmuteRemote"),Gt.prototype),Fe(Gt.prototype,"muteLocal",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"muteLocal"),Gt.prototype),Fe(Gt.prototype,"unmuteLocal",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"unmuteLocal"),Gt.prototype),Fe(Gt.prototype,"close",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"close"),Gt.prototype),Fe(Gt.prototype,"updateEncoderConfig",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"updateEncoderConfig"),Gt.prototype),Fe(Gt.prototype,"updateSendParameters",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"updateSendParameters"),Gt.prototype),Fe(Gt.prototype,"replaceTrack",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"replaceTrack"),Gt.prototype),Fe(Gt.prototype,"getRemoteSSRC",[xa],Object.getOwnPropertyDescriptor(Gt.prototype,"getRemoteSSRC"),Gt.prototype),Gt);function xa(n,r,i){const s=n[r];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const c=this.mutex,u=await c.lock("Locking from P2PConnection.".concat(r));try{for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return await s.apply(this,f)}finally{u()}},i}const Kge={name:"PlanBConnection",create:function(n){let{store:r,spec:i}=n;return new zge(i,r)}};uO(),Ut("PROCESS_ID","process-".concat(qt(8,""),"-").concat(qt(4,""),"-").concat(qt(4,""),"-").concat(qt(4,""),"-").concat(qt(12,""))),function(){let n;try{n=window.localStorage.getItem("websdk_ng_global_parameter")}catch(r){return void A.error("Error loading sdk config",r.message)}if(n)try{const r=JSON.parse(window.atob(n)),i=Date.now();A.debug("Loading global parameters from cache",r),Object.keys(r).forEach(s=>{if(Object.prototype.hasOwnProperty.call(un,s)){const{value:c,expires:u}=r[s];if(u&&u<=i)return;Uo[s]=c,un[s]=c}})}catch(r){A.error("Error loading mutableParamsCache: ".concat(n),r.message)}}(),Array.isArray(Uo.AREAS)&&Uo.AREAS.length>0&&eA(Uo.AREAS,!0);const zW=(n,r,i)=>{A.debug("setParameter key:".concat(n,", value:").concat(JSON.stringify(r))),Ut(n,r,i)};Mu(vge,!1),Mu(Sge,!1),Mu(ime,!1),Mu(xge,!1),Mu(mge,!1),Mu($ge,!1),Mu(Kge,!1);const $n=function(n){const r=new ln,i=n,s={getListeners:r.getListeners.bind(r),on:(c,u)=>(function(h,f){h===_s.SECURITY_POLICY_VIOLATION&&w6(f,!0)}(c,u),r.on.bind(r)(c,u)),addListener:r.addListener.bind(r),once:r.once.bind(r),off:r.off.bind(r),removeAllListeners:r.removeAllListeners.bind(r),emit:r.emit.bind(r),safeEmit:r.safeEmit.bind(r)};return T6(T6({},i),s)}({__TRACK_LIST__:Sh,VERSION:Ca,BUILD:fO,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:zW,getParameter:Y,getSupportedCodec:async function(){let n={audio:[],video:[]};try{let r=new RTCPeerConnection;const i=await async function(s){let c;return bt().supportUnifiedPlan?(s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"}),c=(await s.createOffer()).sdp):c=(await s.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,c}(r);if(!i)return n;r.close(),r=null,n=function(s){const c={video:[],audio:[]};return s.match(/ VP8/i)&&c.video.push("VP8"),s.match(/ VP9/i)&&c.video.push("VP9"),s.match(/ AV1/i)&&c.video.push("AV1"),s.match(/ H264/i)&&c.video.push("H264"),s.match(/ H265/i)&&c.video.push("H265"),s.match(/ opus/i)&&c.audio.push("OPUS"),s.match(/ PCMU/i)&&c.audio.push("PCMU"),s.match(/ PCMA/i)&&c.audio.push("PCMA"),s.match(/ G722/i)&&c.audio.push("G722"),c}(i)}catch(r){throw new se($.CREATE_OFFER_FAILED,r.toString&&r.toString()).print()}return n},checkSystemRequirements:function(){const n=$e.reportApiInvoke(null,{name:Wn.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:fn.TRACER});let r=!1;try{const u=window.RTCPeerConnection,h=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,f=window.WebSocket;r=!!(u&&h&&f),r&&Y0()&&YV(75)&&new u().close()}catch(u){return A.error("check system requirement failed: ",u),!1}let i=!1;const s=St();s.name===Nt.CHROME&&Number(s.version)>=58&&(ko.engine.name!=="WebKit"||function(){const u=St();if(Z_()){if(u.os===tr.MAC_OS)return!0;if(u.os===tr.IOS){const h=ko.os.version&&ko.os.version.split(".");if(h&&Number(h[0])===14&&h[1]&&Number(h[1])>=3||h&&Number(h[0])>14)return!0}}return!1}())&&(i=!0),(s.name===Nt.FIREFOX&&Number(s.version)>=56||s.name===Nt.OPERA&&Number(s.version)>=45||s.name===Nt.SAFARI&&Number(s.version)>=11||s.name==="WebKit"&&(ri()||Za())&&s.osVersion&&Number(s.osVersion.split(".")[0])>=11||tB()||St().name===Nt.QQ)&&(i=!0),A.debug("checkSystemRequirements, api:",r,"browser",i);const c=r&&i;return n.onSuccess(c),c},getDevices:function(n){return da.enumerateDevices(!0,!0,n)},getMicrophones:function(n){return da.getRecordingDevices(n)},getCameras:function(n){return da.getCamerasDevices(n)},getElectronScreenSources:KB,getPlaybackDevices:function(n){return da.getSpeakers(n)},createClient:function(){var n;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const i=qt(5,"client-"),s=$e.reportApiInvoke(null,{id:i,name:Wn.CREATE_CLIENT,options:[r],tag:fn.TRACER});try{(function(c){Jn(c.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Jn(c.mode,"config.mode",["rtc","live","p2p"]),c.audioCodec!==void 0&&Jn(c.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),c.proxyServer!==void 0&&vr(c.proxyServer,"config.proxyServer",1,1e4),c.turnServer!==void 0&&lB(c.turnServer),c.httpRetryConfig!==void 0&&cB(c.httpRetryConfig),c.websocketRetryConfig!==void 0&&cB(c.websocketRetryConfig)})(r)}catch(c){throw s.onError(c),c}return(JV(16,0,!0)||QV(16,0,!0))&&(r.codec==="vp9"&&(r.codec="vp8",A.debug("browser not support vp9, force use vp8")),Ut("UNSUPPORTED_VIDEO_CODEC",["vp9"])),r.audioCodec===void 0&&(r.audioCodec="opus"),s.onSuccess(),new ame(so(so({forceWaitGatewayResponse:!0},r),{},{role:Oe(n=["rtc","p2p"]).call(n,r.mode)?"host":r.role||"audience"}),i)},createCameraVideoTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=Y("CAMERA_CAPTURE_CONFIG"),i=qt(8,"track-cam-"),s=$e.reportApiInvoke(null,{id:i,tag:fn.TRACER,name:Wn.CREATE_CAM_VIDEO_TRACK,options:[sn({},n),r]});r&&(n.encoderConfig=r);const c=pE(n);let u=null;A.info("start create camera video track with config",JSON.stringify(n),"trackId",i);try{u=(await ua({video:c},i)).getVideoTracks()[0]||null}catch(f){throw s.onError(f),f}if(!u){const f=new de($.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(f),f.throw(A)}n.optimizationMode&&NO(i,u,n,gs(n.encoderConfig));const h=new IO(u,n,c,n.scalabiltyMode?uE(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,i);return s.onSuccess(h.getTrackId()),A.info("create camera video success, trackId:",i),h},createCustomVideoTrack:function(n){const r=qt(8,"track-cus-"),i=$e.reportApiInvoke(null,{id:r,tag:fn.TRACER,name:Wn.CREATE_CUSTOM_VIDEO_TRACK,options:[n]}),s=new tn(n.mediaStreamTrack,{width:n.width,height:n.height,frameRate:n.frameRate,bitrateMax:n.bitrateMax,bitrateMin:n.bitrateMin},n.scalabiltyMode?uE(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,r,[Yt.CUSTOM_TRACK]);return i.onSuccess(s.getTrackId()),A.info("create custom video track success with config",n,"trackId",s.getTrackId()),s},createScreenVideoTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const i=typeof r=="object"?function(w){return rF(w)}(r):void 0;i&&(r="auto");const s=qt(8,"track-scr-v-"),c=$e.reportApiInvoke(null,{id:s,tag:fn.TRACER,name:Wn.CREATE_SCREEN_VIDEO_TRACK,options:[sn({},n),r]});n.encoderConfig?typeof n.encoderConfig=="string"||n.encoderConfig.width&&n.encoderConfig.height||(n.encoderConfig.width={max:1920},n.encoderConfig.height={max:1080}):n.encoderConfig="1080p_2";const u=function(w){const O={};w.screenSourceType&&(O.mediaSource=w.screenSourceType),w.extensionId&&Xs()&&(O.extensionId=w.extensionId);const{displaySurface:W,selfBrowserSurface:k,surfaceSwitching:j,systemAudio:H,preferCurrentTab:K}=w;(ph(107)||z0(107)||K0(93))&&(W&&(Jn(W,"displaySurface",["browser","window","monitor"]),O.displaySurface=W),k?(Jn(k,"selfBrowserSurface",["exclude","include"]),O.selfBrowserSurface=k):O.selfBrowserSurface="include",j&&(Jn(j,"surfaceSwitching",["exclude","include"]),O.surfaceSwitching=j)),(ph(105)||z0(105)||K0(91))&&H&&(Jn(H,"systemAudio",["exclude","include"]),O.systemAudio=H),(ph(94)||z0(94)||K0(80))&&K&&(O.preferCurrentTab=!0),w.electronScreenSourceId&&(O.sourceId=w.electronScreenSourceId);const Q=w.encoderConfig?vO(w.encoderConfig):null;return O.mandatory={chromeMediaSource:"desktop",maxWidth:Q?Q.width:void 0,maxHeight:Q?Q.height:void 0},Q&&(Q.frameRate&&(typeof Q.frameRate=="number"?(O.mandatory.maxFrameRate=Q.frameRate,O.mandatory.minFrameRate=Q.frameRate):(O.mandatory.maxFrameRate=Q.frameRate.max||Q.frameRate.ideal||Q.frameRate.exact||void 0,O.mandatory.minFrameRate=Q.frameRate.min||Q.frameRate.ideal||Q.frameRate.exact||void 0),O.frameRate=Q.frameRate),Q.width&&(O.width=Q.width),Q.height&&(O.height=Q.height)),O}(n);let h=null,f=null;const m=bt();if(!m.supportShareAudio&&r==="enable"){const w=new de($.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return c.onError(w),w.throw(A)}A.info("start create screen video track with config",n,"withAudio",r,"trackId",s);const y=m.supportShareAudio&&r!=="disable";try{const w=await ua({screen:u,screenAudio:y?i||!0:void 0},s);h=w.getVideoTracks()[0]||null,f=w.getAudioTracks()[0]||null}catch(w){throw c.onError(w),w}if(!h){const w=new de($.UNEXPECTED_ERROR,"can not find track in media stream");return c.onError(w),w.throw(A)}if(!f&&r==="enable"){h&&h.stop();const w=new de($.SHARE_AUDIO_NOT_ALLOWED);return c.onError(w),w.throw(A)}n.optimizationMode||(n.optimizationMode="detail"),n.optimizationMode&&(NO(s,h,n,n.encoderConfig&&vO(n.encoderConfig)||void 0),n.encoderConfig&&typeof n.encoderConfig!="string"&&(n.encoderConfig.bitrateMin=n.encoderConfig.bitrateMax));const _=new tn(h,n.encoderConfig?vO(n.encoderConfig):{},n.scalabiltyMode?uE(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,s,[Yt.SCREEN_TRACK]);if(!f)return c.onSuccess(_.getTrackId()),A.info("create screen video track success","video:",_.getTrackId()),_;const S=new vn(f,void 0,qt(8,"track-scr-a-"),!1);return c.onSuccess([_.getTrackId(),S.getTrackId()]),A.info("create screen video track success","video:",_.getTrackId(),"audio:",S.getTrackId()),[_,S]},createMicrophoneAndCameraTracks:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=Y("CAMERA_CAPTURE_CONFIG"),s=qt(8,"track-mic-"),c=qt(8,"track-cam-"),u=$e.reportApiInvoke(null,{id:"".concat(s,"-").concat(c),tag:fn.TRACER,name:Wn.CREATE_MIC_AND_CAM_TRACKS,options:[n,r,i]});i&&(r.encoderConfig=i);const h=pE(r),f=iF(n);let m=null,y=null;A.info("start create camera video track(".concat(c,") and microphone audio track(").concat(s,") with config, audio: ").concat(JSON.stringify(n),", video: ").concat(JSON.stringify(r)));try{const w=await ua({audio:f,video:h},"".concat(s,"-").concat(c));m=w.getAudioTracks()[0],y=w.getVideoTracks()[0]}catch(w){throw u.onError(w),w}if(!m||!y){const w=new de($.UNEXPECTED_ERROR,"can not find tracks in media stream");return u.onError(w),w.throw(A)}r.optimizationMode&&NO(c,y,r,gs(r.encoderConfig));const _=new mE(m,n,f,s),S=new IO(y,r,h,r.scalabiltyMode?uE(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,c);return u.onSuccess([_.getTrackId(),S.getTrackId()]),A.info("create camera video track(".concat(c,") and microphone audio track(").concat(s,") success")),[_,S]},createMicrophoneAudioTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=qt(8,"track-mic-"),i=$e.reportApiInvoke(null,{id:r,tag:fn.TRACER,name:Wn.CREATE_MIC_AUDIO_TRACK,options:[n]}),s=iF(n);let c=null;A.info("start create microphone audio track with config",JSON.stringify(n),"trackId",r);try{c=(await ua({audio:s},r)).getAudioTracks()[0]||null}catch(h){throw i.onError(h),h}if(!c){const h=new de($.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(h),h.throw(A)}const u=new mE(c,n,s,r);return i.onSuccess(u.getTrackId()),A.info("create microphone audio track success, trackId:",r),u},createCustomAudioTrack:function(n){const r=qt(8,"track-cus-"),i=$e.reportApiInvoke(null,{id:r,tag:fn.TRACER,name:Wn.CREATE_CUSTOM_AUDIO_TRACK,options:[n]}),s=new vn(n.mediaStreamTrack,n.encoderConfig?dE(n.encoderConfig):{},r,!1);return A.info("create custom audio track success with config",n,"trackId",s.getTrackId()),i.onSuccess(s.getTrackId()),s},createBufferSourceAudioTrack:async function(n){var r;const{cacheOnlineFile:i,encoderConfig:s}=n;let{source:c}=n;const u={source:c instanceof AudioBuffer?"AudioBuffer":c instanceof File?(r=File.name)!==null&&r!==void 0?r:"File":c,cacheOnlineFile:i,encoderConfig:s},h=qt(8,"track-buf-"),f=$e.reportApiInvoke(null,{id:h,tag:fn.TRACER,name:Wn.CREATE_BUFFER_AUDIO_TRACK,options:[u]});if(Y("DISABLE_WEBAUDIO"))throw new de($.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");A.info("start create buffer source audio track with config",JSON.stringify(u),"trackId",h);const m=c;if(!(c instanceof AudioBuffer))try{c=await async function(S,w){let O=null;if(typeof S=="string"){const k=$F.get(S);if(k)return A.debug("use cached audio resource: ",S),k;try{O=(await Mo(()=>mi.get(S,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(j){throw new de($.FETCH_AUDIO_FILE_FAILED,j.toString())}}else O=await new Ie((j,H)=>{const K=new FileReader;K.onload=Q=>{Q.target?j(Q.target.result):H(new de($.READ_LOCAL_AUDIO_FILE_ERROR))},K.onerror=()=>{H(new de($.READ_LOCAL_AUDIO_FILE_ERROR))},K.readAsArrayBuffer(S)});const W=await function(k){const j=Oh();return new Ie((H,K)=>{j.decodeAudioData(k,Q=>{H(Q)},Q=>{K(new de($.DECODE_AUDIO_FILE_FAILED,Q.toString()))})})}(O);return typeof S=="string"&&w&&$F.set(S,W),W}(c,i)}catch(S){return f.onError(S),S.throw(A)}const y=new wfe(c),_=new Tfe(m,y,s?dE(s):{},h);return A.info("create buffer source audio track success, trackId:",h),f.onSuccess(_.getTrackId()),_},setAppType:function(n){if(A.debug("setAppType: ".concat(n)),!(Number.isInteger(n)&&n>=0))throw A.debug("Invalid appType"),new se($.INVALID_PARAMS,"invalid app type",n);Ut("APP_TYPE",Math.floor(n))},setLogLevel:function(n){A.setLogLevel(n)},enableLogUpload:function(){Y("USE_NEW_LOG")?Ut("UPLOAD_LOG",!0):A.enableLogUpload()},disableLogUpload:function(){Y("USE_NEW_LOG")?Ut("UPLOAD_LOG",!1):A.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new F4},checkAudioTrackIsActive:async function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const i=$e.reportApiInvoke(null,{tag:fn.TRACER,name:Wn.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[r]});if(!(n instanceof vn||n instanceof Nh)){const m=new se($.INVALID_TRACK,"the parameter is not a audio track");return i.onError(m),m.throw()}r&&r<1e3&&(r=1e3);const s=n instanceof vn?n.getTrackLabel():"remote_track",c=n.getVolumeLevel();let u=c,h=c;const f=Date.now();return new Ie(m=>{const y=setInterval(()=>{const _=n.getVolumeLevel();u=_>u?_:u,h=_<h?_:h;const S=u-h>1e-4,w=Date.now()-f;if(S||w>r){clearInterval(y);const O=S,W={duration:w,deviceLabel:s,maxVolumeLevel:u,result:O};A.info("[track-".concat(n.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(W))),i.onSuccess(W),m(O)}},200)})},checkVideoTrackIsActive:async function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const i=$e.reportApiInvoke(null,{tag:fn.TRACER,name:Wn.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[r]});if(!(n instanceof tn||n instanceof Ih)){const S=new se($.INVALID_TRACK,"the parameter is not a video track");return i.onError(S),S.throw()}r&&r<1e3&&(r=1e3);const s=n instanceof tn?n.getTrackLabel():"remote_track",c=n.getMediaStreamTrack(!0),u=document.createElement("video");u.style.width="1px",u.style.height="1px",u.setAttribute("muted",""),u.muted=!0,u.setAttribute("playsinline",""),u.controls=!1,(Cr()||Z_())&&(u.style.opacity="0.01",u.style.position="fixed",u.style.left="0",u.style.top="0",document.body.appendChild(u)),u.srcObject=new MediaStream([c]),u.play();const h=document.createElement("canvas");h.width=160,h.height=120;let f=0,m=0;try{const S=Date.now();f=await function(w,O,W,k){let j,H=0,K=null;return new Ie((Q,ie)=>{function re(){H>k&&j&&(j(),Q(H));const te=W.getContext("2d");if(!te){const Ne=new se($.UNEXPECTED_ERROR,"can not get canvas 2d context.");return A.error(Ne.toString()),void ie(Ne)}te.drawImage(w,0,0,160,120);const he=te.getImageData(0,0,W.width,W.height),Se=Math.floor(he.data.length/3);if(K){for(let Ne=0;Ne<Se;Ne+=3)if(he.data[Ne]!==K[Ne])return H+=1,void(K=he.data);K=he.data}else K=he.data}setTimeout(()=>{j&&(j(),Q(H))},O),j=TO(()=>{re()},30)})}(u,r,h,4),m=Date.now()-S}catch(S){throw i.onError(S),S}Hpe===Nt.SAFARI&&(u.pause(),u.remove()),u.srcObject=null;const y=f>4,_={duration:m,changedPicNum:f,deviceLabel:s,result:y};return A.info("[track-".concat(n.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(_))),i.onSuccess(_),y},setArea:eA,audioElementPlayCenter:gi,resumeAudioContext:function(){gi.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(n){sme.processExternalMediaAEC(n)},registerExtensions:function(n){const r=Y("PLUGIN_INFO")||[];n.forEach(i=>{"name"in i&&!Oe(r).call(r,i.name)&&r.push(i.name);const s=i;s.__registered__=!0,s.logger.hookLog=A.extLog,s.reporter.hookApiInvoke=$e.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(c=>{s.parameters[c]=Y(c)})}),zW("PLUGIN_INFO",r)},ChannelMediaRelayError:Lh,ChannelMediaRelayEvent:nc,ChannelMediaRelayState:Ii,RemoteStreamFallbackType:gfe,RemoteStreamType:mfe,ConnectionDisconnectedReason:Pt,AudienceLatencyLevelType:zhe,AREAS:Ot,preload:async function(n,r,i,s){return p5(n,r,i,s)}});return Object.defineProperties($n,{onAudioAutoplayFailed:{get:()=>ha.onAudioAutoplayFailed,set:n=>{ha.onAudioAutoplayFailed=n}},onAutoplayFailed:{get:()=>ha.onAutoplayFailed,set:n=>{ha.onAutoplayFailed=n}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>$n._onSecurityPolicyViolation,set(n){$n._onSecurityPolicyViolation=n,w6(n)}},__CLIENT_LIST__:{get:()=>Y("SHOW_GLOBAL_CLIENT_LIST")?Du:[]}}),da.on(Iu.CAMERA_DEVICE_CHANGED,n=>{A.info("camera device changed",JSON.stringify(n)),$n.onCameraChanged&&$n.onCameraChanged(n),$n.safeEmit(_s.CAMERA_CHANGED,n)}),da.on(Iu.RECORDING_DEVICE_CHANGED,n=>{A.info("microphone device changed",JSON.stringify(n)),$n.onMicrophoneChanged&&$n.onMicrophoneChanged(n),$n.safeEmit(_s.MICROPHONE_CHANGED,n)}),da.on(Iu.PLAYOUT_DEVICE_CHANGED,n=>{A.debug("playout device changed",JSON.stringify(n)),$n.onPlaybackDeviceChanged&&$n.onPlaybackDeviceChanged(n),$n.safeEmit(_s.PLAYBACK_DEVICE_CHANGED,n)}),gi.onAutoplayFailed=()=>{A.info("detect audio element autoplay failed"),ha.onAudioAutoplayFailed&&ha.onAudioAutoplayFailed()},jt.on("autoplay-failed",()=>{A.info("detect webaudio autoplay failed"),ha.onAudioAutoplayFailed&&ha.onAudioAutoplayFailed(),$n.safeEmit(_s.AUTOPLAY_FAILED)}),jt.on(Sr.STATE_CHANGE,(n,r)=>{A.info("audio context state changed: ".concat(r," => ").concat(n)),$n.onAudioContextStateChanged&&$n.onAudioContextStateChanged(n,r),$n.safeEmit(_s.AUDIO_CONTEXT_STATE_CHANGED,n,r)}),xn.on(gh.NETWORK_STATE_CHANGE,(n,r)=>{A.info("[network-indicator] network state changed, ".concat(r," => ").concat(n))}),window&&(window.__ARTC__=$n),$n})})(m9);var oSe=m9.exports;const sP=Kn(oSe),gl=sP.createClient({mode:"rtc",codec:"vp8"}),sSe="d5254e15d07b4169b1d0d2b4bedc07c0",v9=()=>{const[e,t]=x.useState(null),[a,o]=x.useState(null),[l,d]=x.useState(!0),[p,g]=x.useState(!0),[v,E]=x.useState(!1),[T,b]=x.useState([]),[R,N]=x.useState(""),[P,L]=x.useState(!1),[M,D]=x.useState(""),[U,B]=x.useState(!1);x.useEffect(()=>{const le=new URLSearchParams(window.location.search).get("meetingId");if(le)D(le);else{const ee=Math.random().toString(36).substring(2,10);D(ee)}},[]),x.useEffect(()=>(gl.on("user-published",async(Z,le)=>{if(await gl.subscribe(Z,le),le==="video"){const ee=Z.videoTrack;ee&&ee.play(`remote-video-${Z.uid}`)}if(le==="audio"){const ee=Z.audioTrack;ee&&ee.play()}b(ee=>[...ee,Z.uid.toString()])}),gl.on("user-unpublished",Z=>{b(le=>le.filter(ee=>ee!==Z.uid.toString()))}),gl.on("user-left",Z=>{b(le=>le.filter(ee=>ee!==Z.uid.toString()))}),()=>{gl.removeAllListeners(),v&&G()}),[]);const z=async()=>{try{L(!0),N("");const Z=await gl.join(sSe,M,null,null);console.log("Joined with UID:",Z);const[le,ee]=await Promise.all([sP.createMicrophoneAudioTrack(),sP.createCameraVideoTrack()]);await gl.publish([le,ee]),o(le),t(ee),E(!0),ee.play("local-video")}catch(Z){N("Failed to initialize video call. Please check your camera and microphone permissions."),console.error("Error initializing video call:",Z)}finally{L(!1)}},V=async()=>{const Z=`${window.location.origin}${window.location.pathname}?meetingId=${M}`;try{await navigator.clipboard.writeText(Z),B(!0),setTimeout(()=>B(!1),2e3)}catch(le){console.error("Failed to copy meeting link:",le)}},G=async()=>{try{e==null||e.close(),a==null||a.close(),await gl.leave(),E(!1),t(null),o(null),b([])}catch(Z){console.error("Error leaving call:",Z)}},q=async()=>{e&&(await e.setEnabled(!l),d(!l))},ne=async()=>{a&&(await a.setEnabled(!p),g(!p))};return C.jsxs("div",{className:"dashboard-card",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-lg font-semibold",children:"Video Call"}),T.length>0&&C.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[C.jsx(h9,{size:16}),T.length," participant",T.length!==1?"s":""]})]}),C.jsxs("div",{className:"flex gap-2",children:[!v&&C.jsx("button",{className:"btn btn-primary flex items-center gap-2",onClick:z,disabled:P,children:P?"Connecting...":"Start Call"}),C.jsx("button",{className:"btn btn-secondary flex items-center gap-2",onClick:V,children:U?C.jsxs(C.Fragment,{children:[C.jsx(p$,{size:16}),"Copied!"]}):C.jsxs(C.Fragment,{children:[C.jsx(WEe,{size:16}),"Share Link"]})})]})]}),R&&C.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg mb-4",children:R}),C.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("span",{className:"text-sm text-gray-500",children:"Meeting ID: "}),C.jsx("span",{className:"font-mono",children:M})]}),C.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:V,children:U?C.jsx(p$,{size:16}):C.jsx(MEe,{size:16})})]}),C.jsxs("div",{className:"relative",children:[C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C.jsx("div",{id:"local-video",className:"w-full h-[300px] bg-gray-800 rounded-lg overflow-hidden relative",children:!l&&C.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:"Camera Off"})}),T.map(Z=>C.jsx("div",{id:`remote-video-${Z}`,className:"w-full h-[300px] bg-gray-800 rounded-lg overflow-hidden"},Z))]}),v&&C.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4 bg-black/50 p-3 rounded-full",children:[C.jsx("button",{className:`p-3 rounded-full ${l?"bg-gray-700":"bg-red-600"}`,onClick:q,children:l?C.jsx(f9,{className:"w-6 h-6 text-white"}):C.jsx(iSe,{className:"w-6 h-6 text-white"})}),C.jsx("button",{className:`p-3 rounded-full ${p?"bg-gray-700":"bg-red-600"}`,onClick:ne,children:p?C.jsx(KEe,{className:"w-6 h-6 text-white"}):C.jsx(zEe,{className:"w-6 h-6 text-white"})}),C.jsx("button",{className:"p-3 rounded-full bg-red-600",onClick:G,children:C.jsx(YEe,{className:"w-6 h-6 text-white"})})]})]})]})};function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function cSe(e,t){if(by(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(by(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lSe(e){var t=cSe(e,"string");return by(t)=="symbol"?t:t+""}function xe(e,t,a){return(t=lSe(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _9(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var OI,m$;function uSe(){if(m$)return OI;m$=1;var e=function(a,o,l,d,p,g,v,E){if(!a){var T;if(o===void 0)T=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var b=[l,d,p,g,v,E],R=0;T=new Error(o.replace(/%s/g,function(){return b[R++]})),T.name="Invariant Violation"}throw T.framesToPop=1,T}};return OI=e,OI}var dSe=uSe(),ei=_9(dSe),Ht=x.createContext(null);function hSe(){ei(!!x.useContext,"useGoogleMap is React hook and requires React version 16.8+");var e=x.useContext(Ht);return ei(!!e,"useGoogleMap needs a GoogleMap available up in the tree"),e}function fSe(e,t,a){return Object.keys(e).reduce(function(l,d){return t(l,e[d],d)},a)}function pSe(e,t){Object.keys(e).forEach(a=>t(e[a],a))}function mSe(e,t,a,o){var l={},d=(p,g)=>{var v=a[g];v!==t[g]&&(l[g]=v,p(o,v))};return pSe(e,d),l}function gSe(e,t,a){var o=fSe(a,function(d,p,g){return typeof e[g]=="function"&&d.push(google.maps.event.addListener(t,p,e[g])),d},[]);return o}function ySe(e){google.maps.event.removeListener(e)}function nn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.forEach(ySe)}function en(e){var{updaterMap:t,eventMap:a,prevProps:o,nextProps:l,instance:d}=e,p=gSe(l,d,a);return mSe(t,o,l,d),p}var g$={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},y$={extraMapTypes(e,t){t.forEach(function(o,l){e.mapTypes.set(String(l),o)})},center(e,t){e.setCenter(t)},clickableIcons(e,t){e.setClickableIcons(t)},heading(e,t){e.setHeading(t)},mapTypeId(e,t){e.setMapTypeId(t)},options(e,t){e.setOptions(t)},streetView(e,t){e.setStreetView(t)},tilt(e,t){e.setTilt(t)},zoom(e,t){e.setZoom(t)}};function vSe(e){var{children:t,options:a,id:o,mapContainerStyle:l,mapContainerClassName:d,center:p,onClick:g,onDblClick:v,onDrag:E,onDragEnd:T,onDragStart:b,onMouseMove:R,onMouseOut:N,onMouseOver:P,onMouseDown:L,onMouseUp:M,onRightClick:D,onCenterChanged:U,onLoad:B,onUnmount:z}=e,[V,G]=x.useState(null),q=x.useRef(null),[ne,Z]=x.useState(null),[le,ee]=x.useState(null),[ce,be]=x.useState(null),[ae,fe]=x.useState(null),[me,_e]=x.useState(null),[ue,ve]=x.useState(null),[Ce,Ve]=x.useState(null),[Pe,Ge]=x.useState(null),[nt,Re]=x.useState(null),[wt,It]=x.useState(null),[lt,ze]=x.useState(null),[He,tt]=x.useState(null);return x.useEffect(()=>{a&&V!==null&&V.setOptions(a)},[V,a]),x.useEffect(()=>{V!==null&&typeof p<"u"&&V.setCenter(p)},[V,p]),x.useEffect(()=>{V&&v&&(le!==null&&google.maps.event.removeListener(le),ee(google.maps.event.addListener(V,"dblclick",v)))},[v]),x.useEffect(()=>{V&&T&&(ce!==null&&google.maps.event.removeListener(ce),be(google.maps.event.addListener(V,"dragend",T)))},[T]),x.useEffect(()=>{V&&b&&(ae!==null&&google.maps.event.removeListener(ae),fe(google.maps.event.addListener(V,"dragstart",b)))},[b]),x.useEffect(()=>{V&&L&&(me!==null&&google.maps.event.removeListener(me),_e(google.maps.event.addListener(V,"mousedown",L)))},[L]),x.useEffect(()=>{V&&R&&(ue!==null&&google.maps.event.removeListener(ue),ve(google.maps.event.addListener(V,"mousemove",R)))},[R]),x.useEffect(()=>{V&&N&&(Ce!==null&&google.maps.event.removeListener(Ce),Ve(google.maps.event.addListener(V,"mouseout",N)))},[N]),x.useEffect(()=>{V&&P&&(Pe!==null&&google.maps.event.removeListener(Pe),Ge(google.maps.event.addListener(V,"mouseover",P)))},[P]),x.useEffect(()=>{V&&M&&(nt!==null&&google.maps.event.removeListener(nt),Re(google.maps.event.addListener(V,"mouseup",M)))},[M]),x.useEffect(()=>{V&&D&&(wt!==null&&google.maps.event.removeListener(wt),It(google.maps.event.addListener(V,"rightclick",D)))},[D]),x.useEffect(()=>{V&&g&&(lt!==null&&google.maps.event.removeListener(lt),ze(google.maps.event.addListener(V,"click",g)))},[g]),x.useEffect(()=>{V&&E&&(He!==null&&google.maps.event.removeListener(He),tt(google.maps.event.addListener(V,"drag",E)))},[E]),x.useEffect(()=>{V&&U&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(V,"center_changed",U)))},[g]),x.useEffect(()=>{var Be=q.current===null?null:new google.maps.Map(q.current,a);return G(Be),Be!==null&&B&&B(Be),()=>{Be!==null&&z&&z(Be)}},[]),C.jsx("div",{id:o,ref:q,style:l,className:d,children:C.jsx(Ht.Provider,{value:V,children:V!==null?t:null})})}x.memo(vSe);class E9 extends x.PureComponent{constructor(){super(...arguments),xe(this,"state",{map:null}),xe(this,"registeredEvents",[]),xe(this,"mapRef",null),xe(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),xe(this,"panTo",t=>{var a=this.getInstance();a&&a.panTo(t)}),xe(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),xe(this,"getRef",t=>{this.mapRef=t})}componentDidMount(){var t=this.getInstance();this.registeredEvents=en({updaterMap:y$,eventMap:g$,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{map:t}},this.setMapCallback)}componentDidUpdate(t){this.state.map!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:y$,eventMap:g$,prevProps:t,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),nn(this.registeredEvents))}render(){return C.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:C.jsx(Ht.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function v$(e,t,a,o,l,d,p){try{var g=e[d](p),v=g.value}catch(E){return void a(E)}g.done?t(v):Promise.resolve(v).then(o,l)}function S9(e){return function(){var t=this,a=arguments;return new Promise(function(o,l){var d=e.apply(t,a);function p(v){v$(d,o,l,p,g,"next",v)}function g(v){v$(d,o,l,p,g,"throw",v)}p(void 0)})}}function b9(e){var{googleMapsApiKey:t,googleMapsClientId:a,version:o="weekly",language:l,region:d,libraries:p,channel:g,mapIds:v,authReferrerPolicy:E}=e,T=[];return ei(t&&a||!(t&&a),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),t?T.push("key=".concat(t)):a&&T.push("client=".concat(a)),o&&T.push("v=".concat(o)),l&&T.push("language=".concat(l)),d&&T.push("region=".concat(d)),p&&p.length&&T.push("libraries=".concat(p.sort().join(","))),g&&T.push("channel=".concat(g)),v&&v.length&&T.push("map_ids=".concat(v.join(","))),E&&T.push("auth_referrer_policy=".concat(E)),T.push("loading=async"),T.push("callback=initMap"),"https://maps.googleapis.com/maps/api/js?".concat(T.join("&"))}var cd=typeof document<"u";function T9(e){var{url:t,id:a,nonce:o}=e;return cd?new Promise(function(d,p){var g=document.getElementById(a),v=window;if(g){var E=g.getAttribute("data-state");if(g.src===t&&E!=="error"){if(E==="ready")return d(a);var T=v.initMap,b=g.onerror;v.initMap=function(){T&&T(),d(a)},g.onerror=function(N){b&&b(N),p(N)};return}else g.remove()}var R=document.createElement("script");R.type="text/javascript",R.src=t,R.id=a,R.async=!0,R.nonce=o||"",R.onerror=function(P){R.setAttribute("data-state","error"),p(P)},v.initMap=function(){R.setAttribute("data-state","ready"),d(a)},document.head.appendChild(R)}).catch(l=>{throw console.error("injectScript error: ",l),l}):Promise.reject(new Error("document is undefined"))}function _$(e){var t=e.href;return t&&(t.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||t.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:e.tagName.toLowerCase()==="style"&&e.styleSheet&&e.styleSheet.cssText&&e.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(e.styleSheet.cssText="",!0):e.tagName.toLowerCase()==="style"&&e.innerHTML&&e.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(e.innerHTML="",!0):e.tagName.toLowerCase()==="style"&&!e.styleSheet&&!e.innerHTML}function w9(){var e=document.getElementsByTagName("head")[0];if(e){var t=e.insertBefore.bind(e);e.insertBefore=function(l,d){return _$(l)||Reflect.apply(t,e,[l,d]),l};var a=e.appendChild.bind(e);e.appendChild=function(l){return _$(l)||Reflect.apply(a,e,[l]),l}}}var yg=!1;function C9(){return C.jsx("div",{children:"Loading..."})}var cP={id:"script-loader",version:"weekly"};class L1 extends x.PureComponent{constructor(){super(...arguments),xe(this,"check",x.createRef()),xe(this,"state",{loaded:!1}),xe(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),xe(this,"isCleaningUp",S9(function*(){function t(a){if(!yg)a();else if(cd)var o=window.setInterval(function(){yg||(window.clearInterval(o),a())},1)}return new Promise(t)})),xe(this,"cleanup",()=>{yg=!0;var t=document.getElementById(this.props.id);t&&t.parentNode&&t.parentNode.removeChild(t),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(o){return typeof o.src=="string"&&o.src.includes("maps.googleapis")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(o){return o.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(o){return o.innerText!==void 0&&o.innerText.length>0&&o.innerText.includes(".gm-")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)})}),xe(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&w9(),ei(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var t={id:this.props.id,nonce:this.props.nonce,url:b9(this.props)};T9(t).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(a=>{this.props.onError&&this.props.onError(a),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})})}componentDidMount(){if(cd){if(window.google&&window.google.maps&&!yg){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(a){console.error("Error at injecting script after cleaning up: ",a)})}}componentDidUpdate(t){this.props.libraries!==t.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),cd&&t.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(cd){this.cleanup();var t=()=>{this.check.current||(delete window.google,yg=!1)};window.setTimeout(t,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return C.jsxs(C.Fragment,{children:[C.jsx("div",{ref:this.check}),this.state.loaded?this.props.children:this.props.loadingElement||C.jsx(C9,{})]})}}xe(L1,"defaultProps",cP);function _Se(e,t){if(e==null)return{};var a={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;a[o]=e[o]}return a}function k1(e,t){if(e==null)return{};var a,o,l=_Se(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(o=0;o<d.length;o++)a=d[o],t.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var E$;function ESe(e){var{id:t=cP.id,version:a=cP.version,nonce:o,googleMapsApiKey:l,googleMapsClientId:d,language:p,region:g,libraries:v,preventGoogleFontsLoading:E,channel:T,mapIds:b,authReferrerPolicy:R}=e,N=x.useRef(!1),[P,L]=x.useState(!1),[M,D]=x.useState(void 0);x.useEffect(function(){return N.current=!0,()=>{N.current=!1}},[]),x.useEffect(function(){cd&&E&&w9()},[E]),x.useEffect(function(){P&&ei(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[P]);var U=b9({version:a,googleMapsApiKey:l,googleMapsClientId:d,language:p,region:g,libraries:v,channel:T,mapIds:b,authReferrerPolicy:R});x.useEffect(function(){if(!cd)return;function V(){N.current&&(L(!0),E$=U)}if(window.google&&window.google.maps&&E$===U){V();return}T9({id:t,url:U,nonce:o}).then(V).catch(function(q){N.current&&D(q),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(l||"-",") or Client ID (").concat(d||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(q)})},[t,U,o]);var B=x.useRef();return x.useEffect(function(){B.current&&v!==B.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),B.current=v},[v]),{isLoaded:P,loadError:M,url:U}}var SSe=["loadingElement","onLoad","onError","onUnmount","children"],bSe=C.jsx(C9,{});function TSe(e){var{loadingElement:t,onLoad:a,onError:o,onUnmount:l,children:d}=e,p=k1(e,SSe),{isLoaded:g,loadError:v}=ESe(p);return x.useEffect(function(){g&&typeof a=="function"&&a()},[g,a]),x.useEffect(function(){v&&typeof o=="function"&&o(v)},[v,o]),x.useEffect(function(){return()=>{l&&l()}},[l]),g?d:t||bSe}x.memo(TSe);var S$;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(S$||(S$={}));function b$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Mb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?b$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var T$={},w$={options(e,t){e.setOptions(t)}};function wSe(e){var{options:t,onLoad:a,onUnmount:o}=e,l=x.useContext(Ht),[d,p]=x.useState(null);return x.useEffect(()=>{d!==null&&d.setMap(l)},[l]),x.useEffect(()=>{t&&d!==null&&d.setOptions(t)},[d,t]),x.useEffect(()=>{var g=new google.maps.TrafficLayer(Mb(Mb({},t),{},{map:l}));return p(g),a&&a(g),()=>{d!==null&&(o&&o(d),d.setMap(null))}},[]),null}x.memo(wSe);class CSe extends x.PureComponent{constructor(){super(...arguments),xe(this,"state",{trafficLayer:null}),xe(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),xe(this,"registeredEvents",[])}componentDidMount(){var t=new google.maps.TrafficLayer(Mb(Mb({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:w$,eventMap:T$,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{trafficLayer:t}},this.setTrafficLayerCallback)}componentDidUpdate(t){this.state.trafficLayer!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:w$,eventMap:T$,prevProps:t,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),nn(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}xe(CSe,"contextType",Ht);function RSe(e){var{onLoad:t,onUnmount:a}=e,o=x.useContext(Ht),[l,d]=x.useState(null);return x.useEffect(()=>{l!==null&&l.setMap(o)},[o]),x.useEffect(()=>{var p=new google.maps.BicyclingLayer;return d(p),p.setMap(o),t&&t(p),()=>{p!==null&&(a&&a(p),p.setMap(null))}},[]),null}x.memo(RSe);class OSe extends x.PureComponent{constructor(){super(...arguments),xe(this,"state",{bicyclingLayer:null}),xe(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var t=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:t}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}xe(OSe,"contextType",Ht);function ASe(e){var{onLoad:t,onUnmount:a}=e,o=x.useContext(Ht),[l,d]=x.useState(null);return x.useEffect(()=>{l!==null&&l.setMap(o)},[o]),x.useEffect(()=>{var p=new google.maps.TransitLayer;return d(p),p.setMap(o),t&&t(p),()=>{l!==null&&(a&&a(l),l.setMap(null))}},[]),null}x.memo(ASe);class ISe extends x.PureComponent{constructor(){super(...arguments),xe(this,"state",{transitLayer:null}),xe(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var t=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:t}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}xe(ISe,"contextType",Ht);function C$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Ub(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?C$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var R$={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},O$={drawingMode(e,t){e.setDrawingMode(t)},options(e,t){e.setOptions(t)}};function NSe(e){var{options:t,drawingMode:a,onCircleComplete:o,onMarkerComplete:l,onOverlayComplete:d,onPolygonComplete:p,onPolylineComplete:g,onRectangleComplete:v,onLoad:E,onUnmount:T}=e,b=x.useContext(Ht),[R,N]=x.useState(null),[P,L]=x.useState(null),[M,D]=x.useState(null),[U,B]=x.useState(null),[z,V]=x.useState(null),[G,q]=x.useState(null),[ne,Z]=x.useState(null);return x.useEffect(()=>{R!==null&&R.setMap(b)},[b]),x.useEffect(()=>{t&&R!==null&&R.setOptions(t)},[R,t]),x.useEffect(()=>{R!==null&&R.setDrawingMode(a??null)},[R,a]),x.useEffect(()=>{R&&o&&(P!==null&&google.maps.event.removeListener(P),L(google.maps.event.addListener(R,"circlecomplete",o)))},[R,o]),x.useEffect(()=>{R&&l&&(M!==null&&google.maps.event.removeListener(M),D(google.maps.event.addListener(R,"markercomplete",l)))},[R,l]),x.useEffect(()=>{R&&d&&(U!==null&&google.maps.event.removeListener(U),B(google.maps.event.addListener(R,"overlaycomplete",d)))},[R,d]),x.useEffect(()=>{R&&p&&(z!==null&&google.maps.event.removeListener(z),V(google.maps.event.addListener(R,"polygoncomplete",p)))},[R,p]),x.useEffect(()=>{R&&g&&(G!==null&&google.maps.event.removeListener(G),q(google.maps.event.addListener(R,"polylinecomplete",g)))},[R,g]),x.useEffect(()=>{R&&v&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(R,"rectanglecomplete",v)))},[R,v]),x.useEffect(()=>{ei(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var le=new google.maps.drawing.DrawingManager(Ub(Ub({},t),{},{map:b}));return a&&le.setDrawingMode(a),o&&L(google.maps.event.addListener(le,"circlecomplete",o)),l&&D(google.maps.event.addListener(le,"markercomplete",l)),d&&B(google.maps.event.addListener(le,"overlaycomplete",d)),p&&V(google.maps.event.addListener(le,"polygoncomplete",p)),g&&q(google.maps.event.addListener(le,"polylinecomplete",g)),v&&Z(google.maps.event.addListener(le,"rectanglecomplete",v)),N(le),E&&E(le),()=>{R!==null&&(P&&google.maps.event.removeListener(P),M&&google.maps.event.removeListener(M),U&&google.maps.event.removeListener(U),z&&google.maps.event.removeListener(z),G&&google.maps.event.removeListener(G),ne&&google.maps.event.removeListener(ne),T&&T(R),R.setMap(null))}},[]),null}x.memo(NSe);class PSe extends x.PureComponent{constructor(t){super(t),xe(this,"registeredEvents",[]),xe(this,"state",{drawingManager:null}),xe(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),ei(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var t=new google.maps.drawing.DrawingManager(Ub(Ub({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:O$,eventMap:R$,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{drawingManager:t}},this.setDrawingManagerCallback)}componentDidUpdate(t){this.state.drawingManager!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:O$,eventMap:R$,prevProps:t,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),nn(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}xe(PSe,"contextType",Ht);function A$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Pf(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?A$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var I$={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},N$={animation(e,t){e.setAnimation(t)},clickable(e,t){e.setClickable(t)},cursor(e,t){e.setCursor(t)},draggable(e,t){e.setDraggable(t)},icon(e,t){e.setIcon(t)},label(e,t){e.setLabel(t)},map(e,t){e.setMap(t)},opacity(e,t){e.setOpacity(t)},options(e,t){e.setOptions(t)},position(e,t){e.setPosition(t)},shape(e,t){e.setShape(t)},title(e,t){e.setTitle(t)},visible(e,t){e.setVisible(t)},zIndex(e,t){e.setZIndex(t)}},jb={};function xSe(e){var{position:t,options:a,clusterer:o,noClustererRedraw:l,children:d,draggable:p,visible:g,animation:v,clickable:E,cursor:T,icon:b,label:R,opacity:N,shape:P,title:L,zIndex:M,onClick:D,onDblClick:U,onDrag:B,onDragEnd:z,onDragStart:V,onMouseOut:G,onMouseOver:q,onMouseUp:ne,onMouseDown:Z,onRightClick:le,onClickableChanged:ee,onCursorChanged:ce,onAnimationChanged:be,onDraggableChanged:ae,onFlatChanged:fe,onIconChanged:me,onPositionChanged:_e,onShapeChanged:ue,onTitleChanged:ve,onVisibleChanged:Ce,onZindexChanged:Ve,onLoad:Pe,onUnmount:Ge}=e,nt=x.useContext(Ht),[Re,wt]=x.useState(null),[It,lt]=x.useState(null),[ze,He]=x.useState(null),[tt,Be]=x.useState(null),[zt,Wt]=x.useState(null),[Ct,Tn]=x.useState(null),[xr,Bn]=x.useState(null),[er,Ro]=x.useState(null),[Ri,$a]=x.useState(null),[Oo,gr]=x.useState(null),[kc,Lp]=x.useState(null),[ea,kp]=x.useState(null),[Mc,Mp]=x.useState(null),[ou,Up]=x.useState(null),[su,ss]=x.useState(null),[cu,Ev]=x.useState(null),[kd,Gs]=x.useState(null),[lu,Sv]=x.useState(null),[bv,Tv]=x.useState(null),[Md,Uc]=x.useState(null),[Ud,$s]=x.useState(null),[jd,wv]=x.useState(null);x.useEffect(()=>{Re!==null&&Re.setMap(nt)},[nt]),x.useEffect(()=>{typeof a<"u"&&Re!==null&&Re.setOptions(a)},[Re,a]),x.useEffect(()=>{typeof p<"u"&&Re!==null&&Re.setDraggable(p)},[Re,p]),x.useEffect(()=>{t&&Re!==null&&Re.setPosition(t)},[Re,t]),x.useEffect(()=>{typeof g<"u"&&Re!==null&&Re.setVisible(g)},[Re,g]),x.useEffect(()=>{Re==null||Re.setAnimation(v)},[Re,v]),x.useEffect(()=>{Re&&E!==void 0&&Re.setClickable(E)},[Re,E]),x.useEffect(()=>{Re&&T!==void 0&&Re.setCursor(T)},[Re,T]),x.useEffect(()=>{Re&&b!==void 0&&Re.setIcon(b)},[Re,b]),x.useEffect(()=>{Re&&R!==void 0&&Re.setLabel(R)},[Re,R]),x.useEffect(()=>{Re&&N!==void 0&&Re.setOpacity(N)},[Re,N]),x.useEffect(()=>{Re&&P!==void 0&&Re.setShape(P)},[Re,P]),x.useEffect(()=>{Re&&L!==void 0&&Re.setTitle(L)},[Re,L]),x.useEffect(()=>{Re&&M!==void 0&&Re.setZIndex(M)},[Re,M]),x.useEffect(()=>{Re&&U&&(It!==null&&google.maps.event.removeListener(It),lt(google.maps.event.addListener(Re,"dblclick",U)))},[U]),x.useEffect(()=>{Re&&z&&(ze!==null&&google.maps.event.removeListener(ze),He(google.maps.event.addListener(Re,"dragend",z)))},[z]),x.useEffect(()=>{Re&&V&&(tt!==null&&google.maps.event.removeListener(tt),Be(google.maps.event.addListener(Re,"dragstart",V)))},[V]),x.useEffect(()=>{Re&&Z&&(zt!==null&&google.maps.event.removeListener(zt),Wt(google.maps.event.addListener(Re,"mousedown",Z)))},[Z]),x.useEffect(()=>{Re&&G&&(Ct!==null&&google.maps.event.removeListener(Ct),Tn(google.maps.event.addListener(Re,"mouseout",G)))},[G]),x.useEffect(()=>{Re&&q&&(xr!==null&&google.maps.event.removeListener(xr),Bn(google.maps.event.addListener(Re,"mouseover",q)))},[q]),x.useEffect(()=>{Re&&ne&&(er!==null&&google.maps.event.removeListener(er),Ro(google.maps.event.addListener(Re,"mouseup",ne)))},[ne]),x.useEffect(()=>{Re&&le&&(Ri!==null&&google.maps.event.removeListener(Ri),$a(google.maps.event.addListener(Re,"rightclick",le)))},[le]),x.useEffect(()=>{Re&&D&&(Oo!==null&&google.maps.event.removeListener(Oo),gr(google.maps.event.addListener(Re,"click",D)))},[D]),x.useEffect(()=>{Re&&B&&(kc!==null&&google.maps.event.removeListener(kc),Lp(google.maps.event.addListener(Re,"drag",B)))},[B]),x.useEffect(()=>{Re&&ee&&(ea!==null&&google.maps.event.removeListener(ea),kp(google.maps.event.addListener(Re,"clickable_changed",ee)))},[ee]),x.useEffect(()=>{Re&&ce&&(Mc!==null&&google.maps.event.removeListener(Mc),Mp(google.maps.event.addListener(Re,"cursor_changed",ce)))},[ce]),x.useEffect(()=>{Re&&be&&(ou!==null&&google.maps.event.removeListener(ou),Up(google.maps.event.addListener(Re,"animation_changed",be)))},[be]),x.useEffect(()=>{Re&&ae&&(su!==null&&google.maps.event.removeListener(su),ss(google.maps.event.addListener(Re,"draggable_changed",ae)))},[ae]),x.useEffect(()=>{Re&&fe&&(cu!==null&&google.maps.event.removeListener(cu),Ev(google.maps.event.addListener(Re,"flat_changed",fe)))},[fe]),x.useEffect(()=>{Re&&me&&(kd!==null&&google.maps.event.removeListener(kd),Gs(google.maps.event.addListener(Re,"icon_changed",me)))},[me]),x.useEffect(()=>{Re&&_e&&(lu!==null&&google.maps.event.removeListener(lu),Sv(google.maps.event.addListener(Re,"position_changed",_e)))},[_e]),x.useEffect(()=>{Re&&ue&&(bv!==null&&google.maps.event.removeListener(bv),Tv(google.maps.event.addListener(Re,"shape_changed",ue)))},[ue]),x.useEffect(()=>{Re&&ve&&(Md!==null&&google.maps.event.removeListener(Md),Uc(google.maps.event.addListener(Re,"title_changed",ve)))},[ve]),x.useEffect(()=>{Re&&Ce&&(Ud!==null&&google.maps.event.removeListener(Ud),$s(google.maps.event.addListener(Re,"visible_changed",Ce)))},[Ce]),x.useEffect(()=>{Re&&Ve&&(jd!==null&&google.maps.event.removeListener(jd),wv(google.maps.event.addListener(Re,"zindex_changed",Ve)))},[Ve]),x.useEffect(()=>{var Vr=Pf(Pf(Pf({},a||jb),o?jb:{map:nt}),{},{position:t}),Lt=new google.maps.Marker(Vr);return o?o.addMarker(Lt,!!l):Lt.setMap(nt),t&&Lt.setPosition(t),typeof g<"u"&&Lt.setVisible(g),typeof p<"u"&&Lt.setDraggable(p),typeof E<"u"&&Lt.setClickable(E),typeof T=="string"&&Lt.setCursor(T),b&&Lt.setIcon(b),typeof R<"u"&&Lt.setLabel(R),typeof N<"u"&&Lt.setOpacity(N),P&&Lt.setShape(P),typeof L=="string"&&Lt.setTitle(L),typeof M=="number"&&Lt.setZIndex(M),U&&lt(google.maps.event.addListener(Lt,"dblclick",U)),z&&He(google.maps.event.addListener(Lt,"dragend",z)),V&&Be(google.maps.event.addListener(Lt,"dragstart",V)),Z&&Wt(google.maps.event.addListener(Lt,"mousedown",Z)),G&&Tn(google.maps.event.addListener(Lt,"mouseout",G)),q&&Bn(google.maps.event.addListener(Lt,"mouseover",q)),ne&&Ro(google.maps.event.addListener(Lt,"mouseup",ne)),le&&$a(google.maps.event.addListener(Lt,"rightclick",le)),D&&gr(google.maps.event.addListener(Lt,"click",D)),B&&Lp(google.maps.event.addListener(Lt,"drag",B)),ee&&kp(google.maps.event.addListener(Lt,"clickable_changed",ee)),ce&&Mp(google.maps.event.addListener(Lt,"cursor_changed",ce)),be&&Up(google.maps.event.addListener(Lt,"animation_changed",be)),ae&&ss(google.maps.event.addListener(Lt,"draggable_changed",ae)),fe&&Ev(google.maps.event.addListener(Lt,"flat_changed",fe)),me&&Gs(google.maps.event.addListener(Lt,"icon_changed",me)),_e&&Sv(google.maps.event.addListener(Lt,"position_changed",_e)),ue&&Tv(google.maps.event.addListener(Lt,"shape_changed",ue)),ve&&Uc(google.maps.event.addListener(Lt,"title_changed",ve)),Ce&&$s(google.maps.event.addListener(Lt,"visible_changed",Ce)),Ve&&wv(google.maps.event.addListener(Lt,"zindex_changed",Ve)),wt(Lt),Pe&&Pe(Lt),()=>{It!==null&&google.maps.event.removeListener(It),ze!==null&&google.maps.event.removeListener(ze),tt!==null&&google.maps.event.removeListener(tt),zt!==null&&google.maps.event.removeListener(zt),Ct!==null&&google.maps.event.removeListener(Ct),xr!==null&&google.maps.event.removeListener(xr),er!==null&&google.maps.event.removeListener(er),Ri!==null&&google.maps.event.removeListener(Ri),Oo!==null&&google.maps.event.removeListener(Oo),ea!==null&&google.maps.event.removeListener(ea),Mc!==null&&google.maps.event.removeListener(Mc),ou!==null&&google.maps.event.removeListener(ou),su!==null&&google.maps.event.removeListener(su),cu!==null&&google.maps.event.removeListener(cu),kd!==null&&google.maps.event.removeListener(kd),lu!==null&&google.maps.event.removeListener(lu),Md!==null&&google.maps.event.removeListener(Md),Ud!==null&&google.maps.event.removeListener(Ud),jd!==null&&google.maps.event.removeListener(jd),Ge&&Ge(Lt),o?o.removeMarker(Lt,!!l):Lt&&Lt.setMap(null)}},[]);var Xw=x.useMemo(()=>d?x.Children.map(d,Vr=>{if(!x.isValidElement(Vr))return Vr;var Lt=Vr;return x.cloneElement(Lt,{anchor:Re})}):null,[d,Re]);return C.jsx(C.Fragment,{children:Xw})||null}x.memo(xSe);class lP extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[])}componentDidMount(){var t=this;return S9(function*(){var a=Pf(Pf(Pf({},t.props.options||jb),t.props.clusterer?jb:{map:t.context}),{},{position:t.props.position});t.marker=new google.maps.Marker(a),t.props.clusterer?t.props.clusterer.addMarker(t.marker,!!t.props.noClustererRedraw):t.marker.setMap(t.context),t.registeredEvents=en({updaterMap:N$,eventMap:I$,prevProps:{},nextProps:t.props,instance:t.marker}),t.props.onLoad&&t.props.onLoad(t.marker)})()}componentDidUpdate(t){this.marker&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:N$,eventMap:I$,prevProps:t,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),nn(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var t=this.props.children?x.Children.map(this.props.children,a=>{if(!x.isValidElement(a))return a;var o=a;return x.cloneElement(o,{anchor:this.marker})}):null;return t||null}}xe(lP,"contextType",Ht);var DSe=function(){function e(t,a){t.getClusterer().extend(e,google.maps.OverlayView),this.cluster=t,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=a,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(t.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return e.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},e.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},e.prototype.onClick=function(t){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var a=this.cluster.getClusterer();if(google.maps.event.trigger(a,"click",this.cluster),google.maps.event.trigger(a,"clusterclick",this.cluster),a.getZoomOnClick()){var o=a.getMaxZoom(),l=this.cluster.getBounds(),d=a.getMap();d!==null&&"fitBounds"in d&&d.fitBounds(l),this.timeOut=window.setTimeout(function(){var p=a.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(l);var g=p.getZoom()||0;o!==null&&g>o&&p.setZoom(o+1)}},100)}t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}},e.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},e.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},e.prototype.onAdd=function(){var t;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(t=this.getPanes())===null||t===void 0||t.overlayMouseTarget.appendChild(this.div);var a=this.getMap();a!==null&&(this.boundsChangedListener=google.maps.event.addListener(a,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},e.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},e.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var t=this.getPosFromLatLng(this.center);this.div.style.top=t!==null?"".concat(t.y,"px"):"0",this.div.style.left=t!==null?"".concat(t.x,"px"):"0"}},e.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},e.prototype.show=function(){var t,a,o,l,d,p;if(this.div&&this.center){var g=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,v=this.backgroundPosition.split(" "),E=parseInt(((t=v[0])===null||t===void 0?void 0:t.replace(/^\s+|\s+$/g,""))||"0",10),T=parseInt(((a=v[1])===null||a===void 0?void 0:a.replace(/^\s+|\s+$/g,""))||"0",10),b=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(b!==null?"".concat(b.y,"px"):"0","; left: ").concat(b!==null?"".concat(b.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var R=document.createElement("img");R.alt=g,R.src=this.url,R.width=this.width,R.height=this.height,R.setAttribute("style","position: absolute; top: ".concat(T,"px; left: ").concat(E,"px")),this.cluster.getClusterer().enableRetinaIcons||(R.style.clip="rect(-".concat(T,"px, -").concat(E+this.width,"px, -").concat(T+this.height,", -").concat(E,")"));var N=document.createElement("div");N.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((o=this.sums)===null||o===void 0)&&o.text&&(N.innerText="".concat((l=this.sums)===null||l===void 0?void 0:l.text)),!((d=this.sums)===null||d===void 0)&&d.html&&(N.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(R),this.div.appendChild(N),this.div.title=g,this.div.style.display=""}this.visible=!0},e.prototype.useStyle=function(t){this.sums=t;var a=this.cluster.getClusterer().getStyles(),o=a[Math.min(a.length-1,Math.max(0,t.index-1))];o&&(this.url=o.url,this.height=o.height,this.width=o.width,o.className&&(this.className="".concat(this.clusterClassName," ").concat(o.className)),this.anchorText=o.anchorText||[0,0],this.anchorIcon=o.anchorIcon||[this.height/2,this.width/2],this.textColor=o.textColor||"black",this.textSize=o.textSize||11,this.textDecoration=o.textDecoration||"none",this.fontWeight=o.fontWeight||"bold",this.fontStyle=o.fontStyle||"normal",this.fontFamily=o.fontFamily||"Arial,sans-serif",this.backgroundPosition=o.backgroundPosition||"0 0")},e.prototype.setCenter=function(t){this.center=t},e.prototype.getPosFromLatLng=function(t){var a=this.getProjection().fromLatLngToDivPixel(t);return a!==null&&(a.x-=this.anchorIcon[1],a.y-=this.anchorIcon[0]),a},e}(),LSe=function(){function e(t){this.markerClusterer=t,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new DSe(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return e.prototype.getSize=function(){return this.markers.length},e.prototype.getMarkers=function(){return this.markers},e.prototype.getCenter=function(){return this.center},e.prototype.getMap=function(){return this.map},e.prototype.getClusterer=function(){return this.markerClusterer},e.prototype.getBounds=function(){for(var t=new google.maps.LatLngBounds(this.center,this.center),a=this.getMarkers(),o=0,l=a;o<l.length;o++){var d=l[o],p=d.getPosition();p&&t.extend(p)}return t},e.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},e.prototype.addMarker=function(t){var a;if(this.isMarkerAlreadyAdded(t))return!1;if(this.center){if(this.averageCenter){var o=t.getPosition();if(o){var l=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(l-1)+o.lat())/l,(this.center.lng()*(l-1)+o.lng())/l),this.calculateBounds()}}}else{var o=t.getPosition();o&&(this.center=o,this.calculateBounds())}t.isAdded=!0,this.markers.push(t);var d=this.markers.length,p=this.markerClusterer.getMaxZoom(),g=(a=this.map)===null||a===void 0?void 0:a.getZoom();if(p!==null&&typeof g<"u"&&g>p)t.getMap()!==this.map&&t.setMap(this.map);else if(d<this.minClusterSize)t.getMap()!==this.map&&t.setMap(this.map);else if(d===this.minClusterSize)for(var v=0,E=this.markers;v<E.length;v++){var T=E[v];T.setMap(null)}else t.setMap(null);return!0},e.prototype.isMarkerInClusterBounds=function(t){if(this.bounds!==null){var a=t.getPosition();if(a)return this.bounds.contains(a)}return!1},e.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},e.prototype.updateIcon=function(){var t,a=this.markers.length,o=this.markerClusterer.getMaxZoom(),l=(t=this.map)===null||t===void 0?void 0:t.getZoom();if(o!==null&&typeof l<"u"&&l>o){this.clusterIcon.hide();return}if(a<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},e.prototype.isMarkerAlreadyAdded=function(t){if(this.markers.includes)return this.markers.includes(t);for(var a=0;a<this.markers.length;a++)if(t===this.markers[a])return!0;return!1},e}();function kSe(e,t){var a=e.length,o=a.toString().length,l=Math.min(o,t);return{text:a.toString(),index:l,title:""}}var MSe=2e3,USe=500,jSe="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",VSe="png",BSe=[53,56,66,78,90],FSe="cluster",R9=function(){function e(t,a,o){a===void 0&&(a=[]),o===void 0&&(o={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(e,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=o.gridSize||60,this.minClusterSize=o.minimumClusterSize||2,this.maxZoom=o.maxZoom||null,this.styles=o.styles||[],this.title=o.title||"",this.zoomOnClick=!0,o.zoomOnClick!==void 0&&(this.zoomOnClick=o.zoomOnClick),this.averageCenter=!1,o.averageCenter!==void 0&&(this.averageCenter=o.averageCenter),this.ignoreHidden=!1,o.ignoreHidden!==void 0&&(this.ignoreHidden=o.ignoreHidden),this.enableRetinaIcons=!1,o.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=o.enableRetinaIcons),this.imagePath=o.imagePath||jSe,this.imageExtension=o.imageExtension||VSe,this.imageSizes=o.imageSizes||BSe,this.calculator=o.calculator||kSe,this.batchSize=o.batchSize||MSe,this.batchSizeIE=o.batchSizeIE||USe,this.clusterClass=o.clusterClass||FSe,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(a,!0),this.setMap(t)}return e.prototype.onZoomChanged=function(){var t,a;this.resetViewport(!1),(((t=this.getMap())===null||t===void 0?void 0:t.getZoom())===(this.get("minZoom")||0)||((a=this.getMap())===null||a===void 0?void 0:a.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},e.prototype.onIdle=function(){this.redraw()},e.prototype.onAdd=function(){var t=this.getMap();this.activeMap=t,this.ready=!0,this.repaint(),t!==null&&(this.listeners=[google.maps.event.addListener(t,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(t,"idle",this.onIdle)])},e.prototype.onRemove=function(){for(var t=0,a=this.markers;t<a.length;t++){var o=a[t];o.getMap()!==this.activeMap&&o.setMap(this.activeMap)}for(var l=0,d=this.clusters;l<d.length;l++){var p=d[l];p.remove()}this.clusters=[];for(var g=0,v=this.listeners;g<v.length;g++){var E=v[g];google.maps.event.removeListener(E)}this.listeners=[],this.activeMap=null,this.ready=!1},e.prototype.draw=function(){},e.prototype.getMap=function(){return null},e.prototype.getPanes=function(){return null},e.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},e.prototype.setMap=function(){},e.prototype.addListener=function(){return{remove:function(){}}},e.prototype.bindTo=function(){},e.prototype.get=function(){},e.prototype.notify=function(){},e.prototype.set=function(){},e.prototype.setValues=function(){},e.prototype.unbind=function(){},e.prototype.unbindAll=function(){},e.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var t=0;t<this.imageSizes.length;t++)this.styles.push({url:"".concat(this.imagePath+(t+1),".").concat(this.imageExtension),height:this.imageSizes[t]||0,width:this.imageSizes[t]||0})},e.prototype.fitMapToMarkers=function(){for(var t=this.getMarkers(),a=new google.maps.LatLngBounds,o=0,l=t;o<l.length;o++){var d=l[o],p=d.getPosition();p&&a.extend(p)}var g=this.getMap();g!==null&&"fitBounds"in g&&g.fitBounds(a)},e.prototype.getGridSize=function(){return this.gridSize},e.prototype.setGridSize=function(t){this.gridSize=t},e.prototype.getMinimumClusterSize=function(){return this.minClusterSize},e.prototype.setMinimumClusterSize=function(t){this.minClusterSize=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getStyles=function(){return this.styles},e.prototype.setStyles=function(t){this.styles=t},e.prototype.getTitle=function(){return this.title},e.prototype.setTitle=function(t){this.title=t},e.prototype.getZoomOnClick=function(){return this.zoomOnClick},e.prototype.setZoomOnClick=function(t){this.zoomOnClick=t},e.prototype.getAverageCenter=function(){return this.averageCenter},e.prototype.setAverageCenter=function(t){this.averageCenter=t},e.prototype.getIgnoreHidden=function(){return this.ignoreHidden},e.prototype.setIgnoreHidden=function(t){this.ignoreHidden=t},e.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},e.prototype.setEnableRetinaIcons=function(t){this.enableRetinaIcons=t},e.prototype.getImageExtension=function(){return this.imageExtension},e.prototype.setImageExtension=function(t){this.imageExtension=t},e.prototype.getImagePath=function(){return this.imagePath},e.prototype.setImagePath=function(t){this.imagePath=t},e.prototype.getImageSizes=function(){return this.imageSizes},e.prototype.setImageSizes=function(t){this.imageSizes=t},e.prototype.getCalculator=function(){return this.calculator},e.prototype.setCalculator=function(t){this.calculator=t},e.prototype.getBatchSizeIE=function(){return this.batchSizeIE},e.prototype.setBatchSizeIE=function(t){this.batchSizeIE=t},e.prototype.getClusterClass=function(){return this.clusterClass},e.prototype.setClusterClass=function(t){this.clusterClass=t},e.prototype.getMarkers=function(){return this.markers},e.prototype.getTotalMarkers=function(){return this.markers.length},e.prototype.getClusters=function(){return this.clusters},e.prototype.getTotalClusters=function(){return this.clusters.length},e.prototype.addMarker=function(t,a){this.pushMarkerTo(t),a||this.redraw()},e.prototype.addMarkers=function(t,a){for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var l=t[o];l&&this.pushMarkerTo(l)}a||this.redraw()},e.prototype.pushMarkerTo=function(t){var a=this;t.getDraggable()&&google.maps.event.addListener(t,"dragend",function(){a.ready&&(t.isAdded=!1,a.repaint())}),t.isAdded=!1,this.markers.push(t)},e.prototype.removeMarker_=function(t){var a=-1;if(this.markers.indexOf)a=this.markers.indexOf(t);else for(var o=0;o<this.markers.length;o++)if(t===this.markers[o]){a=o;break}return a===-1?!1:(t.setMap(null),this.markers.splice(a,1),!0)},e.prototype.removeMarker=function(t,a){var o=this.removeMarker_(t);return!a&&o&&this.repaint(),o},e.prototype.removeMarkers=function(t,a){for(var o=!1,l=0,d=t;l<d.length;l++){var p=d[l];o=o||this.removeMarker_(p)}return!a&&o&&this.repaint(),o},e.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},e.prototype.repaint=function(){var t=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var o=0,l=t;o<l.length;o++){var d=l[o];d.remove()}},0)},e.prototype.getExtendedBounds=function(t){var a=this.getProjection(),o=a.fromLatLngToDivPixel(new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()));o!==null&&(o.x+=this.gridSize,o.y-=this.gridSize);var l=a.fromLatLngToDivPixel(new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()));if(l!==null&&(l.x-=this.gridSize,l.y+=this.gridSize),o!==null){var d=a.fromDivPixelToLatLng(o);d!==null&&t.extend(d)}if(l!==null){var p=a.fromDivPixelToLatLng(l);p!==null&&t.extend(p)}return t},e.prototype.redraw=function(){this.createClusters(0)},e.prototype.resetViewport=function(t){for(var a=0,o=this.clusters;a<o.length;a++){var l=o[a];l.remove()}this.clusters=[];for(var d=0,p=this.markers;d<p.length;d++){var g=p[d];g.isAdded=!1,t&&g.setMap(null)}},e.prototype.distanceBetweenPoints=function(t,a){var o=6371,l=(a.lat()-t.lat())*Math.PI/180,d=(a.lng()-t.lng())*Math.PI/180,p=Math.sin(l/2)*Math.sin(l/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(a.lat()*Math.PI/180)*Math.sin(d/2)*Math.sin(d/2);return o*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},e.prototype.isMarkerInBounds=function(t,a){var o=t.getPosition();return o?a.contains(o):!1},e.prototype.addToClosestCluster=function(t){for(var a,o=4e4,l=null,d=0,p=this.clusters;d<p.length;d++){var g=p[d];a=g;var v=a.getCenter(),E=t.getPosition();if(v&&E){var T=this.distanceBetweenPoints(v,E);T<o&&(o=T,l=a)}}l&&l.isMarkerInClusterBounds(t)?l.addMarker(t):(a=new LSe(this),a.addMarker(t),this.clusters.push(a))},e.prototype.createClusters=function(t){var a=this;if(this.ready){t===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var o=this.getMap(),l=o!==null&&("getBounds"in o)?o.getBounds():null,d=(o==null?void 0:o.getZoom())||0,p=d>3?new google.maps.LatLngBounds(l==null?void 0:l.getSouthWest(),l==null?void 0:l.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),g=this.getExtendedBounds(p),v=Math.min(t+this.batchSize,this.markers.length),E=t;E<v;E++){var T=this.markers[E];T&&!T.isAdded&&this.isMarkerInBounds(T,g)&&(!this.ignoreHidden||this.ignoreHidden&&T.getVisible())&&this.addToClosestCluster(T)}if(v<this.markers.length)this.timerRefStatic=window.setTimeout(function(){a.createClusters(v)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var b=0,R=this.clusters;b<R.length;b++){var N=R[b];N.updateIcon()}}}},e.prototype.extend=function(t,a){return(function(l){for(var d in l.prototype){var p=d;this.prototype[p]=l.prototype[p]}return this}).apply(t,[a])},e}();function P$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function WSe(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?P$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var po={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},En={averageCenter(e,t){e.setAverageCenter(t)},batchSizeIE(e,t){e.setBatchSizeIE(t)},calculator(e,t){e.setCalculator(t)},clusterClass(e,t){e.setClusterClass(t)},enableRetinaIcons(e,t){e.setEnableRetinaIcons(t)},gridSize(e,t){e.setGridSize(t)},ignoreHidden(e,t){e.setIgnoreHidden(t)},imageExtension(e,t){e.setImageExtension(t)},imagePath(e,t){e.setImagePath(t)},imageSizes(e,t){e.setImageSizes(t)},maxZoom(e,t){e.setMaxZoom(t)},minimumClusterSize(e,t){e.setMinimumClusterSize(t)},styles(e,t){e.setStyles(t)},title(e,t){e.setTitle(t)},zoomOnClick(e,t){e.setZoomOnClick(t)}},GSe={};function $Se(e){var{children:t,options:a,averageCenter:o,batchSizeIE:l,calculator:d,clusterClass:p,enableRetinaIcons:g,gridSize:v,ignoreHidden:E,imageExtension:T,imagePath:b,imageSizes:R,maxZoom:N,minimumClusterSize:P,styles:L,title:M,zoomOnClick:D,onClick:U,onClusteringBegin:B,onClusteringEnd:z,onMouseOver:V,onMouseOut:G,onLoad:q,onUnmount:ne}=e,[Z,le]=x.useState(null),ee=x.useContext(Ht),[ce,be]=x.useState(null),[ae,fe]=x.useState(null),[me,_e]=x.useState(null),[ue,ve]=x.useState(null),[Ce,Ve]=x.useState(null);return x.useEffect(()=>{Z&&G&&(ue!==null&&google.maps.event.removeListener(ue),ve(google.maps.event.addListener(Z,po.onMouseOut,G)))},[G]),x.useEffect(()=>{Z&&V&&(Ce!==null&&google.maps.event.removeListener(Ce),Ve(google.maps.event.addListener(Z,po.onMouseOver,V)))},[V]),x.useEffect(()=>{Z&&U&&(ce!==null&&google.maps.event.removeListener(ce),be(google.maps.event.addListener(Z,po.onClick,U)))},[U]),x.useEffect(()=>{Z&&B&&(ae!==null&&google.maps.event.removeListener(ae),fe(google.maps.event.addListener(Z,po.onClusteringBegin,B)))},[B]),x.useEffect(()=>{Z&&z&&(me!==null&&google.maps.event.removeListener(me),fe(google.maps.event.addListener(Z,po.onClusteringEnd,z)))},[z]),x.useEffect(()=>{typeof o<"u"&&Z!==null&&En.averageCenter(Z,o)},[Z,o]),x.useEffect(()=>{typeof l<"u"&&Z!==null&&En.batchSizeIE(Z,l)},[Z,l]),x.useEffect(()=>{typeof d<"u"&&Z!==null&&En.calculator(Z,d)},[Z,d]),x.useEffect(()=>{typeof p<"u"&&Z!==null&&En.clusterClass(Z,p)},[Z,p]),x.useEffect(()=>{typeof g<"u"&&Z!==null&&En.enableRetinaIcons(Z,g)},[Z,g]),x.useEffect(()=>{typeof v<"u"&&Z!==null&&En.gridSize(Z,v)},[Z,v]),x.useEffect(()=>{typeof E<"u"&&Z!==null&&En.ignoreHidden(Z,E)},[Z,E]),x.useEffect(()=>{typeof T<"u"&&Z!==null&&En.imageExtension(Z,T)},[Z,T]),x.useEffect(()=>{typeof b<"u"&&Z!==null&&En.imagePath(Z,b)},[Z,b]),x.useEffect(()=>{typeof R<"u"&&Z!==null&&En.imageSizes(Z,R)},[Z,R]),x.useEffect(()=>{typeof N<"u"&&Z!==null&&En.maxZoom(Z,N)},[Z,N]),x.useEffect(()=>{typeof P<"u"&&Z!==null&&En.minimumClusterSize(Z,P)},[Z,P]),x.useEffect(()=>{typeof L<"u"&&Z!==null&&En.styles(Z,L)},[Z,L]),x.useEffect(()=>{typeof M<"u"&&Z!==null&&En.title(Z,M)},[Z,M]),x.useEffect(()=>{typeof D<"u"&&Z!==null&&En.zoomOnClick(Z,D)},[Z,D]),x.useEffect(()=>{if(ee){var Pe=WSe({},a||GSe),Ge=new R9(ee,[],Pe);return o&&En.averageCenter(Ge,o),l&&En.batchSizeIE(Ge,l),d&&En.calculator(Ge,d),p&&En.clusterClass(Ge,p),g&&En.enableRetinaIcons(Ge,g),v&&En.gridSize(Ge,v),E&&En.ignoreHidden(Ge,E),T&&En.imageExtension(Ge,T),b&&En.imagePath(Ge,b),R&&En.imageSizes(Ge,R),N&&En.maxZoom(Ge,N),P&&En.minimumClusterSize(Ge,P),L&&En.styles(Ge,L),M&&En.title(Ge,M),D&&En.zoomOnClick(Ge,D),G&&ve(google.maps.event.addListener(Ge,po.onMouseOut,G)),V&&Ve(google.maps.event.addListener(Ge,po.onMouseOver,V)),U&&be(google.maps.event.addListener(Ge,po.onClick,U)),B&&fe(google.maps.event.addListener(Ge,po.onClusteringBegin,B)),z&&_e(google.maps.event.addListener(Ge,po.onClusteringEnd,z)),le(Ge),q&&q(Ge),()=>{ue!==null&&google.maps.event.removeListener(ue),Ce!==null&&google.maps.event.removeListener(Ce),ce!==null&&google.maps.event.removeListener(ce),ae!==null&&google.maps.event.removeListener(ae),me!==null&&google.maps.event.removeListener(me),ne&&ne(Ge)}}},[]),Z!==null&&t(Z)||null}x.memo($Se);class HSe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{markerClusterer:null}),xe(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var t=new R9(this.context,[],this.props.options);this.registeredEvents=en({updaterMap:En,eventMap:po,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({markerClusterer:t}),this.setClustererCallback)}}componentDidUpdate(t){this.state.markerClusterer&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:En,eventMap:po,prevProps:t,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),nn(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}xe(HSe,"contextType",Ht);function x$(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}var O9=function(){function e(t){t===void 0&&(t={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(e,google.maps.OverlayView),this.content=t.content||"",this.disableAutoPan=t.disableAutoPan||!1,this.maxWidth=t.maxWidth||0,this.pixelOffset=t.pixelOffset||new google.maps.Size(0,0),this.position=t.position||new google.maps.LatLng(0,0),this.zIndex=t.zIndex||null,this.boxClass=t.boxClass||"infoBox",this.boxStyle=t.boxStyle||{},this.closeBoxMargin=t.closeBoxMargin||"2px",this.closeBoxURL=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",t.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=t.infoBoxClearance||new google.maps.Size(1,1),typeof t.visible>"u"&&(typeof t.isHidden>"u"?t.visible=!0:t.visible=!t.isHidden),this.isHidden=!t.visible,this.alignBottom=t.alignBottom||!1,this.pane=t.pane||"floatPane",this.enableEventPropagation=t.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return e.prototype.createInfoBoxDiv=function(){var t=this,a=function(T){T.returnValue=!1,T.preventDefault&&T.preventDefault(),t.enableEventPropagation||x$(T)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var o=this.getPanes();if(o!==null&&o[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var l=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-l.left-l.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var d=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,g=d;p<g.length;p++){var v=g[p];this.eventListeners.push(google.maps.event.addListener(this.div,v,x$))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){t.div&&(t.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",a),google.maps.event.trigger(this,"domready")}},e.prototype.getCloseBoxImg=function(){var t="";return this.closeBoxURL!==""&&(t='<img alt=""',t+=' aria-hidden="true"',t+=" src='"+this.closeBoxURL+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin+";",t+="'>"),t},e.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},e.prototype.closeClickHandler=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},e.prototype.getCloseClickHandler=function(){return this.closeClickHandler},e.prototype.panBox=function(t){if(this.div&&!t){var a=this.getMap();if(a instanceof google.maps.Map){var o=0,l=0,d=a.getBounds();d&&!d.contains(this.position)&&a.setCenter(this.position);var p=a.getDiv(),g=p.offsetWidth,v=p.offsetHeight,E=this.pixelOffset.width,T=this.pixelOffset.height,b=this.div.offsetWidth,R=this.div.offsetHeight,N=this.infoBoxClearance.width,P=this.infoBoxClearance.height,L=this.getProjection(),M=L.fromLatLngToContainerPixel(this.position);M!==null&&(M.x<-E+N?o=M.x+E-N:M.x+b+E+N>g&&(o=M.x+b+E+N-g),this.alignBottom?M.y<-T+P+R?l=M.y+T-P-R:M.y+T+P>v&&(l=M.y+T+P-v):M.y<-T+P?l=M.y+T-P:M.y+R+T+P>v&&(l=M.y+R+T+P-v)),o===0&&l===0||a.panBy(o,l)}}},e.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var t=this.boxStyle;for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(this.div.style[a]=t[a]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var o=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+o*100+')"',this.div.style.filter="alpha(opacity="+o*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},e.prototype.getBoxWidths=function(){var t={top:0,bottom:0,left:0,right:0};if(!this.div)return t;if(document.defaultView){var a=this.div.ownerDocument,o=a&&a.defaultView?a.defaultView.getComputedStyle(this.div,""):null;o&&(t.top=parseInt(o.borderTopWidth||"",10)||0,t.bottom=parseInt(o.borderBottomWidth||"",10)||0,t.left=parseInt(o.borderLeftWidth||"",10)||0,t.right=parseInt(o.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var l=this.div.currentStyle;l&&(t.top=parseInt(l.borderTopWidth||"",10)||0,t.bottom=parseInt(l.borderBottomWidth||"",10)||0,t.left=parseInt(l.borderLeftWidth||"",10)||0,t.right=parseInt(l.borderRightWidth||"",10)||0)}return t},e.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},e.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var t=this.getProjection(),a=t.fromLatLngToDivPixel(this.position);a!==null&&(this.div.style.left=a.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(a.y+this.pixelOffset.height)+"px":this.div.style.top=a.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},e.prototype.setOptions=function(t){t===void 0&&(t={}),typeof t.boxClass<"u"&&(this.boxClass=t.boxClass,this.setBoxStyle()),typeof t.boxStyle<"u"&&(this.boxStyle=t.boxStyle,this.setBoxStyle()),typeof t.content<"u"&&this.setContent(t.content),typeof t.disableAutoPan<"u"&&(this.disableAutoPan=t.disableAutoPan),typeof t.maxWidth<"u"&&(this.maxWidth=t.maxWidth),typeof t.pixelOffset<"u"&&(this.pixelOffset=t.pixelOffset),typeof t.alignBottom<"u"&&(this.alignBottom=t.alignBottom),typeof t.position<"u"&&this.setPosition(t.position),typeof t.zIndex<"u"&&this.setZIndex(t.zIndex),typeof t.closeBoxMargin<"u"&&(this.closeBoxMargin=t.closeBoxMargin),typeof t.closeBoxURL<"u"&&(this.closeBoxURL=t.closeBoxURL),typeof t.infoBoxClearance<"u"&&(this.infoBoxClearance=t.infoBoxClearance),typeof t.isHidden<"u"&&(this.isHidden=t.isHidden),typeof t.visible<"u"&&(this.isHidden=!t.visible),typeof t.enableEventPropagation<"u"&&(this.enableEventPropagation=t.enableEventPropagation),this.div&&this.draw()},e.prototype.setContent=function(t){this.content=t,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},e.prototype.setPosition=function(t){this.position=t,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},e.prototype.setVisible=function(t){this.isHidden=!t,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},e.prototype.setZIndex=function(t){this.zIndex=t,this.div&&(this.div.style.zIndex=t+""),google.maps.event.trigger(this,"zindex_changed")},e.prototype.getContent=function(){return this.content},e.prototype.getPosition=function(){return this.position},e.prototype.getZIndex=function(){return this.zIndex},e.prototype.getVisible=function(){var t=this.getMap();return typeof t>"u"||t===null?!1:!this.isHidden},e.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},e.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},e.prototype.open=function(t,a){var o=this;a&&(this.position=a.getPosition(),this.moveListener=google.maps.event.addListener(a,"position_changed",function(){var l=a.getPosition();o.setPosition(l)}),this.mapListener=google.maps.event.addListener(a,"map_changed",function(){o.setMap(a.map)})),this.setMap(t),this.div&&this.panBox()},e.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var t=0,a=this.eventListeners;t<a.length;t++){var o=a[t];google.maps.event.removeListener(o)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},e.prototype.extend=function(t,a){return(function(l){for(var d in l.prototype)Object.prototype.hasOwnProperty.call(this,d)||(this.prototype[d]=l.prototype[d]);return this}).apply(t,[a])},e}(),zSe=["position"],KSe=["position"];function D$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Vb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?D$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var L$={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},k$={options(e,t){e.setOptions(t)},position(e,t){t instanceof google.maps.LatLng?e.setPosition(t):e.setPosition(new google.maps.LatLng(t.lat,t.lng))},visible(e,t){e.setVisible(t)},zIndex(e,t){e.setZIndex(t)}},qSe={};function YSe(e){var{children:t,anchor:a,options:o,position:l,zIndex:d,onCloseClick:p,onDomReady:g,onContentChanged:v,onPositionChanged:E,onZindexChanged:T,onLoad:b,onUnmount:R}=e,N=x.useContext(Ht),[P,L]=x.useState(null),[M,D]=x.useState(null),[U,B]=x.useState(null),[z,V]=x.useState(null),[G,q]=x.useState(null),[ne,Z]=x.useState(null),le=x.useRef(null);return x.useEffect(()=>{N&&P!==null&&(P.close(),a?P.open(N,a):P.getPosition()&&P.open(N))},[N,P,a]),x.useEffect(()=>{o&&P!==null&&P.setOptions(o)},[P,o]),x.useEffect(()=>{if(l&&P!==null){var ee=l instanceof google.maps.LatLng?l:new google.maps.LatLng(l.lat,l.lng);P.setPosition(ee)}},[l]),x.useEffect(()=>{typeof d=="number"&&P!==null&&P.setZIndex(d)},[d]),x.useEffect(()=>{P&&p&&(M!==null&&google.maps.event.removeListener(M),D(google.maps.event.addListener(P,"closeclick",p)))},[p]),x.useEffect(()=>{P&&g&&(U!==null&&google.maps.event.removeListener(U),B(google.maps.event.addListener(P,"domready",g)))},[g]),x.useEffect(()=>{P&&v&&(z!==null&&google.maps.event.removeListener(z),V(google.maps.event.addListener(P,"content_changed",v)))},[v]),x.useEffect(()=>{P&&E&&(G!==null&&google.maps.event.removeListener(G),q(google.maps.event.addListener(P,"position_changed",E)))},[E]),x.useEffect(()=>{P&&T&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(P,"zindex_changed",T)))},[T]),x.useEffect(()=>{if(N){var ee=o||qSe,{position:ce}=ee,be=k1(ee,zSe),ae;ce&&!(ce instanceof google.maps.LatLng)&&(ae=new google.maps.LatLng(ce.lat,ce.lng));var fe=new O9(Vb(Vb({},be),ae?{position:ae}:{}));le.current=document.createElement("div"),L(fe),p&&D(google.maps.event.addListener(fe,"closeclick",p)),g&&B(google.maps.event.addListener(fe,"domready",g)),v&&V(google.maps.event.addListener(fe,"content_changed",v)),E&&q(google.maps.event.addListener(fe,"position_changed",E)),T&&Z(google.maps.event.addListener(fe,"zindex_changed",T)),fe.setContent(le.current),a?fe.open(N,a):fe.getPosition()?fe.open(N):ei(!1,"You must provide either an anchor or a position prop for <InfoBox>."),b&&b(fe)}return()=>{P!==null&&(M&&google.maps.event.removeListener(M),z&&google.maps.event.removeListener(z),U&&google.maps.event.removeListener(U),G&&google.maps.event.removeListener(G),ne&&google.maps.event.removeListener(ne),R&&R(P),P.close())}},[]),le.current?Nd.createPortal(x.Children.only(t),le.current):null}x.memo(YSe);class XSe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"containerElement",null),xe(this,"state",{infoBox:null}),xe(this,"open",(t,a)=>{a?this.context!==null&&t.open(this.context,a):t.getPosition()?this.context!==null&&t.open(this.context):ei(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),xe(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var t=this.props.options||{},{position:a}=t,o=k1(t,KSe),l;a&&!(a instanceof google.maps.LatLng)&&(l=new google.maps.LatLng(a.lat,a.lng));var d=new O9(Vb(Vb({},o),l?{position:l}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=en({updaterMap:k$,eventMap:L$,prevProps:{},nextProps:this.props,instance:d}),this.setState({infoBox:d},this.setInfoBoxCallback)}componentDidUpdate(t){var{infoBox:a}=this.state;a!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:k$,eventMap:L$,prevProps:t,nextProps:this.props,instance:a}))}componentWillUnmount(){var{onUnmount:t}=this.props,{infoBox:a}=this.state;a!==null&&(t&&t(a),nn(this.registeredEvents),a.close())}render(){return this.containerElement?Nd.createPortal(x.Children.only(this.props.children),this.containerElement):null}}xe(XSe,"contextType",Ht);var AI,M$;function JSe(){return M$||(M$=1,AI=function e(t,a){if(t===a)return!0;if(t&&a&&typeof t=="object"&&typeof a=="object"){if(t.constructor!==a.constructor)return!1;var o,l,d;if(Array.isArray(t)){if(o=t.length,o!=a.length)return!1;for(l=o;l--!==0;)if(!e(t[l],a[l]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if(d=Object.keys(t),o=d.length,o!==Object.keys(a).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(a,d[l]))return!1;for(l=o;l--!==0;){var p=d[l];if(!e(t[p],a[p]))return!1}return!0}return t!==t&&a!==a}),AI}var QSe=JSe(),U$=_9(QSe),j$=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],II=1,vg=8;class M1{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[a,o]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");var l=o>>4;if(l!==II)throw new Error("Got v".concat(l," data when expected v").concat(II,"."));var d=j$[o&15];if(!d)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new M1(g,p,d,t)}constructor(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,l=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;var d=j$.indexOf(this.ArrayType),p=t*2*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(d<0)throw new Error("Unexpected typed array class: ".concat(o,"."));l&&l instanceof ArrayBuffer?(this.data=l,this.ids=new this.IndexArrayType(this.data,vg,t),this.coords=new this.ArrayType(this.data,vg+g+v,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(vg+p+g+v),this.ids=new this.IndexArrayType(this.data,vg,t),this.coords=new this.ArrayType(this.data,vg+g+v,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(II<<4)+d]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){var o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=a,o}finish(){var t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return uP(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:d,coords:p,nodeSize:g}=this,v=[0,d.length-1,0],E=[];v.length;){var T=v.pop()||0,b=v.pop()||0,R=v.pop()||0;if(b-R<=g){for(var N=R;N<=b;N++){var P=p[2*N],L=p[2*N+1];P>=t&&P<=o&&L>=a&&L<=l&&E.push(d[N])}continue}var M=R+b>>1,D=p[2*M],U=p[2*M+1];D>=t&&D<=o&&U>=a&&U<=l&&E.push(d[M]),(T===0?t<=D:a<=U)&&(v.push(R),v.push(M-1),v.push(1-T)),(T===0?o>=D:l>=U)&&(v.push(M+1),v.push(b),v.push(1-T))}return E}within(t,a,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:l,coords:d,nodeSize:p}=this,g=[0,l.length-1,0],v=[],E=o*o;g.length;){var T=g.pop()||0,b=g.pop()||0,R=g.pop()||0;if(b-R<=p){for(var N=R;N<=b;N++)V$(d[2*N],d[2*N+1],t,a)<=E&&v.push(l[N]);continue}var P=R+b>>1,L=d[2*P],M=d[2*P+1];V$(L,M,t,a)<=E&&v.push(l[P]),(T===0?t-o<=L:a-o<=M)&&(g.push(R),g.push(P-1),g.push(1-T)),(T===0?t+o>=L:a+o>=M)&&(g.push(P+1),g.push(b),g.push(1-T))}return v}}function uP(e,t,a,o,l,d){if(!(l-o<=a)){var p=o+l>>1;A9(e,t,p,o,l,d),uP(e,t,a,o,p-1,1-d),uP(e,t,a,p+1,l,1-d)}}function A9(e,t,a,o,l,d){for(;l>o;){if(l-o>600){var p=l-o+1,g=a-o+1,v=Math.log(p),E=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*E*(p-E)/p)*(g-p/2<0?-1:1),b=Math.max(o,Math.floor(a-g*E/p+T)),R=Math.min(l,Math.floor(a+(p-g)*E/p+T));A9(e,t,a,b,R,d)}var N=t[2*a+d],P=o,L=l;for(_g(e,t,o,a),t[2*l+d]>N&&_g(e,t,o,l);P<L;){for(_g(e,t,P,L),P++,L--;t[2*P+d]<N;)P++;for(;t[2*L+d]>N;)L--}t[2*o+d]===N?_g(e,t,o,L):(L++,_g(e,t,L,l)),L<=a&&(o=L+1),a<=L&&(l=L-1)}}function _g(e,t,a,o){NI(e,a,o),NI(t,2*a,2*o),NI(t,2*a+1,2*o+1)}function NI(e,t,a){var o=e[t];e[t]=e[a],e[a]=o}function V$(e,t,a,o){var l=e-a,d=t-o;return l*l+d*d}var ZSe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},B$=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),Ju=2,Tl=3,PI=4,El=5,I9=6;class ebe{constructor(t){this.options=Object.assign(Object.create(ZSe),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){var{log:a,minZoom:o,maxZoom:l}=this.options;a&&console.time("total time");var d="prepare ".concat(t.length," points");a&&console.time(d),this.points=t;for(var p=[],g=0;g<t.length;g++){var v=t[g];if(v.geometry){var[E,T]=v.geometry.coordinates,b=B$(LS(E)),R=B$(kS(T));p.push(b,R,1/0,g,-1,1),this.options.reduce&&p.push(0)}}var N=this.trees[l+1]=this._createTree(p);a&&console.timeEnd(d);for(var P=l;P>=o;P--){var L=+Date.now();N=this.trees[P]=this._createTree(this._cluster(N,P)),a&&console.log("z%d: %d clusters in %dms",P,N.numItems,+Date.now()-L)}return a&&console.timeEnd("total time"),this}getClusters(t,a){var o=((t[0]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,t[1])),d=t[2]===180?180:((t[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)o=-180,d=180;else if(o>d){var g=this.getClusters([o,l,180,p],a),v=this.getClusters([-180,l,d,p],a);return g.concat(v)}var E=this.trees[this._limitZoom(a)],T=E.range(LS(o),kS(p),LS(d),kS(l)),b=E.data,R=[];for(var N of T){var P=this.stride*N;R.push(b[P+El]>1?F$(b,P,this.clusterProps):this.points[b[P+Tl]])}return R}getChildren(t){var a=this._getOriginId(t),o=this._getOriginZoom(t),l="No cluster with the specified id.",d=this.trees[o];if(!d)throw new Error(l);var p=d.data;if(a*this.stride>=p.length)throw new Error(l);var g=this.options.radius/(this.options.extent*Math.pow(2,o-1)),v=p[a*this.stride],E=p[a*this.stride+1],T=d.within(v,E,g),b=[];for(var R of T){var N=R*this.stride;p[N+PI]===t&&b.push(p[N+El]>1?F$(p,N,this.clusterProps):this.points[p[N+Tl]])}if(b.length===0)throw new Error(l);return b}getLeaves(t,a,o){a=a||10,o=o||0;var l=[];return this._appendLeaves(l,t,a,o,0),l}getTile(t,a,o){var l=this.trees[this._limitZoom(t)],d=Math.pow(2,t),{extent:p,radius:g}=this.options,v=g/p,E=(o-v)/d,T=(o+1+v)/d,b={features:[]};return this._addTileFeatures(l.range((a-v)/d,E,(a+1+v)/d,T),l.data,a,o,d,b),a===0&&this._addTileFeatures(l.range(1-v/d,E,1,T),l.data,d,o,d,b),a===d-1&&this._addTileFeatures(l.range(0,E,v/d,T),l.data,-1,o,d,b),b.features.length?b:null}getClusterExpansionZoom(t){for(var a=this._getOriginZoom(t)-1;a<=this.options.maxZoom;){var o=this.getChildren(t);if(a++,o.length!==1)break;t=o[0].properties.cluster_id}return a}_appendLeaves(t,a,o,l,d){var p=this.getChildren(a);for(var g of p){var v=g.properties;if(v&&v.cluster?d+v.point_count<=l?d+=v.point_count:d=this._appendLeaves(t,v.cluster_id,o,l,d):d<l?d++:t.push(g),t.length===o)break}return d}_createTree(t){for(var a=new M1(t.length/this.stride|0,this.options.nodeSize,Float32Array),o=0;o<t.length;o+=this.stride)a.add(t[o],t[o+1]);return a.finish(),a.data=t,a}_addTileFeatures(t,a,o,l,d,p){for(var g of t){var v=g*this.stride,E=a[v+El]>1,T=void 0,b=void 0,R=void 0;if(E)T=N9(a,v,this.clusterProps),b=a[v],R=a[v+1];else{var N=this.points[a[v+Tl]];T=N.properties;var[P,L]=N.geometry.coordinates;b=LS(P),R=kS(L)}var M={type:1,geometry:[[Math.round(this.options.extent*(b*d-o)),Math.round(this.options.extent*(R*d-l))]],tags:T},D=void 0;E||this.options.generateId?D=a[v+Tl]:D=this.points[a[v+Tl]].id,D!==void 0&&(M.id=D),p.features.push(M)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,a){for(var{radius:o,extent:l,reduce:d,minPoints:p}=this.options,g=o/(l*Math.pow(2,a)),v=t.data,E=[],T=this.stride,b=0;b<v.length;b+=T)if(!(v[b+Ju]<=a)){v[b+Ju]=a;var R=v[b],N=v[b+1],P=t.within(v[b],v[b+1],g),L=v[b+El],M=L;for(var D of P){var U=D*T;v[U+Ju]>a&&(M+=v[U+El])}if(M>L&&M>=p){var B=R*L,z=N*L,V=void 0,G=-1,q=((b/T|0)<<5)+(a+1)+this.points.length;for(var ne of P){var Z=ne*T;if(!(v[Z+Ju]<=a)){v[Z+Ju]=a;var le=v[Z+El];B+=v[Z]*le,z+=v[Z+1]*le,v[Z+PI]=q,d&&(V||(V=this._map(v,b,!0),G=this.clusterProps.length,this.clusterProps.push(V)),d(V,this._map(v,Z)))}}v[b+PI]=q,E.push(B/M,z/M,1/0,q,-1,M),d&&E.push(G)}else{for(var ee=0;ee<T;ee++)E.push(v[b+ee]);if(M>1)for(var ce of P){var be=ce*T;if(!(v[be+Ju]<=a)){v[be+Ju]=a;for(var ae=0;ae<T;ae++)E.push(v[be+ae])}}}}return E}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,a,o){if(t[a+El]>1){var l=this.clusterProps[t[a+I9]];return o?Object.assign({},l):l}var d=this.points[t[a+Tl]].properties,p=this.options.map(d);return o&&p===d?Object.assign({},p):p}}function F$(e,t,a){return{type:"Feature",id:e[t+Tl],properties:N9(e,t,a),geometry:{type:"Point",coordinates:[tbe(e[t]),nbe(e[t+1])]}}}function N9(e,t,a){var o=e[t+El],l=o>=1e4?"".concat(Math.round(o/1e3),"k"):o>=1e3?"".concat(Math.round(o/100)/10,"k"):o,d=e[t+I9],p=d===-1?{}:Object.assign({},a[d]);return Object.assign(p,{cluster:!0,cluster_id:e[t+Tl],point_count:o,point_count_abbreviated:l})}function LS(e){return e/360+.5}function kS(e){var t=Math.sin(e*Math.PI/180),a=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return a<0?0:a>1?1:a}function tbe(e){return(e-.5)*360}function nbe(e){var t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function rbe(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(a[o[l]]=e[o[l]]);return a}class Ua{static isAdvancedMarkerAvailable(t){return google.maps.marker&&t.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,a){this.isAdvancedMarker(t)?t.map=a:t.setMap(a)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(t.position.lat&&t.position.lng)return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return this.isAdvancedMarker(t)?!0:t.getVisible()}}class dP{constructor(t){var{markers:a,position:o}=t;this.markers=a,o&&(o instanceof google.maps.LatLng?this._position=o:this._position=new google.maps.LatLng(o))}get bounds(){if(!(this.markers.length===0&&!this._position)){var t=new google.maps.LatLngBounds(this._position,this._position);for(var a of this.markers)t.extend(Ua.getPosition(a));return t}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>Ua.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(Ua.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class ibe{constructor(t){var{maxZoom:a=16}=t;this.maxZoom=a}noop(t){var{markers:a}=t;return abe(a)}}var abe=e=>{var t=e.map(a=>new dP({position:Ua.getPosition(a),markers:[a]}));return t};class obe extends ibe{constructor(t){var{maxZoom:a,radius:o=60}=t,l=rbe(t,["maxZoom","radius"]);super({maxZoom:a}),this.state={zoom:-1},this.superCluster=new ebe(Object.assign({maxZoom:this.maxZoom,radius:o},l))}calculate(t){var a=!1,o={zoom:t.map.getZoom()};if(!U$(t.markers,this.markers)){a=!0,this.markers=[...t.markers];var l=this.markers.map(d=>{var p=Ua.getPosition(d),g=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:g},properties:{marker:d}}});this.superCluster.load(l)}return a||(this.state.zoom<=this.maxZoom||o.zoom<=this.maxZoom)&&(a=!U$(this.state,o)),this.state=o,a&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:a}}cluster(t){var{map:a}=t;return this.superCluster.getClusters([-180,-90,180,90],Math.round(a.getZoom())).map(o=>this.transformCluster(o))}transformCluster(t){var{geometry:{coordinates:[a,o]},properties:l}=t;if(l.cluster)return new dP({markers:this.superCluster.getLeaves(l.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:o,lng:a}});var d=l.marker;return new dP({markers:[d],position:Ua.getPosition(d)})}}class sbe{constructor(t,a){this.markers={sum:t.length};var o=a.map(d=>d.count),l=o.reduce((d,p)=>d+p,0);this.clusters={count:a.length,markers:{mean:l/a.length,sum:l,min:Math.min(...o),max:Math.max(...o)}}}}class cbe{render(t,a,o){var{count:l,position:d}=t,p=l>Math.max(10,a.clusters.markers.mean)?"#ff0000":"#0000ff",g='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(l,`</text>
</svg>`),v="Cluster of ".concat(l," markers"),E=Number(google.maps.Marker.MAX_ZINDEX)+l;if(Ua.isAdvancedMarkerAvailable(o)){var T=new DOMParser,b=T.parseFromString(g,"image/svg+xml").documentElement;b.setAttribute("transform","translate(0 25)");var R={map:o,position:d,zIndex:E,title:v,content:b};return new google.maps.marker.AdvancedMarkerElement(R)}var N={position:d,zIndex:E,title:v,icon:{url:"data:image/svg+xml;base64,".concat(btoa(g)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(N)}}function lbe(e,t){for(var a in t.prototype)e.prototype[a]=t.prototype[a]}class U1{constructor(){lbe(U1,google.maps.OverlayView)}}var Xg;(function(e){e.CLUSTERING_BEGIN="clusteringbegin",e.CLUSTERING_END="clusteringend",e.CLUSTER_CLICK="click"})(Xg||(Xg={}));var ube=(e,t,a)=>{a.fitBounds(t.bounds)};class dbe extends U1{constructor(t){var{map:a,markers:o=[],algorithmOptions:l={},algorithm:d=new obe(l),renderer:p=new cbe,onClusterClick:g=ube}=t;super(),this.markers=[...o],this.clusters=[],this.algorithm=d,this.renderer=p,this.onClusterClick=g,a&&this.setMap(a)}addMarker(t,a){this.markers.includes(t)||(this.markers.push(t),a||this.render())}addMarkers(t,a){t.forEach(o=>{this.addMarker(o,!0)}),a||this.render()}removeMarker(t,a){var o=this.markers.indexOf(t);return o===-1?!1:(Ua.setMap(t,null),this.markers.splice(o,1),a||this.render(),!0)}removeMarkers(t,a){var o=!1;return t.forEach(l=>{o=this.removeMarker(l,!0)||o}),o&&!a&&this.render(),o}clearMarkers(t){this.markers.length=0,t||this.render()}render(){var t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,Xg.CLUSTERING_BEGIN,this);var{clusters:a,changed:o}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(o||o==null){var l=new Set;for(var d of a)d.markers.length==1&&l.add(d.markers[0]);var p=[];for(var g of this.clusters)g.marker!=null&&(g.markers.length==1?l.has(g.marker)||Ua.setMap(g.marker,null):p.push(g.marker));this.clusters=a,this.renderClusters(),requestAnimationFrame(()=>p.forEach(v=>Ua.setMap(v,null)))}google.maps.event.trigger(this,Xg.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>Ua.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){var t=new sbe(this.markers,this.clusters),a=this.getMap();this.clusters.forEach(o=>{o.markers.length===1?o.marker=o.markers[0]:(o.marker=this.renderer.render(o,t,a),o.markers.forEach(l=>Ua.setMap(l,null)),this.onClusterClick&&o.marker.addListener("click",l=>{google.maps.event.trigger(this,Xg.CLUSTER_CLICK,o),this.onClusterClick(l,o,a)})),Ua.setMap(o.marker,a)})}}function W$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function G$(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?W$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function hbe(e){var t=hSe(),[a,o]=x.useState(null);return x.useEffect(()=>{if(t&&a===null){var l=new dbe(G$(G$({},e),{},{map:t}));o(l)}},[t]),a}function fbe(e){var{children:t,options:a}=e,o=hbe(a);return o!==null?t(o):null}x.memo(fbe);var $$={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},H$={options(e,t){e.setOptions(t)},position(e,t){e.setPosition(t)},zIndex(e,t){e.setZIndex(t)}};function pbe(e){var{children:t,anchor:a,options:o,position:l,zIndex:d,onCloseClick:p,onDomReady:g,onContentChanged:v,onPositionChanged:E,onZindexChanged:T,onLoad:b,onUnmount:R}=e,N=x.useContext(Ht),[P,L]=x.useState(null),[M,D]=x.useState(null),[U,B]=x.useState(null),[z,V]=x.useState(null),[G,q]=x.useState(null),[ne,Z]=x.useState(null),le=x.useRef(null);return x.useEffect(()=>{P!==null&&(P.close(),a?P.open(N,a):P.getPosition()&&P.open(N))},[N,P,a]),x.useEffect(()=>{o&&P!==null&&P.setOptions(o)},[P,o]),x.useEffect(()=>{l&&P!==null&&P.setPosition(l)},[l]),x.useEffect(()=>{typeof d=="number"&&P!==null&&P.setZIndex(d)},[d]),x.useEffect(()=>{P&&p&&(M!==null&&google.maps.event.removeListener(M),D(google.maps.event.addListener(P,"closeclick",p)))},[p]),x.useEffect(()=>{P&&g&&(U!==null&&google.maps.event.removeListener(U),B(google.maps.event.addListener(P,"domready",g)))},[g]),x.useEffect(()=>{P&&v&&(z!==null&&google.maps.event.removeListener(z),V(google.maps.event.addListener(P,"content_changed",v)))},[v]),x.useEffect(()=>{P&&E&&(G!==null&&google.maps.event.removeListener(G),q(google.maps.event.addListener(P,"position_changed",E)))},[E]),x.useEffect(()=>{P&&T&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(P,"zindex_changed",T)))},[T]),x.useEffect(()=>{var ee=new google.maps.InfoWindow(o);return L(ee),le.current=document.createElement("div"),p&&D(google.maps.event.addListener(ee,"closeclick",p)),g&&B(google.maps.event.addListener(ee,"domready",g)),v&&V(google.maps.event.addListener(ee,"content_changed",v)),E&&q(google.maps.event.addListener(ee,"position_changed",E)),T&&Z(google.maps.event.addListener(ee,"zindex_changed",T)),ee.setContent(le.current),l&&ee.setPosition(l),d&&ee.setZIndex(d),a?ee.open(N,a):ee.getPosition()?ee.open(N):ei(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),b&&b(ee),()=>{M&&google.maps.event.removeListener(M),z&&google.maps.event.removeListener(z),U&&google.maps.event.removeListener(U),G&&google.maps.event.removeListener(G),ne&&google.maps.event.removeListener(ne),R&&R(ee),ee.close()}},[]),le.current?Nd.createPortal(x.Children.only(t),le.current):null}x.memo(pbe);class P9 extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"containerElement",null),xe(this,"state",{infoWindow:null}),xe(this,"open",(t,a)=>{a?t.open(this.context,a):t.getPosition()?t.open(this.context):ei(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),xe(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var t=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=en({updaterMap:H$,eventMap:$$,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({infoWindow:t}),this.setInfoWindowCallback)}componentDidUpdate(t){this.state.infoWindow!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:H$,eventMap:$$,prevProps:t,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(nn(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Nd.createPortal(x.Children.only(this.props.children),this.containerElement):null}}xe(P9,"contextType",Ht);function z$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Bb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?z$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var K$={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},q$={draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},path(e,t){e.setPath(t)},visible(e,t){e.setVisible(t)}},mbe={};function gbe(e){var{options:t,draggable:a,editable:o,visible:l,path:d,onDblClick:p,onDragEnd:g,onDragStart:v,onMouseDown:E,onMouseMove:T,onMouseOut:b,onMouseOver:R,onMouseUp:N,onRightClick:P,onClick:L,onDrag:M,onLoad:D,onUnmount:U}=e,B=x.useContext(Ht),[z,V]=x.useState(null),[G,q]=x.useState(null),[ne,Z]=x.useState(null),[le,ee]=x.useState(null),[ce,be]=x.useState(null),[ae,fe]=x.useState(null),[me,_e]=x.useState(null),[ue,ve]=x.useState(null),[Ce,Ve]=x.useState(null),[Pe,Ge]=x.useState(null),[nt,Re]=x.useState(null),[wt,It]=x.useState(null);return x.useEffect(()=>{z!==null&&z.setMap(B)},[B]),x.useEffect(()=>{typeof t<"u"&&z!==null&&z.setOptions(t)},[z,t]),x.useEffect(()=>{typeof a<"u"&&z!==null&&z.setDraggable(a)},[z,a]),x.useEffect(()=>{typeof o<"u"&&z!==null&&z.setEditable(o)},[z,o]),x.useEffect(()=>{typeof l<"u"&&z!==null&&z.setVisible(l)},[z,l]),x.useEffect(()=>{typeof d<"u"&&z!==null&&z.setPath(d)},[z,d]),x.useEffect(()=>{z&&p&&(G!==null&&google.maps.event.removeListener(G),q(google.maps.event.addListener(z,"dblclick",p)))},[p]),x.useEffect(()=>{z&&g&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(z,"dragend",g)))},[g]),x.useEffect(()=>{z&&v&&(le!==null&&google.maps.event.removeListener(le),ee(google.maps.event.addListener(z,"dragstart",v)))},[v]),x.useEffect(()=>{z&&E&&(ce!==null&&google.maps.event.removeListener(ce),be(google.maps.event.addListener(z,"mousedown",E)))},[E]),x.useEffect(()=>{z&&T&&(ae!==null&&google.maps.event.removeListener(ae),fe(google.maps.event.addListener(z,"mousemove",T)))},[T]),x.useEffect(()=>{z&&b&&(me!==null&&google.maps.event.removeListener(me),_e(google.maps.event.addListener(z,"mouseout",b)))},[b]),x.useEffect(()=>{z&&R&&(ue!==null&&google.maps.event.removeListener(ue),ve(google.maps.event.addListener(z,"mouseover",R)))},[R]),x.useEffect(()=>{z&&N&&(Ce!==null&&google.maps.event.removeListener(Ce),Ve(google.maps.event.addListener(z,"mouseup",N)))},[N]),x.useEffect(()=>{z&&P&&(Pe!==null&&google.maps.event.removeListener(Pe),Ge(google.maps.event.addListener(z,"rightclick",P)))},[P]),x.useEffect(()=>{z&&L&&(nt!==null&&google.maps.event.removeListener(nt),Re(google.maps.event.addListener(z,"click",L)))},[L]),x.useEffect(()=>{z&&M&&(wt!==null&&google.maps.event.removeListener(wt),It(google.maps.event.addListener(z,"drag",M)))},[M]),x.useEffect(()=>{var lt=new google.maps.Polyline(Bb(Bb({},t||mbe),{},{map:B}));return d&&lt.setPath(d),typeof l<"u"&&lt.setVisible(l),typeof o<"u"&&lt.setEditable(o),typeof a<"u"&&lt.setDraggable(a),p&&q(google.maps.event.addListener(lt,"dblclick",p)),g&&Z(google.maps.event.addListener(lt,"dragend",g)),v&&ee(google.maps.event.addListener(lt,"dragstart",v)),E&&be(google.maps.event.addListener(lt,"mousedown",E)),T&&fe(google.maps.event.addListener(lt,"mousemove",T)),b&&_e(google.maps.event.addListener(lt,"mouseout",b)),R&&ve(google.maps.event.addListener(lt,"mouseover",R)),N&&Ve(google.maps.event.addListener(lt,"mouseup",N)),P&&Ge(google.maps.event.addListener(lt,"rightclick",P)),L&&Re(google.maps.event.addListener(lt,"click",L)),M&&It(google.maps.event.addListener(lt,"drag",M)),V(lt),D&&D(lt),()=>{G!==null&&google.maps.event.removeListener(G),ne!==null&&google.maps.event.removeListener(ne),le!==null&&google.maps.event.removeListener(le),ce!==null&&google.maps.event.removeListener(ce),ae!==null&&google.maps.event.removeListener(ae),me!==null&&google.maps.event.removeListener(me),ue!==null&&google.maps.event.removeListener(ue),Ce!==null&&google.maps.event.removeListener(Ce),Pe!==null&&google.maps.event.removeListener(Pe),nt!==null&&google.maps.event.removeListener(nt),U&&U(lt),lt.setMap(null)}},[]),null}x.memo(gbe);class ybe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{polyline:null}),xe(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var t=new google.maps.Polyline(Bb(Bb({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:q$,eventMap:K$,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{polyline:t}},this.setPolylineCallback)}componentDidUpdate(t){this.state.polyline!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:q$,eventMap:K$,prevProps:t,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),nn(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}xe(ybe,"contextType",Ht);function Y$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function X$(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Y$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var J$={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Q$={draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},path(e,t){e.setPath(t)},paths(e,t){e.setPaths(t)},visible(e,t){e.setVisible(t)}};function vbe(e){var{options:t,draggable:a,editable:o,visible:l,path:d,paths:p,onDblClick:g,onDragEnd:v,onDragStart:E,onMouseDown:T,onMouseMove:b,onMouseOut:R,onMouseOver:N,onMouseUp:P,onRightClick:L,onClick:M,onDrag:D,onLoad:U,onUnmount:B,onEdit:z}=e,V=x.useContext(Ht),[G,q]=x.useState(null),[ne,Z]=x.useState(null),[le,ee]=x.useState(null),[ce,be]=x.useState(null),[ae,fe]=x.useState(null),[me,_e]=x.useState(null),[ue,ve]=x.useState(null),[Ce,Ve]=x.useState(null),[Pe,Ge]=x.useState(null),[nt,Re]=x.useState(null),[wt,It]=x.useState(null),[lt,ze]=x.useState(null);return x.useEffect(()=>{G!==null&&G.setMap(V)},[V]),x.useEffect(()=>{typeof t<"u"&&G!==null&&G.setOptions(t)},[G,t]),x.useEffect(()=>{typeof a<"u"&&G!==null&&G.setDraggable(a)},[G,a]),x.useEffect(()=>{typeof o<"u"&&G!==null&&G.setEditable(o)},[G,o]),x.useEffect(()=>{typeof l<"u"&&G!==null&&G.setVisible(l)},[G,l]),x.useEffect(()=>{typeof d<"u"&&G!==null&&G.setPath(d)},[G,d]),x.useEffect(()=>{typeof p<"u"&&G!==null&&G.setPaths(p)},[G,p]),x.useEffect(()=>{G&&typeof g=="function"&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(G,"dblclick",g)))},[g]),x.useEffect(()=>{G&&(google.maps.event.addListener(G.getPath(),"insert_at",()=>{z==null||z(G)}),google.maps.event.addListener(G.getPath(),"set_at",()=>{z==null||z(G)}),google.maps.event.addListener(G.getPath(),"remove_at",()=>{z==null||z(G)}))},[G,z]),x.useEffect(()=>{G&&typeof v=="function"&&(le!==null&&google.maps.event.removeListener(le),ee(google.maps.event.addListener(G,"dragend",v)))},[v]),x.useEffect(()=>{G&&typeof E=="function"&&(ce!==null&&google.maps.event.removeListener(ce),be(google.maps.event.addListener(G,"dragstart",E)))},[E]),x.useEffect(()=>{G&&typeof T=="function"&&(ae!==null&&google.maps.event.removeListener(ae),fe(google.maps.event.addListener(G,"mousedown",T)))},[T]),x.useEffect(()=>{G&&typeof b=="function"&&(me!==null&&google.maps.event.removeListener(me),_e(google.maps.event.addListener(G,"mousemove",b)))},[b]),x.useEffect(()=>{G&&typeof R=="function"&&(ue!==null&&google.maps.event.removeListener(ue),ve(google.maps.event.addListener(G,"mouseout",R)))},[R]),x.useEffect(()=>{G&&typeof N=="function"&&(Ce!==null&&google.maps.event.removeListener(Ce),Ve(google.maps.event.addListener(G,"mouseover",N)))},[N]),x.useEffect(()=>{G&&typeof P=="function"&&(Pe!==null&&google.maps.event.removeListener(Pe),Ge(google.maps.event.addListener(G,"mouseup",P)))},[P]),x.useEffect(()=>{G&&typeof L=="function"&&(nt!==null&&google.maps.event.removeListener(nt),Re(google.maps.event.addListener(G,"rightclick",L)))},[L]),x.useEffect(()=>{G&&typeof M=="function"&&(wt!==null&&google.maps.event.removeListener(wt),It(google.maps.event.addListener(G,"click",M)))},[M]),x.useEffect(()=>{G&&typeof D=="function"&&(lt!==null&&google.maps.event.removeListener(lt),ze(google.maps.event.addListener(G,"drag",D)))},[D]),x.useEffect(()=>{var He=new google.maps.Polygon(X$(X$({},t),{},{map:V}));return d&&He.setPath(d),p&&He.setPaths(p),typeof l<"u"&&He.setVisible(l),typeof o<"u"&&He.setEditable(o),typeof a<"u"&&He.setDraggable(a),g&&Z(google.maps.event.addListener(He,"dblclick",g)),v&&ee(google.maps.event.addListener(He,"dragend",v)),E&&be(google.maps.event.addListener(He,"dragstart",E)),T&&fe(google.maps.event.addListener(He,"mousedown",T)),b&&_e(google.maps.event.addListener(He,"mousemove",b)),R&&ve(google.maps.event.addListener(He,"mouseout",R)),N&&Ve(google.maps.event.addListener(He,"mouseover",N)),P&&Ge(google.maps.event.addListener(He,"mouseup",P)),L&&Re(google.maps.event.addListener(He,"rightclick",L)),M&&It(google.maps.event.addListener(He,"click",M)),D&&ze(google.maps.event.addListener(He,"drag",D)),q(He),U&&U(He),()=>{ne!==null&&google.maps.event.removeListener(ne),le!==null&&google.maps.event.removeListener(le),ce!==null&&google.maps.event.removeListener(ce),ae!==null&&google.maps.event.removeListener(ae),me!==null&&google.maps.event.removeListener(me),ue!==null&&google.maps.event.removeListener(ue),Ce!==null&&google.maps.event.removeListener(Ce),Pe!==null&&google.maps.event.removeListener(Pe),nt!==null&&google.maps.event.removeListener(nt),wt!==null&&google.maps.event.removeListener(wt),B&&B(He),He.setMap(null)}},[]),null}x.memo(vbe);class _be extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[])}componentDidMount(){var t=this.props.options||{};this.polygon=new google.maps.Polygon(t),this.polygon.setMap(this.context),this.registeredEvents=en({updaterMap:Q$,eventMap:J$,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(t){this.polygon&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:Q$,eventMap:J$,prevProps:t,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),nn(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}xe(_be,"contextType",Ht);function Z$(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Fb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Z$(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z$(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var e8={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},t8={bounds(e,t){e.setBounds(t)},draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},visible(e,t){e.setVisible(t)}};function Ebe(e){var{options:t,bounds:a,draggable:o,editable:l,visible:d,onDblClick:p,onDragEnd:g,onDragStart:v,onMouseDown:E,onMouseMove:T,onMouseOut:b,onMouseOver:R,onMouseUp:N,onRightClick:P,onClick:L,onDrag:M,onBoundsChanged:D,onLoad:U,onUnmount:B}=e,z=x.useContext(Ht),[V,G]=x.useState(null),[q,ne]=x.useState(null),[Z,le]=x.useState(null),[ee,ce]=x.useState(null),[be,ae]=x.useState(null),[fe,me]=x.useState(null),[_e,ue]=x.useState(null),[ve,Ce]=x.useState(null),[Ve,Pe]=x.useState(null),[Ge,nt]=x.useState(null),[Re,wt]=x.useState(null),[It,lt]=x.useState(null),[ze,He]=x.useState(null);return x.useEffect(()=>{V!==null&&V.setMap(z)},[z]),x.useEffect(()=>{typeof t<"u"&&V!==null&&V.setOptions(t)},[V,t]),x.useEffect(()=>{typeof o<"u"&&V!==null&&V.setDraggable(o)},[V,o]),x.useEffect(()=>{typeof l<"u"&&V!==null&&V.setEditable(l)},[V,l]),x.useEffect(()=>{typeof d<"u"&&V!==null&&V.setVisible(d)},[V,d]),x.useEffect(()=>{typeof a<"u"&&V!==null&&V.setBounds(a)},[V,a]),x.useEffect(()=>{V&&p&&(q!==null&&google.maps.event.removeListener(q),ne(google.maps.event.addListener(V,"dblclick",p)))},[p]),x.useEffect(()=>{V&&g&&(Z!==null&&google.maps.event.removeListener(Z),le(google.maps.event.addListener(V,"dragend",g)))},[g]),x.useEffect(()=>{V&&v&&(ee!==null&&google.maps.event.removeListener(ee),ce(google.maps.event.addListener(V,"dragstart",v)))},[v]),x.useEffect(()=>{V&&E&&(be!==null&&google.maps.event.removeListener(be),ae(google.maps.event.addListener(V,"mousedown",E)))},[E]),x.useEffect(()=>{V&&T&&(fe!==null&&google.maps.event.removeListener(fe),me(google.maps.event.addListener(V,"mousemove",T)))},[T]),x.useEffect(()=>{V&&b&&(_e!==null&&google.maps.event.removeListener(_e),ue(google.maps.event.addListener(V,"mouseout",b)))},[b]),x.useEffect(()=>{V&&R&&(ve!==null&&google.maps.event.removeListener(ve),Ce(google.maps.event.addListener(V,"mouseover",R)))},[R]),x.useEffect(()=>{V&&N&&(Ve!==null&&google.maps.event.removeListener(Ve),Pe(google.maps.event.addListener(V,"mouseup",N)))},[N]),x.useEffect(()=>{V&&P&&(Ge!==null&&google.maps.event.removeListener(Ge),nt(google.maps.event.addListener(V,"rightclick",P)))},[P]),x.useEffect(()=>{V&&L&&(Re!==null&&google.maps.event.removeListener(Re),wt(google.maps.event.addListener(V,"click",L)))},[L]),x.useEffect(()=>{V&&M&&(It!==null&&google.maps.event.removeListener(It),lt(google.maps.event.addListener(V,"drag",M)))},[M]),x.useEffect(()=>{V&&D&&(ze!==null&&google.maps.event.removeListener(ze),He(google.maps.event.addListener(V,"bounds_changed",D)))},[D]),x.useEffect(()=>{var tt=new google.maps.Rectangle(Fb(Fb({},t),{},{map:z}));return typeof d<"u"&&tt.setVisible(d),typeof l<"u"&&tt.setEditable(l),typeof o<"u"&&tt.setDraggable(o),typeof a<"u"&&tt.setBounds(a),p&&ne(google.maps.event.addListener(tt,"dblclick",p)),g&&le(google.maps.event.addListener(tt,"dragend",g)),v&&ce(google.maps.event.addListener(tt,"dragstart",v)),E&&ae(google.maps.event.addListener(tt,"mousedown",E)),T&&me(google.maps.event.addListener(tt,"mousemove",T)),b&&ue(google.maps.event.addListener(tt,"mouseout",b)),R&&Ce(google.maps.event.addListener(tt,"mouseover",R)),N&&Pe(google.maps.event.addListener(tt,"mouseup",N)),P&&nt(google.maps.event.addListener(tt,"rightclick",P)),L&&wt(google.maps.event.addListener(tt,"click",L)),M&&lt(google.maps.event.addListener(tt,"drag",M)),D&&He(google.maps.event.addListener(tt,"bounds_changed",D)),G(tt),U&&U(tt),()=>{q!==null&&google.maps.event.removeListener(q),Z!==null&&google.maps.event.removeListener(Z),ee!==null&&google.maps.event.removeListener(ee),be!==null&&google.maps.event.removeListener(be),fe!==null&&google.maps.event.removeListener(fe),_e!==null&&google.maps.event.removeListener(_e),ve!==null&&google.maps.event.removeListener(ve),Ve!==null&&google.maps.event.removeListener(Ve),Ge!==null&&google.maps.event.removeListener(Ge),Re!==null&&google.maps.event.removeListener(Re),It!==null&&google.maps.event.removeListener(It),ze!==null&&google.maps.event.removeListener(ze),B&&B(tt),tt.setMap(null)}},[]),null}x.memo(Ebe);let Sbe=class extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{rectangle:null}),xe(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var t=new google.maps.Rectangle(Fb(Fb({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:t8,eventMap:e8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{rectangle:t}},this.setRectangleCallback)}componentDidUpdate(t){this.state.rectangle!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:t8,eventMap:e8,prevProps:t,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),nn(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}};xe(Sbe,"contextType",Ht);function n8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Wb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?n8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var r8={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},i8={center(e,t){e.setCenter(t)},draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},radius(e,t){e.setRadius(t)},visible(e,t){e.setVisible(t)}},bbe={};function Tbe(e){var{options:t,center:a,radius:o,draggable:l,editable:d,visible:p,onDblClick:g,onDragEnd:v,onDragStart:E,onMouseDown:T,onMouseMove:b,onMouseOut:R,onMouseOver:N,onMouseUp:P,onRightClick:L,onClick:M,onDrag:D,onCenterChanged:U,onRadiusChanged:B,onLoad:z,onUnmount:V}=e,G=x.useContext(Ht),[q,ne]=x.useState(null),[Z,le]=x.useState(null),[ee,ce]=x.useState(null),[be,ae]=x.useState(null),[fe,me]=x.useState(null),[_e,ue]=x.useState(null),[ve,Ce]=x.useState(null),[Ve,Pe]=x.useState(null),[Ge,nt]=x.useState(null),[Re,wt]=x.useState(null),[It,lt]=x.useState(null),[ze,He]=x.useState(null),[tt,Be]=x.useState(null),[zt,Wt]=x.useState(null);return x.useEffect(()=>{q!==null&&q.setMap(G)},[G]),x.useEffect(()=>{typeof t<"u"&&q!==null&&q.setOptions(t)},[q,t]),x.useEffect(()=>{typeof l<"u"&&q!==null&&q.setDraggable(l)},[q,l]),x.useEffect(()=>{typeof d<"u"&&q!==null&&q.setEditable(d)},[q,d]),x.useEffect(()=>{typeof p<"u"&&q!==null&&q.setVisible(p)},[q,p]),x.useEffect(()=>{typeof o=="number"&&q!==null&&q.setRadius(o)},[q,o]),x.useEffect(()=>{typeof a<"u"&&q!==null&&q.setCenter(a)},[q,a]),x.useEffect(()=>{q&&g&&(Z!==null&&google.maps.event.removeListener(Z),le(google.maps.event.addListener(q,"dblclick",g)))},[g]),x.useEffect(()=>{q&&v&&(ee!==null&&google.maps.event.removeListener(ee),ce(google.maps.event.addListener(q,"dragend",v)))},[v]),x.useEffect(()=>{q&&E&&(be!==null&&google.maps.event.removeListener(be),ae(google.maps.event.addListener(q,"dragstart",E)))},[E]),x.useEffect(()=>{q&&T&&(fe!==null&&google.maps.event.removeListener(fe),me(google.maps.event.addListener(q,"mousedown",T)))},[T]),x.useEffect(()=>{q&&b&&(_e!==null&&google.maps.event.removeListener(_e),ue(google.maps.event.addListener(q,"mousemove",b)))},[b]),x.useEffect(()=>{q&&R&&(ve!==null&&google.maps.event.removeListener(ve),Ce(google.maps.event.addListener(q,"mouseout",R)))},[R]),x.useEffect(()=>{q&&N&&(Ve!==null&&google.maps.event.removeListener(Ve),Pe(google.maps.event.addListener(q,"mouseover",N)))},[N]),x.useEffect(()=>{q&&P&&(Ge!==null&&google.maps.event.removeListener(Ge),nt(google.maps.event.addListener(q,"mouseup",P)))},[P]),x.useEffect(()=>{q&&L&&(Re!==null&&google.maps.event.removeListener(Re),wt(google.maps.event.addListener(q,"rightclick",L)))},[L]),x.useEffect(()=>{q&&M&&(It!==null&&google.maps.event.removeListener(It),lt(google.maps.event.addListener(q,"click",M)))},[M]),x.useEffect(()=>{q&&D&&(ze!==null&&google.maps.event.removeListener(ze),He(google.maps.event.addListener(q,"drag",D)))},[D]),x.useEffect(()=>{q&&U&&(tt!==null&&google.maps.event.removeListener(tt),Be(google.maps.event.addListener(q,"center_changed",U)))},[M]),x.useEffect(()=>{q&&B&&(zt!==null&&google.maps.event.removeListener(zt),Wt(google.maps.event.addListener(q,"radius_changed",B)))},[B]),x.useEffect(()=>{var Ct=new google.maps.Circle(Wb(Wb({},t||bbe),{},{map:G}));return typeof o=="number"&&Ct.setRadius(o),typeof a<"u"&&Ct.setCenter(a),typeof o=="number"&&Ct.setRadius(o),typeof p<"u"&&Ct.setVisible(p),typeof d<"u"&&Ct.setEditable(d),typeof l<"u"&&Ct.setDraggable(l),g&&le(google.maps.event.addListener(Ct,"dblclick",g)),v&&ce(google.maps.event.addListener(Ct,"dragend",v)),E&&ae(google.maps.event.addListener(Ct,"dragstart",E)),T&&me(google.maps.event.addListener(Ct,"mousedown",T)),b&&ue(google.maps.event.addListener(Ct,"mousemove",b)),R&&Ce(google.maps.event.addListener(Ct,"mouseout",R)),N&&Pe(google.maps.event.addListener(Ct,"mouseover",N)),P&&nt(google.maps.event.addListener(Ct,"mouseup",P)),L&&wt(google.maps.event.addListener(Ct,"rightclick",L)),M&&lt(google.maps.event.addListener(Ct,"click",M)),D&&He(google.maps.event.addListener(Ct,"drag",D)),U&&Be(google.maps.event.addListener(Ct,"center_changed",U)),B&&Wt(google.maps.event.addListener(Ct,"radius_changed",B)),ne(Ct),z&&z(Ct),()=>{Z!==null&&google.maps.event.removeListener(Z),ee!==null&&google.maps.event.removeListener(ee),be!==null&&google.maps.event.removeListener(be),fe!==null&&google.maps.event.removeListener(fe),_e!==null&&google.maps.event.removeListener(_e),ve!==null&&google.maps.event.removeListener(ve),Ve!==null&&google.maps.event.removeListener(Ve),Ge!==null&&google.maps.event.removeListener(Ge),Re!==null&&google.maps.event.removeListener(Re),It!==null&&google.maps.event.removeListener(It),tt!==null&&google.maps.event.removeListener(tt),zt!==null&&google.maps.event.removeListener(zt),V&&V(Ct),Ct.setMap(null)}},[]),null}x.memo(Tbe);class wbe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{circle:null}),xe(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var t=new google.maps.Circle(Wb(Wb({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:i8,eventMap:r8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{circle:t}},this.setCircleCallback)}componentDidUpdate(t){this.state.circle!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:i8,eventMap:r8,prevProps:t,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var t;this.props.onUnmount&&this.props.onUnmount(this.state.circle),nn(this.registeredEvents),(t=this.state.circle)===null||t===void 0||t.setMap(null)}}render(){return null}}xe(wbe,"contextType",Ht);function a8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Gb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?a8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):a8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var o8={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},s8={add(e,t){e.add(t)},addgeojson(e,t,a){e.addGeoJson(t,a)},contains(e,t){e.contains(t)},foreach(e,t){e.forEach(t)},loadgeojson(e,t,a,o){e.loadGeoJson(t,a,o)},overridestyle(e,t,a){e.overrideStyle(t,a)},remove(e,t){e.remove(t)},revertstyle(e,t){e.revertStyle(t)},controlposition(e,t){e.setControlPosition(t)},controls(e,t){e.setControls(t)},drawingmode(e,t){e.setDrawingMode(t)},map(e,t){e.setMap(t)},style(e,t){e.setStyle(t)},togeojson(e,t){e.toGeoJson(t)}};function Cbe(e){var{options:t,onClick:a,onDblClick:o,onMouseDown:l,onMouseMove:d,onMouseOut:p,onMouseOver:g,onMouseUp:v,onRightClick:E,onAddFeature:T,onRemoveFeature:b,onRemoveProperty:R,onSetGeometry:N,onSetProperty:P,onLoad:L,onUnmount:M}=e,D=x.useContext(Ht),[U,B]=x.useState(null),[z,V]=x.useState(null),[G,q]=x.useState(null),[ne,Z]=x.useState(null),[le,ee]=x.useState(null),[ce,be]=x.useState(null),[ae,fe]=x.useState(null),[me,_e]=x.useState(null),[ue,ve]=x.useState(null),[Ce,Ve]=x.useState(null),[Pe,Ge]=x.useState(null),[nt,Re]=x.useState(null),[wt,It]=x.useState(null),[lt,ze]=x.useState(null);return x.useEffect(()=>{U!==null&&U.setMap(D)},[D]),x.useEffect(()=>{U&&o&&(z!==null&&google.maps.event.removeListener(z),V(google.maps.event.addListener(U,"dblclick",o)))},[o]),x.useEffect(()=>{U&&l&&(G!==null&&google.maps.event.removeListener(G),q(google.maps.event.addListener(U,"mousedown",l)))},[l]),x.useEffect(()=>{U&&d&&(ne!==null&&google.maps.event.removeListener(ne),Z(google.maps.event.addListener(U,"mousemove",d)))},[d]),x.useEffect(()=>{U&&p&&(le!==null&&google.maps.event.removeListener(le),ee(google.maps.event.addListener(U,"mouseout",p)))},[p]),x.useEffect(()=>{U&&g&&(ce!==null&&google.maps.event.removeListener(ce),be(google.maps.event.addListener(U,"mouseover",g)))},[g]),x.useEffect(()=>{U&&v&&(ae!==null&&google.maps.event.removeListener(ae),fe(google.maps.event.addListener(U,"mouseup",v)))},[v]),x.useEffect(()=>{U&&E&&(me!==null&&google.maps.event.removeListener(me),_e(google.maps.event.addListener(U,"rightclick",E)))},[E]),x.useEffect(()=>{U&&a&&(ue!==null&&google.maps.event.removeListener(ue),ve(google.maps.event.addListener(U,"click",a)))},[a]),x.useEffect(()=>{U&&T&&(Ce!==null&&google.maps.event.removeListener(Ce),Ve(google.maps.event.addListener(U,"addfeature",T)))},[T]),x.useEffect(()=>{U&&b&&(Pe!==null&&google.maps.event.removeListener(Pe),Ge(google.maps.event.addListener(U,"removefeature",b)))},[b]),x.useEffect(()=>{U&&R&&(nt!==null&&google.maps.event.removeListener(nt),Re(google.maps.event.addListener(U,"removeproperty",R)))},[R]),x.useEffect(()=>{U&&N&&(wt!==null&&google.maps.event.removeListener(wt),It(google.maps.event.addListener(U,"setgeometry",N)))},[N]),x.useEffect(()=>{U&&P&&(lt!==null&&google.maps.event.removeListener(lt),ze(google.maps.event.addListener(U,"setproperty",P)))},[P]),x.useEffect(()=>{if(D!==null){var He=new google.maps.Data(Gb(Gb({},t),{},{map:D}));o&&V(google.maps.event.addListener(He,"dblclick",o)),l&&q(google.maps.event.addListener(He,"mousedown",l)),d&&Z(google.maps.event.addListener(He,"mousemove",d)),p&&ee(google.maps.event.addListener(He,"mouseout",p)),g&&be(google.maps.event.addListener(He,"mouseover",g)),v&&fe(google.maps.event.addListener(He,"mouseup",v)),E&&_e(google.maps.event.addListener(He,"rightclick",E)),a&&ve(google.maps.event.addListener(He,"click",a)),T&&Ve(google.maps.event.addListener(He,"addfeature",T)),b&&Ge(google.maps.event.addListener(He,"removefeature",b)),R&&Re(google.maps.event.addListener(He,"removeproperty",R)),N&&It(google.maps.event.addListener(He,"setgeometry",N)),P&&ze(google.maps.event.addListener(He,"setproperty",P)),B(He),L&&L(He)}return()=>{U&&(z!==null&&google.maps.event.removeListener(z),G!==null&&google.maps.event.removeListener(G),ne!==null&&google.maps.event.removeListener(ne),le!==null&&google.maps.event.removeListener(le),ce!==null&&google.maps.event.removeListener(ce),ae!==null&&google.maps.event.removeListener(ae),me!==null&&google.maps.event.removeListener(me),ue!==null&&google.maps.event.removeListener(ue),Ce!==null&&google.maps.event.removeListener(Ce),Pe!==null&&google.maps.event.removeListener(Pe),nt!==null&&google.maps.event.removeListener(nt),wt!==null&&google.maps.event.removeListener(wt),lt!==null&&google.maps.event.removeListener(lt),M&&M(U),U.setMap(null))}},[]),null}x.memo(Cbe);class Rbe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{data:null}),xe(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var t=new google.maps.Data(Gb(Gb({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:s8,eventMap:o8,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({data:t}),this.setDataCallback)}}componentDidUpdate(t){this.state.data!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:s8,eventMap:o8,prevProps:t,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),nn(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}xe(Rbe,"contextType",Ht);function c8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function l8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?c8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var u8={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},d8={options(e,t){e.setOptions(t)},url(e,t){e.setUrl(t)},zIndex(e,t){e.setZIndex(t)}};class Obe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{kmlLayer:null}),xe(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var t=new google.maps.KmlLayer(l8(l8({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:d8,eventMap:u8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{kmlLayer:t}},this.setKmlLayerCallback)}componentDidUpdate(t){this.state.kmlLayer!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:d8,eventMap:u8,prevProps:t,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),nn(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}xe(Obe,"contextType",Ht);function x9(e,t){return typeof t=="function"?t(e.offsetWidth,e.offsetHeight):{x:0,y:0}}function Abe(e,t){return new t(e.lat,e.lng)}function Ibe(e,t){return new t(new google.maps.LatLng(e.ne.lat,e.ne.lng),new google.maps.LatLng(e.sw.lat,e.sw.lng))}function Nbe(e,t,a){return e instanceof t?e:a(e,t)}function Pbe(e,t,a){return e instanceof t?e:a(e,t)}function xbe(e,t,a){var o=e&&e.fromLatLngToDivPixel(a.getNorthEast()),l=e&&e.fromLatLngToDivPixel(a.getSouthWest());return o&&l?{left:"".concat(l.x+t.x,"px"),top:"".concat(o.y+t.y,"px"),width:"".concat(o.x-l.x-t.x,"px"),height:"".concat(l.y-o.y-t.y,"px")}:{left:"-9999px",top:"-9999px"}}function Dbe(e,t,a){var o=e&&e.fromLatLngToDivPixel(a);if(o){var{x:l,y:d}=o;return{left:"".concat(l+t.x,"px"),top:"".concat(d+t.y,"px")}}return{left:"-9999px",top:"-9999px"}}function D9(e,t,a,o){return a!==void 0?xbe(e,t,Pbe(a,google.maps.LatLngBounds,Ibe)):Dbe(e,t,Nbe(o,google.maps.LatLng,Abe))}function Lbe(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.height&&e.height===t.height}function h8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function kbe(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?h8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Mbe(e,t,a,o,l){class d extends google.maps.OverlayView{constructor(g,v,E,T){super(),this.container=g,this.pane=v,this.position=E,this.bounds=T}onAdd(){var g,v=(g=this.getPanes())===null||g===void 0?void 0:g[this.pane];v==null||v.appendChild(this.container)}draw(){var g=this.getProjection(),v=kbe({},this.container?x9(this.container,l):{x:0,y:0}),E=D9(g,v,this.bounds,this.position);for(var[T,b]of Object.entries(E))this.container.style[T]=b}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new d(e,t,a,o)}function f8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Ube(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?f8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function p8(e){if(!e)return"";var t=e instanceof google.maps.LatLng?e:new google.maps.LatLng(e.lat,e.lng);return t+""}function m8(e){if(!e)return"";var t=e instanceof google.maps.LatLngBounds?e:new google.maps.LatLngBounds(new google.maps.LatLng(e.south,e.east),new google.maps.LatLng(e.north,e.west));return t+""}function jbe(e){var{position:t,bounds:a,mapPaneName:o,zIndex:l,onLoad:d,onUnmount:p,getPixelPositionOffset:g,children:v}=e,E=x.useContext(Ht),T=x.useMemo(()=>{var R=document.createElement("div");return R.style.position="absolute",R},[]),b=x.useMemo(()=>Mbe(T,o,t,a,g),[T,o,t,a]);return x.useEffect(()=>(d==null||d(b),b==null||b.setMap(E),()=>{p==null||p(b),b==null||b.setMap(null)}),[E,b]),x.useEffect(()=>{T.style.zIndex="".concat(l)},[l,T]),Nd.createPortal(v,T)}x.memo(jbe);class _p extends x.PureComponent{constructor(t){super(t),xe(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),xe(this,"updatePane",()=>{var o=this.props.mapPaneName,l=this.overlayView.getPanes();ei(!!o,"OverlayView requires props.mapPaneName but got %s",o),l?this.setState({paneEl:l[o]}):this.setState({paneEl:null})}),xe(this,"onAdd",()=>{var o,l;this.updatePane(),(o=(l=this.props).onLoad)===null||o===void 0||o.call(l,this.overlayView)}),xe(this,"onPositionElement",()=>{var o=this.overlayView.getProjection(),l=Ube({x:0,y:0},this.containerRef.current?x9(this.containerRef.current,this.props.getPixelPositionOffset):{}),d=D9(o,l,this.props.bounds,this.props.position);if(!Lbe(d,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,g,v,E;this.setState({containerStyle:{top:(p=d.top)!==null&&p!==void 0?p:0,left:(g=d.left)!==null&&g!==void 0?g:0,width:(v=d.width)!==null&&v!==void 0?v:0,height:(E=d.height)!==null&&E!==void 0?E:0,position:"absolute"}})}}),xe(this,"draw",()=>{this.onPositionElement()}),xe(this,"onRemove",()=>{var o,l;this.setState(()=>({paneEl:null})),(o=(l=this.props).onUnmount)===null||o===void 0||o.call(l,this.overlayView)}),this.containerRef=x.createRef();var a=new google.maps.OverlayView;a.onAdd=this.onAdd,a.draw=this.draw,a.onRemove=this.onRemove,this.overlayView=a}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(t){var a=p8(t.position),o=p8(this.props.position),l=m8(t.bounds),d=m8(this.props.bounds);(a!==o||l!==d)&&this.overlayView.draw(),t.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var t=this.state.paneEl;return t?Nd.createPortal(C.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:x.Children.only(this.props.children)}),t):null}}xe(_p,"FLOAT_PANE","floatPane");xe(_p,"MAP_PANE","mapPane");xe(_p,"MARKER_LAYER","markerLayer");xe(_p,"OVERLAY_LAYER","overlayLayer");xe(_p,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");xe(_p,"contextType",Ht);function Vbe(){}function g8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function y8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?g8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var v8={onDblClick:"dblclick",onClick:"click"},_8={opacity(e,t){e.setOpacity(t)}};function Bbe(e){var{url:t,bounds:a,options:o,visible:l}=e,d=x.useContext(Ht),p=new google.maps.LatLngBounds(new google.maps.LatLng(a.south,a.west),new google.maps.LatLng(a.north,a.east)),g=x.useMemo(()=>new google.maps.GroundOverlay(t,p,o),[]);return x.useEffect(()=>{g!==null&&g.setMap(d)},[d]),x.useEffect(()=>{typeof t<"u"&&g!==null&&(g.set("url",t),g.setMap(d))},[g,t]),x.useEffect(()=>{typeof l<"u"&&g!==null&&g.setOpacity(l?1:0)},[g,l]),x.useEffect(()=>{var v=new google.maps.LatLngBounds(new google.maps.LatLng(a.south,a.west),new google.maps.LatLng(a.north,a.east));typeof a<"u"&&g!==null&&(g.set("bounds",v),g.setMap(d))},[g,a]),null}x.memo(Bbe);class L9 extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{groundOverlay:null}),xe(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){ei(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var t=new google.maps.GroundOverlay(this.props.url,this.props.bounds,y8(y8({},this.props.options),{},{map:this.context}));this.registeredEvents=en({updaterMap:_8,eventMap:v8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{groundOverlay:t}},this.setGroundOverlayCallback)}componentDidUpdate(t){this.state.groundOverlay!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:_8,eventMap:v8,prevProps:t,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}xe(L9,"defaultProps",{onLoad:Vbe});xe(L9,"contextType",Ht);function E8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function $b(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?E8(Object(a),!0).forEach(function(o){xe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}var S8={},b8={data(e,t){e.setData(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)}};function Fbe(e){var{data:t,onLoad:a,onUnmount:o,options:l}=e,d=x.useContext(Ht),[p,g]=x.useState(null);return x.useEffect(()=>{google.maps.visualization||ei(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),x.useEffect(()=>{ei(!!t,"data property is required in HeatmapLayer %s",t)},[t]),x.useEffect(()=>{p!==null&&p.setMap(d)},[d]),x.useEffect(()=>{l&&p!==null&&p.setOptions(l)},[p,l]),x.useEffect(()=>{var v=new google.maps.visualization.HeatmapLayer($b($b({},l),{},{data:t,map:d}));return g(v),a&&a(v),()=>{p!==null&&(o&&o(p),p.setMap(null))}},[]),null}x.memo(Fbe);class Wbe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{heatmapLayer:null}),xe(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){ei(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),ei(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var t=new google.maps.visualization.HeatmapLayer($b($b({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=en({updaterMap:b8,eventMap:S8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{heatmapLayer:t}},this.setHeatmapLayerCallback)}componentDidUpdate(t){nn(this.registeredEvents),this.registeredEvents=en({updaterMap:b8,eventMap:S8,prevProps:t,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),nn(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}xe(Wbe,"contextType",Ht);var T8={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},w8={register(e,t,a){e.registerPanoProvider(t,a)},links(e,t){e.setLinks(t)},motionTracking(e,t){e.setMotionTracking(t)},options(e,t){e.setOptions(t)},pano(e,t){e.setPano(t)},position(e,t){e.setPosition(t)},pov(e,t){e.setPov(t)},visible(e,t){e.setVisible(t)},zoom(e,t){e.setZoom(t)}};class Gbe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{streetViewPanorama:null}),xe(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var t,a,o=(t=(a=this.context)===null||a===void 0?void 0:a.getStreetView())!==null&&t!==void 0?t:null;this.registeredEvents=en({updaterMap:w8,eventMap:T8,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({streetViewPanorama:o}),this.setStreetViewPanoramaCallback)}componentDidUpdate(t){this.state.streetViewPanorama!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:w8,eventMap:T8,prevProps:t,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),nn(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}xe(Gbe,"contextType",Ht);class $be extends x.PureComponent{constructor(){super(...arguments),xe(this,"state",{streetViewService:null}),xe(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var t=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:t}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}xe($be,"contextType",Ht);var C8={onDirectionsChanged:"directions_changed"},R8={directions(e,t){e.setDirections(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},panel(e,t){e.setPanel(t)},routeIndex(e,t){e.setRouteIndex(t)}};class k9 extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"state",{directionsRenderer:null}),xe(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var t=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=en({updaterMap:R8,eventMap:C8,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{directionsRenderer:t}},this.setDirectionsRendererCallback)}componentDidUpdate(t){this.state.directionsRenderer!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:R8,eventMap:C8,prevProps:t,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),nn(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}xe(k9,"contextType",Ht);var O8={onPlacesChanged:"places_changed"},A8={bounds(e,t){e.setBounds(t)}};class Hbe extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"containerElement",x.createRef()),xe(this,"state",{searchBox:null}),xe(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(ei(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var t=this.containerElement.current.querySelector("input");if(t!==null){var a=new google.maps.places.SearchBox(t,this.props.options);this.registeredEvents=en({updaterMap:A8,eventMap:O8,prevProps:{},nextProps:this.props,instance:a}),this.setState(function(){return{searchBox:a}},this.setSearchBoxCallback)}}}componentDidUpdate(t){this.state.searchBox!==null&&(nn(this.registeredEvents),this.registeredEvents=en({updaterMap:A8,eventMap:O8,prevProps:t,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),nn(this.registeredEvents))}render(){return C.jsx("div",{ref:this.containerElement,children:x.Children.only(this.props.children)})}}xe(Hbe,"contextType",Ht);var I8={onPlaceChanged:"place_changed"},N8={bounds(e,t){e.setBounds(t)},restrictions(e,t){e.setComponentRestrictions(t)},fields(e,t){e.setFields(t)},options(e,t){e.setOptions(t)},types(e,t){e.setTypes(t)}};class M9 extends x.PureComponent{constructor(){super(...arguments),xe(this,"registeredEvents",[]),xe(this,"containerElement",x.createRef()),xe(this,"state",{autocomplete:null}),xe(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var t;ei(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var a=(t=this.containerElement.current)===null||t===void 0?void 0:t.querySelector("input");if(a){var o=new google.maps.places.Autocomplete(a,this.props.options);this.registeredEvents=en({updaterMap:N8,eventMap:I8,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({autocomplete:o}),this.setAutocompleteCallback)}}componentDidUpdate(t){nn(this.registeredEvents),this.registeredEvents=en({updaterMap:N8,eventMap:I8,prevProps:t,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&nn(this.registeredEvents)}render(){return C.jsx("div",{ref:this.containerElement,className:this.props.className,children:x.Children.only(this.props.children)})}}xe(M9,"defaultProps",{className:""});xe(M9,"contextType",Ht);const zbe={lat:12.9716,lng:77.5946},Kbe={width:"100%",height:"400px",borderRadius:"0.5rem"},qbe=()=>{const[e,t]=x.useState(zbe),[a,o]=x.useState([]),[l,d]=x.useState(null),[p,g]=x.useState(!1),[v,E]=x.useState({name:"",description:"",type:"crop"}),[T,b]=x.useState(!1),R={mapTypeControl:!0,streetViewControl:!0,fullscreenControl:!0,styles:[{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}]};x.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(M=>{const D={lat:M.coords.latitude,lng:M.coords.longitude};t(D)},M=>{console.error("Error getting location:",M)})},[]);const N=M=>{if(p&&M.latLng){const D={id:Date.now(),name:v.name||"New Farm Location",position:{lat:M.latLng.lat(),lng:M.latLng.lng()},description:v.description||"Farm location description",type:v.type};o([...a,D]),g(!1),E({name:"",description:"",type:"crop"})}},P=M=>{o(a.filter(D=>D.id!==M)),d(null)},L=M=>{switch(M){case"crop":return"https://maps.google.com/mapfiles/ms/icons/green-dot.png";case"livestock":return"https://maps.google.com/mapfiles/ms/icons/blue-dot.png";case"storage":return"https://maps.google.com/mapfiles/ms/icons/yellow-dot.png";default:return"https://maps.google.com/mapfiles/ms/icons/red-dot.png"}};return C.jsxs("div",{className:"chart-container",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-lg font-semibold",children:"Farm Locations"}),C.jsx("button",{className:`btn ${p?"btn-secondary":"btn-primary"} flex items-center gap-2`,onClick:()=>g(!p),children:p?"Cancel":C.jsxs(C.Fragment,{children:[C.jsx(vp,{size:16})," Add Location"]})})]}),p&&C.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[C.jsx("h3",{className:"font-semibold mb-2",children:"Add New Location"}),C.jsxs("div",{className:"space-y-3",children:[C.jsx("input",{type:"text",placeholder:"Location Name",className:"w-full p-2 border rounded",value:v.name,onChange:M=>E({...v,name:M.target.value})}),C.jsx("textarea",{placeholder:"Description",className:"w-full p-2 border rounded",value:v.description,onChange:M=>E({...v,description:M.target.value})}),C.jsxs("select",{className:"w-full p-2 border rounded",value:v.type,onChange:M=>E({...v,type:M.target.value}),children:[C.jsx("option",{value:"crop",children:"Crop Farm"}),C.jsx("option",{value:"livestock",children:"Livestock Farm"}),C.jsx("option",{value:"storage",children:"Storage Facility"})]}),C.jsx("p",{className:"text-sm text-gray-600",children:"Click on the map to add the location"})]})]}),C.jsx("div",{className:"relative w-full h-[400px] bg-gray-100 rounded-lg overflow-hidden",children:C.jsx(L1,{googleMapsApiKey:"AIzaSyCfM9DyyPMZqY-84K7ottW1G1CPxJ51rf4",onLoad:()=>b(!0),children:T&&C.jsxs(E9,{mapContainerStyle:Kbe,center:e,zoom:13,options:R,onClick:N,children:[C.jsx(lP,{position:e,icon:{url:"https://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:new window.google.maps.Size(40,40)}}),a.map(M=>C.jsx(lP,{position:M.position,onClick:()=>d(M),icon:{url:L(M.type),scaledSize:new window.google.maps.Size(30,30)}},M.id)),l&&C.jsx(P9,{position:l.position,onCloseClick:()=>d(null),children:C.jsxs("div",{className:"p-2",children:[C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsx("h3",{className:"font-semibold text-gray-800",children:l.name}),C.jsx("button",{onClick:()=>P(l.id),className:"text-red-500 hover:text-red-700",children:C.jsx(D1,{size:16})})]}),C.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description}),C.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Type: ",l.type]}),C.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[C.jsxs("p",{children:["Lat: ",l.position.lat.toFixed(4)]}),C.jsxs("p",{children:["Lng: ",l.position.lng.toFixed(4)]})]})]})})]})})})]})};function U9(e){var t,a,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(a=U9(e[t]))&&(o&&(o+=" "),o+=a)}else for(a in e)e[a]&&(o&&(o+=" "),o+=a);return o}function Sn(){for(var e,t,a=0,o="",l=arguments.length;a<l;a++)(e=arguments[a])&&(t=U9(e))&&(o&&(o+=" "),o+=t);return o}const j1="-",Ybe=e=>{const t=Jbe(e),{conflictingClassGroups:a,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:p=>{const g=p.split(j1);return g[0]===""&&g.length!==1&&g.shift(),j9(g,t)||Xbe(p)},getConflictingClassGroupIds:(p,g)=>{const v=a[p]||[];return g&&o[p]?[...v,...o[p]]:v}}},j9=(e,t)=>{var p;if(e.length===0)return t.classGroupId;const a=e[0],o=t.nextPart.get(a),l=o?j9(e.slice(1),o):void 0;if(l)return l;if(t.validators.length===0)return;const d=e.join(j1);return(p=t.validators.find(({validator:g})=>g(d)))==null?void 0:p.classGroupId},P8=/^\[(.+)\]$/,Xbe=e=>{if(P8.test(e)){const t=P8.exec(e)[1],a=t==null?void 0:t.substring(0,t.indexOf(":"));if(a)return"arbitrary.."+a}},Jbe=e=>{const{theme:t,prefix:a}=e,o={nextPart:new Map,validators:[]};return Zbe(Object.entries(e.classGroups),a).forEach(([d,p])=>{hP(p,o,d,t)}),o},hP=(e,t,a,o)=>{e.forEach(l=>{if(typeof l=="string"){const d=l===""?t:x8(t,l);d.classGroupId=a;return}if(typeof l=="function"){if(Qbe(l)){hP(l(o),t,a,o);return}t.validators.push({validator:l,classGroupId:a});return}Object.entries(l).forEach(([d,p])=>{hP(p,x8(t,d),a,o)})})},x8=(e,t)=>{let a=e;return t.split(j1).forEach(o=>{a.nextPart.has(o)||a.nextPart.set(o,{nextPart:new Map,validators:[]}),a=a.nextPart.get(o)}),a},Qbe=e=>e.isThemeGetter,Zbe=(e,t)=>t?e.map(([a,o])=>{const l=o.map(d=>typeof d=="string"?t+d:typeof d=="object"?Object.fromEntries(Object.entries(d).map(([p,g])=>[t+p,g])):d);return[a,l]}):e,eTe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,a=new Map,o=new Map;const l=(d,p)=>{a.set(d,p),t++,t>e&&(t=0,o=a,a=new Map)};return{get(d){let p=a.get(d);if(p!==void 0)return p;if((p=o.get(d))!==void 0)return l(d,p),p},set(d,p){a.has(d)?a.set(d,p):l(d,p)}}},V9="!",tTe=e=>{const{separator:t,experimentalParseClassName:a}=e,o=t.length===1,l=t[0],d=t.length,p=g=>{const v=[];let E=0,T=0,b;for(let M=0;M<g.length;M++){let D=g[M];if(E===0){if(D===l&&(o||g.slice(M,M+d)===t)){v.push(g.slice(T,M)),T=M+d;continue}if(D==="/"){b=M;continue}}D==="["?E++:D==="]"&&E--}const R=v.length===0?g:g.substring(T),N=R.startsWith(V9),P=N?R.substring(1):R,L=b&&b>T?b-T:void 0;return{modifiers:v,hasImportantModifier:N,baseClassName:P,maybePostfixModifierPosition:L}};return a?g=>a({className:g,parseClassName:p}):p},nTe=e=>{if(e.length<=1)return e;const t=[];let a=[];return e.forEach(o=>{o[0]==="["?(t.push(...a.sort(),o),a=[]):a.push(o)}),t.push(...a.sort()),t},rTe=e=>({cache:eTe(e.cacheSize),parseClassName:tTe(e),...Ybe(e)}),iTe=/\s+/,aTe=(e,t)=>{const{parseClassName:a,getClassGroupId:o,getConflictingClassGroupIds:l}=t,d=[],p=e.trim().split(iTe);let g="";for(let v=p.length-1;v>=0;v-=1){const E=p[v],{modifiers:T,hasImportantModifier:b,baseClassName:R,maybePostfixModifierPosition:N}=a(E);let P=!!N,L=o(P?R.substring(0,N):R);if(!L){if(!P){g=E+(g.length>0?" "+g:g);continue}if(L=o(R),!L){g=E+(g.length>0?" "+g:g);continue}P=!1}const M=nTe(T).join(":"),D=b?M+V9:M,U=D+L;if(d.includes(U))continue;d.push(U);const B=l(L,P);for(let z=0;z<B.length;++z){const V=B[z];d.push(D+V)}g=E+(g.length>0?" "+g:g)}return g};function oTe(){let e=0,t,a,o="";for(;e<arguments.length;)(t=arguments[e++])&&(a=B9(t))&&(o&&(o+=" "),o+=a);return o}const B9=e=>{if(typeof e=="string")return e;let t,a="";for(let o=0;o<e.length;o++)e[o]&&(t=B9(e[o]))&&(a&&(a+=" "),a+=t);return a};function sTe(e,...t){let a,o,l,d=p;function p(v){const E=t.reduce((T,b)=>b(T),e());return a=rTe(E),o=a.cache.get,l=a.cache.set,d=g,g(v)}function g(v){const E=o(v);if(E)return E;const T=aTe(v,a);return l(v,T),T}return function(){return d(oTe.apply(null,arguments))}}const or=e=>{const t=a=>a[e]||[];return t.isThemeGetter=!0,t},F9=/^\[(?:([a-z-]+):)?(.+)\]$/i,cTe=/^\d+\/\d+$/,lTe=new Set(["px","full","screen"]),uTe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,dTe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,hTe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fTe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,pTe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,dc=e=>xf(e)||lTe.has(e)||cTe.test(e),yl=e=>Ep(e,"length",bTe),xf=e=>!!e&&!Number.isNaN(Number(e)),xI=e=>Ep(e,"number",xf),Eg=e=>!!e&&Number.isInteger(Number(e)),mTe=e=>e.endsWith("%")&&xf(e.slice(0,-1)),$t=e=>F9.test(e),vl=e=>uTe.test(e),gTe=new Set(["length","size","percentage"]),yTe=e=>Ep(e,gTe,W9),vTe=e=>Ep(e,"position",W9),_Te=new Set(["image","url"]),ETe=e=>Ep(e,_Te,wTe),STe=e=>Ep(e,"",TTe),Sg=()=>!0,Ep=(e,t,a)=>{const o=F9.exec(e);return o?o[1]?typeof t=="string"?o[1]===t:t.has(o[1]):a(o[2]):!1},bTe=e=>dTe.test(e)&&!hTe.test(e),W9=()=>!1,TTe=e=>fTe.test(e),wTe=e=>pTe.test(e),CTe=()=>{const e=or("colors"),t=or("spacing"),a=or("blur"),o=or("brightness"),l=or("borderColor"),d=or("borderRadius"),p=or("borderSpacing"),g=or("borderWidth"),v=or("contrast"),E=or("grayscale"),T=or("hueRotate"),b=or("invert"),R=or("gap"),N=or("gradientColorStops"),P=or("gradientColorStopPositions"),L=or("inset"),M=or("margin"),D=or("opacity"),U=or("padding"),B=or("saturate"),z=or("scale"),V=or("sepia"),G=or("skew"),q=or("space"),ne=or("translate"),Z=()=>["auto","contain","none"],le=()=>["auto","hidden","clip","visible","scroll"],ee=()=>["auto",$t,t],ce=()=>[$t,t],be=()=>["",dc,yl],ae=()=>["auto",xf,$t],fe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],me=()=>["solid","dashed","dotted","double","none"],_e=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ue=()=>["start","end","center","between","around","evenly","stretch"],ve=()=>["","0",$t],Ce=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ve=()=>[xf,$t];return{cacheSize:500,separator:":",theme:{colors:[Sg],spacing:[dc,yl],blur:["none","",vl,$t],brightness:Ve(),borderColor:[e],borderRadius:["none","","full",vl,$t],borderSpacing:ce(),borderWidth:be(),contrast:Ve(),grayscale:ve(),hueRotate:Ve(),invert:ve(),gap:ce(),gradientColorStops:[e],gradientColorStopPositions:[mTe,yl],inset:ee(),margin:ee(),opacity:Ve(),padding:ce(),saturate:Ve(),scale:Ve(),sepia:ve(),skew:Ve(),space:ce(),translate:ce()},classGroups:{aspect:[{aspect:["auto","square","video",$t]}],container:["container"],columns:[{columns:[vl]}],"break-after":[{"break-after":Ce()}],"break-before":[{"break-before":Ce()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...fe(),$t]}],overflow:[{overflow:le()}],"overflow-x":[{"overflow-x":le()}],"overflow-y":[{"overflow-y":le()}],overscroll:[{overscroll:Z()}],"overscroll-x":[{"overscroll-x":Z()}],"overscroll-y":[{"overscroll-y":Z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[L]}],"inset-x":[{"inset-x":[L]}],"inset-y":[{"inset-y":[L]}],start:[{start:[L]}],end:[{end:[L]}],top:[{top:[L]}],right:[{right:[L]}],bottom:[{bottom:[L]}],left:[{left:[L]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Eg,$t]}],basis:[{basis:ee()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",$t]}],grow:[{grow:ve()}],shrink:[{shrink:ve()}],order:[{order:["first","last","none",Eg,$t]}],"grid-cols":[{"grid-cols":[Sg]}],"col-start-end":[{col:["auto",{span:["full",Eg,$t]},$t]}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":[Sg]}],"row-start-end":[{row:["auto",{span:[Eg,$t]},$t]}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",$t]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",$t]}],gap:[{gap:[R]}],"gap-x":[{"gap-x":[R]}],"gap-y":[{"gap-y":[R]}],"justify-content":[{justify:["normal",...ue()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ue(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ue(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[U]}],px:[{px:[U]}],py:[{py:[U]}],ps:[{ps:[U]}],pe:[{pe:[U]}],pt:[{pt:[U]}],pr:[{pr:[U]}],pb:[{pb:[U]}],pl:[{pl:[U]}],m:[{m:[M]}],mx:[{mx:[M]}],my:[{my:[M]}],ms:[{ms:[M]}],me:[{me:[M]}],mt:[{mt:[M]}],mr:[{mr:[M]}],mb:[{mb:[M]}],ml:[{ml:[M]}],"space-x":[{"space-x":[q]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[q]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",$t,t]}],"min-w":[{"min-w":[$t,t,"min","max","fit"]}],"max-w":[{"max-w":[$t,t,"none","full","min","max","fit","prose",{screen:[vl]},vl]}],h:[{h:[$t,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[$t,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[$t,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[$t,t,"auto","min","max","fit"]}],"font-size":[{text:["base",vl,yl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",xI]}],"font-family":[{font:[Sg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",$t]}],"line-clamp":[{"line-clamp":["none",xf,xI]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",dc,$t]}],"list-image":[{"list-image":["none",$t]}],"list-style-type":[{list:["none","disc","decimal",$t]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[D]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...me(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",dc,yl]}],"underline-offset":[{"underline-offset":["auto",dc,$t]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ce()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$t]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$t]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[D]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...fe(),vTe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yTe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ETe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[P]}],"gradient-via-pos":[{via:[P]}],"gradient-to-pos":[{to:[P]}],"gradient-from":[{from:[N]}],"gradient-via":[{via:[N]}],"gradient-to":[{to:[N]}],rounded:[{rounded:[d]}],"rounded-s":[{"rounded-s":[d]}],"rounded-e":[{"rounded-e":[d]}],"rounded-t":[{"rounded-t":[d]}],"rounded-r":[{"rounded-r":[d]}],"rounded-b":[{"rounded-b":[d]}],"rounded-l":[{"rounded-l":[d]}],"rounded-ss":[{"rounded-ss":[d]}],"rounded-se":[{"rounded-se":[d]}],"rounded-ee":[{"rounded-ee":[d]}],"rounded-es":[{"rounded-es":[d]}],"rounded-tl":[{"rounded-tl":[d]}],"rounded-tr":[{"rounded-tr":[d]}],"rounded-br":[{"rounded-br":[d]}],"rounded-bl":[{"rounded-bl":[d]}],"border-w":[{border:[g]}],"border-w-x":[{"border-x":[g]}],"border-w-y":[{"border-y":[g]}],"border-w-s":[{"border-s":[g]}],"border-w-e":[{"border-e":[g]}],"border-w-t":[{"border-t":[g]}],"border-w-r":[{"border-r":[g]}],"border-w-b":[{"border-b":[g]}],"border-w-l":[{"border-l":[g]}],"border-opacity":[{"border-opacity":[D]}],"border-style":[{border:[...me(),"hidden"]}],"divide-x":[{"divide-x":[g]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[g]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[D]}],"divide-style":[{divide:me()}],"border-color":[{border:[l]}],"border-color-x":[{"border-x":[l]}],"border-color-y":[{"border-y":[l]}],"border-color-s":[{"border-s":[l]}],"border-color-e":[{"border-e":[l]}],"border-color-t":[{"border-t":[l]}],"border-color-r":[{"border-r":[l]}],"border-color-b":[{"border-b":[l]}],"border-color-l":[{"border-l":[l]}],"divide-color":[{divide:[l]}],"outline-style":[{outline:["",...me()]}],"outline-offset":[{"outline-offset":[dc,$t]}],"outline-w":[{outline:[dc,yl]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:be()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[D]}],"ring-offset-w":[{"ring-offset":[dc,yl]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",vl,STe]}],"shadow-color":[{shadow:[Sg]}],opacity:[{opacity:[D]}],"mix-blend":[{"mix-blend":[..._e(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":_e()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[o]}],contrast:[{contrast:[v]}],"drop-shadow":[{"drop-shadow":["","none",vl,$t]}],grayscale:[{grayscale:[E]}],"hue-rotate":[{"hue-rotate":[T]}],invert:[{invert:[b]}],saturate:[{saturate:[B]}],sepia:[{sepia:[V]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[v]}],"backdrop-grayscale":[{"backdrop-grayscale":[E]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[T]}],"backdrop-invert":[{"backdrop-invert":[b]}],"backdrop-opacity":[{"backdrop-opacity":[D]}],"backdrop-saturate":[{"backdrop-saturate":[B]}],"backdrop-sepia":[{"backdrop-sepia":[V]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[p]}],"border-spacing-x":[{"border-spacing-x":[p]}],"border-spacing-y":[{"border-spacing-y":[p]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",$t]}],duration:[{duration:Ve()}],ease:[{ease:["linear","in","out","in-out",$t]}],delay:[{delay:Ve()}],animate:[{animate:["none","spin","ping","pulse","bounce",$t]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[z]}],"scale-x":[{"scale-x":[z]}],"scale-y":[{"scale-y":[z]}],rotate:[{rotate:[Eg,$t]}],"translate-x":[{"translate-x":[ne]}],"translate-y":[{"translate-y":[ne]}],"skew-x":[{"skew-x":[G]}],"skew-y":[{"skew-y":[G]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",$t]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$t]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ce()}],"scroll-mx":[{"scroll-mx":ce()}],"scroll-my":[{"scroll-my":ce()}],"scroll-ms":[{"scroll-ms":ce()}],"scroll-me":[{"scroll-me":ce()}],"scroll-mt":[{"scroll-mt":ce()}],"scroll-mr":[{"scroll-mr":ce()}],"scroll-mb":[{"scroll-mb":ce()}],"scroll-ml":[{"scroll-ml":ce()}],"scroll-p":[{"scroll-p":ce()}],"scroll-px":[{"scroll-px":ce()}],"scroll-py":[{"scroll-py":ce()}],"scroll-ps":[{"scroll-ps":ce()}],"scroll-pe":[{"scroll-pe":ce()}],"scroll-pt":[{"scroll-pt":ce()}],"scroll-pr":[{"scroll-pr":ce()}],"scroll-pb":[{"scroll-pb":ce()}],"scroll-pl":[{"scroll-pl":ce()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$t]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[dc,yl,xI]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},RTe=sTe(CTe);function Sp(...e){return RTe(Sn(e))}const Wl=x.forwardRef(({className:e,...t},a)=>C.jsx("div",{ref:a,className:Sp("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Wl.displayName="Card";const Jg=x.forwardRef(({className:e,...t},a)=>C.jsx("div",{ref:a,className:Sp("flex flex-col space-y-1.5 p-6",e),...t}));Jg.displayName="CardHeader";const Qg=x.forwardRef(({className:e,...t},a)=>C.jsx("h3",{ref:a,className:Sp("text-2xl font-semibold leading-none tracking-tight",e),...t}));Qg.displayName="CardTitle";const Df=x.forwardRef(({className:e,...t},a)=>C.jsx("div",{ref:a,className:Sp("p-6 pt-0",e),...t}));Df.displayName="CardContent";const G9=()=>{const[e,t]=x.useState("12.9716"),[a,o]=x.useState("77.5946"),[l,d]=x.useState(10),[p,g]=x.useState(""),[v,E]=x.useState(""),[T,b]=x.useState([]),[R,N]=x.useState(!1),[P,L]=x.useState(""),[M,D]=x.useState(""),[U,B]=x.useState(!1),[z,V]=x.useState([0,4]),G="AlzaSyplubBLrYqUCH-O7Xk_sKMz1sAZTVzizke",q=async()=>{N(!0),L(""),D("Starting search...");try{const ee=parseFloat(e),ce=parseFloat(a);if(isNaN(ee)||isNaN(ce))throw new Error("Invalid coordinates");if(ee<-90||ee>90||ce<-180||ce>180)throw new Error("Coordinates out of valid range");D("Fetching places from GoMaps API...");const be=new URL("https://maps.gomaps.pro/maps/api/place/nearbysearch/json"),ae={key:G,location:`${ee},${ce}`,radius:(l*1e3).toString(),language:"en",type:"store"};p.trim()&&(ae.keyword=p.trim()),U&&(ae.opennow="true"),z[0]>0&&(ae.minprice=z[0].toString()),z[1]<4&&(ae.maxprice=z[1].toString()),Object.entries(ae).forEach(([ue,ve])=>{ve!==void 0&&be.searchParams.append(ue,ve)}),console.log("Request URL:",be.toString());const me=await(await fetch(be.toString())).json();if(me.status!=="OK")throw new Error(`GoMaps API error: ${me.status}`);const _e=await Promise.all(me.results.map(async(ue,ve)=>{var Ve,Pe,Ge,nt,Re,wt,It,lt,ze;let Ce;if(ue.place_id)try{const He=new URL("https://maps.gomaps.pro/maps/api/place/details/json");He.searchParams.append("key",G),He.searchParams.append("place_id",ue.place_id),He.searchParams.append("fields","formatted_phone_number");const Be=await(await fetch(He.toString())).json();Be.status==="OK"&&Be.result&&(Ce=Be.result.formatted_phone_number)}catch(He){console.error("Error fetching place details:",He)}return{id:ue.place_id||ve.toString(),name:ue.name||"Unknown Place",address:ue.vicinity||"No address available",rating:ue.rating||0,distance:ne(ee,ce,((Ve=ue.geometry)==null?void 0:Ve.location.lat)||ee,((Pe=ue.geometry)==null?void 0:Pe.location.lng)||ce),lat:((Ge=ue.geometry)==null?void 0:Ge.location.lat)||ee,lng:((nt=ue.geometry)==null?void 0:nt.location.lng)||ce,type:(((Re=ue.types)==null?void 0:Re[0])||"Unknown").replace("_"," "),photo:(lt=(It=(wt=ue.photos)==null?void 0:wt[0])==null?void 0:It.getUrl)==null?void 0:lt.call(It,{maxWidth:400}),isOpen:(ze=ue.opening_hours)==null?void 0:ze.open_now,priceLevel:ue.price_level,phoneNumber:Ce}}));b(_e.sort((ue,ve)=>ue.distance-ve.distance)),D(`Found ${_e.length} places within ${l}km`)}catch(ee){console.error("Search error:",ee),L("Error: "+ee.message),D("Error occurred during search: "+ee.message)}finally{N(!1)}},ne=(ee,ce,be,ae)=>{const me=(be-ee)*Math.PI/180,_e=(ae-ce)*Math.PI/180,ue=Math.sin(me/2)*Math.sin(me/2)+Math.cos(ee*Math.PI/180)*Math.cos(be*Math.PI/180)*Math.sin(_e/2)*Math.sin(_e/2);return 6371*(2*Math.atan2(Math.sqrt(ue),Math.sqrt(1-ue)))},Z=()=>{navigator.geolocation?(N(!0),navigator.geolocation.getCurrentPosition(ee=>{t(ee.coords.latitude.toString()),o(ee.coords.longitude.toString()),N(!1),D("Retrieved current location")},ee=>{L("Geolocation error: "+ee.message),N(!1)})):L("Geolocation is not supported by your browser")},le=async()=>{var ee,ce,be;if(v.trim()){N(!0),L(""),D("Searching location...");try{const ae=new URL("https://maps.gomaps.pro/maps/api/geocode/json");ae.searchParams.append("key",G),ae.searchParams.append("address",v.trim());const me=await(await fetch(ae.toString())).json();if(me.status==="OK"&&((be=(ce=(ee=me.results)==null?void 0:ee[0])==null?void 0:ce.geometry)!=null&&be.location)){const{lat:_e,lng:ue}=me.results[0].geometry.location;t(_e.toString()),o(ue.toString()),D(`Found location: ${me.results[0].formatted_address}`),await q()}else throw new Error("Location not found")}catch(ae){console.error("Geocoding error:",ae),L("Error finding location: "+ae.message),D("Error occurred during location search: "+ae.message),N(!1)}}};return C.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[C.jsxs(Wl,{className:"mb-6 p-6",children:[C.jsxs("div",{className:"mb-4",children:[C.jsx("h2",{className:"text-2xl font-bold",children:"Find Nearby Places"}),C.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Search by location name or use coordinates to find nearby places"})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by Location Name"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("input",{type:"text",value:v,onChange:ee=>E(ee.target.value),placeholder:"e.g., Bangalore, MG Road, Central Park",className:"flex-1 p-2 border rounded",onKeyDown:ee=>ee.key==="Enter"&&le()}),C.jsx("button",{onClick:le,disabled:R||!v.trim(),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Search"})]})]}),C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"absolute inset-0 flex items-center",children:C.jsx("div",{className:"w-full border-t border-gray-300"})}),C.jsx("div",{className:"relative flex justify-center text-sm",children:C.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or use coordinates"})})]}),C.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),C.jsx("input",{type:"text",value:e,onChange:ee=>t(ee.target.value),placeholder:"e.g., 12.9716",className:"w-full p-2 border rounded"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),C.jsx("input",{type:"text",value:a,onChange:ee=>o(ee.target.value),placeholder:"e.g., 77.5946",className:"w-full p-2 border rounded"})]})]}),C.jsx("button",{onClick:Z,className:"w-full px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Use My Current Location"}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by Name"}),C.jsx("input",{type:"text",value:p,onChange:ee=>g(ee.target.value),placeholder:"e.g., supermarket, mall",className:"w-full p-2 border rounded"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("input",{type:"checkbox",id:"openNow",checked:U,onChange:ee=>B(ee.target.checked),className:"rounded border-gray-300"}),C.jsx("label",{htmlFor:"openNow",className:"text-sm text-gray-700",children:"Show only open places"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Range"}),C.jsx("input",{type:"range",min:"0",max:"4",value:z[1],onChange:ee=>V([z[0],parseInt(ee.target.value)]),className:"w-full"}),C.jsxs("div",{className:"text-sm text-gray-600 text-center",children:["$".repeat(z[0])," - ","$".repeat(z[1])]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Radius (km)"}),C.jsx("input",{type:"range",min:"1",max:"100",value:l,onChange:ee=>d(Number(ee.target.value)),className:"w-full"}),C.jsxs("div",{className:"text-sm text-gray-600 text-center",children:[l," km"]})]}),C.jsxs("button",{onClick:q,disabled:R,className:"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[R?C.jsx(s9,{className:"w-5 h-5 animate-spin"}):C.jsx(l9,{className:"w-5 h-5"}),"Search Nearby Places"]}),P&&C.jsx("div",{className:"text-red-500 text-center p-2 bg-red-50 rounded",children:P}),M&&C.jsxs("div",{className:"text-gray-600 text-sm bg-gray-50 p-2 rounded",children:["Debug: ",M]})]})]}),T.length>0&&C.jsxs(Wl,{className:"p-6",children:[C.jsxs("div",{className:"mb-4",children:[C.jsx("h2",{className:"text-2xl font-bold",children:"Found Places"}),C.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",T.length," results within ",l,"km",p&&` matching "${p}"`,U&&" (Open now)"]})]}),C.jsx("div",{className:"space-y-4",children:T.map(ee=>C.jsx("div",{className:"p-4 border rounded hover:bg-gray-50 transition-colors",children:C.jsxs("div",{className:"flex items-start gap-4",children:[ee.photo&&C.jsx("img",{src:ee.photo,alt:ee.name,className:"w-24 h-24 object-cover rounded"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h3",{className:"font-semibold text-lg",children:ee.name}),C.jsx("p",{className:"text-gray-600",children:ee.address}),C.jsxs("div",{className:"mt-2 flex justify-between text-sm",children:[C.jsxs("span",{className:"text-gray-500",children:[ee.distance.toFixed(1),"km away"]}),C.jsxs("div",{className:"flex items-center gap-2",children:[ee.isOpen!==void 0&&C.jsx("span",{className:ee.isOpen?"text-green-600":"text-red-600",children:ee.isOpen?"Open":"Closed"}),C.jsx("span",{className:"text-yellow-600",children:ee.rating>0?` ${ee.rating.toFixed(1)}`:"No rating"})]})]}),C.jsxs("div",{className:"mt-1 flex justify-between text-sm text-gray-500",children:[C.jsxs("span",{children:["Type: ",ee.type]}),C.jsxs("div",{className:"flex items-center gap-4",children:[ee.phoneNumber&&C.jsxs("a",{href:`tel:${ee.phoneNumber}`,className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),ee.phoneNumber]}),ee.priceLevel!==void 0&&C.jsx("span",{children:"$".repeat(ee.priceLevel)})]})]})]})]})},ee.id))})]})]})},D8=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,L8=Sn,OTe=(e,t)=>a=>{var o;if((t==null?void 0:t.variants)==null)return L8(e,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:l,defaultVariants:d}=t,p=Object.keys(l).map(E=>{const T=a==null?void 0:a[E],b=d==null?void 0:d[E];if(T===null)return null;const R=D8(T)||D8(b);return l[E][R]}),g=a&&Object.entries(a).reduce((E,T)=>{let[b,R]=T;return R===void 0||(E[b]=R),E},{}),v=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((E,T)=>{let{class:b,className:R,...N}=T;return Object.entries(N).every(P=>{let[L,M]=P;return Array.isArray(M)?M.includes({...d,...g}[L]):{...d,...g}[L]===M})?[...E,b,R]:E},[]);return L8(e,p,v,a==null?void 0:a.class,a==null?void 0:a.className)},ATe=OTe("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),V1=x.forwardRef(({className:e,variant:t,...a},o)=>C.jsx("div",{ref:o,role:"alert",className:Sp(ATe({variant:t}),e),...a}));V1.displayName="Alert";const B1=x.forwardRef(({className:e,...t},a)=>C.jsx("div",{ref:a,className:Sp("text-sm [&_p]:leading-relaxed",e),...t}));B1.displayName="AlertDescription";var ITe=Array.isArray,Sa=ITe,NTe=typeof Al=="object"&&Al&&Al.Object===Object&&Al,$9=NTe,PTe=$9,xTe=typeof self=="object"&&self&&self.Object===Object&&self,DTe=PTe||xTe||Function("return this")(),Ws=DTe,LTe=Ws,kTe=LTe.Symbol,hv=kTe,k8=hv,H9=Object.prototype,MTe=H9.hasOwnProperty,UTe=H9.toString,bg=k8?k8.toStringTag:void 0;function jTe(e){var t=MTe.call(e,bg),a=e[bg];try{e[bg]=void 0;var o=!0}catch{}var l=UTe.call(e);return o&&(t?e[bg]=a:delete e[bg]),l}var VTe=jTe,BTe=Object.prototype,FTe=BTe.toString;function WTe(e){return FTe.call(e)}var GTe=WTe,M8=hv,$Te=VTe,HTe=GTe,zTe="[object Null]",KTe="[object Undefined]",U8=M8?M8.toStringTag:void 0;function qTe(e){return e==null?e===void 0?KTe:zTe:U8&&U8 in Object(e)?$Te(e):HTe(e)}var xc=qTe;function YTe(e){return e!=null&&typeof e=="object"}var Dc=YTe,XTe=xc,JTe=Dc,QTe="[object Symbol]";function ZTe(e){return typeof e=="symbol"||JTe(e)&&XTe(e)==QTe}var bp=ZTe,ewe=Sa,twe=bp,nwe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rwe=/^\w*$/;function iwe(e,t){if(ewe(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||twe(e)?!0:rwe.test(e)||!nwe.test(e)||t!=null&&e in Object(t)}var F1=iwe;function awe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var tu=awe;const Tp=Kn(tu);var owe=xc,swe=tu,cwe="[object AsyncFunction]",lwe="[object Function]",uwe="[object GeneratorFunction]",dwe="[object Proxy]";function hwe(e){if(!swe(e))return!1;var t=owe(e);return t==lwe||t==uwe||t==cwe||t==dwe}var W1=hwe;const Zt=Kn(W1);var fwe=Ws,pwe=fwe["__core-js_shared__"],mwe=pwe,DI=mwe,j8=function(){var e=/[^.]+$/.exec(DI&&DI.keys&&DI.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function gwe(e){return!!j8&&j8 in e}var ywe=gwe,vwe=Function.prototype,_we=vwe.toString;function Ewe(e){if(e!=null){try{return _we.call(e)}catch{}try{return e+""}catch{}}return""}var z9=Ewe,Swe=W1,bwe=ywe,Twe=tu,wwe=z9,Cwe=/[\\^$.*+?()[\]{}|]/g,Rwe=/^\[object .+?Constructor\]$/,Owe=Function.prototype,Awe=Object.prototype,Iwe=Owe.toString,Nwe=Awe.hasOwnProperty,Pwe=RegExp("^"+Iwe.call(Nwe).replace(Cwe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xwe(e){if(!Twe(e)||bwe(e))return!1;var t=Swe(e)?Pwe:Rwe;return t.test(wwe(e))}var Dwe=xwe;function Lwe(e,t){return e==null?void 0:e[t]}var kwe=Lwe,Mwe=Dwe,Uwe=kwe;function jwe(e,t){var a=Uwe(e,t);return Mwe(a)?a:void 0}var Pd=jwe,Vwe=Pd,Bwe=Vwe(Object,"create"),ow=Bwe,V8=ow;function Fwe(){this.__data__=V8?V8(null):{},this.size=0}var Wwe=Fwe;function Gwe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var $we=Gwe,Hwe=ow,zwe="__lodash_hash_undefined__",Kwe=Object.prototype,qwe=Kwe.hasOwnProperty;function Ywe(e){var t=this.__data__;if(Hwe){var a=t[e];return a===zwe?void 0:a}return qwe.call(t,e)?t[e]:void 0}var Xwe=Ywe,Jwe=ow,Qwe=Object.prototype,Zwe=Qwe.hasOwnProperty;function eCe(e){var t=this.__data__;return Jwe?t[e]!==void 0:Zwe.call(t,e)}var tCe=eCe,nCe=ow,rCe="__lodash_hash_undefined__";function iCe(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=nCe&&t===void 0?rCe:t,this}var aCe=iCe,oCe=Wwe,sCe=$we,cCe=Xwe,lCe=tCe,uCe=aCe;function wp(e){var t=-1,a=e==null?0:e.length;for(this.clear();++t<a;){var o=e[t];this.set(o[0],o[1])}}wp.prototype.clear=oCe;wp.prototype.delete=sCe;wp.prototype.get=cCe;wp.prototype.has=lCe;wp.prototype.set=uCe;var dCe=wp;function hCe(){this.__data__=[],this.size=0}var fCe=hCe;function pCe(e,t){return e===t||e!==e&&t!==t}var G1=pCe,mCe=G1;function gCe(e,t){for(var a=e.length;a--;)if(mCe(e[a][0],t))return a;return-1}var sw=gCe,yCe=sw,vCe=Array.prototype,_Ce=vCe.splice;function ECe(e){var t=this.__data__,a=yCe(t,e);if(a<0)return!1;var o=t.length-1;return a==o?t.pop():_Ce.call(t,a,1),--this.size,!0}var SCe=ECe,bCe=sw;function TCe(e){var t=this.__data__,a=bCe(t,e);return a<0?void 0:t[a][1]}var wCe=TCe,CCe=sw;function RCe(e){return CCe(this.__data__,e)>-1}var OCe=RCe,ACe=sw;function ICe(e,t){var a=this.__data__,o=ACe(a,e);return o<0?(++this.size,a.push([e,t])):a[o][1]=t,this}var NCe=ICe,PCe=fCe,xCe=SCe,DCe=wCe,LCe=OCe,kCe=NCe;function Cp(e){var t=-1,a=e==null?0:e.length;for(this.clear();++t<a;){var o=e[t];this.set(o[0],o[1])}}Cp.prototype.clear=PCe;Cp.prototype.delete=xCe;Cp.prototype.get=DCe;Cp.prototype.has=LCe;Cp.prototype.set=kCe;var cw=Cp,MCe=Pd,UCe=Ws,jCe=MCe(UCe,"Map"),$1=jCe,B8=dCe,VCe=cw,BCe=$1;function FCe(){this.size=0,this.__data__={hash:new B8,map:new(BCe||VCe),string:new B8}}var WCe=FCe;function GCe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var $Ce=GCe,HCe=$Ce;function zCe(e,t){var a=e.__data__;return HCe(t)?a[typeof t=="string"?"string":"hash"]:a.map}var lw=zCe,KCe=lw;function qCe(e){var t=KCe(this,e).delete(e);return this.size-=t?1:0,t}var YCe=qCe,XCe=lw;function JCe(e){return XCe(this,e).get(e)}var QCe=JCe,ZCe=lw;function eRe(e){return ZCe(this,e).has(e)}var tRe=eRe,nRe=lw;function rRe(e,t){var a=nRe(this,e),o=a.size;return a.set(e,t),this.size+=a.size==o?0:1,this}var iRe=rRe,aRe=WCe,oRe=YCe,sRe=QCe,cRe=tRe,lRe=iRe;function Rp(e){var t=-1,a=e==null?0:e.length;for(this.clear();++t<a;){var o=e[t];this.set(o[0],o[1])}}Rp.prototype.clear=aRe;Rp.prototype.delete=oRe;Rp.prototype.get=sRe;Rp.prototype.has=cRe;Rp.prototype.set=lRe;var H1=Rp,K9=H1,uRe="Expected a function";function z1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(uRe);var a=function(){var o=arguments,l=t?t.apply(this,o):o[0],d=a.cache;if(d.has(l))return d.get(l);var p=e.apply(this,o);return a.cache=d.set(l,p)||d,p};return a.cache=new(z1.Cache||K9),a}z1.Cache=K9;var q9=z1;const dRe=Kn(q9);var hRe=q9,fRe=500;function pRe(e){var t=hRe(e,function(o){return a.size===fRe&&a.clear(),o}),a=t.cache;return t}var mRe=pRe,gRe=mRe,yRe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vRe=/\\(\\)?/g,_Re=gRe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(yRe,function(a,o,l,d){t.push(l?d.replace(vRe,"$1"):o||a)}),t}),ERe=_Re;function SRe(e,t){for(var a=-1,o=e==null?0:e.length,l=Array(o);++a<o;)l[a]=t(e[a],a,e);return l}var K1=SRe,F8=hv,bRe=K1,TRe=Sa,wRe=bp,W8=F8?F8.prototype:void 0,G8=W8?W8.toString:void 0;function Y9(e){if(typeof e=="string")return e;if(TRe(e))return bRe(e,Y9)+"";if(wRe(e))return G8?G8.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var CRe=Y9,RRe=CRe;function ORe(e){return e==null?"":RRe(e)}var X9=ORe,ARe=Sa,IRe=F1,NRe=ERe,PRe=X9;function xRe(e,t){return ARe(e)?e:IRe(e,t)?[e]:NRe(PRe(e))}var J9=xRe,DRe=bp;function LRe(e){if(typeof e=="string"||DRe(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var uw=LRe,kRe=J9,MRe=uw;function URe(e,t){t=kRe(t,e);for(var a=0,o=t.length;e!=null&&a<o;)e=e[MRe(t[a++])];return a&&a==o?e:void 0}var q1=URe,jRe=q1;function VRe(e,t,a){var o=e==null?void 0:jRe(e,t);return o===void 0?a:o}var Q9=VRe;const Eo=Kn(Q9);function BRe(e){return e==null}var FRe=BRe;const Pn=Kn(FRe);var WRe=xc,GRe=Sa,$Re=Dc,HRe="[object String]";function zRe(e){return typeof e=="string"||!GRe(e)&&$Re(e)&&WRe(e)==HRe}var KRe=zRe;const fv=Kn(KRe);var Z9={exports:{}},Vn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1=Symbol.for("react.element"),X1=Symbol.for("react.portal"),dw=Symbol.for("react.fragment"),hw=Symbol.for("react.strict_mode"),fw=Symbol.for("react.profiler"),pw=Symbol.for("react.provider"),mw=Symbol.for("react.context"),qRe=Symbol.for("react.server_context"),gw=Symbol.for("react.forward_ref"),yw=Symbol.for("react.suspense"),vw=Symbol.for("react.suspense_list"),_w=Symbol.for("react.memo"),Ew=Symbol.for("react.lazy"),YRe=Symbol.for("react.offscreen"),eX;eX=Symbol.for("react.module.reference");function wo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Y1:switch(e=e.type,e){case dw:case fw:case hw:case yw:case vw:return e;default:switch(e=e&&e.$$typeof,e){case qRe:case mw:case gw:case Ew:case _w:case pw:return e;default:return t}}case X1:return t}}}Vn.ContextConsumer=mw;Vn.ContextProvider=pw;Vn.Element=Y1;Vn.ForwardRef=gw;Vn.Fragment=dw;Vn.Lazy=Ew;Vn.Memo=_w;Vn.Portal=X1;Vn.Profiler=fw;Vn.StrictMode=hw;Vn.Suspense=yw;Vn.SuspenseList=vw;Vn.isAsyncMode=function(){return!1};Vn.isConcurrentMode=function(){return!1};Vn.isContextConsumer=function(e){return wo(e)===mw};Vn.isContextProvider=function(e){return wo(e)===pw};Vn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Y1};Vn.isForwardRef=function(e){return wo(e)===gw};Vn.isFragment=function(e){return wo(e)===dw};Vn.isLazy=function(e){return wo(e)===Ew};Vn.isMemo=function(e){return wo(e)===_w};Vn.isPortal=function(e){return wo(e)===X1};Vn.isProfiler=function(e){return wo(e)===fw};Vn.isStrictMode=function(e){return wo(e)===hw};Vn.isSuspense=function(e){return wo(e)===yw};Vn.isSuspenseList=function(e){return wo(e)===vw};Vn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===dw||e===fw||e===hw||e===yw||e===vw||e===YRe||typeof e=="object"&&e!==null&&(e.$$typeof===Ew||e.$$typeof===_w||e.$$typeof===pw||e.$$typeof===mw||e.$$typeof===gw||e.$$typeof===eX||e.getModuleId!==void 0)};Vn.typeOf=wo;Z9.exports=Vn;var XRe=Z9.exports,JRe=xc,QRe=Dc,ZRe="[object Number]";function e0e(e){return typeof e=="number"||QRe(e)&&JRe(e)==ZRe}var tX=e0e;const t0e=Kn(tX);var n0e=tX;function r0e(e){return n0e(e)&&e!=+e}var i0e=r0e;const pv=Kn(i0e);var es=function(t){return t===0?0:t>0?1:-1},ld=function(t){return fv(t)&&t.indexOf("%")===t.length-1},Ze=function(t){return t0e(t)&&!pv(t)},Zr=function(t){return Ze(t)||fv(t)},a0e=0,Sw=function(t){var a=++a0e;return"".concat(t||"").concat(a)},wd=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ze(t)&&!fv(t))return o;var d;if(ld(t)){var p=t.indexOf("%");d=a*parseFloat(t.slice(0,p))/100}else d=+t;return pv(d)&&(d=o),l&&d>a&&(d=a),d},Ol=function(t){if(!t)return null;var a=Object.keys(t);return a&&a.length?t[a[0]]:null},o0e=function(t){if(!Array.isArray(t))return!1;for(var a=t.length,o={},l=0;l<a;l++)if(!o[t[l]])o[t[l]]=!0;else return!0;return!1},nf=function(t,a){return Ze(t)&&Ze(a)?function(o){return t+o*(a-t)}:function(){return a}};function fP(e,t,a){return!e||!e.length?null:e.find(function(o){return o&&(typeof t=="function"?t(o):Eo(o,t))===a})}function Lf(e,t){for(var a in e)if({}.hasOwnProperty.call(e,a)&&(!{}.hasOwnProperty.call(t,a)||e[a]!==t[a]))return!1;for(var o in t)if({}.hasOwnProperty.call(t,o)&&!{}.hasOwnProperty.call(e,o))return!1;return!0}function pP(e){"@babel/helpers - typeof";return pP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pP(e)}var s0e=["viewBox","children"],c0e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],$8=["points","pathLength"],LI={svg:s0e,polygon:$8,polyline:$8},J1=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Hb=function(t,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(x.isValidElement(t)&&(o=t.props),!Tp(o))return null;var l={};return Object.keys(o).forEach(function(d){J1.includes(d)&&(l[d]=a||function(p){return o[d](o,p)})}),l},l0e=function(t,a,o){return function(l){return t(a,o,l),null}},zb=function(t,a,o){if(!Tp(t)||pP(t)!=="object")return null;var l=null;return Object.keys(t).forEach(function(d){var p=t[d];J1.includes(d)&&typeof p=="function"&&(l||(l={}),l[d]=l0e(p,a,o))}),l},u0e=["children"],d0e=["children"];function H8(e,t){if(e==null)return{};var a=h0e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function h0e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var z8={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Sc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},K8=null,kI=null,Q1=function e(t){if(t===K8&&Array.isArray(kI))return kI;var a=[];return x.Children.forEach(t,function(o){Pn(o)||(XRe.isFragment(o)?a=a.concat(e(o.props.children)):a.push(o))}),kI=a,K8=t,a};function rs(e,t){var a=[],o=[];return Array.isArray(t)?o=t.map(function(l){return Sc(l)}):o=[Sc(t)],Q1(e).forEach(function(l){var d=Eo(l,"type.displayName")||Eo(l,"type.name");o.indexOf(d)!==-1&&a.push(l)}),a}function Ma(e,t){var a=rs(e,t);return a[0]}var q8=function(t){if(!t||!t.props)return!1;var a=t.props,o=a.width,l=a.height;return!(!Ze(o)||o<=0||!Ze(l)||l<=0)},f0e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],p0e=function(t){return t&&t.type&&fv(t.type)&&f0e.indexOf(t.type)>=0},m0e=function(t,a,o,l){var d,p=(d=LI==null?void 0:LI[l])!==null&&d!==void 0?d:[];return!Zt(t)&&(l&&p.includes(a)||c0e.includes(a))||o&&J1.includes(a)},Cn=function(t,a,o){if(!t||typeof t=="function"||typeof t=="boolean")return null;var l=t;if(x.isValidElement(t)&&(l=t.props),!Tp(l))return null;var d={};return Object.keys(l).forEach(function(p){var g;m0e((g=l)===null||g===void 0?void 0:g[p],p,a,o)&&(d[p]=l[p])}),d},mP=function e(t,a){if(t===a)return!0;var o=x.Children.count(t);if(o!==x.Children.count(a))return!1;if(o===0)return!0;if(o===1)return Y8(Array.isArray(t)?t[0]:t,Array.isArray(a)?a[0]:a);for(var l=0;l<o;l++){var d=t[l],p=a[l];if(Array.isArray(d)||Array.isArray(p)){if(!e(d,p))return!1}else if(!Y8(d,p))return!1}return!0},Y8=function(t,a){if(Pn(t)&&Pn(a))return!0;if(!Pn(t)&&!Pn(a)){var o=t.props||{},l=o.children,d=H8(o,u0e),p=a.props||{},g=p.children,v=H8(p,d0e);return l&&g?Lf(d,v)&&mP(l,g):!l&&!g?Lf(d,v):!1}return!1},X8=function(t,a){var o=[],l={};return Q1(t).forEach(function(d,p){if(p0e(d))o.push(d);else if(d){var g=Sc(d.type),v=a[g]||{},E=v.handler,T=v.once;if(E&&(!T||!l[g])){var b=E(d,g,p);o.push(b),l[g]=!0}}}),o},g0e=function(t){var a=t&&t.type;return a&&z8[a]?z8[a]:null},y0e=function(t,a){return Q1(a).indexOf(t)},v0e=["children","width","height","viewBox","className","style","title","desc"];function gP(){return gP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},gP.apply(this,arguments)}function _0e(e,t){if(e==null)return{};var a=E0e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function E0e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function yP(e){var t=e.children,a=e.width,o=e.height,l=e.viewBox,d=e.className,p=e.style,g=e.title,v=e.desc,E=_0e(e,v0e),T=l||{width:a,height:o,x:0,y:0},b=Sn("recharts-surface",d);return ye.createElement("svg",gP({},Cn(E,!0,"svg"),{className:b,width:a,height:o,style:p,viewBox:"".concat(T.x," ").concat(T.y," ").concat(T.width," ").concat(T.height)}),ye.createElement("title",null,g),ye.createElement("desc",null,v),t)}var S0e=["children","className"];function vP(){return vP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},vP.apply(this,arguments)}function b0e(e,t){if(e==null)return{};var a=T0e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function T0e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var hi=ye.forwardRef(function(e,t){var a=e.children,o=e.className,l=b0e(e,S0e),d=Sn("recharts-layer",o);return ye.createElement("g",vP({className:d},Cn(l,!0),{ref:t}),a)}),bc=function(t,a){for(var o=arguments.length,l=new Array(o>2?o-2:0),d=2;d<o;d++)l[d-2]=arguments[d]};function w0e(e,t,a){var o=-1,l=e.length;t<0&&(t=-t>l?0:l+t),a=a>l?l:a,a<0&&(a+=l),l=t>a?0:a-t>>>0,t>>>=0;for(var d=Array(l);++o<l;)d[o]=e[o+t];return d}var C0e=w0e,R0e=C0e;function O0e(e,t,a){var o=e.length;return a=a===void 0?o:a,!t&&a>=o?e:R0e(e,t,a)}var A0e=O0e,I0e="\\ud800-\\udfff",N0e="\\u0300-\\u036f",P0e="\\ufe20-\\ufe2f",x0e="\\u20d0-\\u20ff",D0e=N0e+P0e+x0e,L0e="\\ufe0e\\ufe0f",k0e="\\u200d",M0e=RegExp("["+k0e+I0e+D0e+L0e+"]");function U0e(e){return M0e.test(e)}var nX=U0e;function j0e(e){return e.split("")}var V0e=j0e,rX="\\ud800-\\udfff",B0e="\\u0300-\\u036f",F0e="\\ufe20-\\ufe2f",W0e="\\u20d0-\\u20ff",G0e=B0e+F0e+W0e,$0e="\\ufe0e\\ufe0f",H0e="["+rX+"]",_P="["+G0e+"]",EP="\\ud83c[\\udffb-\\udfff]",z0e="(?:"+_P+"|"+EP+")",iX="[^"+rX+"]",aX="(?:\\ud83c[\\udde6-\\uddff]){2}",oX="[\\ud800-\\udbff][\\udc00-\\udfff]",K0e="\\u200d",sX=z0e+"?",cX="["+$0e+"]?",q0e="(?:"+K0e+"(?:"+[iX,aX,oX].join("|")+")"+cX+sX+")*",Y0e=cX+sX+q0e,X0e="(?:"+[iX+_P+"?",_P,aX,oX,H0e].join("|")+")",J0e=RegExp(EP+"(?="+EP+")|"+X0e+Y0e,"g");function Q0e(e){return e.match(J0e)||[]}var Z0e=Q0e,eOe=V0e,tOe=nX,nOe=Z0e;function rOe(e){return tOe(e)?nOe(e):eOe(e)}var iOe=rOe,aOe=A0e,oOe=nX,sOe=iOe,cOe=X9;function lOe(e){return function(t){t=cOe(t);var a=oOe(t)?sOe(t):void 0,o=a?a[0]:t.charAt(0),l=a?aOe(a,1).join(""):t.slice(1);return o[e]()+l}}var uOe=lOe,dOe=uOe,hOe=dOe("toUpperCase"),fOe=hOe;const bw=Kn(fOe);function Qn(e){return function(){return e}}const lX=Math.cos,Kb=Math.sin,as=Math.sqrt,qb=Math.PI,Tw=2*qb,SP=Math.PI,bP=2*SP,td=1e-6,pOe=bP-td;function uX(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function mOe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return uX;const a=10**t;return function(o){this._+=o[0];for(let l=1,d=o.length;l<d;++l)this._+=Math.round(arguments[l]*a)/a+o[l]}}class gOe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?uX:mOe(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,o,l){this._append`Q${+t},${+a},${this._x1=+o},${this._y1=+l}`}bezierCurveTo(t,a,o,l,d,p){this._append`C${+t},${+a},${+o},${+l},${this._x1=+d},${this._y1=+p}`}arcTo(t,a,o,l,d){if(t=+t,a=+a,o=+o,l=+l,d=+d,d<0)throw new Error(`negative radius: ${d}`);let p=this._x1,g=this._y1,v=o-t,E=l-a,T=p-t,b=g-a,R=T*T+b*b;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(R>td)if(!(Math.abs(b*v-E*T)>td)||!d)this._append`L${this._x1=t},${this._y1=a}`;else{let N=o-p,P=l-g,L=v*v+E*E,M=N*N+P*P,D=Math.sqrt(L),U=Math.sqrt(R),B=d*Math.tan((SP-Math.acos((L+R-M)/(2*D*U)))/2),z=B/U,V=B/D;Math.abs(z-1)>td&&this._append`L${t+z*T},${a+z*b}`,this._append`A${d},${d},0,0,${+(b*N>T*P)},${this._x1=t+V*v},${this._y1=a+V*E}`}}arc(t,a,o,l,d,p){if(t=+t,a=+a,o=+o,p=!!p,o<0)throw new Error(`negative radius: ${o}`);let g=o*Math.cos(l),v=o*Math.sin(l),E=t+g,T=a+v,b=1^p,R=p?l-d:d-l;this._x1===null?this._append`M${E},${T}`:(Math.abs(this._x1-E)>td||Math.abs(this._y1-T)>td)&&this._append`L${E},${T}`,o&&(R<0&&(R=R%bP+bP),R>pOe?this._append`A${o},${o},0,1,${b},${t-g},${a-v}A${o},${o},0,1,${b},${this._x1=E},${this._y1=T}`:R>td&&this._append`A${o},${o},0,${+(R>=SP)},${b},${this._x1=t+o*Math.cos(d)},${this._y1=a+o*Math.sin(d)}`)}rect(t,a,o,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${o=+o}v${+l}h${-o}Z`}toString(){return this._}}function Z1(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const o=Math.floor(a);if(!(o>=0))throw new RangeError(`invalid digits: ${a}`);t=o}return e},()=>new gOe(t)}function eD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dX(e){this._context=e}dX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ww(e){return new dX(e)}function hX(e){return e[0]}function fX(e){return e[1]}function pX(e,t){var a=Qn(!0),o=null,l=ww,d=null,p=Z1(g);e=typeof e=="function"?e:e===void 0?hX:Qn(e),t=typeof t=="function"?t:t===void 0?fX:Qn(t);function g(v){var E,T=(v=eD(v)).length,b,R=!1,N;for(o==null&&(d=l(N=p())),E=0;E<=T;++E)!(E<T&&a(b=v[E],E,v))===R&&((R=!R)?d.lineStart():d.lineEnd()),R&&d.point(+e(b,E,v),+t(b,E,v));if(N)return d=null,N+""||null}return g.x=function(v){return arguments.length?(e=typeof v=="function"?v:Qn(+v),g):e},g.y=function(v){return arguments.length?(t=typeof v=="function"?v:Qn(+v),g):t},g.defined=function(v){return arguments.length?(a=typeof v=="function"?v:Qn(!!v),g):a},g.curve=function(v){return arguments.length?(l=v,o!=null&&(d=l(o)),g):l},g.context=function(v){return arguments.length?(v==null?o=d=null:d=l(o=v),g):o},g}function MS(e,t,a){var o=null,l=Qn(!0),d=null,p=ww,g=null,v=Z1(E);e=typeof e=="function"?e:e===void 0?hX:Qn(+e),t=typeof t=="function"?t:Qn(t===void 0?0:+t),a=typeof a=="function"?a:a===void 0?fX:Qn(+a);function E(b){var R,N,P,L=(b=eD(b)).length,M,D=!1,U,B=new Array(L),z=new Array(L);for(d==null&&(g=p(U=v())),R=0;R<=L;++R){if(!(R<L&&l(M=b[R],R,b))===D)if(D=!D)N=R,g.areaStart(),g.lineStart();else{for(g.lineEnd(),g.lineStart(),P=R-1;P>=N;--P)g.point(B[P],z[P]);g.lineEnd(),g.areaEnd()}D&&(B[R]=+e(M,R,b),z[R]=+t(M,R,b),g.point(o?+o(M,R,b):B[R],a?+a(M,R,b):z[R]))}if(U)return g=null,U+""||null}function T(){return pX().defined(l).curve(p).context(d)}return E.x=function(b){return arguments.length?(e=typeof b=="function"?b:Qn(+b),o=null,E):e},E.x0=function(b){return arguments.length?(e=typeof b=="function"?b:Qn(+b),E):e},E.x1=function(b){return arguments.length?(o=b==null?null:typeof b=="function"?b:Qn(+b),E):o},E.y=function(b){return arguments.length?(t=typeof b=="function"?b:Qn(+b),a=null,E):t},E.y0=function(b){return arguments.length?(t=typeof b=="function"?b:Qn(+b),E):t},E.y1=function(b){return arguments.length?(a=b==null?null:typeof b=="function"?b:Qn(+b),E):a},E.lineX0=E.lineY0=function(){return T().x(e).y(t)},E.lineY1=function(){return T().x(e).y(a)},E.lineX1=function(){return T().x(o).y(t)},E.defined=function(b){return arguments.length?(l=typeof b=="function"?b:Qn(!!b),E):l},E.curve=function(b){return arguments.length?(p=b,d!=null&&(g=p(d)),E):p},E.context=function(b){return arguments.length?(b==null?d=g=null:g=p(d=b),E):d},E}class mX{constructor(t,a){this._context=t,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,a){switch(t=+t,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,a):this._context.moveTo(t,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,a,t,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,t,this._y0,t,a);break}}this._x0=t,this._y0=a}}function yOe(e){return new mX(e,!0)}function vOe(e){return new mX(e,!1)}const tD={draw(e,t){const a=as(t/qb);e.moveTo(a,0),e.arc(0,0,a,0,Tw)}},_Oe={draw(e,t){const a=as(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},gX=as(1/3),EOe=gX*2,SOe={draw(e,t){const a=as(t/EOe),o=a*gX;e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath()}},bOe={draw(e,t){const a=as(t),o=-a/2;e.rect(o,o,a,a)}},TOe=.8908130915292852,yX=Kb(qb/10)/Kb(7*qb/10),wOe=Kb(Tw/10)*yX,COe=-lX(Tw/10)*yX,ROe={draw(e,t){const a=as(t*TOe),o=wOe*a,l=COe*a;e.moveTo(0,-a),e.lineTo(o,l);for(let d=1;d<5;++d){const p=Tw*d/5,g=lX(p),v=Kb(p);e.lineTo(v*a,-g*a),e.lineTo(g*o-v*l,v*o+g*l)}e.closePath()}},MI=as(3),OOe={draw(e,t){const a=-as(t/(MI*3));e.moveTo(0,a*2),e.lineTo(-MI*a,-a),e.lineTo(MI*a,-a),e.closePath()}},ho=-.5,fo=as(3)/2,TP=1/as(12),AOe=(TP/2+1)*3,IOe={draw(e,t){const a=as(t/AOe),o=a/2,l=a*TP,d=o,p=a*TP+a,g=-d,v=p;e.moveTo(o,l),e.lineTo(d,p),e.lineTo(g,v),e.lineTo(ho*o-fo*l,fo*o+ho*l),e.lineTo(ho*d-fo*p,fo*d+ho*p),e.lineTo(ho*g-fo*v,fo*g+ho*v),e.lineTo(ho*o+fo*l,ho*l-fo*o),e.lineTo(ho*d+fo*p,ho*p-fo*d),e.lineTo(ho*g+fo*v,ho*v-fo*g),e.closePath()}};function NOe(e,t){let a=null,o=Z1(l);e=typeof e=="function"?e:Qn(e||tD),t=typeof t=="function"?t:Qn(t===void 0?64:+t);function l(){let d;if(a||(a=d=o()),e.apply(this,arguments).draw(a,+t.apply(this,arguments)),d)return a=null,d+""||null}return l.type=function(d){return arguments.length?(e=typeof d=="function"?d:Qn(d),l):e},l.size=function(d){return arguments.length?(t=typeof d=="function"?d:Qn(+d),l):t},l.context=function(d){return arguments.length?(a=d??null,l):a},l}function Yb(){}function Xb(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function vX(e){this._context=e}vX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Xb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Xb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function POe(e){return new vX(e)}function _X(e){this._context=e}_X.prototype={areaStart:Yb,areaEnd:Yb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Xb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xOe(e){return new _X(e)}function EX(e){this._context=e}EX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,o):this._context.moveTo(a,o);break;case 3:this._point=4;default:Xb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function DOe(e){return new EX(e)}function SX(e){this._context=e}SX.prototype={areaStart:Yb,areaEnd:Yb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function LOe(e){return new SX(e)}function J8(e){return e<0?-1:1}function Q8(e,t,a){var o=e._x1-e._x0,l=t-e._x1,d=(e._y1-e._y0)/(o||l<0&&-0),p=(a-e._y1)/(l||o<0&&-0),g=(d*l+p*o)/(o+l);return(J8(d)+J8(p))*Math.min(Math.abs(d),Math.abs(p),.5*Math.abs(g))||0}function Z8(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function UI(e,t,a){var o=e._x0,l=e._y0,d=e._x1,p=e._y1,g=(d-o)/3;e._context.bezierCurveTo(o+g,l+g*t,d-g,p-g*a,d,p)}function Jb(e){this._context=e}Jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:UI(this,this._t0,Z8(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,UI(this,Z8(this,a=Q8(this,e,t)),a);break;default:UI(this,this._t0,a=Q8(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}};function bX(e){this._context=new TX(e)}(bX.prototype=Object.create(Jb.prototype)).point=function(e,t){Jb.prototype.point.call(this,t,e)};function TX(e){this._context=e}TX.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,o,l,d){this._context.bezierCurveTo(t,e,o,a,d,l)}};function kOe(e){return new Jb(e)}function MOe(e){return new bX(e)}function wX(e){this._context=e}wX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),a===2)this._context.lineTo(e[1],t[1]);else for(var o=eH(e),l=eH(t),d=0,p=1;p<a;++d,++p)this._context.bezierCurveTo(o[0][d],l[0][d],o[1][d],l[1][d],e[p],t[p]);(this._line||this._line!==0&&a===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function eH(e){var t,a=e.length-1,o,l=new Array(a),d=new Array(a),p=new Array(a);for(l[0]=0,d[0]=2,p[0]=e[0]+2*e[1],t=1;t<a-1;++t)l[t]=1,d[t]=4,p[t]=4*e[t]+2*e[t+1];for(l[a-1]=2,d[a-1]=7,p[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)o=l[t]/d[t-1],d[t]-=o,p[t]-=o*p[t-1];for(l[a-1]=p[a-1]/d[a-1],t=a-2;t>=0;--t)l[t]=(p[t]-l[t+1])/d[t];for(d[a-1]=(e[a]+l[a-1])/2,t=0;t<a-1;++t)d[t]=2*e[t+1]-l[t+1];return[l,d]}function UOe(e){return new wX(e)}function Cw(e,t){this._context=e,this._t=t}Cw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}};function jOe(e){return new Cw(e,.5)}function VOe(e){return new Cw(e,0)}function BOe(e){return new Cw(e,1)}function $f(e,t){if((p=e.length)>1)for(var a=1,o,l,d=e[t[0]],p,g=d.length;a<p;++a)for(l=d,d=e[t[a]],o=0;o<g;++o)d[o][1]+=d[o][0]=isNaN(l[o][1])?l[o][0]:l[o][1]}function wP(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function FOe(e,t){return e[t]}function WOe(e){const t=[];return t.key=e,t}function GOe(){var e=Qn([]),t=wP,a=$f,o=FOe;function l(d){var p=Array.from(e.apply(this,arguments),WOe),g,v=p.length,E=-1,T;for(const b of d)for(g=0,++E;g<v;++g)(p[g][E]=[0,+o(b,p[g].key,E,d)]).data=b;for(g=0,T=eD(t(p));g<v;++g)p[T[g]].index=g;return a(p,T),p}return l.keys=function(d){return arguments.length?(e=typeof d=="function"?d:Qn(Array.from(d)),l):e},l.value=function(d){return arguments.length?(o=typeof d=="function"?d:Qn(+d),l):o},l.order=function(d){return arguments.length?(t=d==null?wP:typeof d=="function"?d:Qn(Array.from(d)),l):t},l.offset=function(d){return arguments.length?(a=d??$f,l):a},l}function $Oe(e,t){if((o=e.length)>0){for(var a,o,l=0,d=e[0].length,p;l<d;++l){for(p=a=0;a<o;++a)p+=e[a][l][1]||0;if(p)for(a=0;a<o;++a)e[a][l][1]/=p}$f(e,t)}}function HOe(e,t){if((l=e.length)>0){for(var a=0,o=e[t[0]],l,d=o.length;a<d;++a){for(var p=0,g=0;p<l;++p)g+=e[p][a][1]||0;o[a][1]+=o[a][0]=-g/2}$f(e,t)}}function zOe(e,t){if(!(!((p=e.length)>0)||!((d=(l=e[t[0]]).length)>0))){for(var a=0,o=1,l,d,p;o<d;++o){for(var g=0,v=0,E=0;g<p;++g){for(var T=e[t[g]],b=T[o][1]||0,R=T[o-1][1]||0,N=(b-R)/2,P=0;P<g;++P){var L=e[t[P]],M=L[o][1]||0,D=L[o-1][1]||0;N+=M-D}v+=b,E+=N*b}l[o-1][1]+=l[o-1][0]=a,v&&(a-=E/v)}l[o-1][1]+=l[o-1][0]=a,$f(e,t)}}function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}var KOe=["type","size","sizeType"];function CP(){return CP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},CP.apply(this,arguments)}function tH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function nH(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tH(Object(a),!0).forEach(function(o){qOe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function qOe(e,t,a){return t=YOe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function YOe(e){var t=XOe(e,"string");return Ty(t)=="symbol"?t:t+""}function XOe(e,t){if(Ty(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Ty(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JOe(e,t){if(e==null)return{};var a=QOe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function QOe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var CX={symbolCircle:tD,symbolCross:_Oe,symbolDiamond:SOe,symbolSquare:bOe,symbolStar:ROe,symbolTriangle:OOe,symbolWye:IOe},ZOe=Math.PI/180,eAe=function(t){var a="symbol".concat(bw(t));return CX[a]||tD},tAe=function(t,a,o){if(a==="area")return t;switch(o){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var l=18*ZOe;return 1.25*t*t*(Math.tan(l)-Math.tan(l*2)*Math.pow(Math.tan(l),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},nAe=function(t,a){CX["symbol".concat(bw(t))]=a},nD=function(t){var a=t.type,o=a===void 0?"circle":a,l=t.size,d=l===void 0?64:l,p=t.sizeType,g=p===void 0?"area":p,v=JOe(t,KOe),E=nH(nH({},v),{},{type:o,size:d,sizeType:g}),T=function(){var M=eAe(o),D=NOe().type(M).size(tAe(d,g,o));return D()},b=E.className,R=E.cx,N=E.cy,P=Cn(E,!0);return R===+R&&N===+N&&d===+d?ye.createElement("path",CP({},P,{className:Sn("recharts-symbols",b),transform:"translate(".concat(R,", ").concat(N,")"),d:T()})):null};nD.registerSymbol=nAe;function Hf(e){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}function RP(){return RP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},RP.apply(this,arguments)}function rH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function rAe(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?rH(Object(a),!0).forEach(function(o){wy(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function iAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aAe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,OX(o.key),o)}}function oAe(e,t,a){return aAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sAe(e,t,a){return t=Qb(t),cAe(e,RX()?Reflect.construct(t,a||[],Qb(e).constructor):t.apply(e,a))}function cAe(e,t){if(t&&(Hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lAe(e)}function lAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RX=function(){return!!e})()}function Qb(e){return Qb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Qb(e)}function uAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OP(e,t)}function OP(e,t){return OP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},OP(e,t)}function wy(e,t,a){return t=OX(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function OX(e){var t=dAe(e,"string");return Hf(t)=="symbol"?t:t+""}function dAe(e,t){if(Hf(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Hf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ko=32,rD=function(e){function t(){return iAe(this,t),sAe(this,t,arguments)}return uAe(t,e),oAe(t,[{key:"renderIcon",value:function(o){var l=this.props.inactiveColor,d=Ko/2,p=Ko/6,g=Ko/3,v=o.inactive?l:o.color;if(o.type==="plainline")return ye.createElement("line",{strokeWidth:4,fill:"none",stroke:v,strokeDasharray:o.payload.strokeDasharray,x1:0,y1:d,x2:Ko,y2:d,className:"recharts-legend-icon"});if(o.type==="line")return ye.createElement("path",{strokeWidth:4,fill:"none",stroke:v,d:"M0,".concat(d,"h").concat(g,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(2*g,",").concat(d,`
            H`).concat(Ko,"M").concat(2*g,",").concat(d,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(g,",").concat(d),className:"recharts-legend-icon"});if(o.type==="rect")return ye.createElement("path",{stroke:"none",fill:v,d:"M0,".concat(Ko/8,"h").concat(Ko,"v").concat(Ko*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(ye.isValidElement(o.legendIcon)){var E=rAe({},o);return delete E.legendIcon,ye.cloneElement(o.legendIcon,E)}return ye.createElement(nD,{fill:v,cx:d,cy:d,size:Ko,sizeType:"diameter",type:o.type})}},{key:"renderItems",value:function(){var o=this,l=this.props,d=l.payload,p=l.iconSize,g=l.layout,v=l.formatter,E=l.inactiveColor,T={x:0,y:0,width:Ko,height:Ko},b={display:g==="horizontal"?"inline-block":"block",marginRight:10},R={display:"inline-block",verticalAlign:"middle",marginRight:4};return d.map(function(N,P){var L=N.formatter||v,M=Sn(wy(wy({"recharts-legend-item":!0},"legend-item-".concat(P),!0),"inactive",N.inactive));if(N.type==="none")return null;var D=Zt(N.value)?null:N.value;bc(!Zt(N.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var U=N.inactive?E:N.color;return ye.createElement("li",RP({className:M,style:b,key:"legend-item-".concat(P)},zb(o.props,N,P)),ye.createElement(yP,{width:p,height:p,viewBox:T,style:R},o.renderIcon(N)),ye.createElement("span",{className:"recharts-legend-item-text",style:{color:U}},L?L(D,N,P):D))})}},{key:"render",value:function(){var o=this.props,l=o.payload,d=o.layout,p=o.align;if(!l||!l.length)return null;var g={padding:0,margin:0,textAlign:d==="horizontal"?p:"left"};return ye.createElement("ul",{className:"recharts-default-legend",style:g},this.renderItems())}}])}(x.PureComponent);wy(rD,"displayName","Legend");wy(rD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var hAe=cw;function fAe(){this.__data__=new hAe,this.size=0}var pAe=fAe;function mAe(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a}var gAe=mAe;function yAe(e){return this.__data__.get(e)}var vAe=yAe;function _Ae(e){return this.__data__.has(e)}var EAe=_Ae,SAe=cw,bAe=$1,TAe=H1,wAe=200;function CAe(e,t){var a=this.__data__;if(a instanceof SAe){var o=a.__data__;if(!bAe||o.length<wAe-1)return o.push([e,t]),this.size=++a.size,this;a=this.__data__=new TAe(o)}return a.set(e,t),this.size=a.size,this}var RAe=CAe,OAe=cw,AAe=pAe,IAe=gAe,NAe=vAe,PAe=EAe,xAe=RAe;function Op(e){var t=this.__data__=new OAe(e);this.size=t.size}Op.prototype.clear=AAe;Op.prototype.delete=IAe;Op.prototype.get=NAe;Op.prototype.has=PAe;Op.prototype.set=xAe;var AX=Op,DAe="__lodash_hash_undefined__";function LAe(e){return this.__data__.set(e,DAe),this}var kAe=LAe;function MAe(e){return this.__data__.has(e)}var UAe=MAe,jAe=H1,VAe=kAe,BAe=UAe;function Zb(e){var t=-1,a=e==null?0:e.length;for(this.__data__=new jAe;++t<a;)this.add(e[t])}Zb.prototype.add=Zb.prototype.push=VAe;Zb.prototype.has=BAe;var IX=Zb;function FAe(e,t){for(var a=-1,o=e==null?0:e.length;++a<o;)if(t(e[a],a,e))return!0;return!1}var NX=FAe;function WAe(e,t){return e.has(t)}var PX=WAe,GAe=IX,$Ae=NX,HAe=PX,zAe=1,KAe=2;function qAe(e,t,a,o,l,d){var p=a&zAe,g=e.length,v=t.length;if(g!=v&&!(p&&v>g))return!1;var E=d.get(e),T=d.get(t);if(E&&T)return E==t&&T==e;var b=-1,R=!0,N=a&KAe?new GAe:void 0;for(d.set(e,t),d.set(t,e);++b<g;){var P=e[b],L=t[b];if(o)var M=p?o(L,P,b,t,e,d):o(P,L,b,e,t,d);if(M!==void 0){if(M)continue;R=!1;break}if(N){if(!$Ae(t,function(D,U){if(!HAe(N,U)&&(P===D||l(P,D,a,o,d)))return N.push(U)})){R=!1;break}}else if(!(P===L||l(P,L,a,o,d))){R=!1;break}}return d.delete(e),d.delete(t),R}var xX=qAe,YAe=Ws,XAe=YAe.Uint8Array,JAe=XAe;function QAe(e){var t=-1,a=Array(e.size);return e.forEach(function(o,l){a[++t]=[l,o]}),a}var ZAe=QAe;function eIe(e){var t=-1,a=Array(e.size);return e.forEach(function(o){a[++t]=o}),a}var iD=eIe,iH=hv,aH=JAe,tIe=G1,nIe=xX,rIe=ZAe,iIe=iD,aIe=1,oIe=2,sIe="[object Boolean]",cIe="[object Date]",lIe="[object Error]",uIe="[object Map]",dIe="[object Number]",hIe="[object RegExp]",fIe="[object Set]",pIe="[object String]",mIe="[object Symbol]",gIe="[object ArrayBuffer]",yIe="[object DataView]",oH=iH?iH.prototype:void 0,jI=oH?oH.valueOf:void 0;function vIe(e,t,a,o,l,d,p){switch(a){case yIe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case gIe:return!(e.byteLength!=t.byteLength||!d(new aH(e),new aH(t)));case sIe:case cIe:case dIe:return tIe(+e,+t);case lIe:return e.name==t.name&&e.message==t.message;case hIe:case pIe:return e==t+"";case uIe:var g=rIe;case fIe:var v=o&aIe;if(g||(g=iIe),e.size!=t.size&&!v)return!1;var E=p.get(e);if(E)return E==t;o|=oIe,p.set(e,t);var T=nIe(g(e),g(t),o,l,d,p);return p.delete(e),T;case mIe:if(jI)return jI.call(e)==jI.call(t)}return!1}var _Ie=vIe;function EIe(e,t){for(var a=-1,o=t.length,l=e.length;++a<o;)e[l+a]=t[a];return e}var DX=EIe,SIe=DX,bIe=Sa;function TIe(e,t,a){var o=t(e);return bIe(e)?o:SIe(o,a(e))}var wIe=TIe;function CIe(e,t){for(var a=-1,o=e==null?0:e.length,l=0,d=[];++a<o;){var p=e[a];t(p,a,e)&&(d[l++]=p)}return d}var RIe=CIe;function OIe(){return[]}var AIe=OIe,IIe=RIe,NIe=AIe,PIe=Object.prototype,xIe=PIe.propertyIsEnumerable,sH=Object.getOwnPropertySymbols,DIe=sH?function(e){return e==null?[]:(e=Object(e),IIe(sH(e),function(t){return xIe.call(e,t)}))}:NIe,LIe=DIe;function kIe(e,t){for(var a=-1,o=Array(e);++a<e;)o[a]=t(a);return o}var MIe=kIe,UIe=xc,jIe=Dc,VIe="[object Arguments]";function BIe(e){return jIe(e)&&UIe(e)==VIe}var FIe=BIe,cH=FIe,WIe=Dc,LX=Object.prototype,GIe=LX.hasOwnProperty,$Ie=LX.propertyIsEnumerable,HIe=cH(function(){return arguments}())?cH:function(e){return WIe(e)&&GIe.call(e,"callee")&&!$Ie.call(e,"callee")},aD=HIe,eT={exports:{}};function zIe(){return!1}var KIe=zIe;eT.exports;(function(e,t){var a=Ws,o=KIe,l=t&&!t.nodeType&&t,d=l&&!0&&e&&!e.nodeType&&e,p=d&&d.exports===l,g=p?a.Buffer:void 0,v=g?g.isBuffer:void 0,E=v||o;e.exports=E})(eT,eT.exports);var kX=eT.exports,qIe=9007199254740991,YIe=/^(?:0|[1-9]\d*)$/;function XIe(e,t){var a=typeof e;return t=t??qIe,!!t&&(a=="number"||a!="symbol"&&YIe.test(e))&&e>-1&&e%1==0&&e<t}var oD=XIe,JIe=9007199254740991;function QIe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=JIe}var sD=QIe,ZIe=xc,eNe=sD,tNe=Dc,nNe="[object Arguments]",rNe="[object Array]",iNe="[object Boolean]",aNe="[object Date]",oNe="[object Error]",sNe="[object Function]",cNe="[object Map]",lNe="[object Number]",uNe="[object Object]",dNe="[object RegExp]",hNe="[object Set]",fNe="[object String]",pNe="[object WeakMap]",mNe="[object ArrayBuffer]",gNe="[object DataView]",yNe="[object Float32Array]",vNe="[object Float64Array]",_Ne="[object Int8Array]",ENe="[object Int16Array]",SNe="[object Int32Array]",bNe="[object Uint8Array]",TNe="[object Uint8ClampedArray]",wNe="[object Uint16Array]",CNe="[object Uint32Array]",cr={};cr[yNe]=cr[vNe]=cr[_Ne]=cr[ENe]=cr[SNe]=cr[bNe]=cr[TNe]=cr[wNe]=cr[CNe]=!0;cr[nNe]=cr[rNe]=cr[mNe]=cr[iNe]=cr[gNe]=cr[aNe]=cr[oNe]=cr[sNe]=cr[cNe]=cr[lNe]=cr[uNe]=cr[dNe]=cr[hNe]=cr[fNe]=cr[pNe]=!1;function RNe(e){return tNe(e)&&eNe(e.length)&&!!cr[ZIe(e)]}var ONe=RNe;function ANe(e){return function(t){return e(t)}}var MX=ANe,tT={exports:{}};tT.exports;(function(e,t){var a=$9,o=t&&!t.nodeType&&t,l=o&&!0&&e&&!e.nodeType&&e,d=l&&l.exports===o,p=d&&a.process,g=function(){try{var v=l&&l.require&&l.require("util").types;return v||p&&p.binding&&p.binding("util")}catch{}}();e.exports=g})(tT,tT.exports);var INe=tT.exports,NNe=ONe,PNe=MX,lH=INe,uH=lH&&lH.isTypedArray,xNe=uH?PNe(uH):NNe,UX=xNe,DNe=MIe,LNe=aD,kNe=Sa,MNe=kX,UNe=oD,jNe=UX,VNe=Object.prototype,BNe=VNe.hasOwnProperty;function FNe(e,t){var a=kNe(e),o=!a&&LNe(e),l=!a&&!o&&MNe(e),d=!a&&!o&&!l&&jNe(e),p=a||o||l||d,g=p?DNe(e.length,String):[],v=g.length;for(var E in e)(t||BNe.call(e,E))&&!(p&&(E=="length"||l&&(E=="offset"||E=="parent")||d&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||UNe(E,v)))&&g.push(E);return g}var WNe=FNe,GNe=Object.prototype;function $Ne(e){var t=e&&e.constructor,a=typeof t=="function"&&t.prototype||GNe;return e===a}var HNe=$Ne;function zNe(e,t){return function(a){return e(t(a))}}var jX=zNe,KNe=jX,qNe=KNe(Object.keys,Object),YNe=qNe,XNe=HNe,JNe=YNe,QNe=Object.prototype,ZNe=QNe.hasOwnProperty;function ePe(e){if(!XNe(e))return JNe(e);var t=[];for(var a in Object(e))ZNe.call(e,a)&&a!="constructor"&&t.push(a);return t}var tPe=ePe,nPe=W1,rPe=sD;function iPe(e){return e!=null&&rPe(e.length)&&!nPe(e)}var mv=iPe,aPe=WNe,oPe=tPe,sPe=mv;function cPe(e){return sPe(e)?aPe(e):oPe(e)}var Rw=cPe,lPe=wIe,uPe=LIe,dPe=Rw;function hPe(e){return lPe(e,dPe,uPe)}var fPe=hPe,dH=fPe,pPe=1,mPe=Object.prototype,gPe=mPe.hasOwnProperty;function yPe(e,t,a,o,l,d){var p=a&pPe,g=dH(e),v=g.length,E=dH(t),T=E.length;if(v!=T&&!p)return!1;for(var b=v;b--;){var R=g[b];if(!(p?R in t:gPe.call(t,R)))return!1}var N=d.get(e),P=d.get(t);if(N&&P)return N==t&&P==e;var L=!0;d.set(e,t),d.set(t,e);for(var M=p;++b<v;){R=g[b];var D=e[R],U=t[R];if(o)var B=p?o(U,D,R,t,e,d):o(D,U,R,e,t,d);if(!(B===void 0?D===U||l(D,U,a,o,d):B)){L=!1;break}M||(M=R=="constructor")}if(L&&!M){var z=e.constructor,V=t.constructor;z!=V&&"constructor"in e&&"constructor"in t&&!(typeof z=="function"&&z instanceof z&&typeof V=="function"&&V instanceof V)&&(L=!1)}return d.delete(e),d.delete(t),L}var vPe=yPe,_Pe=Pd,EPe=Ws,SPe=_Pe(EPe,"DataView"),bPe=SPe,TPe=Pd,wPe=Ws,CPe=TPe(wPe,"Promise"),RPe=CPe,OPe=Pd,APe=Ws,IPe=OPe(APe,"Set"),VX=IPe,NPe=Pd,PPe=Ws,xPe=NPe(PPe,"WeakMap"),DPe=xPe,AP=bPe,IP=$1,NP=RPe,PP=VX,xP=DPe,BX=xc,Ap=z9,hH="[object Map]",LPe="[object Object]",fH="[object Promise]",pH="[object Set]",mH="[object WeakMap]",gH="[object DataView]",kPe=Ap(AP),MPe=Ap(IP),UPe=Ap(NP),jPe=Ap(PP),VPe=Ap(xP),nd=BX;(AP&&nd(new AP(new ArrayBuffer(1)))!=gH||IP&&nd(new IP)!=hH||NP&&nd(NP.resolve())!=fH||PP&&nd(new PP)!=pH||xP&&nd(new xP)!=mH)&&(nd=function(e){var t=BX(e),a=t==LPe?e.constructor:void 0,o=a?Ap(a):"";if(o)switch(o){case kPe:return gH;case MPe:return hH;case UPe:return fH;case jPe:return pH;case VPe:return mH}return t});var BPe=nd,VI=AX,FPe=xX,WPe=_Ie,GPe=vPe,yH=BPe,vH=Sa,_H=kX,$Pe=UX,HPe=1,EH="[object Arguments]",SH="[object Array]",US="[object Object]",zPe=Object.prototype,bH=zPe.hasOwnProperty;function KPe(e,t,a,o,l,d){var p=vH(e),g=vH(t),v=p?SH:yH(e),E=g?SH:yH(t);v=v==EH?US:v,E=E==EH?US:E;var T=v==US,b=E==US,R=v==E;if(R&&_H(e)){if(!_H(t))return!1;p=!0,T=!1}if(R&&!T)return d||(d=new VI),p||$Pe(e)?FPe(e,t,a,o,l,d):WPe(e,t,v,a,o,l,d);if(!(a&HPe)){var N=T&&bH.call(e,"__wrapped__"),P=b&&bH.call(t,"__wrapped__");if(N||P){var L=N?e.value():e,M=P?t.value():t;return d||(d=new VI),l(L,M,a,o,d)}}return R?(d||(d=new VI),GPe(e,t,a,o,l,d)):!1}var qPe=KPe,YPe=qPe,TH=Dc;function FX(e,t,a,o,l){return e===t?!0:e==null||t==null||!TH(e)&&!TH(t)?e!==e&&t!==t:YPe(e,t,a,o,FX,l)}var cD=FX,XPe=AX,JPe=cD,QPe=1,ZPe=2;function exe(e,t,a,o){var l=a.length,d=l,p=!o;if(e==null)return!d;for(e=Object(e);l--;){var g=a[l];if(p&&g[2]?g[1]!==e[g[0]]:!(g[0]in e))return!1}for(;++l<d;){g=a[l];var v=g[0],E=e[v],T=g[1];if(p&&g[2]){if(E===void 0&&!(v in e))return!1}else{var b=new XPe;if(o)var R=o(E,T,v,e,t,b);if(!(R===void 0?JPe(T,E,QPe|ZPe,o,b):R))return!1}}return!0}var txe=exe,nxe=tu;function rxe(e){return e===e&&!nxe(e)}var WX=rxe,ixe=WX,axe=Rw;function oxe(e){for(var t=axe(e),a=t.length;a--;){var o=t[a],l=e[o];t[a]=[o,l,ixe(l)]}return t}var sxe=oxe;function cxe(e,t){return function(a){return a==null?!1:a[e]===t&&(t!==void 0||e in Object(a))}}var GX=cxe,lxe=txe,uxe=sxe,dxe=GX;function hxe(e){var t=uxe(e);return t.length==1&&t[0][2]?dxe(t[0][0],t[0][1]):function(a){return a===e||lxe(a,e,t)}}var fxe=hxe;function pxe(e,t){return e!=null&&t in Object(e)}var mxe=pxe,gxe=J9,yxe=aD,vxe=Sa,_xe=oD,Exe=sD,Sxe=uw;function bxe(e,t,a){t=gxe(t,e);for(var o=-1,l=t.length,d=!1;++o<l;){var p=Sxe(t[o]);if(!(d=e!=null&&a(e,p)))break;e=e[p]}return d||++o!=l?d:(l=e==null?0:e.length,!!l&&Exe(l)&&_xe(p,l)&&(vxe(e)||yxe(e)))}var Txe=bxe,wxe=mxe,Cxe=Txe;function Rxe(e,t){return e!=null&&Cxe(e,t,wxe)}var Oxe=Rxe,Axe=cD,Ixe=Q9,Nxe=Oxe,Pxe=F1,xxe=WX,Dxe=GX,Lxe=uw,kxe=1,Mxe=2;function Uxe(e,t){return Pxe(e)&&xxe(t)?Dxe(Lxe(e),t):function(a){var o=Ixe(a,e);return o===void 0&&o===t?Nxe(a,e):Axe(t,o,kxe|Mxe)}}var jxe=Uxe;function Vxe(e){return e}var Ip=Vxe;function Bxe(e){return function(t){return t==null?void 0:t[e]}}var Fxe=Bxe,Wxe=q1;function Gxe(e){return function(t){return Wxe(t,e)}}var $xe=Gxe,Hxe=Fxe,zxe=$xe,Kxe=F1,qxe=uw;function Yxe(e){return Kxe(e)?Hxe(qxe(e)):zxe(e)}var Xxe=Yxe,Jxe=fxe,Qxe=jxe,Zxe=Ip,e1e=Sa,t1e=Xxe;function n1e(e){return typeof e=="function"?e:e==null?Zxe:typeof e=="object"?e1e(e)?Qxe(e[0],e[1]):Jxe(e):t1e(e)}var nu=n1e;function r1e(e,t,a,o){for(var l=e.length,d=a+(o?1:-1);o?d--:++d<l;)if(t(e[d],d,e))return d;return-1}var $X=r1e;function i1e(e){return e!==e}var a1e=i1e;function o1e(e,t,a){for(var o=a-1,l=e.length;++o<l;)if(e[o]===t)return o;return-1}var s1e=o1e,c1e=$X,l1e=a1e,u1e=s1e;function d1e(e,t,a){return t===t?u1e(e,t,a):c1e(e,l1e,a)}var h1e=d1e,f1e=h1e;function p1e(e,t){var a=e==null?0:e.length;return!!a&&f1e(e,t,0)>-1}var m1e=p1e;function g1e(e,t,a){for(var o=-1,l=e==null?0:e.length;++o<l;)if(a(t,e[o]))return!0;return!1}var y1e=g1e;function v1e(){}var _1e=v1e,BI=VX,E1e=_1e,S1e=iD,b1e=1/0,T1e=BI&&1/S1e(new BI([,-0]))[1]==b1e?function(e){return new BI(e)}:E1e,w1e=T1e,C1e=IX,R1e=m1e,O1e=y1e,A1e=PX,I1e=w1e,N1e=iD,P1e=200;function x1e(e,t,a){var o=-1,l=R1e,d=e.length,p=!0,g=[],v=g;if(a)p=!1,l=O1e;else if(d>=P1e){var E=t?null:I1e(e);if(E)return N1e(E);p=!1,l=A1e,v=new C1e}else v=t?[]:g;e:for(;++o<d;){var T=e[o],b=t?t(T):T;if(T=a||T!==0?T:0,p&&b===b){for(var R=v.length;R--;)if(v[R]===b)continue e;t&&v.push(b),g.push(T)}else l(v,b,a)||(v!==g&&v.push(b),g.push(T))}return g}var D1e=x1e,L1e=nu,k1e=D1e;function M1e(e,t){return e&&e.length?k1e(e,L1e(t)):[]}var U1e=M1e;const wH=Kn(U1e);function HX(e,t,a){return t===!0?wH(e,a):Zt(t)?wH(e,t):e}function zf(e){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}var j1e=["ref"];function CH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function hc(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?CH(Object(a),!0).forEach(function(o){Ow(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):CH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function V1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,KX(o.key),o)}}function B1e(e,t,a){return RH(e.prototype,t),RH(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function F1e(e,t,a){return t=nT(t),W1e(e,zX()?Reflect.construct(t,a,nT(e).constructor):t.apply(e,a))}function W1e(e,t){if(t&&(zf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G1e(e)}function G1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zX=function(){return!!e})()}function nT(e){return nT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},nT(e)}function $1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DP(e,t)}function DP(e,t){return DP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},DP(e,t)}function Ow(e,t,a){return t=KX(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function KX(e){var t=H1e(e,"string");return zf(t)=="symbol"?t:t+""}function H1e(e,t){if(zf(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(zf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z1e(e,t){if(e==null)return{};var a=K1e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function K1e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function q1e(e){return e.value}function Y1e(e,t){if(ye.isValidElement(e))return ye.cloneElement(e,t);if(typeof e=="function")return ye.createElement(e,t);t.ref;var a=z1e(t,j1e);return ye.createElement(rD,a)}var OH=1,md=function(e){function t(){var a;V1e(this,t);for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return a=F1e(this,t,[].concat(l)),Ow(a,"lastBoundingBox",{width:-1,height:-1}),a}return $1e(t,e),B1e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();return o.height=this.wrapperNode.offsetHeight,o.width=this.wrapperNode.offsetWidth,o}return null}},{key:"updateBBox",value:function(){var o=this.props.onBBoxUpdate,l=this.getBBox();l?(Math.abs(l.width-this.lastBoundingBox.width)>OH||Math.abs(l.height-this.lastBoundingBox.height)>OH)&&(this.lastBoundingBox.width=l.width,this.lastBoundingBox.height=l.height,o&&o(l)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,o&&o(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?hc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(o){var l=this.props,d=l.layout,p=l.align,g=l.verticalAlign,v=l.margin,E=l.chartWidth,T=l.chartHeight,b,R;if(!o||(o.left===void 0||o.left===null)&&(o.right===void 0||o.right===null))if(p==="center"&&d==="vertical"){var N=this.getBBoxSnapshot();b={left:((E||0)-N.width)/2}}else b=p==="right"?{right:v&&v.right||0}:{left:v&&v.left||0};if(!o||(o.top===void 0||o.top===null)&&(o.bottom===void 0||o.bottom===null))if(g==="middle"){var P=this.getBBoxSnapshot();R={top:((T||0)-P.height)/2}}else R=g==="bottom"?{bottom:v&&v.bottom||0}:{top:v&&v.top||0};return hc(hc({},b),R)}},{key:"render",value:function(){var o=this,l=this.props,d=l.content,p=l.width,g=l.height,v=l.wrapperStyle,E=l.payloadUniqBy,T=l.payload,b=hc(hc({position:"absolute",width:p||"auto",height:g||"auto"},this.getDefaultPosition(v)),v);return ye.createElement("div",{className:"recharts-legend-wrapper",style:b,ref:function(N){o.wrapperNode=N}},Y1e(d,hc(hc({},this.props),{},{payload:HX(T,E,q1e)})))}}],[{key:"getWithHeight",value:function(o,l){var d=hc(hc({},this.defaultProps),o.props),p=d.layout;return p==="vertical"&&Ze(o.props.height)?{height:o.props.height}:p==="horizontal"?{width:o.props.width||l}:null}}])}(x.PureComponent);Ow(md,"displayName","Legend");Ow(md,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var AH=hv,X1e=aD,J1e=Sa,IH=AH?AH.isConcatSpreadable:void 0;function Q1e(e){return J1e(e)||X1e(e)||!!(IH&&e&&e[IH])}var Z1e=Q1e,eDe=DX,tDe=Z1e;function qX(e,t,a,o,l){var d=-1,p=e.length;for(a||(a=tDe),l||(l=[]);++d<p;){var g=e[d];t>0&&a(g)?t>1?qX(g,t-1,a,o,l):eDe(l,g):o||(l[l.length]=g)}return l}var YX=qX;function nDe(e){return function(t,a,o){for(var l=-1,d=Object(t),p=o(t),g=p.length;g--;){var v=p[e?g:++l];if(a(d[v],v,d)===!1)break}return t}}var rDe=nDe,iDe=rDe,aDe=iDe(),oDe=aDe,sDe=oDe,cDe=Rw;function lDe(e,t){return e&&sDe(e,t,cDe)}var XX=lDe,uDe=mv;function dDe(e,t){return function(a,o){if(a==null)return a;if(!uDe(a))return e(a,o);for(var l=a.length,d=t?l:-1,p=Object(a);(t?d--:++d<l)&&o(p[d],d,p)!==!1;);return a}}var hDe=dDe,fDe=XX,pDe=hDe,mDe=pDe(fDe),lD=mDe,gDe=lD,yDe=mv;function vDe(e,t){var a=-1,o=yDe(e)?Array(e.length):[];return gDe(e,function(l,d,p){o[++a]=t(l,d,p)}),o}var JX=vDe;function _De(e,t){var a=e.length;for(e.sort(t);a--;)e[a]=e[a].value;return e}var EDe=_De,NH=bp;function SDe(e,t){if(e!==t){var a=e!==void 0,o=e===null,l=e===e,d=NH(e),p=t!==void 0,g=t===null,v=t===t,E=NH(t);if(!g&&!E&&!d&&e>t||d&&p&&v&&!g&&!E||o&&p&&v||!a&&v||!l)return 1;if(!o&&!d&&!E&&e<t||E&&a&&l&&!o&&!d||g&&a&&l||!p&&l||!v)return-1}return 0}var bDe=SDe,TDe=bDe;function wDe(e,t,a){for(var o=-1,l=e.criteria,d=t.criteria,p=l.length,g=a.length;++o<p;){var v=TDe(l[o],d[o]);if(v){if(o>=g)return v;var E=a[o];return v*(E=="desc"?-1:1)}}return e.index-t.index}var CDe=wDe,FI=K1,RDe=q1,ODe=nu,ADe=JX,IDe=EDe,NDe=MX,PDe=CDe,xDe=Ip,DDe=Sa;function LDe(e,t,a){t.length?t=FI(t,function(d){return DDe(d)?function(p){return RDe(p,d.length===1?d[0]:d)}:d}):t=[xDe];var o=-1;t=FI(t,NDe(ODe));var l=ADe(e,function(d,p,g){var v=FI(t,function(E){return E(d)});return{criteria:v,index:++o,value:d}});return IDe(l,function(d,p){return PDe(d,p,a)})}var kDe=LDe;function MDe(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}var UDe=MDe,jDe=UDe,PH=Math.max;function VDe(e,t,a){return t=PH(t===void 0?e.length-1:t,0),function(){for(var o=arguments,l=-1,d=PH(o.length-t,0),p=Array(d);++l<d;)p[l]=o[t+l];l=-1;for(var g=Array(t+1);++l<t;)g[l]=o[l];return g[t]=a(p),jDe(e,this,g)}}var BDe=VDe;function FDe(e){return function(){return e}}var WDe=FDe,GDe=Pd,$De=function(){try{var e=GDe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),QX=$De,HDe=WDe,xH=QX,zDe=Ip,KDe=xH?function(e,t){return xH(e,"toString",{configurable:!0,enumerable:!1,value:HDe(t),writable:!0})}:zDe,qDe=KDe,YDe=800,XDe=16,JDe=Date.now;function QDe(e){var t=0,a=0;return function(){var o=JDe(),l=XDe-(o-a);if(a=o,l>0){if(++t>=YDe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ZDe=QDe,eLe=qDe,tLe=ZDe,nLe=tLe(eLe),rLe=nLe,iLe=Ip,aLe=BDe,oLe=rLe;function sLe(e,t){return oLe(aLe(e,t,iLe),e+"")}var cLe=sLe,lLe=G1,uLe=mv,dLe=oD,hLe=tu;function fLe(e,t,a){if(!hLe(a))return!1;var o=typeof t;return(o=="number"?uLe(a)&&dLe(t,a.length):o=="string"&&t in a)?lLe(a[t],e):!1}var Aw=fLe,pLe=YX,mLe=kDe,gLe=cLe,DH=Aw,yLe=gLe(function(e,t){if(e==null)return[];var a=t.length;return a>1&&DH(e,t[0],t[1])?t=[]:a>2&&DH(t[0],t[1],t[2])&&(t=[t[0]]),mLe(e,pLe(t,1),[])}),vLe=yLe;const uD=Kn(vLe);function Cy(e){"@babel/helpers - typeof";return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(e)}function LP(){return LP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},LP.apply(this,arguments)}function _Le(e,t){return TLe(e)||bLe(e,t)||SLe(e,t)||ELe()}function ELe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SLe(e,t){if(e){if(typeof e=="string")return LH(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return LH(e,t)}}function LH(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function bLe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function TLe(e){if(Array.isArray(e))return e}function kH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function WI(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?kH(Object(a),!0).forEach(function(o){wLe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function wLe(e,t,a){return t=CLe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function CLe(e){var t=RLe(e,"string");return Cy(t)=="symbol"?t:t+""}function RLe(e,t){if(Cy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Cy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OLe(e){return Array.isArray(e)&&Zr(e[0])&&Zr(e[1])?e.join(" ~ "):e}var ALe=function(t){var a=t.separator,o=a===void 0?" : ":a,l=t.contentStyle,d=l===void 0?{}:l,p=t.itemStyle,g=p===void 0?{}:p,v=t.labelStyle,E=v===void 0?{}:v,T=t.payload,b=t.formatter,R=t.itemSorter,N=t.wrapperClassName,P=t.labelClassName,L=t.label,M=t.labelFormatter,D=t.accessibilityLayer,U=D===void 0?!1:D,B=function(){if(T&&T.length){var ce={padding:0,margin:0},be=(R?uD(T,R):T).map(function(ae,fe){if(ae.type==="none")return null;var me=WI({display:"block",paddingTop:4,paddingBottom:4,color:ae.color||"#000"},g),_e=ae.formatter||b||OLe,ue=ae.value,ve=ae.name,Ce=ue,Ve=ve;if(Ce!=null&&Ve!=null){var Pe=_e(ue,ve,ae,fe,T);if(Array.isArray(Pe)){var Ge=_Le(Pe,2);Ce=Ge[0],Ve=Ge[1]}else Ce=Pe}return ye.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(fe),style:me},Zr(Ve)?ye.createElement("span",{className:"recharts-tooltip-item-name"},Ve):null,Zr(Ve)?ye.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,ye.createElement("span",{className:"recharts-tooltip-item-value"},Ce),ye.createElement("span",{className:"recharts-tooltip-item-unit"},ae.unit||""))});return ye.createElement("ul",{className:"recharts-tooltip-item-list",style:ce},be)}return null},z=WI({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},d),V=WI({margin:0},E),G=!Pn(L),q=G?L:"",ne=Sn("recharts-default-tooltip",N),Z=Sn("recharts-tooltip-label",P);G&&M&&T!==void 0&&T!==null&&(q=M(L,T));var le=U?{role:"status","aria-live":"assertive"}:{};return ye.createElement("div",LP({className:ne,style:z},le),ye.createElement("p",{className:Z,style:V},ye.isValidElement(q)?q:"".concat(q)),B())};function Ry(e){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(e)}function jS(e,t,a){return t=ILe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ILe(e){var t=NLe(e,"string");return Ry(t)=="symbol"?t:t+""}function NLe(e,t){if(Ry(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Ry(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tg="recharts-tooltip-wrapper",PLe={visibility:"hidden"};function xLe(e){var t=e.coordinate,a=e.translateX,o=e.translateY;return Sn(Tg,jS(jS(jS(jS({},"".concat(Tg,"-right"),Ze(a)&&t&&Ze(t.x)&&a>=t.x),"".concat(Tg,"-left"),Ze(a)&&t&&Ze(t.x)&&a<t.x),"".concat(Tg,"-bottom"),Ze(o)&&t&&Ze(t.y)&&o>=t.y),"".concat(Tg,"-top"),Ze(o)&&t&&Ze(t.y)&&o<t.y))}function MH(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.key,l=e.offsetTopLeft,d=e.position,p=e.reverseDirection,g=e.tooltipDimension,v=e.viewBox,E=e.viewBoxDimension;if(d&&Ze(d[o]))return d[o];var T=a[o]-g-l,b=a[o]+l;if(t[o])return p[o]?T:b;if(p[o]){var R=T,N=v[o];return R<N?Math.max(b,v[o]):Math.max(T,v[o])}var P=b+g,L=v[o]+E;return P>L?Math.max(T,v[o]):Math.max(b,v[o])}function DLe(e){var t=e.translateX,a=e.translateY,o=e.useTranslate3d;return{transform:o?"translate3d(".concat(t,"px, ").concat(a,"px, 0)"):"translate(".concat(t,"px, ").concat(a,"px)")}}function LLe(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.offsetTopLeft,l=e.position,d=e.reverseDirection,p=e.tooltipBox,g=e.useTranslate3d,v=e.viewBox,E,T,b;return p.height>0&&p.width>0&&a?(T=MH({allowEscapeViewBox:t,coordinate:a,key:"x",offsetTopLeft:o,position:l,reverseDirection:d,tooltipDimension:p.width,viewBox:v,viewBoxDimension:v.width}),b=MH({allowEscapeViewBox:t,coordinate:a,key:"y",offsetTopLeft:o,position:l,reverseDirection:d,tooltipDimension:p.height,viewBox:v,viewBoxDimension:v.height}),E=DLe({translateX:T,translateY:b,useTranslate3d:g})):E=PLe,{cssProperties:E,cssClasses:xLe({translateX:T,translateY:b,coordinate:a})}}function Kf(e){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(e)}function UH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function jH(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?UH(Object(a),!0).forEach(function(o){MP(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):UH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function kLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MLe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,eJ(o.key),o)}}function ULe(e,t,a){return MLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jLe(e,t,a){return t=rT(t),VLe(e,ZX()?Reflect.construct(t,a,rT(e).constructor):t.apply(e,a))}function VLe(e,t){if(t&&(Kf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BLe(e)}function BLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZX=function(){return!!e})()}function rT(e){return rT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},rT(e)}function FLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kP(e,t)}function kP(e,t){return kP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},kP(e,t)}function MP(e,t,a){return t=eJ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eJ(e){var t=WLe(e,"string");return Kf(t)=="symbol"?t:t+""}function WLe(e,t){if(Kf(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Kf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var VH=1,GLe=function(e){function t(){var a;kLe(this,t);for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return a=jLe(this,t,[].concat(l)),MP(a,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),MP(a,"handleKeyDown",function(p){if(p.key==="Escape"){var g,v,E,T;a.setState({dismissed:!0,dismissedAtCoordinate:{x:(g=(v=a.props.coordinate)===null||v===void 0?void 0:v.x)!==null&&g!==void 0?g:0,y:(E=(T=a.props.coordinate)===null||T===void 0?void 0:T.y)!==null&&E!==void 0?E:0}})}}),a}return FLe(t,e),ULe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();(Math.abs(o.width-this.state.lastBoundingBox.width)>VH||Math.abs(o.height-this.state.lastBoundingBox.height)>VH)&&this.setState({lastBoundingBox:{width:o.width,height:o.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var o,l;this.props.active&&this.updateBBox(),this.state.dismissed&&(((o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==this.state.dismissedAtCoordinate.x||((l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var o=this,l=this.props,d=l.active,p=l.allowEscapeViewBox,g=l.animationDuration,v=l.animationEasing,E=l.children,T=l.coordinate,b=l.hasPayload,R=l.isAnimationActive,N=l.offset,P=l.position,L=l.reverseDirection,M=l.useTranslate3d,D=l.viewBox,U=l.wrapperStyle,B=LLe({allowEscapeViewBox:p,coordinate:T,offsetTopLeft:N,position:P,reverseDirection:L,tooltipBox:this.state.lastBoundingBox,useTranslate3d:M,viewBox:D}),z=B.cssClasses,V=B.cssProperties,G=jH(jH({transition:R&&d?"transform ".concat(g,"ms ").concat(v):void 0},V),{},{pointerEvents:"none",visibility:!this.state.dismissed&&d&&b?"visible":"hidden",position:"absolute",top:0,left:0},U);return ye.createElement("div",{tabIndex:-1,className:z,style:G,ref:function(ne){o.wrapperNode=ne}},E)}}])}(x.PureComponent),$Le=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Gl={isSsr:$Le(),get:function(t){return Gl[t]},set:function(t,a){if(typeof t=="string")Gl[t]=a;else{var o=Object.keys(t);o&&o.length&&o.forEach(function(l){Gl[l]=t[l]})}}};function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function BH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function FH(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?BH(Object(a),!0).forEach(function(o){dD(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):BH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function HLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zLe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,nJ(o.key),o)}}function KLe(e,t,a){return zLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qLe(e,t,a){return t=iT(t),YLe(e,tJ()?Reflect.construct(t,a||[],iT(e).constructor):t.apply(e,a))}function YLe(e,t){if(t&&(qf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XLe(e)}function XLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tJ=function(){return!!e})()}function iT(e){return iT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},iT(e)}function JLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UP(e,t)}function UP(e,t){return UP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},UP(e,t)}function dD(e,t,a){return t=nJ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function nJ(e){var t=QLe(e,"string");return qf(t)=="symbol"?t:t+""}function QLe(e,t){if(qf(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(qf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZLe(e){return e.dataKey}function eke(e,t){return ye.isValidElement(e)?ye.cloneElement(e,t):typeof e=="function"?ye.createElement(e,t):ye.createElement(ALe,t)}var xs=function(e){function t(){return HLe(this,t),qLe(this,t,arguments)}return JLe(t,e),KLe(t,[{key:"render",value:function(){var o=this,l=this.props,d=l.active,p=l.allowEscapeViewBox,g=l.animationDuration,v=l.animationEasing,E=l.content,T=l.coordinate,b=l.filterNull,R=l.isAnimationActive,N=l.offset,P=l.payload,L=l.payloadUniqBy,M=l.position,D=l.reverseDirection,U=l.useTranslate3d,B=l.viewBox,z=l.wrapperStyle,V=P??[];b&&V.length&&(V=HX(P.filter(function(q){return q.value!=null&&(q.hide!==!0||o.props.includeHidden)}),L,ZLe));var G=V.length>0;return ye.createElement(GLe,{allowEscapeViewBox:p,animationDuration:g,animationEasing:v,isAnimationActive:R,active:d,coordinate:T,hasPayload:G,offset:N,position:M,reverseDirection:D,useTranslate3d:U,viewBox:B,wrapperStyle:z},eke(E,FH(FH({},this.props),{},{payload:V})))}}])}(x.PureComponent);dD(xs,"displayName","Tooltip");dD(xs,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Gl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var tke=Ws,nke=function(){return tke.Date.now()},rke=nke,ike=/\s/;function ake(e){for(var t=e.length;t--&&ike.test(e.charAt(t)););return t}var oke=ake,ske=oke,cke=/^\s+/;function lke(e){return e&&e.slice(0,ske(e)+1).replace(cke,"")}var uke=lke,dke=uke,WH=tu,hke=bp,GH=NaN,fke=/^[-+]0x[0-9a-f]+$/i,pke=/^0b[01]+$/i,mke=/^0o[0-7]+$/i,gke=parseInt;function yke(e){if(typeof e=="number")return e;if(hke(e))return GH;if(WH(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=WH(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=dke(e);var a=pke.test(e);return a||mke.test(e)?gke(e.slice(2),a?2:8):fke.test(e)?GH:+e}var rJ=yke,vke=tu,GI=rke,$H=rJ,_ke="Expected a function",Eke=Math.max,Ske=Math.min;function bke(e,t,a){var o,l,d,p,g,v,E=0,T=!1,b=!1,R=!0;if(typeof e!="function")throw new TypeError(_ke);t=$H(t)||0,vke(a)&&(T=!!a.leading,b="maxWait"in a,d=b?Eke($H(a.maxWait)||0,t):d,R="trailing"in a?!!a.trailing:R);function N(G){var q=o,ne=l;return o=l=void 0,E=G,p=e.apply(ne,q),p}function P(G){return E=G,g=setTimeout(D,t),T?N(G):p}function L(G){var q=G-v,ne=G-E,Z=t-q;return b?Ske(Z,d-ne):Z}function M(G){var q=G-v,ne=G-E;return v===void 0||q>=t||q<0||b&&ne>=d}function D(){var G=GI();if(M(G))return U(G);g=setTimeout(D,L(G))}function U(G){return g=void 0,R&&o?N(G):(o=l=void 0,p)}function B(){g!==void 0&&clearTimeout(g),E=0,o=v=l=g=void 0}function z(){return g===void 0?p:U(GI())}function V(){var G=GI(),q=M(G);if(o=arguments,l=this,v=G,q){if(g===void 0)return P(v);if(b)return clearTimeout(g),g=setTimeout(D,t),N(v)}return g===void 0&&(g=setTimeout(D,t)),p}return V.cancel=B,V.flush=z,V}var Tke=bke,wke=Tke,Cke=tu,Rke="Expected a function";function Oke(e,t,a){var o=!0,l=!0;if(typeof e!="function")throw new TypeError(Rke);return Cke(a)&&(o="leading"in a?!!a.leading:o,l="trailing"in a?!!a.trailing:l),wke(e,t,{leading:o,maxWait:t,trailing:l})}var Ake=Oke;const iJ=Kn(Ake);function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function HH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function VS(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?HH(Object(a),!0).forEach(function(o){Ike(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Ike(e,t,a){return t=Nke(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Nke(e){var t=Pke(e,"string");return Oy(t)=="symbol"?t:t+""}function Pke(e,t){if(Oy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Oy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xke(e,t){return Mke(e)||kke(e,t)||Lke(e,t)||Dke()}function Dke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lke(e,t){if(e){if(typeof e=="string")return zH(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zH(e,t)}}function zH(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function kke(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function Mke(e){if(Array.isArray(e))return e}var Uke=x.forwardRef(function(e,t){var a=e.aspect,o=e.initialDimension,l=o===void 0?{width:-1,height:-1}:o,d=e.width,p=d===void 0?"100%":d,g=e.height,v=g===void 0?"100%":g,E=e.minWidth,T=E===void 0?0:E,b=e.minHeight,R=e.maxHeight,N=e.children,P=e.debounce,L=P===void 0?0:P,M=e.id,D=e.className,U=e.onResize,B=e.style,z=B===void 0?{}:B,V=x.useRef(null),G=x.useRef();G.current=U,x.useImperativeHandle(t,function(){return Object.defineProperty(V.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),V.current},configurable:!0})});var q=x.useState({containerWidth:l.width,containerHeight:l.height}),ne=xke(q,2),Z=ne[0],le=ne[1],ee=x.useCallback(function(be,ae){le(function(fe){var me=Math.round(be),_e=Math.round(ae);return fe.containerWidth===me&&fe.containerHeight===_e?fe:{containerWidth:me,containerHeight:_e}})},[]);x.useEffect(function(){var be=function(ve){var Ce,Ve=ve[0].contentRect,Pe=Ve.width,Ge=Ve.height;ee(Pe,Ge),(Ce=G.current)===null||Ce===void 0||Ce.call(G,Pe,Ge)};L>0&&(be=iJ(be,L,{trailing:!0,leading:!1}));var ae=new ResizeObserver(be),fe=V.current.getBoundingClientRect(),me=fe.width,_e=fe.height;return ee(me,_e),ae.observe(V.current),function(){ae.disconnect()}},[ee,L]);var ce=x.useMemo(function(){var be=Z.containerWidth,ae=Z.containerHeight;if(be<0||ae<0)return null;bc(ld(p)||ld(v),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,p,v),bc(!a||a>0,"The aspect(%s) must be greater than zero.",a);var fe=ld(p)?be:p,me=ld(v)?ae:v;a&&a>0&&(fe?me=fe/a:me&&(fe=me*a),R&&me>R&&(me=R)),bc(fe>0||me>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,fe,me,p,v,T,b,a);var _e=!Array.isArray(N)&&Sc(N.type).endsWith("Chart");return ye.Children.map(N,function(ue){return ye.isValidElement(ue)?x.cloneElement(ue,VS({width:fe,height:me},_e?{style:VS({height:"100%",width:"100%",maxHeight:me,maxWidth:fe},ue.props.style)}:{})):ue})},[a,N,v,R,b,T,Z,p]);return ye.createElement("div",{id:M?"".concat(M):void 0,className:Sn("recharts-responsive-container",D),style:VS(VS({},z),{},{width:p,height:v,minWidth:T,minHeight:b,maxHeight:R}),ref:V},ce)}),aJ=function(t){return null};aJ.displayName="Cell";function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function KH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function jP(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?KH(Object(a),!0).forEach(function(o){jke(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):KH(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function jke(e,t,a){return t=Vke(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Vke(e){var t=Bke(e,"string");return Ay(t)=="symbol"?t:t+""}function Bke(e,t){if(Ay(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Ay(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rf={widthCache:{},cacheCount:0},Fke=2e3,Wke={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},qH="recharts_measurement_span";function Gke(e){var t=jP({},e);return Object.keys(t).forEach(function(a){t[a]||delete t[a]}),t}var Zg=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Gl.isSsr)return{width:0,height:0};var o=Gke(a),l=JSON.stringify({text:t,copyStyle:o});if(rf.widthCache[l])return rf.widthCache[l];try{var d=document.getElementById(qH);d||(d=document.createElement("span"),d.setAttribute("id",qH),d.setAttribute("aria-hidden","true"),document.body.appendChild(d));var p=jP(jP({},Wke),o);Object.assign(d.style,p),d.textContent="".concat(t);var g=d.getBoundingClientRect(),v={width:g.width,height:g.height};return rf.widthCache[l]=v,++rf.cacheCount>Fke&&(rf.cacheCount=0,rf.widthCache={}),v}catch{return{width:0,height:0}}},$ke=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function aT(e,t){return qke(e)||Kke(e,t)||zke(e,t)||Hke()}function Hke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zke(e,t){if(e){if(typeof e=="string")return YH(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return YH(e,t)}}function YH(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Kke(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;v=!1}else for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function qke(e){if(Array.isArray(e))return e}function Yke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Jke(o.key),o)}}function Xke(e,t,a){return XH(e.prototype,t),XH(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jke(e){var t=Qke(e,"string");return Iy(t)=="symbol"?t:t+""}function Qke(e,t){if(Iy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Iy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var JH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Zke=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,eMe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,oJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},tMe=Object.keys(oJ),bf="NaN";function nMe(e,t){return e*oJ[t]}var BS=function(){function e(t,a){Yke(this,e),this.num=t,this.unit=a,this.num=t,this.unit=a,Number.isNaN(t)&&(this.unit=""),a!==""&&!Zke.test(a)&&(this.num=NaN,this.unit=""),tMe.includes(a)&&(this.num=nMe(t,a),this.unit="px")}return Xke(e,[{key:"add",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num+a.num,this.unit)}},{key:"subtract",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num-a.num,this.unit)}},{key:"multiply",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num*a.num,this.unit||a.unit)}},{key:"divide",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num/a.num,this.unit||a.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(a){var o,l=(o=eMe.exec(a))!==null&&o!==void 0?o:[],d=aT(l,3),p=d[1],g=d[2];return new e(parseFloat(p),g??"")}}])}();function sJ(e){if(e.includes(bf))return bf;for(var t=e;t.includes("*")||t.includes("/");){var a,o=(a=JH.exec(t))!==null&&a!==void 0?a:[],l=aT(o,4),d=l[1],p=l[2],g=l[3],v=BS.parse(d??""),E=BS.parse(g??""),T=p==="*"?v.multiply(E):v.divide(E);if(T.isNaN())return bf;t=t.replace(JH,T.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var b,R=(b=QH.exec(t))!==null&&b!==void 0?b:[],N=aT(R,4),P=N[1],L=N[2],M=N[3],D=BS.parse(P??""),U=BS.parse(M??""),B=L==="+"?D.add(U):D.subtract(U);if(B.isNaN())return bf;t=t.replace(QH,B.toString())}return t}var ZH=/\(([^()]*)\)/;function rMe(e){for(var t=e;t.includes("(");){var a=ZH.exec(t),o=aT(a,2),l=o[1];t=t.replace(ZH,sJ(l))}return t}function iMe(e){var t=e.replace(/\s+/g,"");return t=rMe(t),t=sJ(t),t}function aMe(e){try{return iMe(e)}catch{return bf}}function $I(e){var t=aMe(e.slice(5,-1));return t===bf?"":t}var oMe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],sMe=["dx","dy","angle","className","breakAll"];function VP(){return VP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},VP.apply(this,arguments)}function ez(e,t){if(e==null)return{};var a=cMe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function cMe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function tz(e,t){return hMe(e)||dMe(e,t)||uMe(e,t)||lMe()}function lMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uMe(e,t){if(e){if(typeof e=="string")return nz(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return nz(e,t)}}function nz(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function dMe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;v=!1}else for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function hMe(e){if(Array.isArray(e))return e}var cJ=/[ \f\n\r\t\v\u2028\u2029]+/,lJ=function(t){var a=t.children,o=t.breakAll,l=t.style;try{var d=[];Pn(a)||(o?d=a.toString().split(""):d=a.toString().split(cJ));var p=d.map(function(v){return{word:v,width:Zg(v,l).width}}),g=o?0:Zg("",l).width;return{wordsWithComputedWidth:p,spaceWidth:g}}catch{return null}},fMe=function(t,a,o,l,d){var p=t.maxLines,g=t.children,v=t.style,E=t.breakAll,T=Ze(p),b=g,R=function(){var fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return fe.reduce(function(me,_e){var ue=_e.word,ve=_e.width,Ce=me[me.length-1];if(Ce&&(l==null||d||Ce.width+ve+o<Number(l)))Ce.words.push(ue),Ce.width+=ve+o;else{var Ve={words:[ue],width:ve};me.push(Ve)}return me},[])},N=R(a),P=function(fe){return fe.reduce(function(me,_e){return me.width>_e.width?me:_e})};if(!T)return N;for(var L="",M=function(fe){var me=b.slice(0,fe),_e=lJ({breakAll:E,style:v,children:me+L}).wordsWithComputedWidth,ue=R(_e),ve=ue.length>p||P(ue).width>Number(l);return[ve,ue]},D=0,U=b.length-1,B=0,z;D<=U&&B<=b.length-1;){var V=Math.floor((D+U)/2),G=V-1,q=M(G),ne=tz(q,2),Z=ne[0],le=ne[1],ee=M(V),ce=tz(ee,1),be=ce[0];if(!Z&&!be&&(D=V+1),Z&&be&&(U=V-1),!Z&&be){z=le;break}B++}return z||N},rz=function(t){var a=Pn(t)?[]:t.toString().split(cJ);return[{words:a}]},pMe=function(t){var a=t.width,o=t.scaleToFit,l=t.children,d=t.style,p=t.breakAll,g=t.maxLines;if((a||o)&&!Gl.isSsr){var v,E,T=lJ({breakAll:p,children:l,style:d});if(T){var b=T.wordsWithComputedWidth,R=T.spaceWidth;v=b,E=R}else return rz(l);return fMe({breakAll:p,children:l,maxLines:g,style:d},v,E,a,o)}return rz(l)},iz="#808080",oT=function(t){var a=t.x,o=a===void 0?0:a,l=t.y,d=l===void 0?0:l,p=t.lineHeight,g=p===void 0?"1em":p,v=t.capHeight,E=v===void 0?"0.71em":v,T=t.scaleToFit,b=T===void 0?!1:T,R=t.textAnchor,N=R===void 0?"start":R,P=t.verticalAnchor,L=P===void 0?"end":P,M=t.fill,D=M===void 0?iz:M,U=ez(t,oMe),B=x.useMemo(function(){return pMe({breakAll:U.breakAll,children:U.children,maxLines:U.maxLines,scaleToFit:b,style:U.style,width:U.width})},[U.breakAll,U.children,U.maxLines,b,U.style,U.width]),z=U.dx,V=U.dy,G=U.angle,q=U.className,ne=U.breakAll,Z=ez(U,sMe);if(!Zr(o)||!Zr(d))return null;var le=o+(Ze(z)?z:0),ee=d+(Ze(V)?V:0),ce;switch(L){case"start":ce=$I("calc(".concat(E,")"));break;case"middle":ce=$I("calc(".concat((B.length-1)/2," * -").concat(g," + (").concat(E," / 2))"));break;default:ce=$I("calc(".concat(B.length-1," * -").concat(g,")"));break}var be=[];if(b){var ae=B[0].width,fe=U.width;be.push("scale(".concat((Ze(fe)?fe/ae:1)/ae,")"))}return G&&be.push("rotate(".concat(G,", ").concat(le,", ").concat(ee,")")),be.length&&(Z.transform=be.join(" ")),ye.createElement("text",VP({},Cn(Z,!0),{x:le,y:ee,className:Sn("recharts-text",q),textAnchor:N,fill:D.includes("url")?iz:D}),B.map(function(me,_e){var ue=me.words.join(ne?"":" ");return ye.createElement("tspan",{x:le,dy:_e===0?ce:g,key:"".concat(ue,"-").concat(_e)},ue)}))};function $l(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function mMe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hD(e){let t,a,o;e.length!==2?(t=$l,a=(g,v)=>$l(e(g),v),o=(g,v)=>e(g)-v):(t=e===$l||e===mMe?e:gMe,a=e,o=e);function l(g,v,E=0,T=g.length){if(E<T){if(t(v,v)!==0)return T;do{const b=E+T>>>1;a(g[b],v)<0?E=b+1:T=b}while(E<T)}return E}function d(g,v,E=0,T=g.length){if(E<T){if(t(v,v)!==0)return T;do{const b=E+T>>>1;a(g[b],v)<=0?E=b+1:T=b}while(E<T)}return E}function p(g,v,E=0,T=g.length){const b=l(g,v,E,T-1);return b>E&&o(g[b-1],v)>-o(g[b],v)?b-1:b}return{left:l,center:p,right:d}}function gMe(){return 0}function uJ(e){return e===null?NaN:+e}function*yMe(e,t){for(let a of e)a!=null&&(a=+a)>=a&&(yield a)}const vMe=hD($l),gv=vMe.right;hD(uJ).center;class az extends Map{constructor(t,a=SMe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:a}}),t!=null)for(const[o,l]of t)this.set(o,l)}get(t){return super.get(oz(this,t))}has(t){return super.has(oz(this,t))}set(t,a){return super.set(_Me(this,t),a)}delete(t){return super.delete(EMe(this,t))}}function oz({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):a}function _Me({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):(e.set(o,a),a)}function EMe({_intern:e,_key:t},a){const o=t(a);return e.has(o)&&(a=e.get(o),e.delete(o)),a}function SMe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function bMe(e=$l){if(e===$l)return dJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,a)=>{const o=e(t,a);return o||o===0?o:(e(a,a)===0)-(e(t,t)===0)}}function dJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const TMe=Math.sqrt(50),wMe=Math.sqrt(10),CMe=Math.sqrt(2);function sT(e,t,a){const o=(t-e)/Math.max(0,a),l=Math.floor(Math.log10(o)),d=o/Math.pow(10,l),p=d>=TMe?10:d>=wMe?5:d>=CMe?2:1;let g,v,E;return l<0?(E=Math.pow(10,-l)/p,g=Math.round(e*E),v=Math.round(t*E),g/E<e&&++g,v/E>t&&--v,E=-E):(E=Math.pow(10,l)*p,g=Math.round(e/E),v=Math.round(t/E),g*E<e&&++g,v*E>t&&--v),v<g&&.5<=a&&a<2?sT(e,t,a*2):[g,v,E]}function BP(e,t,a){if(t=+t,e=+e,a=+a,!(a>0))return[];if(e===t)return[e];const o=t<e,[l,d,p]=o?sT(t,e,a):sT(e,t,a);if(!(d>=l))return[];const g=d-l+1,v=new Array(g);if(o)if(p<0)for(let E=0;E<g;++E)v[E]=(d-E)/-p;else for(let E=0;E<g;++E)v[E]=(d-E)*p;else if(p<0)for(let E=0;E<g;++E)v[E]=(l+E)/-p;else for(let E=0;E<g;++E)v[E]=(l+E)*p;return v}function FP(e,t,a){return t=+t,e=+e,a=+a,sT(e,t,a)[2]}function WP(e,t,a){t=+t,e=+e,a=+a;const o=t<e,l=o?FP(t,e,a):FP(e,t,a);return(o?-1:1)*(l<0?1/-l:l)}function sz(e,t){let a;for(const o of e)o!=null&&(a<o||a===void 0&&o>=o)&&(a=o);return a}function cz(e,t){let a;for(const o of e)o!=null&&(a>o||a===void 0&&o>=o)&&(a=o);return a}function hJ(e,t,a=0,o=1/0,l){if(t=Math.floor(t),a=Math.floor(Math.max(0,a)),o=Math.floor(Math.min(e.length-1,o)),!(a<=t&&t<=o))return e;for(l=l===void 0?dJ:bMe(l);o>a;){if(o-a>600){const v=o-a+1,E=t-a+1,T=Math.log(v),b=.5*Math.exp(2*T/3),R=.5*Math.sqrt(T*b*(v-b)/v)*(E-v/2<0?-1:1),N=Math.max(a,Math.floor(t-E*b/v+R)),P=Math.min(o,Math.floor(t+(v-E)*b/v+R));hJ(e,t,N,P,l)}const d=e[t];let p=a,g=o;for(wg(e,a,t),l(e[o],d)>0&&wg(e,a,o);p<g;){for(wg(e,p,g),++p,--g;l(e[p],d)<0;)++p;for(;l(e[g],d)>0;)--g}l(e[a],d)===0?wg(e,a,g):(++g,wg(e,g,o)),g<=t&&(a=g+1),t<=g&&(o=g-1)}return e}function wg(e,t,a){const o=e[t];e[t]=e[a],e[a]=o}function RMe(e,t,a){if(e=Float64Array.from(yMe(e)),!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return cz(e);if(t>=1)return sz(e);var o,l=(o-1)*t,d=Math.floor(l),p=sz(hJ(e,d).subarray(0,d+1)),g=cz(e.subarray(d+1));return p+(g-p)*(l-d)}}function OMe(e,t,a=uJ){if(!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return+a(e[0],0,e);if(t>=1)return+a(e[o-1],o-1,e);var o,l=(o-1)*t,d=Math.floor(l),p=+a(e[d],d,e),g=+a(e[d+1],d+1,e);return p+(g-p)*(l-d)}}function AMe(e,t,a){e=+e,t=+t,a=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+a;for(var o=-1,l=Math.max(0,Math.ceil((t-e)/a))|0,d=new Array(l);++o<l;)d[o]=e+o*a;return d}function Co(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Lc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const GP=Symbol("implicit");function fD(){var e=new az,t=[],a=[],o=GP;function l(d){let p=e.get(d);if(p===void 0){if(o!==GP)return o;e.set(d,p=t.push(d)-1)}return a[p%a.length]}return l.domain=function(d){if(!arguments.length)return t.slice();t=[],e=new az;for(const p of d)e.has(p)||e.set(p,t.push(p)-1);return l},l.range=function(d){return arguments.length?(a=Array.from(d),l):a.slice()},l.unknown=function(d){return arguments.length?(o=d,l):o},l.copy=function(){return fD(t,a).unknown(o)},Co.apply(l,arguments),l}function Ny(){var e=fD().unknown(void 0),t=e.domain,a=e.range,o=0,l=1,d,p,g=!1,v=0,E=0,T=.5;delete e.unknown;function b(){var R=t().length,N=l<o,P=N?l:o,L=N?o:l;d=(L-P)/Math.max(1,R-v+E*2),g&&(d=Math.floor(d)),P+=(L-P-d*(R-v))*T,p=d*(1-v),g&&(P=Math.round(P),p=Math.round(p));var M=AMe(R).map(function(D){return P+d*D});return a(N?M.reverse():M)}return e.domain=function(R){return arguments.length?(t(R),b()):t()},e.range=function(R){return arguments.length?([o,l]=R,o=+o,l=+l,b()):[o,l]},e.rangeRound=function(R){return[o,l]=R,o=+o,l=+l,g=!0,b()},e.bandwidth=function(){return p},e.step=function(){return d},e.round=function(R){return arguments.length?(g=!!R,b()):g},e.padding=function(R){return arguments.length?(v=Math.min(1,E=+R),b()):v},e.paddingInner=function(R){return arguments.length?(v=Math.min(1,R),b()):v},e.paddingOuter=function(R){return arguments.length?(E=+R,b()):E},e.align=function(R){return arguments.length?(T=Math.max(0,Math.min(1,R)),b()):T},e.copy=function(){return Ny(t(),[o,l]).round(g).paddingInner(v).paddingOuter(E).align(T)},Co.apply(b(),arguments)}function fJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return fJ(t())},e}function ey(){return fJ(Ny.apply(null,arguments).paddingInner(1))}function pD(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function pJ(e,t){var a=Object.create(e.prototype);for(var o in t)a[o]=t[o];return a}function yv(){}var Py=.7,cT=1/Py,kf="\\s*([+-]?\\d+)\\s*",xy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",js="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IMe=/^#([0-9a-f]{3,8})$/,NMe=new RegExp(`^rgb\\(${kf},${kf},${kf}\\)$`),PMe=new RegExp(`^rgb\\(${js},${js},${js}\\)$`),xMe=new RegExp(`^rgba\\(${kf},${kf},${kf},${xy}\\)$`),DMe=new RegExp(`^rgba\\(${js},${js},${js},${xy}\\)$`),LMe=new RegExp(`^hsl\\(${xy},${js},${js}\\)$`),kMe=new RegExp(`^hsla\\(${xy},${js},${js},${xy}\\)$`),lz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pD(yv,Dy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:uz,formatHex:uz,formatHex8:MMe,formatHsl:UMe,formatRgb:dz,toString:dz});function uz(){return this.rgb().formatHex()}function MMe(){return this.rgb().formatHex8()}function UMe(){return mJ(this).formatHsl()}function dz(){return this.rgb().formatRgb()}function Dy(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=IMe.exec(e))?(a=t[1].length,t=parseInt(t[1],16),a===6?hz(t):a===3?new ya(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):a===8?FS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):a===4?FS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=NMe.exec(e))?new ya(t[1],t[2],t[3],1):(t=PMe.exec(e))?new ya(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xMe.exec(e))?FS(t[1],t[2],t[3],t[4]):(t=DMe.exec(e))?FS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=LMe.exec(e))?mz(t[1],t[2]/100,t[3]/100,1):(t=kMe.exec(e))?mz(t[1],t[2]/100,t[3]/100,t[4]):lz.hasOwnProperty(e)?hz(lz[e]):e==="transparent"?new ya(NaN,NaN,NaN,0):null}function hz(e){return new ya(e>>16&255,e>>8&255,e&255,1)}function FS(e,t,a,o){return o<=0&&(e=t=a=NaN),new ya(e,t,a,o)}function jMe(e){return e instanceof yv||(e=Dy(e)),e?(e=e.rgb(),new ya(e.r,e.g,e.b,e.opacity)):new ya}function $P(e,t,a,o){return arguments.length===1?jMe(e):new ya(e,t,a,o??1)}function ya(e,t,a,o){this.r=+e,this.g=+t,this.b=+a,this.opacity=+o}pD(ya,$P,pJ(yv,{brighter(e){return e=e==null?cT:Math.pow(cT,e),new ya(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Py:Math.pow(Py,e),new ya(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ya(gd(this.r),gd(this.g),gd(this.b),lT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fz,formatHex:fz,formatHex8:VMe,formatRgb:pz,toString:pz}));function fz(){return`#${ud(this.r)}${ud(this.g)}${ud(this.b)}`}function VMe(){return`#${ud(this.r)}${ud(this.g)}${ud(this.b)}${ud((isNaN(this.opacity)?1:this.opacity)*255)}`}function pz(){const e=lT(this.opacity);return`${e===1?"rgb(":"rgba("}${gd(this.r)}, ${gd(this.g)}, ${gd(this.b)}${e===1?")":`, ${e})`}`}function lT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function gd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ud(e){return e=gd(e),(e<16?"0":"")+e.toString(16)}function mz(e,t,a,o){return o<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new Zo(e,t,a,o)}function mJ(e){if(e instanceof Zo)return new Zo(e.h,e.s,e.l,e.opacity);if(e instanceof yv||(e=Dy(e)),!e)return new Zo;if(e instanceof Zo)return e;e=e.rgb();var t=e.r/255,a=e.g/255,o=e.b/255,l=Math.min(t,a,o),d=Math.max(t,a,o),p=NaN,g=d-l,v=(d+l)/2;return g?(t===d?p=(a-o)/g+(a<o)*6:a===d?p=(o-t)/g+2:p=(t-a)/g+4,g/=v<.5?d+l:2-d-l,p*=60):g=v>0&&v<1?0:p,new Zo(p,g,v,e.opacity)}function BMe(e,t,a,o){return arguments.length===1?mJ(e):new Zo(e,t,a,o??1)}function Zo(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}pD(Zo,BMe,pJ(yv,{brighter(e){return e=e==null?cT:Math.pow(cT,e),new Zo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Py:Math.pow(Py,e),new Zo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(a<.5?a:1-a)*t,l=2*a-o;return new ya(HI(e>=240?e-240:e+120,l,o),HI(e,l,o),HI(e<120?e+240:e-120,l,o),this.opacity)},clamp(){return new Zo(gz(this.h),WS(this.s),WS(this.l),lT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=lT(this.opacity);return`${e===1?"hsl(":"hsla("}${gz(this.h)}, ${WS(this.s)*100}%, ${WS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function gz(e){return e=(e||0)%360,e<0?e+360:e}function WS(e){return Math.max(0,Math.min(1,e||0))}function HI(e,t,a){return(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)*255}const mD=e=>()=>e;function FMe(e,t){return function(a){return e+a*t}}function WMe(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(o){return Math.pow(e+o*t,a)}}function GMe(e){return(e=+e)==1?gJ:function(t,a){return a-t?WMe(t,a,e):mD(isNaN(t)?a:t)}}function gJ(e,t){var a=t-e;return a?FMe(e,a):mD(isNaN(e)?t:e)}const yz=function e(t){var a=GMe(t);function o(l,d){var p=a((l=$P(l)).r,(d=$P(d)).r),g=a(l.g,d.g),v=a(l.b,d.b),E=gJ(l.opacity,d.opacity);return function(T){return l.r=p(T),l.g=g(T),l.b=v(T),l.opacity=E(T),l+""}}return o.gamma=e,o}(1);function $Me(e,t){t||(t=[]);var a=e?Math.min(t.length,e.length):0,o=t.slice(),l;return function(d){for(l=0;l<a;++l)o[l]=e[l]*(1-d)+t[l]*d;return o}}function HMe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zMe(e,t){var a=t?t.length:0,o=e?Math.min(a,e.length):0,l=new Array(o),d=new Array(a),p;for(p=0;p<o;++p)l[p]=Np(e[p],t[p]);for(;p<a;++p)d[p]=t[p];return function(g){for(p=0;p<o;++p)d[p]=l[p](g);return d}}function KMe(e,t){var a=new Date;return e=+e,t=+t,function(o){return a.setTime(e*(1-o)+t*o),a}}function uT(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function qMe(e,t){var a={},o={},l;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(l in t)l in e?a[l]=Np(e[l],t[l]):o[l]=t[l];return function(d){for(l in a)o[l]=a[l](d);return o}}var HP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zI=new RegExp(HP.source,"g");function YMe(e){return function(){return e}}function XMe(e){return function(t){return e(t)+""}}function JMe(e,t){var a=HP.lastIndex=zI.lastIndex=0,o,l,d,p=-1,g=[],v=[];for(e=e+"",t=t+"";(o=HP.exec(e))&&(l=zI.exec(t));)(d=l.index)>a&&(d=t.slice(a,d),g[p]?g[p]+=d:g[++p]=d),(o=o[0])===(l=l[0])?g[p]?g[p]+=l:g[++p]=l:(g[++p]=null,v.push({i:p,x:uT(o,l)})),a=zI.lastIndex;return a<t.length&&(d=t.slice(a),g[p]?g[p]+=d:g[++p]=d),g.length<2?v[0]?XMe(v[0].x):YMe(t):(t=v.length,function(E){for(var T=0,b;T<t;++T)g[(b=v[T]).i]=b.x(E);return g.join("")})}function Np(e,t){var a=typeof t,o;return t==null||a==="boolean"?mD(t):(a==="number"?uT:a==="string"?(o=Dy(t))?(t=o,yz):JMe:t instanceof Dy?yz:t instanceof Date?KMe:HMe(t)?$Me:Array.isArray(t)?zMe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?qMe:uT)(e,t)}function gD(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}}function QMe(e,t){t===void 0&&(t=e,e=Np);for(var a=0,o=t.length-1,l=t[0],d=new Array(o<0?0:o);a<o;)d[a]=e(l,l=t[++a]);return function(p){var g=Math.max(0,Math.min(o-1,Math.floor(p*=o)));return d[g](p-g)}}function ZMe(e){return function(){return e}}function dT(e){return+e}var vz=[0,1];function Xi(e){return e}function zP(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:ZMe(isNaN(t)?NaN:.5)}function e2e(e,t){var a;return e>t&&(a=e,e=t,t=a),function(o){return Math.max(e,Math.min(t,o))}}function t2e(e,t,a){var o=e[0],l=e[1],d=t[0],p=t[1];return l<o?(o=zP(l,o),d=a(p,d)):(o=zP(o,l),d=a(d,p)),function(g){return d(o(g))}}function n2e(e,t,a){var o=Math.min(e.length,t.length)-1,l=new Array(o),d=new Array(o),p=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++p<o;)l[p]=zP(e[p],e[p+1]),d[p]=a(t[p],t[p+1]);return function(g){var v=gv(e,g,1,o)-1;return d[v](l[v](g))}}function vv(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Iw(){var e=vz,t=vz,a=Np,o,l,d,p=Xi,g,v,E;function T(){var R=Math.min(e.length,t.length);return p!==Xi&&(p=e2e(e[0],e[R-1])),g=R>2?n2e:t2e,v=E=null,b}function b(R){return R==null||isNaN(R=+R)?d:(v||(v=g(e.map(o),t,a)))(o(p(R)))}return b.invert=function(R){return p(l((E||(E=g(t,e.map(o),uT)))(R)))},b.domain=function(R){return arguments.length?(e=Array.from(R,dT),T()):e.slice()},b.range=function(R){return arguments.length?(t=Array.from(R),T()):t.slice()},b.rangeRound=function(R){return t=Array.from(R),a=gD,T()},b.clamp=function(R){return arguments.length?(p=R?!0:Xi,T()):p!==Xi},b.interpolate=function(R){return arguments.length?(a=R,T()):a},b.unknown=function(R){return arguments.length?(d=R,b):d},function(R,N){return o=R,l=N,T()}}function yD(){return Iw()(Xi,Xi)}function r2e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function hT(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,o=e.slice(0,a);return[o.length>1?o[0]+o.slice(2):o,+e.slice(a+1)]}function Yf(e){return e=hT(Math.abs(e)),e?e[1]:NaN}function i2e(e,t){return function(a,o){for(var l=a.length,d=[],p=0,g=e[0],v=0;l>0&&g>0&&(v+g+1>o&&(g=Math.max(1,o-v)),d.push(a.substring(l-=g,l+g)),!((v+=g+1)>o));)g=e[p=(p+1)%e.length];return d.reverse().join(t)}}function a2e(e){return function(t){return t.replace(/[0-9]/g,function(a){return e[+a]})}}var o2e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ly(e){if(!(t=o2e.exec(e)))throw new Error("invalid format: "+e);var t;return new vD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ly.prototype=vD.prototype;function vD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}vD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function s2e(e){e:for(var t=e.length,a=1,o=-1,l;a<t;++a)switch(e[a]){case".":o=l=a;break;case"0":o===0&&(o=a),l=a;break;default:if(!+e[a])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(l+1):e}var yJ;function c2e(e,t){var a=hT(e,t);if(!a)return e+"";var o=a[0],l=a[1],d=l-(yJ=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,p=o.length;return d===p?o:d>p?o+new Array(d-p+1).join("0"):d>0?o.slice(0,d)+"."+o.slice(d):"0."+new Array(1-d).join("0")+hT(e,Math.max(0,t+d-1))[0]}function _z(e,t){var a=hT(e,t);if(!a)return e+"";var o=a[0],l=a[1];return l<0?"0."+new Array(-l).join("0")+o:o.length>l+1?o.slice(0,l+1)+"."+o.slice(l+1):o+new Array(l-o.length+2).join("0")}const Ez={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:r2e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_z(e*100,t),r:_z,s:c2e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Sz(e){return e}var bz=Array.prototype.map,Tz=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function l2e(e){var t=e.grouping===void 0||e.thousands===void 0?Sz:i2e(bz.call(e.grouping,Number),e.thousands+""),a=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",d=e.numerals===void 0?Sz:a2e(bz.call(e.numerals,String)),p=e.percent===void 0?"%":e.percent+"",g=e.minus===void 0?"":e.minus+"",v=e.nan===void 0?"NaN":e.nan+"";function E(b){b=Ly(b);var R=b.fill,N=b.align,P=b.sign,L=b.symbol,M=b.zero,D=b.width,U=b.comma,B=b.precision,z=b.trim,V=b.type;V==="n"?(U=!0,V="g"):Ez[V]||(B===void 0&&(B=12),z=!0,V="g"),(M||R==="0"&&N==="=")&&(M=!0,R="0",N="=");var G=L==="$"?a:L==="#"&&/[boxX]/.test(V)?"0"+V.toLowerCase():"",q=L==="$"?o:/[%p]/.test(V)?p:"",ne=Ez[V],Z=/[defgprs%]/.test(V);B=B===void 0?6:/[gprs]/.test(V)?Math.max(1,Math.min(21,B)):Math.max(0,Math.min(20,B));function le(ee){var ce=G,be=q,ae,fe,me;if(V==="c")be=ne(ee)+be,ee="";else{ee=+ee;var _e=ee<0||1/ee<0;if(ee=isNaN(ee)?v:ne(Math.abs(ee),B),z&&(ee=s2e(ee)),_e&&+ee==0&&P!=="+"&&(_e=!1),ce=(_e?P==="("?P:g:P==="-"||P==="("?"":P)+ce,be=(V==="s"?Tz[8+yJ/3]:"")+be+(_e&&P==="("?")":""),Z){for(ae=-1,fe=ee.length;++ae<fe;)if(me=ee.charCodeAt(ae),48>me||me>57){be=(me===46?l+ee.slice(ae+1):ee.slice(ae))+be,ee=ee.slice(0,ae);break}}}U&&!M&&(ee=t(ee,1/0));var ue=ce.length+ee.length+be.length,ve=ue<D?new Array(D-ue+1).join(R):"";switch(U&&M&&(ee=t(ve+ee,ve.length?D-be.length:1/0),ve=""),N){case"<":ee=ce+ee+be+ve;break;case"=":ee=ce+ve+ee+be;break;case"^":ee=ve.slice(0,ue=ve.length>>1)+ce+ee+be+ve.slice(ue);break;default:ee=ve+ce+ee+be;break}return d(ee)}return le.toString=function(){return b+""},le}function T(b,R){var N=E((b=Ly(b),b.type="f",b)),P=Math.max(-8,Math.min(8,Math.floor(Yf(R)/3)))*3,L=Math.pow(10,-P),M=Tz[8+P/3];return function(D){return N(L*D)+M}}return{format:E,formatPrefix:T}}var GS,_D,vJ;u2e({thousands:",",grouping:[3],currency:["$",""]});function u2e(e){return GS=l2e(e),_D=GS.format,vJ=GS.formatPrefix,GS}function d2e(e){return Math.max(0,-Yf(Math.abs(e)))}function h2e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yf(t)/3)))*3-Yf(Math.abs(e)))}function f2e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Yf(t)-Yf(e))+1}function _J(e,t,a,o){var l=WP(e,t,a),d;switch(o=Ly(o??",f"),o.type){case"s":{var p=Math.max(Math.abs(e),Math.abs(t));return o.precision==null&&!isNaN(d=h2e(l,p))&&(o.precision=d),vJ(o,p)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(d=f2e(l,Math.max(Math.abs(e),Math.abs(t))))&&(o.precision=d-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(d=d2e(l))&&(o.precision=d-(o.type==="%")*2);break}}return _D(o)}function ru(e){var t=e.domain;return e.ticks=function(a){var o=t();return BP(o[0],o[o.length-1],a??10)},e.tickFormat=function(a,o){var l=t();return _J(l[0],l[l.length-1],a??10,o)},e.nice=function(a){a==null&&(a=10);var o=t(),l=0,d=o.length-1,p=o[l],g=o[d],v,E,T=10;for(g<p&&(E=p,p=g,g=E,E=l,l=d,d=E);T-- >0;){if(E=FP(p,g,a),E===v)return o[l]=p,o[d]=g,t(o);if(E>0)p=Math.floor(p/E)*E,g=Math.ceil(g/E)*E;else if(E<0)p=Math.ceil(p*E)/E,g=Math.floor(g*E)/E;else break;v=E}return e},e}function fT(){var e=yD();return e.copy=function(){return vv(e,fT())},Co.apply(e,arguments),ru(e)}function EJ(e){var t;function a(o){return o==null||isNaN(o=+o)?t:o}return a.invert=a,a.domain=a.range=function(o){return arguments.length?(e=Array.from(o,dT),a):e.slice()},a.unknown=function(o){return arguments.length?(t=o,a):t},a.copy=function(){return EJ(e).unknown(t)},e=arguments.length?Array.from(e,dT):[0,1],ru(a)}function SJ(e,t){e=e.slice();var a=0,o=e.length-1,l=e[a],d=e[o],p;return d<l&&(p=a,a=o,o=p,p=l,l=d,d=p),e[a]=t.floor(l),e[o]=t.ceil(d),e}function wz(e){return Math.log(e)}function Cz(e){return Math.exp(e)}function p2e(e){return-Math.log(-e)}function m2e(e){return-Math.exp(-e)}function g2e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function y2e(e){return e===10?g2e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function v2e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Rz(e){return(t,a)=>-e(-t,a)}function ED(e){const t=e(wz,Cz),a=t.domain;let o=10,l,d;function p(){return l=v2e(o),d=y2e(o),a()[0]<0?(l=Rz(l),d=Rz(d),e(p2e,m2e)):e(wz,Cz),t}return t.base=function(g){return arguments.length?(o=+g,p()):o},t.domain=function(g){return arguments.length?(a(g),p()):a()},t.ticks=g=>{const v=a();let E=v[0],T=v[v.length-1];const b=T<E;b&&([E,T]=[T,E]);let R=l(E),N=l(T),P,L;const M=g==null?10:+g;let D=[];if(!(o%1)&&N-R<M){if(R=Math.floor(R),N=Math.ceil(N),E>0){for(;R<=N;++R)for(P=1;P<o;++P)if(L=R<0?P/d(-R):P*d(R),!(L<E)){if(L>T)break;D.push(L)}}else for(;R<=N;++R)for(P=o-1;P>=1;--P)if(L=R>0?P/d(-R):P*d(R),!(L<E)){if(L>T)break;D.push(L)}D.length*2<M&&(D=BP(E,T,M))}else D=BP(R,N,Math.min(N-R,M)).map(d);return b?D.reverse():D},t.tickFormat=(g,v)=>{if(g==null&&(g=10),v==null&&(v=o===10?"s":","),typeof v!="function"&&(!(o%1)&&(v=Ly(v)).precision==null&&(v.trim=!0),v=_D(v)),g===1/0)return v;const E=Math.max(1,o*g/t.ticks().length);return T=>{let b=T/d(Math.round(l(T)));return b*o<o-.5&&(b*=o),b<=E?v(T):""}},t.nice=()=>a(SJ(a(),{floor:g=>d(Math.floor(l(g))),ceil:g=>d(Math.ceil(l(g)))})),t}function bJ(){const e=ED(Iw()).domain([1,10]);return e.copy=()=>vv(e,bJ()).base(e.base()),Co.apply(e,arguments),e}function Oz(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Az(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function SD(e){var t=1,a=e(Oz(t),Az(t));return a.constant=function(o){return arguments.length?e(Oz(t=+o),Az(t)):t},ru(a)}function TJ(){var e=SD(Iw());return e.copy=function(){return vv(e,TJ()).constant(e.constant())},Co.apply(e,arguments)}function Iz(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function _2e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function E2e(e){return e<0?-e*e:e*e}function bD(e){var t=e(Xi,Xi),a=1;function o(){return a===1?e(Xi,Xi):a===.5?e(_2e,E2e):e(Iz(a),Iz(1/a))}return t.exponent=function(l){return arguments.length?(a=+l,o()):a},ru(t)}function TD(){var e=bD(Iw());return e.copy=function(){return vv(e,TD()).exponent(e.exponent())},Co.apply(e,arguments),e}function S2e(){return TD.apply(null,arguments).exponent(.5)}function Nz(e){return Math.sign(e)*e*e}function b2e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function wJ(){var e=yD(),t=[0,1],a=!1,o;function l(d){var p=b2e(e(d));return isNaN(p)?o:a?Math.round(p):p}return l.invert=function(d){return e.invert(Nz(d))},l.domain=function(d){return arguments.length?(e.domain(d),l):e.domain()},l.range=function(d){return arguments.length?(e.range((t=Array.from(d,dT)).map(Nz)),l):t.slice()},l.rangeRound=function(d){return l.range(d).round(!0)},l.round=function(d){return arguments.length?(a=!!d,l):a},l.clamp=function(d){return arguments.length?(e.clamp(d),l):e.clamp()},l.unknown=function(d){return arguments.length?(o=d,l):o},l.copy=function(){return wJ(e.domain(),t).round(a).clamp(e.clamp()).unknown(o)},Co.apply(l,arguments),ru(l)}function CJ(){var e=[],t=[],a=[],o;function l(){var p=0,g=Math.max(1,t.length);for(a=new Array(g-1);++p<g;)a[p-1]=OMe(e,p/g);return d}function d(p){return p==null||isNaN(p=+p)?o:t[gv(a,p)]}return d.invertExtent=function(p){var g=t.indexOf(p);return g<0?[NaN,NaN]:[g>0?a[g-1]:e[0],g<a.length?a[g]:e[e.length-1]]},d.domain=function(p){if(!arguments.length)return e.slice();e=[];for(let g of p)g!=null&&!isNaN(g=+g)&&e.push(g);return e.sort($l),l()},d.range=function(p){return arguments.length?(t=Array.from(p),l()):t.slice()},d.unknown=function(p){return arguments.length?(o=p,d):o},d.quantiles=function(){return a.slice()},d.copy=function(){return CJ().domain(e).range(t).unknown(o)},Co.apply(d,arguments)}function RJ(){var e=0,t=1,a=1,o=[.5],l=[0,1],d;function p(v){return v!=null&&v<=v?l[gv(o,v,0,a)]:d}function g(){var v=-1;for(o=new Array(a);++v<a;)o[v]=((v+1)*t-(v-a)*e)/(a+1);return p}return p.domain=function(v){return arguments.length?([e,t]=v,e=+e,t=+t,g()):[e,t]},p.range=function(v){return arguments.length?(a=(l=Array.from(v)).length-1,g()):l.slice()},p.invertExtent=function(v){var E=l.indexOf(v);return E<0?[NaN,NaN]:E<1?[e,o[0]]:E>=a?[o[a-1],t]:[o[E-1],o[E]]},p.unknown=function(v){return arguments.length&&(d=v),p},p.thresholds=function(){return o.slice()},p.copy=function(){return RJ().domain([e,t]).range(l).unknown(d)},Co.apply(ru(p),arguments)}function OJ(){var e=[.5],t=[0,1],a,o=1;function l(d){return d!=null&&d<=d?t[gv(e,d,0,o)]:a}return l.domain=function(d){return arguments.length?(e=Array.from(d),o=Math.min(e.length,t.length-1),l):e.slice()},l.range=function(d){return arguments.length?(t=Array.from(d),o=Math.min(e.length,t.length-1),l):t.slice()},l.invertExtent=function(d){var p=t.indexOf(d);return[e[p-1],e[p]]},l.unknown=function(d){return arguments.length?(a=d,l):a},l.copy=function(){return OJ().domain(e).range(t).unknown(a)},Co.apply(l,arguments)}const KI=new Date,qI=new Date;function ti(e,t,a,o){function l(d){return e(d=arguments.length===0?new Date:new Date(+d)),d}return l.floor=d=>(e(d=new Date(+d)),d),l.ceil=d=>(e(d=new Date(d-1)),t(d,1),e(d),d),l.round=d=>{const p=l(d),g=l.ceil(d);return d-p<g-d?p:g},l.offset=(d,p)=>(t(d=new Date(+d),p==null?1:Math.floor(p)),d),l.range=(d,p,g)=>{const v=[];if(d=l.ceil(d),g=g==null?1:Math.floor(g),!(d<p)||!(g>0))return v;let E;do v.push(E=new Date(+d)),t(d,g),e(d);while(E<d&&d<p);return v},l.filter=d=>ti(p=>{if(p>=p)for(;e(p),!d(p);)p.setTime(p-1)},(p,g)=>{if(p>=p)if(g<0)for(;++g<=0;)for(;t(p,-1),!d(p););else for(;--g>=0;)for(;t(p,1),!d(p););}),a&&(l.count=(d,p)=>(KI.setTime(+d),qI.setTime(+p),e(KI),e(qI),Math.floor(a(KI,qI))),l.every=d=>(d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?l.filter(o?p=>o(p)%d===0:p=>l.count(0,p)%d===0):l)),l}const pT=ti(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);pT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ti(t=>{t.setTime(Math.floor(t/e)*e)},(t,a)=>{t.setTime(+t+a*e)},(t,a)=>(a-t)/e):pT);pT.range;const yc=1e3,vo=yc*60,vc=vo*60,Ac=vc*24,wD=Ac*7,Pz=Ac*30,YI=Ac*365,dd=ti(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*yc)},(e,t)=>(t-e)/yc,e=>e.getUTCSeconds());dd.range;const CD=ti(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yc)},(e,t)=>{e.setTime(+e+t*vo)},(e,t)=>(t-e)/vo,e=>e.getMinutes());CD.range;const RD=ti(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*vo)},(e,t)=>(t-e)/vo,e=>e.getUTCMinutes());RD.range;const OD=ti(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yc-e.getMinutes()*vo)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getHours());OD.range;const AD=ti(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getUTCHours());AD.range;const _v=ti(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vo)/Ac,e=>e.getDate()-1);_v.range;const Nw=ti(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ac,e=>e.getUTCDate()-1);Nw.range;const AJ=ti(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ac,e=>Math.floor(e/Ac));AJ.range;function xd(e){return ti(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,a)=>{t.setDate(t.getDate()+a*7)},(t,a)=>(a-t-(a.getTimezoneOffset()-t.getTimezoneOffset())*vo)/wD)}const Pw=xd(0),mT=xd(1),T2e=xd(2),w2e=xd(3),Xf=xd(4),C2e=xd(5),R2e=xd(6);Pw.range;mT.range;T2e.range;w2e.range;Xf.range;C2e.range;R2e.range;function Dd(e){return ti(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCDate(t.getUTCDate()+a*7)},(t,a)=>(a-t)/wD)}const xw=Dd(0),gT=Dd(1),O2e=Dd(2),A2e=Dd(3),Jf=Dd(4),I2e=Dd(5),N2e=Dd(6);xw.range;gT.range;O2e.range;A2e.range;Jf.range;I2e.range;N2e.range;const ID=ti(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ID.range;const ND=ti(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());ND.range;const Ic=ti(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ic.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ti(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,a)=>{t.setFullYear(t.getFullYear()+a*e)});Ic.range;const Nc=ti(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Nc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ti(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCFullYear(t.getUTCFullYear()+a*e)});Nc.range;function IJ(e,t,a,o,l,d){const p=[[dd,1,yc],[dd,5,5*yc],[dd,15,15*yc],[dd,30,30*yc],[d,1,vo],[d,5,5*vo],[d,15,15*vo],[d,30,30*vo],[l,1,vc],[l,3,3*vc],[l,6,6*vc],[l,12,12*vc],[o,1,Ac],[o,2,2*Ac],[a,1,wD],[t,1,Pz],[t,3,3*Pz],[e,1,YI]];function g(E,T,b){const R=T<E;R&&([E,T]=[T,E]);const N=b&&typeof b.range=="function"?b:v(E,T,b),P=N?N.range(E,+T+1):[];return R?P.reverse():P}function v(E,T,b){const R=Math.abs(T-E)/b,N=hD(([,,M])=>M).right(p,R);if(N===p.length)return e.every(WP(E/YI,T/YI,b));if(N===0)return pT.every(Math.max(WP(E,T,b),1));const[P,L]=p[R/p[N-1][2]<p[N][2]/R?N-1:N];return P.every(L)}return[g,v]}const[P2e,x2e]=IJ(Nc,ND,xw,AJ,AD,RD),[D2e,L2e]=IJ(Ic,ID,Pw,_v,OD,CD);function XI(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function JI(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Cg(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function k2e(e){var t=e.dateTime,a=e.date,o=e.time,l=e.periods,d=e.days,p=e.shortDays,g=e.months,v=e.shortMonths,E=Rg(l),T=Og(l),b=Rg(d),R=Og(d),N=Rg(p),P=Og(p),L=Rg(g),M=Og(g),D=Rg(v),U=Og(v),B={a:_e,A:ue,b:ve,B:Ce,c:null,d:Uz,e:Uz,f:iUe,g:pUe,G:gUe,H:tUe,I:nUe,j:rUe,L:NJ,m:aUe,M:oUe,p:Ve,q:Pe,Q:Bz,s:Fz,S:sUe,u:cUe,U:lUe,V:uUe,w:dUe,W:hUe,x:null,X:null,y:fUe,Y:mUe,Z:yUe,"%":Vz},z={a:Ge,A:nt,b:Re,B:wt,c:null,d:jz,e:jz,f:SUe,g:PUe,G:DUe,H:vUe,I:_Ue,j:EUe,L:xJ,m:bUe,M:TUe,p:It,q:lt,Q:Bz,s:Fz,S:wUe,u:CUe,U:RUe,V:OUe,w:AUe,W:IUe,x:null,X:null,y:NUe,Y:xUe,Z:LUe,"%":Vz},V={a:le,A:ee,b:ce,B:be,c:ae,d:kz,e:kz,f:J2e,g:Lz,G:Dz,H:Mz,I:Mz,j:K2e,L:X2e,m:z2e,M:q2e,p:Z,q:H2e,Q:Z2e,s:eUe,S:Y2e,u:B2e,U:F2e,V:W2e,w:V2e,W:G2e,x:fe,X:me,y:Lz,Y:Dz,Z:$2e,"%":Q2e};B.x=G(a,B),B.X=G(o,B),B.c=G(t,B),z.x=G(a,z),z.X=G(o,z),z.c=G(t,z);function G(ze,He){return function(tt){var Be=[],zt=-1,Wt=0,Ct=ze.length,Tn,xr,Bn;for(tt instanceof Date||(tt=new Date(+tt));++zt<Ct;)ze.charCodeAt(zt)===37&&(Be.push(ze.slice(Wt,zt)),(xr=xz[Tn=ze.charAt(++zt)])!=null?Tn=ze.charAt(++zt):xr=Tn==="e"?" ":"0",(Bn=He[Tn])&&(Tn=Bn(tt,xr)),Be.push(Tn),Wt=zt+1);return Be.push(ze.slice(Wt,zt)),Be.join("")}}function q(ze,He){return function(tt){var Be=Cg(1900,void 0,1),zt=ne(Be,ze,tt+="",0),Wt,Ct;if(zt!=tt.length)return null;if("Q"in Be)return new Date(Be.Q);if("s"in Be)return new Date(Be.s*1e3+("L"in Be?Be.L:0));if(He&&!("Z"in Be)&&(Be.Z=0),"p"in Be&&(Be.H=Be.H%12+Be.p*12),Be.m===void 0&&(Be.m="q"in Be?Be.q:0),"V"in Be){if(Be.V<1||Be.V>53)return null;"w"in Be||(Be.w=1),"Z"in Be?(Wt=JI(Cg(Be.y,0,1)),Ct=Wt.getUTCDay(),Wt=Ct>4||Ct===0?gT.ceil(Wt):gT(Wt),Wt=Nw.offset(Wt,(Be.V-1)*7),Be.y=Wt.getUTCFullYear(),Be.m=Wt.getUTCMonth(),Be.d=Wt.getUTCDate()+(Be.w+6)%7):(Wt=XI(Cg(Be.y,0,1)),Ct=Wt.getDay(),Wt=Ct>4||Ct===0?mT.ceil(Wt):mT(Wt),Wt=_v.offset(Wt,(Be.V-1)*7),Be.y=Wt.getFullYear(),Be.m=Wt.getMonth(),Be.d=Wt.getDate()+(Be.w+6)%7)}else("W"in Be||"U"in Be)&&("w"in Be||(Be.w="u"in Be?Be.u%7:"W"in Be?1:0),Ct="Z"in Be?JI(Cg(Be.y,0,1)).getUTCDay():XI(Cg(Be.y,0,1)).getDay(),Be.m=0,Be.d="W"in Be?(Be.w+6)%7+Be.W*7-(Ct+5)%7:Be.w+Be.U*7-(Ct+6)%7);return"Z"in Be?(Be.H+=Be.Z/100|0,Be.M+=Be.Z%100,JI(Be)):XI(Be)}}function ne(ze,He,tt,Be){for(var zt=0,Wt=He.length,Ct=tt.length,Tn,xr;zt<Wt;){if(Be>=Ct)return-1;if(Tn=He.charCodeAt(zt++),Tn===37){if(Tn=He.charAt(zt++),xr=V[Tn in xz?He.charAt(zt++):Tn],!xr||(Be=xr(ze,tt,Be))<0)return-1}else if(Tn!=tt.charCodeAt(Be++))return-1}return Be}function Z(ze,He,tt){var Be=E.exec(He.slice(tt));return Be?(ze.p=T.get(Be[0].toLowerCase()),tt+Be[0].length):-1}function le(ze,He,tt){var Be=N.exec(He.slice(tt));return Be?(ze.w=P.get(Be[0].toLowerCase()),tt+Be[0].length):-1}function ee(ze,He,tt){var Be=b.exec(He.slice(tt));return Be?(ze.w=R.get(Be[0].toLowerCase()),tt+Be[0].length):-1}function ce(ze,He,tt){var Be=D.exec(He.slice(tt));return Be?(ze.m=U.get(Be[0].toLowerCase()),tt+Be[0].length):-1}function be(ze,He,tt){var Be=L.exec(He.slice(tt));return Be?(ze.m=M.get(Be[0].toLowerCase()),tt+Be[0].length):-1}function ae(ze,He,tt){return ne(ze,t,He,tt)}function fe(ze,He,tt){return ne(ze,a,He,tt)}function me(ze,He,tt){return ne(ze,o,He,tt)}function _e(ze){return p[ze.getDay()]}function ue(ze){return d[ze.getDay()]}function ve(ze){return v[ze.getMonth()]}function Ce(ze){return g[ze.getMonth()]}function Ve(ze){return l[+(ze.getHours()>=12)]}function Pe(ze){return 1+~~(ze.getMonth()/3)}function Ge(ze){return p[ze.getUTCDay()]}function nt(ze){return d[ze.getUTCDay()]}function Re(ze){return v[ze.getUTCMonth()]}function wt(ze){return g[ze.getUTCMonth()]}function It(ze){return l[+(ze.getUTCHours()>=12)]}function lt(ze){return 1+~~(ze.getUTCMonth()/3)}return{format:function(ze){var He=G(ze+="",B);return He.toString=function(){return ze},He},parse:function(ze){var He=q(ze+="",!1);return He.toString=function(){return ze},He},utcFormat:function(ze){var He=G(ze+="",z);return He.toString=function(){return ze},He},utcParse:function(ze){var He=q(ze+="",!0);return He.toString=function(){return ze},He}}}var xz={"-":"",_:" ",0:"0"},pi=/^\s*\d+/,M2e=/^%/,U2e=/[\\^$*+?|[\]().{}]/g;function bn(e,t,a){var o=e<0?"-":"",l=(o?-e:e)+"",d=l.length;return o+(d<a?new Array(a-d+1).join(t)+l:l)}function j2e(e){return e.replace(U2e,"\\$&")}function Rg(e){return new RegExp("^(?:"+e.map(j2e).join("|")+")","i")}function Og(e){return new Map(e.map((t,a)=>[t.toLowerCase(),a]))}function V2e(e,t,a){var o=pi.exec(t.slice(a,a+1));return o?(e.w=+o[0],a+o[0].length):-1}function B2e(e,t,a){var o=pi.exec(t.slice(a,a+1));return o?(e.u=+o[0],a+o[0].length):-1}function F2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.U=+o[0],a+o[0].length):-1}function W2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.V=+o[0],a+o[0].length):-1}function G2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.W=+o[0],a+o[0].length):-1}function Dz(e,t,a){var o=pi.exec(t.slice(a,a+4));return o?(e.y=+o[0],a+o[0].length):-1}function Lz(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),a+o[0].length):-1}function $2e(e,t,a){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),a+o[0].length):-1}function H2e(e,t,a){var o=pi.exec(t.slice(a,a+1));return o?(e.q=o[0]*3-3,a+o[0].length):-1}function z2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.m=o[0]-1,a+o[0].length):-1}function kz(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.d=+o[0],a+o[0].length):-1}function K2e(e,t,a){var o=pi.exec(t.slice(a,a+3));return o?(e.m=0,e.d=+o[0],a+o[0].length):-1}function Mz(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.H=+o[0],a+o[0].length):-1}function q2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.M=+o[0],a+o[0].length):-1}function Y2e(e,t,a){var o=pi.exec(t.slice(a,a+2));return o?(e.S=+o[0],a+o[0].length):-1}function X2e(e,t,a){var o=pi.exec(t.slice(a,a+3));return o?(e.L=+o[0],a+o[0].length):-1}function J2e(e,t,a){var o=pi.exec(t.slice(a,a+6));return o?(e.L=Math.floor(o[0]/1e3),a+o[0].length):-1}function Q2e(e,t,a){var o=M2e.exec(t.slice(a,a+1));return o?a+o[0].length:-1}function Z2e(e,t,a){var o=pi.exec(t.slice(a));return o?(e.Q=+o[0],a+o[0].length):-1}function eUe(e,t,a){var o=pi.exec(t.slice(a));return o?(e.s=+o[0],a+o[0].length):-1}function Uz(e,t){return bn(e.getDate(),t,2)}function tUe(e,t){return bn(e.getHours(),t,2)}function nUe(e,t){return bn(e.getHours()%12||12,t,2)}function rUe(e,t){return bn(1+_v.count(Ic(e),e),t,3)}function NJ(e,t){return bn(e.getMilliseconds(),t,3)}function iUe(e,t){return NJ(e,t)+"000"}function aUe(e,t){return bn(e.getMonth()+1,t,2)}function oUe(e,t){return bn(e.getMinutes(),t,2)}function sUe(e,t){return bn(e.getSeconds(),t,2)}function cUe(e){var t=e.getDay();return t===0?7:t}function lUe(e,t){return bn(Pw.count(Ic(e)-1,e),t,2)}function PJ(e){var t=e.getDay();return t>=4||t===0?Xf(e):Xf.ceil(e)}function uUe(e,t){return e=PJ(e),bn(Xf.count(Ic(e),e)+(Ic(e).getDay()===4),t,2)}function dUe(e){return e.getDay()}function hUe(e,t){return bn(mT.count(Ic(e)-1,e),t,2)}function fUe(e,t){return bn(e.getFullYear()%100,t,2)}function pUe(e,t){return e=PJ(e),bn(e.getFullYear()%100,t,2)}function mUe(e,t){return bn(e.getFullYear()%1e4,t,4)}function gUe(e,t){var a=e.getDay();return e=a>=4||a===0?Xf(e):Xf.ceil(e),bn(e.getFullYear()%1e4,t,4)}function yUe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+bn(t/60|0,"0",2)+bn(t%60,"0",2)}function jz(e,t){return bn(e.getUTCDate(),t,2)}function vUe(e,t){return bn(e.getUTCHours(),t,2)}function _Ue(e,t){return bn(e.getUTCHours()%12||12,t,2)}function EUe(e,t){return bn(1+Nw.count(Nc(e),e),t,3)}function xJ(e,t){return bn(e.getUTCMilliseconds(),t,3)}function SUe(e,t){return xJ(e,t)+"000"}function bUe(e,t){return bn(e.getUTCMonth()+1,t,2)}function TUe(e,t){return bn(e.getUTCMinutes(),t,2)}function wUe(e,t){return bn(e.getUTCSeconds(),t,2)}function CUe(e){var t=e.getUTCDay();return t===0?7:t}function RUe(e,t){return bn(xw.count(Nc(e)-1,e),t,2)}function DJ(e){var t=e.getUTCDay();return t>=4||t===0?Jf(e):Jf.ceil(e)}function OUe(e,t){return e=DJ(e),bn(Jf.count(Nc(e),e)+(Nc(e).getUTCDay()===4),t,2)}function AUe(e){return e.getUTCDay()}function IUe(e,t){return bn(gT.count(Nc(e)-1,e),t,2)}function NUe(e,t){return bn(e.getUTCFullYear()%100,t,2)}function PUe(e,t){return e=DJ(e),bn(e.getUTCFullYear()%100,t,2)}function xUe(e,t){return bn(e.getUTCFullYear()%1e4,t,4)}function DUe(e,t){var a=e.getUTCDay();return e=a>=4||a===0?Jf(e):Jf.ceil(e),bn(e.getUTCFullYear()%1e4,t,4)}function LUe(){return"+0000"}function Vz(){return"%"}function Bz(e){return+e}function Fz(e){return Math.floor(+e/1e3)}var af,LJ,kJ;kUe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function kUe(e){return af=k2e(e),LJ=af.format,af.parse,kJ=af.utcFormat,af.utcParse,af}function MUe(e){return new Date(e)}function UUe(e){return e instanceof Date?+e:+new Date(+e)}function PD(e,t,a,o,l,d,p,g,v,E){var T=yD(),b=T.invert,R=T.domain,N=E(".%L"),P=E(":%S"),L=E("%I:%M"),M=E("%I %p"),D=E("%a %d"),U=E("%b %d"),B=E("%B"),z=E("%Y");function V(G){return(v(G)<G?N:g(G)<G?P:p(G)<G?L:d(G)<G?M:o(G)<G?l(G)<G?D:U:a(G)<G?B:z)(G)}return T.invert=function(G){return new Date(b(G))},T.domain=function(G){return arguments.length?R(Array.from(G,UUe)):R().map(MUe)},T.ticks=function(G){var q=R();return e(q[0],q[q.length-1],G??10)},T.tickFormat=function(G,q){return q==null?V:E(q)},T.nice=function(G){var q=R();return(!G||typeof G.range!="function")&&(G=t(q[0],q[q.length-1],G??10)),G?R(SJ(q,G)):T},T.copy=function(){return vv(T,PD(e,t,a,o,l,d,p,g,v,E))},T}function jUe(){return Co.apply(PD(D2e,L2e,Ic,ID,Pw,_v,OD,CD,dd,LJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function VUe(){return Co.apply(PD(P2e,x2e,Nc,ND,xw,Nw,AD,RD,dd,kJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Dw(){var e=0,t=1,a,o,l,d,p=Xi,g=!1,v;function E(b){return b==null||isNaN(b=+b)?v:p(l===0?.5:(b=(d(b)-a)*l,g?Math.max(0,Math.min(1,b)):b))}E.domain=function(b){return arguments.length?([e,t]=b,a=d(e=+e),o=d(t=+t),l=a===o?0:1/(o-a),E):[e,t]},E.clamp=function(b){return arguments.length?(g=!!b,E):g},E.interpolator=function(b){return arguments.length?(p=b,E):p};function T(b){return function(R){var N,P;return arguments.length?([N,P]=R,p=b(N,P),E):[p(0),p(1)]}}return E.range=T(Np),E.rangeRound=T(gD),E.unknown=function(b){return arguments.length?(v=b,E):v},function(b){return d=b,a=b(e),o=b(t),l=a===o?0:1/(o-a),E}}function iu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function MJ(){var e=ru(Dw()(Xi));return e.copy=function(){return iu(e,MJ())},Lc.apply(e,arguments)}function UJ(){var e=ED(Dw()).domain([1,10]);return e.copy=function(){return iu(e,UJ()).base(e.base())},Lc.apply(e,arguments)}function jJ(){var e=SD(Dw());return e.copy=function(){return iu(e,jJ()).constant(e.constant())},Lc.apply(e,arguments)}function xD(){var e=bD(Dw());return e.copy=function(){return iu(e,xD()).exponent(e.exponent())},Lc.apply(e,arguments)}function BUe(){return xD.apply(null,arguments).exponent(.5)}function VJ(){var e=[],t=Xi;function a(o){if(o!=null&&!isNaN(o=+o))return t((gv(e,o,1)-1)/(e.length-1))}return a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort($l),a},a.interpolator=function(o){return arguments.length?(t=o,a):t},a.range=function(){return e.map((o,l)=>t(l/(e.length-1)))},a.quantiles=function(o){return Array.from({length:o+1},(l,d)=>RMe(e,d/o))},a.copy=function(){return VJ(t).domain(e)},Lc.apply(a,arguments)}function Lw(){var e=0,t=.5,a=1,o=1,l,d,p,g,v,E=Xi,T,b=!1,R;function N(L){return isNaN(L=+L)?R:(L=.5+((L=+T(L))-d)*(o*L<o*d?g:v),E(b?Math.max(0,Math.min(1,L)):L))}N.domain=function(L){return arguments.length?([e,t,a]=L,l=T(e=+e),d=T(t=+t),p=T(a=+a),g=l===d?0:.5/(d-l),v=d===p?0:.5/(p-d),o=d<l?-1:1,N):[e,t,a]},N.clamp=function(L){return arguments.length?(b=!!L,N):b},N.interpolator=function(L){return arguments.length?(E=L,N):E};function P(L){return function(M){var D,U,B;return arguments.length?([D,U,B]=M,E=QMe(L,[D,U,B]),N):[E(0),E(.5),E(1)]}}return N.range=P(Np),N.rangeRound=P(gD),N.unknown=function(L){return arguments.length?(R=L,N):R},function(L){return T=L,l=L(e),d=L(t),p=L(a),g=l===d?0:.5/(d-l),v=d===p?0:.5/(p-d),o=d<l?-1:1,N}}function BJ(){var e=ru(Lw()(Xi));return e.copy=function(){return iu(e,BJ())},Lc.apply(e,arguments)}function FJ(){var e=ED(Lw()).domain([.1,1,10]);return e.copy=function(){return iu(e,FJ()).base(e.base())},Lc.apply(e,arguments)}function WJ(){var e=SD(Lw());return e.copy=function(){return iu(e,WJ()).constant(e.constant())},Lc.apply(e,arguments)}function DD(){var e=bD(Lw());return e.copy=function(){return iu(e,DD()).exponent(e.exponent())},Lc.apply(e,arguments)}function FUe(){return DD.apply(null,arguments).exponent(.5)}const Wz=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ny,scaleDiverging:BJ,scaleDivergingLog:FJ,scaleDivergingPow:DD,scaleDivergingSqrt:FUe,scaleDivergingSymlog:WJ,scaleIdentity:EJ,scaleImplicit:GP,scaleLinear:fT,scaleLog:bJ,scaleOrdinal:fD,scalePoint:ey,scalePow:TD,scaleQuantile:CJ,scaleQuantize:RJ,scaleRadial:wJ,scaleSequential:MJ,scaleSequentialLog:UJ,scaleSequentialPow:xD,scaleSequentialQuantile:VJ,scaleSequentialSqrt:BUe,scaleSequentialSymlog:jJ,scaleSqrt:S2e,scaleSymlog:TJ,scaleThreshold:OJ,scaleTime:jUe,scaleUtc:VUe,tickFormat:_J},Symbol.toStringTag,{value:"Module"}));var WUe=bp;function GUe(e,t,a){for(var o=-1,l=e.length;++o<l;){var d=e[o],p=t(d);if(p!=null&&(g===void 0?p===p&&!WUe(p):a(p,g)))var g=p,v=d}return v}var GJ=GUe;function $Ue(e,t){return e>t}var HUe=$Ue,zUe=GJ,KUe=HUe,qUe=Ip;function YUe(e){return e&&e.length?zUe(e,qUe,KUe):void 0}var XUe=YUe;const kw=Kn(XUe);function JUe(e,t){return e<t}var QUe=JUe,ZUe=GJ,eje=QUe,tje=Ip;function nje(e){return e&&e.length?ZUe(e,tje,eje):void 0}var rje=nje;const Mw=Kn(rje);var ije=K1,aje=nu,oje=JX,sje=Sa;function cje(e,t){var a=sje(e)?ije:oje;return a(e,aje(t))}var lje=cje,uje=YX,dje=lje;function hje(e,t){return uje(dje(e,t),1)}var fje=hje;const pje=Kn(fje);var mje=cD;function gje(e,t){return mje(e,t)}var yje=gje;const LD=Kn(yje);var Pp=1e9,vje={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},MD,mr=!0,To="[DecimalError] ",yd=To+"Invalid argument: ",kD=To+"Exponent out of range: ",xp=Math.floor,rd=Math.pow,_je=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ja,ui=1e7,lr=7,$J=9007199254740991,yT=xp($J/lr),ct={};ct.absoluteValue=ct.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ct.comparedTo=ct.cmp=function(e){var t,a,o,l,d=this;if(e=new d.constructor(e),d.s!==e.s)return d.s||-e.s;if(d.e!==e.e)return d.e>e.e^d.s<0?1:-1;for(o=d.d.length,l=e.d.length,t=0,a=o<l?o:l;t<a;++t)if(d.d[t]!==e.d[t])return d.d[t]>e.d[t]^d.s<0?1:-1;return o===l?0:o>l^d.s<0?1:-1};ct.decimalPlaces=ct.dp=function(){var e=this,t=e.d.length-1,a=(t-e.e)*lr;if(t=e.d[t],t)for(;t%10==0;t/=10)a--;return a<0?0:a};ct.dividedBy=ct.div=function(e){return Tc(this,new this.constructor(e))};ct.dividedToIntegerBy=ct.idiv=function(e){var t=this,a=t.constructor;return Xn(Tc(t,new a(e),0,1),a.precision)};ct.equals=ct.eq=function(e){return!this.cmp(e)};ct.exponent=function(){return $r(this)};ct.greaterThan=ct.gt=function(e){return this.cmp(e)>0};ct.greaterThanOrEqualTo=ct.gte=function(e){return this.cmp(e)>=0};ct.isInteger=ct.isint=function(){return this.e>this.d.length-2};ct.isNegative=ct.isneg=function(){return this.s<0};ct.isPositive=ct.ispos=function(){return this.s>0};ct.isZero=function(){return this.s===0};ct.lessThan=ct.lt=function(e){return this.cmp(e)<0};ct.lessThanOrEqualTo=ct.lte=function(e){return this.cmp(e)<1};ct.logarithm=ct.log=function(e){var t,a=this,o=a.constructor,l=o.precision,d=l+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(ja))throw Error(To+"NaN");if(a.s<1)throw Error(To+(a.s?"NaN":"-Infinity"));return a.eq(ja)?new o(0):(mr=!1,t=Tc(ky(a,d),ky(e,d),d),mr=!0,Xn(t,l))};ct.minus=ct.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KJ(t,e):HJ(t,(e.s=-e.s,e))};ct.modulo=ct.mod=function(e){var t,a=this,o=a.constructor,l=o.precision;if(e=new o(e),!e.s)throw Error(To+"NaN");return a.s?(mr=!1,t=Tc(a,e,0,1).times(e),mr=!0,a.minus(t)):Xn(new o(a),l)};ct.naturalExponential=ct.exp=function(){return zJ(this)};ct.naturalLogarithm=ct.ln=function(){return ky(this)};ct.negated=ct.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ct.plus=ct.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HJ(t,e):KJ(t,(e.s=-e.s,e))};ct.precision=ct.sd=function(e){var t,a,o,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(yd+e);if(t=$r(l)+1,o=l.d.length-1,a=o*lr+1,o=l.d[o],o){for(;o%10==0;o/=10)a--;for(o=l.d[0];o>=10;o/=10)a++}return e&&t>a?t:a};ct.squareRoot=ct.sqrt=function(){var e,t,a,o,l,d,p,g=this,v=g.constructor;if(g.s<1){if(!g.s)return new v(0);throw Error(To+"NaN")}for(e=$r(g),mr=!1,l=Math.sqrt(+g),l==0||l==1/0?(t=ks(g.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=xp((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),o=new v(t)):o=new v(l.toString()),a=v.precision,l=p=a+3;;)if(d=o,o=d.plus(Tc(g,d,p+2)).times(.5),ks(d.d).slice(0,p)===(t=ks(o.d)).slice(0,p)){if(t=t.slice(p-3,p+1),l==p&&t=="4999"){if(Xn(d,a+1,0),d.times(d).eq(g)){o=d;break}}else if(t!="9999")break;p+=4}return mr=!0,Xn(o,a)};ct.times=ct.mul=function(e){var t,a,o,l,d,p,g,v,E,T=this,b=T.constructor,R=T.d,N=(e=new b(e)).d;if(!T.s||!e.s)return new b(0);for(e.s*=T.s,a=T.e+e.e,v=R.length,E=N.length,v<E&&(d=R,R=N,N=d,p=v,v=E,E=p),d=[],p=v+E,o=p;o--;)d.push(0);for(o=E;--o>=0;){for(t=0,l=v+o;l>o;)g=d[l]+N[o]*R[l-o-1]+t,d[l--]=g%ui|0,t=g/ui|0;d[l]=(d[l]+t)%ui|0}for(;!d[--p];)d.pop();return t?++a:d.shift(),e.d=d,e.e=a,mr?Xn(e,b.precision):e};ct.toDecimalPlaces=ct.todp=function(e,t){var a=this,o=a.constructor;return a=new o(a),e===void 0?a:(Bs(e,0,Pp),t===void 0?t=o.rounding:Bs(t,0,8),Xn(a,e+$r(a)+1,t))};ct.toExponential=function(e,t){var a,o=this,l=o.constructor;return e===void 0?a=Cd(o,!0):(Bs(e,0,Pp),t===void 0?t=l.rounding:Bs(t,0,8),o=Xn(new l(o),e+1,t),a=Cd(o,!0,e+1)),a};ct.toFixed=function(e,t){var a,o,l=this,d=l.constructor;return e===void 0?Cd(l):(Bs(e,0,Pp),t===void 0?t=d.rounding:Bs(t,0,8),o=Xn(new d(l),e+$r(l)+1,t),a=Cd(o.abs(),!1,e+$r(o)+1),l.isneg()&&!l.isZero()?"-"+a:a)};ct.toInteger=ct.toint=function(){var e=this,t=e.constructor;return Xn(new t(e),$r(e)+1,t.rounding)};ct.toNumber=function(){return+this};ct.toPower=ct.pow=function(e){var t,a,o,l,d,p,g=this,v=g.constructor,E=12,T=+(e=new v(e));if(!e.s)return new v(ja);if(g=new v(g),!g.s){if(e.s<1)throw Error(To+"Infinity");return g}if(g.eq(ja))return g;if(o=v.precision,e.eq(ja))return Xn(g,o);if(t=e.e,a=e.d.length-1,p=t>=a,d=g.s,p){if((a=T<0?-T:T)<=$J){for(l=new v(ja),t=Math.ceil(o/lr+4),mr=!1;a%2&&(l=l.times(g),$z(l.d,t)),a=xp(a/2),a!==0;)g=g.times(g),$z(g.d,t);return mr=!0,e.s<0?new v(ja).div(l):Xn(l,o)}}else if(d<0)throw Error(To+"NaN");return d=d<0&&e.d[Math.max(t,a)]&1?-1:1,g.s=1,mr=!1,l=e.times(ky(g,o+E)),mr=!0,l=zJ(l),l.s=d,l};ct.toPrecision=function(e,t){var a,o,l=this,d=l.constructor;return e===void 0?(a=$r(l),o=Cd(l,a<=d.toExpNeg||a>=d.toExpPos)):(Bs(e,1,Pp),t===void 0?t=d.rounding:Bs(t,0,8),l=Xn(new d(l),e,t),a=$r(l),o=Cd(l,e<=a||a<=d.toExpNeg,e)),o};ct.toSignificantDigits=ct.tosd=function(e,t){var a=this,o=a.constructor;return e===void 0?(e=o.precision,t=o.rounding):(Bs(e,1,Pp),t===void 0?t=o.rounding:Bs(t,0,8)),Xn(new o(a),e,t)};ct.toString=ct.valueOf=ct.val=ct.toJSON=ct[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=$r(e),a=e.constructor;return Cd(e,t<=a.toExpNeg||t>=a.toExpPos)};function HJ(e,t){var a,o,l,d,p,g,v,E,T=e.constructor,b=T.precision;if(!e.s||!t.s)return t.s||(t=new T(e)),mr?Xn(t,b):t;if(v=e.d,E=t.d,p=e.e,l=t.e,v=v.slice(),d=p-l,d){for(d<0?(o=v,d=-d,g=E.length):(o=E,l=p,g=v.length),p=Math.ceil(b/lr),g=p>g?p+1:g+1,d>g&&(d=g,o.length=1),o.reverse();d--;)o.push(0);o.reverse()}for(g=v.length,d=E.length,g-d<0&&(d=g,o=E,E=v,v=o),a=0;d;)a=(v[--d]=v[d]+E[d]+a)/ui|0,v[d]%=ui;for(a&&(v.unshift(a),++l),g=v.length;v[--g]==0;)v.pop();return t.d=v,t.e=l,mr?Xn(t,b):t}function Bs(e,t,a){if(e!==~~e||e<t||e>a)throw Error(yd+e)}function ks(e){var t,a,o,l=e.length-1,d="",p=e[0];if(l>0){for(d+=p,t=1;t<l;t++)o=e[t]+"",a=lr-o.length,a&&(d+=wl(a)),d+=o;p=e[t],o=p+"",a=lr-o.length,a&&(d+=wl(a))}else if(p===0)return"0";for(;p%10===0;)p/=10;return d+p}var Tc=function(){function e(o,l){var d,p=0,g=o.length;for(o=o.slice();g--;)d=o[g]*l+p,o[g]=d%ui|0,p=d/ui|0;return p&&o.unshift(p),o}function t(o,l,d,p){var g,v;if(d!=p)v=d>p?1:-1;else for(g=v=0;g<d;g++)if(o[g]!=l[g]){v=o[g]>l[g]?1:-1;break}return v}function a(o,l,d){for(var p=0;d--;)o[d]-=p,p=o[d]<l[d]?1:0,o[d]=p*ui+o[d]-l[d];for(;!o[0]&&o.length>1;)o.shift()}return function(o,l,d,p){var g,v,E,T,b,R,N,P,L,M,D,U,B,z,V,G,q,ne,Z=o.constructor,le=o.s==l.s?1:-1,ee=o.d,ce=l.d;if(!o.s)return new Z(o);if(!l.s)throw Error(To+"Division by zero");for(v=o.e-l.e,q=ce.length,V=ee.length,N=new Z(le),P=N.d=[],E=0;ce[E]==(ee[E]||0);)++E;if(ce[E]>(ee[E]||0)&&--v,d==null?U=d=Z.precision:p?U=d+($r(o)-$r(l))+1:U=d,U<0)return new Z(0);if(U=U/lr+2|0,E=0,q==1)for(T=0,ce=ce[0],U++;(E<V||T)&&U--;E++)B=T*ui+(ee[E]||0),P[E]=B/ce|0,T=B%ce|0;else{for(T=ui/(ce[0]+1)|0,T>1&&(ce=e(ce,T),ee=e(ee,T),q=ce.length,V=ee.length),z=q,L=ee.slice(0,q),M=L.length;M<q;)L[M++]=0;ne=ce.slice(),ne.unshift(0),G=ce[0],ce[1]>=ui/2&&++G;do T=0,g=t(ce,L,q,M),g<0?(D=L[0],q!=M&&(D=D*ui+(L[1]||0)),T=D/G|0,T>1?(T>=ui&&(T=ui-1),b=e(ce,T),R=b.length,M=L.length,g=t(b,L,R,M),g==1&&(T--,a(b,q<R?ne:ce,R))):(T==0&&(g=T=1),b=ce.slice()),R=b.length,R<M&&b.unshift(0),a(L,b,M),g==-1&&(M=L.length,g=t(ce,L,q,M),g<1&&(T++,a(L,q<M?ne:ce,M))),M=L.length):g===0&&(T++,L=[0]),P[E++]=T,g&&L[0]?L[M++]=ee[z]||0:(L=[ee[z]],M=1);while((z++<V||L[0]!==void 0)&&U--)}return P[0]||P.shift(),N.e=v,Xn(N,p?d+$r(N)+1:d)}}();function zJ(e,t){var a,o,l,d,p,g,v=0,E=0,T=e.constructor,b=T.precision;if($r(e)>16)throw Error(kD+$r(e));if(!e.s)return new T(ja);for(t==null?(mr=!1,g=b):g=t,p=new T(.03125);e.abs().gte(.1);)e=e.times(p),E+=5;for(o=Math.log(rd(2,E))/Math.LN10*2+5|0,g+=o,a=l=d=new T(ja),T.precision=g;;){if(l=Xn(l.times(e),g),a=a.times(++v),p=d.plus(Tc(l,a,g)),ks(p.d).slice(0,g)===ks(d.d).slice(0,g)){for(;E--;)d=Xn(d.times(d),g);return T.precision=b,t==null?(mr=!0,Xn(d,b)):d}d=p}}function $r(e){for(var t=e.e*lr,a=e.d[0];a>=10;a/=10)t++;return t}function QI(e,t,a){if(t>e.LN10.sd())throw mr=!0,a&&(e.precision=a),Error(To+"LN10 precision limit exceeded");return Xn(new e(e.LN10),t)}function wl(e){for(var t="";e--;)t+="0";return t}function ky(e,t){var a,o,l,d,p,g,v,E,T,b=1,R=10,N=e,P=N.d,L=N.constructor,M=L.precision;if(N.s<1)throw Error(To+(N.s?"NaN":"-Infinity"));if(N.eq(ja))return new L(0);if(t==null?(mr=!1,E=M):E=t,N.eq(10))return t==null&&(mr=!0),QI(L,E);if(E+=R,L.precision=E,a=ks(P),o=a.charAt(0),d=$r(N),Math.abs(d)<15e14){for(;o<7&&o!=1||o==1&&a.charAt(1)>3;)N=N.times(e),a=ks(N.d),o=a.charAt(0),b++;d=$r(N),o>1?(N=new L("0."+a),d++):N=new L(o+"."+a.slice(1))}else return v=QI(L,E+2,M).times(d+""),N=ky(new L(o+"."+a.slice(1)),E-R).plus(v),L.precision=M,t==null?(mr=!0,Xn(N,M)):N;for(g=p=N=Tc(N.minus(ja),N.plus(ja),E),T=Xn(N.times(N),E),l=3;;){if(p=Xn(p.times(T),E),v=g.plus(Tc(p,new L(l),E)),ks(v.d).slice(0,E)===ks(g.d).slice(0,E))return g=g.times(2),d!==0&&(g=g.plus(QI(L,E+2,M).times(d+""))),g=Tc(g,new L(b),E),L.precision=M,t==null?(mr=!0,Xn(g,M)):g;g=v,l+=2}}function Gz(e,t){var a,o,l;for((a=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(a<0&&(a=o),a+=+t.slice(o+1),t=t.substring(0,o)):a<0&&(a=t.length),o=0;t.charCodeAt(o)===48;)++o;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(o,l),t){if(l-=o,a=a-o-1,e.e=xp(a/lr),e.d=[],o=(a+1)%lr,a<0&&(o+=lr),o<l){for(o&&e.d.push(+t.slice(0,o)),l-=lr;o<l;)e.d.push(+t.slice(o,o+=lr));t=t.slice(o),o=lr-t.length}else o-=l;for(;o--;)t+="0";if(e.d.push(+t),mr&&(e.e>yT||e.e<-yT))throw Error(kD+a)}else e.s=0,e.e=0,e.d=[0];return e}function Xn(e,t,a){var o,l,d,p,g,v,E,T,b=e.d;for(p=1,d=b[0];d>=10;d/=10)p++;if(o=t-p,o<0)o+=lr,l=t,E=b[T=0];else{if(T=Math.ceil((o+1)/lr),d=b.length,T>=d)return e;for(E=d=b[T],p=1;d>=10;d/=10)p++;o%=lr,l=o-lr+p}if(a!==void 0&&(d=rd(10,p-l-1),g=E/d%10|0,v=t<0||b[T+1]!==void 0||E%d,v=a<4?(g||v)&&(a==0||a==(e.s<0?3:2)):g>5||g==5&&(a==4||v||a==6&&(o>0?l>0?E/rd(10,p-l):0:b[T-1])%10&1||a==(e.s<0?8:7))),t<1||!b[0])return v?(d=$r(e),b.length=1,t=t-d-1,b[0]=rd(10,(lr-t%lr)%lr),e.e=xp(-t/lr)||0):(b.length=1,b[0]=e.e=e.s=0),e;if(o==0?(b.length=T,d=1,T--):(b.length=T+1,d=rd(10,lr-o),b[T]=l>0?(E/rd(10,p-l)%rd(10,l)|0)*d:0),v)for(;;)if(T==0){(b[0]+=d)==ui&&(b[0]=1,++e.e);break}else{if(b[T]+=d,b[T]!=ui)break;b[T--]=0,d=1}for(o=b.length;b[--o]===0;)b.pop();if(mr&&(e.e>yT||e.e<-yT))throw Error(kD+$r(e));return e}function KJ(e,t){var a,o,l,d,p,g,v,E,T,b,R=e.constructor,N=R.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new R(e),mr?Xn(t,N):t;if(v=e.d,b=t.d,o=t.e,E=e.e,v=v.slice(),p=E-o,p){for(T=p<0,T?(a=v,p=-p,g=b.length):(a=b,o=E,g=v.length),l=Math.max(Math.ceil(N/lr),g)+2,p>l&&(p=l,a.length=1),a.reverse(),l=p;l--;)a.push(0);a.reverse()}else{for(l=v.length,g=b.length,T=l<g,T&&(g=l),l=0;l<g;l++)if(v[l]!=b[l]){T=v[l]<b[l];break}p=0}for(T&&(a=v,v=b,b=a,t.s=-t.s),g=v.length,l=b.length-g;l>0;--l)v[g++]=0;for(l=b.length;l>p;){if(v[--l]<b[l]){for(d=l;d&&v[--d]===0;)v[d]=ui-1;--v[d],v[l]+=ui}v[l]-=b[l]}for(;v[--g]===0;)v.pop();for(;v[0]===0;v.shift())--o;return v[0]?(t.d=v,t.e=o,mr?Xn(t,N):t):new R(0)}function Cd(e,t,a){var o,l=$r(e),d=ks(e.d),p=d.length;return t?(a&&(o=a-p)>0?d=d.charAt(0)+"."+d.slice(1)+wl(o):p>1&&(d=d.charAt(0)+"."+d.slice(1)),d=d+(l<0?"e":"e+")+l):l<0?(d="0."+wl(-l-1)+d,a&&(o=a-p)>0&&(d+=wl(o))):l>=p?(d+=wl(l+1-p),a&&(o=a-l-1)>0&&(d=d+"."+wl(o))):((o=l+1)<p&&(d=d.slice(0,o)+"."+d.slice(o)),a&&(o=a-p)>0&&(l+1===p&&(d+="."),d+=wl(o))),e.s<0?"-"+d:d}function $z(e,t){if(e.length>t)return e.length=t,!0}function qJ(e){var t,a,o;function l(d){var p=this;if(!(p instanceof l))return new l(d);if(p.constructor=l,d instanceof l){p.s=d.s,p.e=d.e,p.d=(d=d.d)?d.slice():d;return}if(typeof d=="number"){if(d*0!==0)throw Error(yd+d);if(d>0)p.s=1;else if(d<0)d=-d,p.s=-1;else{p.s=0,p.e=0,p.d=[0];return}if(d===~~d&&d<1e7){p.e=0,p.d=[d];return}return Gz(p,d.toString())}else if(typeof d!="string")throw Error(yd+d);if(d.charCodeAt(0)===45?(d=d.slice(1),p.s=-1):p.s=1,_je.test(d))Gz(p,d);else throw Error(yd+d)}if(l.prototype=ct,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=qJ,l.config=l.set=Eje,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<o.length;)e.hasOwnProperty(a=o[t++])||(e[a]=this[a]);return l.config(e),l}function Eje(e){if(!e||typeof e!="object")throw Error(To+"Object expected");var t,a,o,l=["precision",1,Pp,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((o=e[a=l[t]])!==void 0)if(xp(o)===o&&o>=l[t+1]&&o<=l[t+2])this[a]=o;else throw Error(yd+a+": "+o);if((o=e[a="LN10"])!==void 0)if(o==Math.LN10)this[a]=new this(o);else throw Error(yd+a+": "+o);return this}var MD=qJ(vje);ja=new MD(1);const zn=MD;function Sje(e){return Cje(e)||wje(e)||Tje(e)||bje()}function bje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tje(e,t){if(e){if(typeof e=="string")return KP(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return KP(e,t)}}function wje(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Cje(e){if(Array.isArray(e))return KP(e)}function KP(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var Rje=function(t){return t},YJ={"@@functional/placeholder":!0},XJ=function(t){return t===YJ},Hz=function(t){return function a(){return arguments.length===0||arguments.length===1&&XJ(arguments.length<=0?void 0:arguments[0])?a:t.apply(void 0,arguments)}},Oje=function e(t,a){return t===1?a:Hz(function(){for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];var p=l.filter(function(g){return g!==YJ}).length;return p>=t?a.apply(void 0,l):e(t-p,Hz(function(){for(var g=arguments.length,v=new Array(g),E=0;E<g;E++)v[E]=arguments[E];var T=l.map(function(b){return XJ(b)?v.shift():b});return a.apply(void 0,Sje(T).concat(v))}))})},Uw=function(t){return Oje(t.length,t)},qP=function(t,a){for(var o=[],l=t;l<a;++l)o[l-t]=l;return o},Aje=Uw(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(a){return t[a]}).map(e)}),Ije=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];if(!a.length)return Rje;var l=a.reverse(),d=l[0],p=l.slice(1);return function(){return p.reduce(function(g,v){return v(g)},d.apply(void 0,arguments))}},YP=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},JJ=function(t){var a=null,o=null;return function(){for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];return a&&d.every(function(g,v){return g===a[v]})||(a=d,o=t.apply(void 0,d)),o}};function Nje(e){var t;return e===0?t=1:t=Math.floor(new zn(e).abs().log(10).toNumber())+1,t}function Pje(e,t,a){for(var o=new zn(e),l=0,d=[];o.lt(t)&&l<1e5;)d.push(o.toNumber()),o=o.add(a),l++;return d}var xje=Uw(function(e,t,a){var o=+e,l=+t;return o+a*(l-o)}),Dje=Uw(function(e,t,a){var o=t-+e;return o=o||1/0,(a-e)/o}),Lje=Uw(function(e,t,a){var o=t-+e;return o=o||1/0,Math.max(0,Math.min(1,(a-e)/o))});const jw={rangeStep:Pje,getDigitCount:Nje,interpolateNumber:xje,uninterpolateNumber:Dje,uninterpolateTruncation:Lje};function XP(e){return Uje(e)||Mje(e)||QJ(e)||kje()}function kje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mje(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Uje(e){if(Array.isArray(e))return JP(e)}function My(e,t){return Bje(e)||Vje(e,t)||QJ(e,t)||jje()}function jje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QJ(e,t){if(e){if(typeof e=="string")return JP(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return JP(e,t)}}function JP(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Vje(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var a=[],o=!0,l=!1,d=void 0;try{for(var p=e[Symbol.iterator](),g;!(o=(g=p.next()).done)&&(a.push(g.value),!(t&&a.length===t));o=!0);}catch(v){l=!0,d=v}finally{try{!o&&p.return!=null&&p.return()}finally{if(l)throw d}}return a}}function Bje(e){if(Array.isArray(e))return e}function ZJ(e){var t=My(e,2),a=t[0],o=t[1],l=a,d=o;return a>o&&(l=o,d=a),[l,d]}function eQ(e,t,a){if(e.lte(0))return new zn(0);var o=jw.getDigitCount(e.toNumber()),l=new zn(10).pow(o),d=e.div(l),p=o!==1?.05:.1,g=new zn(Math.ceil(d.div(p).toNumber())).add(a).mul(p),v=g.mul(l);return t?v:new zn(Math.ceil(v))}function Fje(e,t,a){var o=1,l=new zn(e);if(!l.isint()&&a){var d=Math.abs(e);d<1?(o=new zn(10).pow(jw.getDigitCount(e)-1),l=new zn(Math.floor(l.div(o).toNumber())).mul(o)):d>1&&(l=new zn(Math.floor(e)))}else e===0?l=new zn(Math.floor((t-1)/2)):a||(l=new zn(Math.floor(e)));var p=Math.floor((t-1)/2),g=Ije(Aje(function(v){return l.add(new zn(v-p).mul(o)).toNumber()}),qP);return g(0,t)}function tQ(e,t,a,o){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(a-1)))return{step:new zn(0),tickMin:new zn(0),tickMax:new zn(0)};var d=eQ(new zn(t).sub(e).div(a-1),o,l),p;e<=0&&t>=0?p=new zn(0):(p=new zn(e).add(t).div(2),p=p.sub(new zn(p).mod(d)));var g=Math.ceil(p.sub(e).div(d).toNumber()),v=Math.ceil(new zn(t).sub(p).div(d).toNumber()),E=g+v+1;return E>a?tQ(e,t,a,o,l+1):(E<a&&(v=t>0?v+(a-E):v,g=t>0?g:g+(a-E)),{step:d,tickMin:p.sub(new zn(g).mul(d)),tickMax:p.add(new zn(v).mul(d))})}function Wje(e){var t=My(e,2),a=t[0],o=t[1],l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=Math.max(l,2),g=ZJ([a,o]),v=My(g,2),E=v[0],T=v[1];if(E===-1/0||T===1/0){var b=T===1/0?[E].concat(XP(qP(0,l-1).map(function(){return 1/0}))):[].concat(XP(qP(0,l-1).map(function(){return-1/0})),[T]);return a>o?YP(b):b}if(E===T)return Fje(E,l,d);var R=tQ(E,T,p,d),N=R.step,P=R.tickMin,L=R.tickMax,M=jw.rangeStep(P,L.add(new zn(.1).mul(N)),N);return a>o?YP(M):M}function Gje(e,t){var a=My(e,2),o=a[0],l=a[1],d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=ZJ([o,l]),g=My(p,2),v=g[0],E=g[1];if(v===-1/0||E===1/0)return[o,l];if(v===E)return[v];var T=Math.max(t,2),b=eQ(new zn(E).sub(v).div(T-1),d,0),R=[].concat(XP(jw.rangeStep(new zn(v),new zn(E).sub(new zn(.99).mul(b)),b)),[E]);return o>l?YP(R):R}var $je=JJ(Wje),Hje=JJ(Gje),zje="Invariant failed";function Rd(e,t){throw new Error(zje)}var Kje=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function vT(){return vT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},vT.apply(this,arguments)}function qje(e,t){return Qje(e)||Jje(e,t)||Xje(e,t)||Yje()}function Yje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xje(e,t){if(e){if(typeof e=="string")return zz(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zz(e,t)}}function zz(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Jje(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function Qje(e){if(Array.isArray(e))return e}function Zje(e,t){if(e==null)return{};var a=eVe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function eVe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function tVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nVe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,iQ(o.key),o)}}function rVe(e,t,a){return nVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iVe(e,t,a){return t=_T(t),aVe(e,nQ()?Reflect.construct(t,a||[],_T(e).constructor):t.apply(e,a))}function aVe(e,t){if(t&&(Qf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oVe(e)}function oVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nQ=function(){return!!e})()}function _T(e){return _T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_T(e)}function sVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QP(e,t)}function QP(e,t){return QP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},QP(e,t)}function rQ(e,t,a){return t=iQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function iQ(e){var t=cVe(e,"string");return Qf(t)=="symbol"?t:t+""}function cVe(e,t){if(Qf(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Qf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vw=function(e){function t(){return tVe(this,t),iVe(this,t,arguments)}return sVe(t,e),rVe(t,[{key:"render",value:function(){var o=this.props,l=o.offset,d=o.layout,p=o.width,g=o.dataKey,v=o.data,E=o.dataPointFormatter,T=o.xAxis,b=o.yAxis,R=Zje(o,Kje),N=Cn(R,!1);this.props.direction==="x"&&T.type!=="number"&&Rd();var P=v.map(function(L){var M=E(L,g),D=M.x,U=M.y,B=M.value,z=M.errorVal;if(!z)return null;var V=[],G,q;if(Array.isArray(z)){var ne=qje(z,2);G=ne[0],q=ne[1]}else G=q=z;if(d==="vertical"){var Z=T.scale,le=U+l,ee=le+p,ce=le-p,be=Z(B-G),ae=Z(B+q);V.push({x1:ae,y1:ee,x2:ae,y2:ce}),V.push({x1:be,y1:le,x2:ae,y2:le}),V.push({x1:be,y1:ee,x2:be,y2:ce})}else if(d==="horizontal"){var fe=b.scale,me=D+l,_e=me-p,ue=me+p,ve=fe(B-G),Ce=fe(B+q);V.push({x1:_e,y1:Ce,x2:ue,y2:Ce}),V.push({x1:me,y1:ve,x2:me,y2:Ce}),V.push({x1:_e,y1:ve,x2:ue,y2:ve})}return ye.createElement(hi,vT({className:"recharts-errorBar",key:"bar-".concat(V.map(function(Ve){return"".concat(Ve.x1,"-").concat(Ve.x2,"-").concat(Ve.y1,"-").concat(Ve.y2)}))},N),V.map(function(Ve){return ye.createElement("line",vT({},Ve,{key:"line-".concat(Ve.x1,"-").concat(Ve.x2,"-").concat(Ve.y1,"-").concat(Ve.y2)}))}))});return ye.createElement(hi,{className:"recharts-errorBars"},P)}}])}(ye.Component);rQ(Vw,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});rQ(Vw,"displayName","ErrorBar");function Uy(e){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function Kz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Qu(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Kz(Object(a),!0).forEach(function(o){lVe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Kz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function lVe(e,t,a){return t=uVe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function uVe(e){var t=dVe(e,"string");return Uy(t)=="symbol"?t:t+""}function dVe(e,t){if(Uy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Uy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aQ=function(t){var a=t.children,o=t.formattedGraphicalItems,l=t.legendWidth,d=t.legendContent,p=Ma(a,md);if(!p)return null;var g=md.defaultProps,v=g!==void 0?Qu(Qu({},g),p.props):{},E;return p.props&&p.props.payload?E=p.props&&p.props.payload:d==="children"?E=(o||[]).reduce(function(T,b){var R=b.item,N=b.props,P=N.sectors||N.data||[];return T.concat(P.map(function(L){return{type:p.props.iconType||R.props.legendType,value:L.name,color:L.fill,payload:L}}))},[]):E=(o||[]).map(function(T){var b=T.item,R=b.type.defaultProps,N=R!==void 0?Qu(Qu({},R),b.props):{},P=N.dataKey,L=N.name,M=N.legendType,D=N.hide;return{inactive:D,dataKey:P,type:v.iconType||M||"square",color:UD(b),value:L||P,payload:N}}),Qu(Qu(Qu({},v),md.getWithHeight(p,l)),{},{payload:E,item:p})};function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function qz(e){return mVe(e)||pVe(e)||fVe(e)||hVe()}function hVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fVe(e,t){if(e){if(typeof e=="string")return ZP(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ZP(e,t)}}function pVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mVe(e){if(Array.isArray(e))return ZP(e)}function ZP(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Yz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Pr(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Yz(Object(a),!0).forEach(function(o){Mf(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Yz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Mf(e,t,a){return t=gVe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gVe(e){var t=yVe(e,"string");return jy(t)=="symbol"?t:t+""}function yVe(e,t){if(jy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(jy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fs(e,t,a){return Pn(e)||Pn(t)?a:Zr(t)?Eo(e,t,a):Zt(t)?t(e):a}function ty(e,t,a,o){var l=pje(e,function(g){return Fs(g,t)});if(a==="number"){var d=l.filter(function(g){return Ze(g)||parseFloat(g)});return d.length?[Mw(d),kw(d)]:[1/0,-1/0]}var p=o?l.filter(function(g){return!Pn(g)}):l;return p.map(function(g){return Zr(g)||g instanceof Date?g:""})}var vVe=function(t){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,p=-1,g=(a=o==null?void 0:o.length)!==null&&a!==void 0?a:0;if(g<=1)return 0;if(d&&d.axisType==="angleAxis"&&Math.abs(Math.abs(d.range[1]-d.range[0])-360)<=1e-6)for(var v=d.range,E=0;E<g;E++){var T=E>0?l[E-1].coordinate:l[g-1].coordinate,b=l[E].coordinate,R=E>=g-1?l[0].coordinate:l[E+1].coordinate,N=void 0;if(es(b-T)!==es(R-b)){var P=[];if(es(R-b)===es(v[1]-v[0])){N=R;var L=b+v[1]-v[0];P[0]=Math.min(L,(L+T)/2),P[1]=Math.max(L,(L+T)/2)}else{N=T;var M=R+v[1]-v[0];P[0]=Math.min(b,(M+b)/2),P[1]=Math.max(b,(M+b)/2)}var D=[Math.min(b,(N+b)/2),Math.max(b,(N+b)/2)];if(t>D[0]&&t<=D[1]||t>=P[0]&&t<=P[1]){p=l[E].index;break}}else{var U=Math.min(T,R),B=Math.max(T,R);if(t>(U+b)/2&&t<=(B+b)/2){p=l[E].index;break}}}else for(var z=0;z<g;z++)if(z===0&&t<=(o[z].coordinate+o[z+1].coordinate)/2||z>0&&z<g-1&&t>(o[z].coordinate+o[z-1].coordinate)/2&&t<=(o[z].coordinate+o[z+1].coordinate)/2||z===g-1&&t>(o[z].coordinate+o[z-1].coordinate)/2){p=o[z].index;break}return p},UD=function(t){var a,o=t,l=o.type.displayName,d=(a=t.type)!==null&&a!==void 0&&a.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,p=d.stroke,g=d.fill,v;switch(l){case"Line":v=p;break;case"Area":case"Radar":v=p&&p!=="none"?p:g;break;default:v=g;break}return v},_Ve=function(t){var a=t.barSize,o=t.totalSize,l=t.stackGroups,d=l===void 0?{}:l;if(!d)return{};for(var p={},g=Object.keys(d),v=0,E=g.length;v<E;v++)for(var T=d[g[v]].stackGroups,b=Object.keys(T),R=0,N=b.length;R<N;R++){var P=T[b[R]],L=P.items,M=P.cateAxisId,D=L.filter(function(q){return Sc(q.type).indexOf("Bar")>=0});if(D&&D.length){var U=D[0].type.defaultProps,B=U!==void 0?Pr(Pr({},U),D[0].props):D[0].props,z=B.barSize,V=B[M];p[V]||(p[V]=[]);var G=Pn(z)?a:z;p[V].push({item:D[0],stackList:D.slice(1),barSize:Pn(G)?void 0:wd(G,o,0)})}}return p},EVe=function(t){var a=t.barGap,o=t.barCategoryGap,l=t.bandSize,d=t.sizeList,p=d===void 0?[]:d,g=t.maxBarSize,v=p.length;if(v<1)return null;var E=wd(a,l,0,!0),T,b=[];if(p[0].barSize===+p[0].barSize){var R=!1,N=l/v,P=p.reduce(function(z,V){return z+V.barSize||0},0);P+=(v-1)*E,P>=l&&(P-=(v-1)*E,E=0),P>=l&&N>0&&(R=!0,N*=.9,P=v*N);var L=(l-P)/2>>0,M={offset:L-E,size:0};T=p.reduce(function(z,V){var G={item:V.item,position:{offset:M.offset+M.size+E,size:R?N:V.barSize}},q=[].concat(qz(z),[G]);return M=q[q.length-1].position,V.stackList&&V.stackList.length&&V.stackList.forEach(function(ne){q.push({item:ne,position:M})}),q},b)}else{var D=wd(o,l,0,!0);l-2*D-(v-1)*E<=0&&(E=0);var U=(l-2*D-(v-1)*E)/v;U>1&&(U>>=0);var B=g===+g?Math.min(U,g):U;T=p.reduce(function(z,V,G){var q=[].concat(qz(z),[{item:V.item,position:{offset:D+(U+E)*G+(U-B)/2,size:B}}]);return V.stackList&&V.stackList.length&&V.stackList.forEach(function(ne){q.push({item:ne,position:q[q.length-1].position})}),q},b)}return T},SVe=function(t,a,o,l){var d=o.children,p=o.width,g=o.margin,v=p-(g.left||0)-(g.right||0),E=aQ({children:d,legendWidth:v});if(E){var T=l||{},b=T.width,R=T.height,N=E.align,P=E.verticalAlign,L=E.layout;if((L==="vertical"||L==="horizontal"&&P==="middle")&&N!=="center"&&Ze(t[N]))return Pr(Pr({},t),{},Mf({},N,t[N]+(b||0)));if((L==="horizontal"||L==="vertical"&&N==="center")&&P!=="middle"&&Ze(t[P]))return Pr(Pr({},t),{},Mf({},P,t[P]+(R||0)))}return t},bVe=function(t,a,o){return Pn(a)?!0:t==="horizontal"?a==="yAxis":t==="vertical"||o==="x"?a==="xAxis":o==="y"?a==="yAxis":!0},oQ=function(t,a,o,l,d){var p=a.props.children,g=rs(p,Vw).filter(function(E){return bVe(l,d,E.props.direction)});if(g&&g.length){var v=g.map(function(E){return E.props.dataKey});return t.reduce(function(E,T){var b=Fs(T,o);if(Pn(b))return E;var R=Array.isArray(b)?[Mw(b),kw(b)]:[b,b],N=v.reduce(function(P,L){var M=Fs(T,L,0),D=R[0]-Math.abs(Array.isArray(M)?M[0]:M),U=R[1]+Math.abs(Array.isArray(M)?M[1]:M);return[Math.min(D,P[0]),Math.max(U,P[1])]},[1/0,-1/0]);return[Math.min(N[0],E[0]),Math.max(N[1],E[1])]},[1/0,-1/0])}return null},TVe=function(t,a,o,l,d){var p=a.map(function(g){return oQ(t,g,o,d,l)}).filter(function(g){return!Pn(g)});return p&&p.length?p.reduce(function(g,v){return[Math.min(g[0],v[0]),Math.max(g[1],v[1])]},[1/0,-1/0]):null},sQ=function(t,a,o,l,d){var p=a.map(function(v){var E=v.props.dataKey;return o==="number"&&E&&oQ(t,v,E,l)||ty(t,E,o,d)});if(o==="number")return p.reduce(function(v,E){return[Math.min(v[0],E[0]),Math.max(v[1],E[1])]},[1/0,-1/0]);var g={};return p.reduce(function(v,E){for(var T=0,b=E.length;T<b;T++)g[E[T]]||(g[E[T]]=!0,v.push(E[T]));return v},[])},cQ=function(t,a){return t==="horizontal"&&a==="xAxis"||t==="vertical"&&a==="yAxis"||t==="centric"&&a==="angleAxis"||t==="radial"&&a==="radiusAxis"},lQ=function(t,a,o,l){if(l)return t.map(function(v){return v.coordinate});var d,p,g=t.map(function(v){return v.coordinate===a&&(d=!0),v.coordinate===o&&(p=!0),v.coordinate});return d||g.push(a),p||g.push(o),g},_c=function(t,a,o){if(!t)return null;var l=t.scale,d=t.duplicateDomain,p=t.type,g=t.range,v=t.realScaleType==="scaleBand"?l.bandwidth()/2:2,E=(a||o)&&p==="category"&&l.bandwidth?l.bandwidth()/v:0;if(E=t.axisType==="angleAxis"&&(g==null?void 0:g.length)>=2?es(g[0]-g[1])*2*E:E,a&&(t.ticks||t.niceTicks)){var T=(t.ticks||t.niceTicks).map(function(b){var R=d?d.indexOf(b):b;return{coordinate:l(R)+E,value:b,offset:E}});return T.filter(function(b){return!pv(b.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(b,R){return{coordinate:l(b)+E,value:b,index:R,offset:E}}):l.ticks&&!o?l.ticks(t.tickCount).map(function(b){return{coordinate:l(b)+E,value:b,offset:E}}):l.domain().map(function(b,R){return{coordinate:l(b)+E,value:d?d[b]:b,index:R,offset:E}})},ZI=new WeakMap,$S=function(t,a){if(typeof a!="function")return t;ZI.has(t)||ZI.set(t,new WeakMap);var o=ZI.get(t);if(o.has(a))return o.get(a);var l=function(){t.apply(void 0,arguments),a.apply(void 0,arguments)};return o.set(a,l),l},wVe=function(t,a,o){var l=t.scale,d=t.type,p=t.layout,g=t.axisType;if(l==="auto")return p==="radial"&&g==="radiusAxis"?{scale:Ny(),realScaleType:"band"}:p==="radial"&&g==="angleAxis"?{scale:fT(),realScaleType:"linear"}:d==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!o)?{scale:ey(),realScaleType:"point"}:d==="category"?{scale:Ny(),realScaleType:"band"}:{scale:fT(),realScaleType:"linear"};if(fv(l)){var v="scale".concat(bw(l));return{scale:(Wz[v]||ey)(),realScaleType:Wz[v]?v:"point"}}return Zt(l)?{scale:l}:{scale:ey(),realScaleType:"point"}},Xz=1e-4,CVe=function(t){var a=t.domain();if(!(!a||a.length<=2)){var o=a.length,l=t.range(),d=Math.min(l[0],l[1])-Xz,p=Math.max(l[0],l[1])+Xz,g=t(a[0]),v=t(a[o-1]);(g<d||g>p||v<d||v>p)&&t.domain([a[0],a[o-1]])}},RVe=function(t,a){if(!t)return null;for(var o=0,l=t.length;o<l;o++)if(t[o].item===a)return t[o].position;return null},OVe=function(t,a){if(!a||a.length!==2||!Ze(a[0])||!Ze(a[1]))return t;var o=Math.min(a[0],a[1]),l=Math.max(a[0],a[1]),d=[t[0],t[1]];return(!Ze(t[0])||t[0]<o)&&(d[0]=o),(!Ze(t[1])||t[1]>l)&&(d[1]=l),d[0]>l&&(d[0]=l),d[1]<o&&(d[1]=o),d},AVe=function(t){var a=t.length;if(!(a<=0))for(var o=0,l=t[0].length;o<l;++o)for(var d=0,p=0,g=0;g<a;++g){var v=pv(t[g][o][1])?t[g][o][0]:t[g][o][1];v>=0?(t[g][o][0]=d,t[g][o][1]=d+v,d=t[g][o][1]):(t[g][o][0]=p,t[g][o][1]=p+v,p=t[g][o][1])}},IVe=function(t){var a=t.length;if(!(a<=0))for(var o=0,l=t[0].length;o<l;++o)for(var d=0,p=0;p<a;++p){var g=pv(t[p][o][1])?t[p][o][0]:t[p][o][1];g>=0?(t[p][o][0]=d,t[p][o][1]=d+g,d=t[p][o][1]):(t[p][o][0]=0,t[p][o][1]=0)}},NVe={sign:AVe,expand:$Oe,none:$f,silhouette:HOe,wiggle:zOe,positive:IVe},PVe=function(t,a,o){var l=a.map(function(g){return g.props.dataKey}),d=NVe[o],p=GOe().keys(l).value(function(g,v){return+Fs(g,v,0)}).order(wP).offset(d);return p(t)},xVe=function(t,a,o,l,d,p){if(!t)return null;var g=p?a.reverse():a,v={},E=g.reduce(function(b,R){var N,P=(N=R.type)!==null&&N!==void 0&&N.defaultProps?Pr(Pr({},R.type.defaultProps),R.props):R.props,L=P.stackId,M=P.hide;if(M)return b;var D=P[o],U=b[D]||{hasStack:!1,stackGroups:{}};if(Zr(L)){var B=U.stackGroups[L]||{numericAxisId:o,cateAxisId:l,items:[]};B.items.push(R),U.hasStack=!0,U.stackGroups[L]=B}else U.stackGroups[Sw("_stackId_")]={numericAxisId:o,cateAxisId:l,items:[R]};return Pr(Pr({},b),{},Mf({},D,U))},v),T={};return Object.keys(E).reduce(function(b,R){var N=E[R];if(N.hasStack){var P={};N.stackGroups=Object.keys(N.stackGroups).reduce(function(L,M){var D=N.stackGroups[M];return Pr(Pr({},L),{},Mf({},M,{numericAxisId:o,cateAxisId:l,items:D.items,stackedData:PVe(t,D.items,d)}))},P)}return Pr(Pr({},b),{},Mf({},R,N))},T)},DVe=function(t,a){var o=a.realScaleType,l=a.type,d=a.tickCount,p=a.originalDomain,g=a.allowDecimals,v=o||a.scale;if(v!=="auto"&&v!=="linear")return null;if(d&&l==="number"&&p&&(p[0]==="auto"||p[1]==="auto")){var E=t.domain();if(!E.length)return null;var T=$je(E,d,g);return t.domain([Mw(T),kw(T)]),{niceTicks:T}}if(d&&l==="number"){var b=t.domain(),R=Hje(b,d,g);return{niceTicks:R}}return null},Jz=function(t){var a=t.axis,o=t.ticks,l=t.offset,d=t.bandSize,p=t.entry,g=t.index;if(a.type==="category")return o[g]?o[g].coordinate+l:null;var v=Fs(p,a.dataKey,a.domain[g]);return Pn(v)?null:a.scale(v)-d/2+l},LVe=function(t){var a=t.numericAxis,o=a.scale.domain();if(a.type==="number"){var l=Math.min(o[0],o[1]),d=Math.max(o[0],o[1]);return l<=0&&d>=0?0:d<0?d:l}return o[0]},kVe=function(t,a){var o,l=(o=t.type)!==null&&o!==void 0&&o.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,d=l.stackId;if(Zr(d)){var p=a[d];if(p){var g=p.items.indexOf(t);return g>=0?p.stackedData[g]:null}}return null},MVe=function(t){return t.reduce(function(a,o){return[Mw(o.concat([a[0]]).filter(Ze)),kw(o.concat([a[1]]).filter(Ze))]},[1/0,-1/0])},uQ=function(t,a,o){return Object.keys(t).reduce(function(l,d){var p=t[d],g=p.stackedData,v=g.reduce(function(E,T){var b=MVe(T.slice(a,o+1));return[Math.min(E[0],b[0]),Math.max(E[1],b[1])]},[1/0,-1/0]);return[Math.min(v[0],l[0]),Math.max(v[1],l[1])]},[1/0,-1/0]).map(function(l){return l===1/0||l===-1/0?0:l})},Qz=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Zz=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ex=function(t,a,o){if(Zt(t))return t(a,o);if(!Array.isArray(t))return a;var l=[];if(Ze(t[0]))l[0]=o?t[0]:Math.min(t[0],a[0]);else if(Qz.test(t[0])){var d=+Qz.exec(t[0])[1];l[0]=a[0]-d}else Zt(t[0])?l[0]=t[0](a[0]):l[0]=a[0];if(Ze(t[1]))l[1]=o?t[1]:Math.max(t[1],a[1]);else if(Zz.test(t[1])){var p=+Zz.exec(t[1])[1];l[1]=a[1]+p}else Zt(t[1])?l[1]=t[1](a[1]):l[1]=a[1];return l},ET=function(t,a,o){if(t&&t.scale&&t.scale.bandwidth){var l=t.scale.bandwidth();if(!o||l>0)return l}if(t&&a&&a.length>=2){for(var d=uD(a,function(b){return b.coordinate}),p=1/0,g=1,v=d.length;g<v;g++){var E=d[g],T=d[g-1];p=Math.min((E.coordinate||0)-(T.coordinate||0),p)}return p===1/0?0:p}return o?void 0:0},eK=function(t,a,o){return!t||!t.length||LD(t,Eo(o,"type.defaultProps.domain"))?a:t},dQ=function(t,a){var o=t.type.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,l=o.dataKey,d=o.name,p=o.unit,g=o.formatter,v=o.tooltipType,E=o.chartType,T=o.hide;return Pr(Pr({},Cn(t,!1)),{},{dataKey:l,unit:p,formatter:g,name:d||l,color:UD(t),value:Fs(a,l),type:v,payload:a,chartType:E,hide:T})};function Vy(e){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(e)}function tK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function nK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tK(Object(a),!0).forEach(function(o){UVe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function UVe(e,t,a){return t=jVe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function jVe(e){var t=VVe(e,"string");return Vy(t)=="symbol"?t:t+""}function VVe(e,t){if(Vy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Vy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ST=Math.PI/180,BVe=function(t){return t*180/Math.PI},Ti=function(t,a,o,l){return{x:t+Math.cos(-ST*l)*o,y:a+Math.sin(-ST*l)*o}},FVe=function(t,a){var o=t.x,l=t.y,d=a.x,p=a.y;return Math.sqrt(Math.pow(o-d,2)+Math.pow(l-p,2))},WVe=function(t,a){var o=t.x,l=t.y,d=a.cx,p=a.cy,g=FVe({x:o,y:l},{x:d,y:p});if(g<=0)return{radius:g};var v=(o-d)/g,E=Math.acos(v);return l>p&&(E=2*Math.PI-E),{radius:g,angle:BVe(E),angleInRadian:E}},GVe=function(t){var a=t.startAngle,o=t.endAngle,l=Math.floor(a/360),d=Math.floor(o/360),p=Math.min(l,d);return{startAngle:a-p*360,endAngle:o-p*360}},$Ve=function(t,a){var o=a.startAngle,l=a.endAngle,d=Math.floor(o/360),p=Math.floor(l/360),g=Math.min(d,p);return t+g*360},rK=function(t,a){var o=t.x,l=t.y,d=WVe({x:o,y:l},a),p=d.radius,g=d.angle,v=a.innerRadius,E=a.outerRadius;if(p<v||p>E)return!1;if(p===0)return!0;var T=GVe(a),b=T.startAngle,R=T.endAngle,N=g,P;if(b<=R){for(;N>R;)N-=360;for(;N<b;)N+=360;P=N>=b&&N<=R}else{for(;N>b;)N-=360;for(;N<R;)N+=360;P=N>=R&&N<=b}return P?nK(nK({},a),{},{radius:p,angle:$Ve(N,a)}):null};function By(e){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},By(e)}var HVe=["offset"];function zVe(e){return XVe(e)||YVe(e)||qVe(e)||KVe()}function KVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qVe(e,t){if(e){if(typeof e=="string")return tx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return tx(e,t)}}function YVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XVe(e){if(Array.isArray(e))return tx(e)}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function JVe(e,t){if(e==null)return{};var a=QVe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function QVe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function iK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Xr(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?iK(Object(a),!0).forEach(function(o){ZVe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):iK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function ZVe(e,t,a){return t=eBe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eBe(e){var t=tBe(e,"string");return By(t)=="symbol"?t:t+""}function tBe(e,t){if(By(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(By(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Fy.apply(this,arguments)}var nBe=function(t){var a=t.value,o=t.formatter,l=Pn(t.children)?a:t.children;return Zt(o)?o(l):l},rBe=function(t,a){var o=es(a-t),l=Math.min(Math.abs(a-t),360);return o*l},iBe=function(t,a,o){var l=t.position,d=t.viewBox,p=t.offset,g=t.className,v=d,E=v.cx,T=v.cy,b=v.innerRadius,R=v.outerRadius,N=v.startAngle,P=v.endAngle,L=v.clockWise,M=(b+R)/2,D=rBe(N,P),U=D>=0?1:-1,B,z;l==="insideStart"?(B=N+U*p,z=L):l==="insideEnd"?(B=P-U*p,z=!L):l==="end"&&(B=P+U*p,z=L),z=D<=0?z:!z;var V=Ti(E,T,M,B),G=Ti(E,T,M,B+(z?1:-1)*359),q="M".concat(V.x,",").concat(V.y,`
    A`).concat(M,",").concat(M,",0,1,").concat(z?0:1,`,
    `).concat(G.x,",").concat(G.y),ne=Pn(t.id)?Sw("recharts-radial-line-"):t.id;return ye.createElement("text",Fy({},o,{dominantBaseline:"central",className:Sn("recharts-radial-bar-label",g)}),ye.createElement("defs",null,ye.createElement("path",{id:ne,d:q})),ye.createElement("textPath",{xlinkHref:"#".concat(ne)},a))},aBe=function(t){var a=t.viewBox,o=t.offset,l=t.position,d=a,p=d.cx,g=d.cy,v=d.innerRadius,E=d.outerRadius,T=d.startAngle,b=d.endAngle,R=(T+b)/2;if(l==="outside"){var N=Ti(p,g,E+o,R),P=N.x,L=N.y;return{x:P,y:L,textAnchor:P>=p?"start":"end",verticalAnchor:"middle"}}if(l==="center")return{x:p,y:g,textAnchor:"middle",verticalAnchor:"middle"};if(l==="centerTop")return{x:p,y:g,textAnchor:"middle",verticalAnchor:"start"};if(l==="centerBottom")return{x:p,y:g,textAnchor:"middle",verticalAnchor:"end"};var M=(v+E)/2,D=Ti(p,g,M,R),U=D.x,B=D.y;return{x:U,y:B,textAnchor:"middle",verticalAnchor:"middle"}},oBe=function(t){var a=t.viewBox,o=t.parentViewBox,l=t.offset,d=t.position,p=a,g=p.x,v=p.y,E=p.width,T=p.height,b=T>=0?1:-1,R=b*l,N=b>0?"end":"start",P=b>0?"start":"end",L=E>=0?1:-1,M=L*l,D=L>0?"end":"start",U=L>0?"start":"end";if(d==="top"){var B={x:g+E/2,y:v-b*l,textAnchor:"middle",verticalAnchor:N};return Xr(Xr({},B),o?{height:Math.max(v-o.y,0),width:E}:{})}if(d==="bottom"){var z={x:g+E/2,y:v+T+R,textAnchor:"middle",verticalAnchor:P};return Xr(Xr({},z),o?{height:Math.max(o.y+o.height-(v+T),0),width:E}:{})}if(d==="left"){var V={x:g-M,y:v+T/2,textAnchor:D,verticalAnchor:"middle"};return Xr(Xr({},V),o?{width:Math.max(V.x-o.x,0),height:T}:{})}if(d==="right"){var G={x:g+E+M,y:v+T/2,textAnchor:U,verticalAnchor:"middle"};return Xr(Xr({},G),o?{width:Math.max(o.x+o.width-G.x,0),height:T}:{})}var q=o?{width:E,height:T}:{};return d==="insideLeft"?Xr({x:g+M,y:v+T/2,textAnchor:U,verticalAnchor:"middle"},q):d==="insideRight"?Xr({x:g+E-M,y:v+T/2,textAnchor:D,verticalAnchor:"middle"},q):d==="insideTop"?Xr({x:g+E/2,y:v+R,textAnchor:"middle",verticalAnchor:P},q):d==="insideBottom"?Xr({x:g+E/2,y:v+T-R,textAnchor:"middle",verticalAnchor:N},q):d==="insideTopLeft"?Xr({x:g+M,y:v+R,textAnchor:U,verticalAnchor:P},q):d==="insideTopRight"?Xr({x:g+E-M,y:v+R,textAnchor:D,verticalAnchor:P},q):d==="insideBottomLeft"?Xr({x:g+M,y:v+T-R,textAnchor:U,verticalAnchor:N},q):d==="insideBottomRight"?Xr({x:g+E-M,y:v+T-R,textAnchor:D,verticalAnchor:N},q):Tp(d)&&(Ze(d.x)||ld(d.x))&&(Ze(d.y)||ld(d.y))?Xr({x:g+wd(d.x,E),y:v+wd(d.y,T),textAnchor:"end",verticalAnchor:"end"},q):Xr({x:g+E/2,y:v+T/2,textAnchor:"middle",verticalAnchor:"middle"},q)},sBe=function(t){return"cx"in t&&Ze(t.cx)};function Vi(e){var t=e.offset,a=t===void 0?5:t,o=JVe(e,HVe),l=Xr({offset:a},o),d=l.viewBox,p=l.position,g=l.value,v=l.children,E=l.content,T=l.className,b=T===void 0?"":T,R=l.textBreakAll;if(!d||Pn(g)&&Pn(v)&&!x.isValidElement(E)&&!Zt(E))return null;if(x.isValidElement(E))return x.cloneElement(E,l);var N;if(Zt(E)){if(N=x.createElement(E,l),x.isValidElement(N))return N}else N=nBe(l);var P=sBe(d),L=Cn(l,!0);if(P&&(p==="insideStart"||p==="insideEnd"||p==="end"))return iBe(l,N,L);var M=P?aBe(l):oBe(l);return ye.createElement(oT,Fy({className:Sn("recharts-label",b)},L,M,{breakAll:R}),N)}Vi.displayName="Label";var hQ=function(t){var a=t.cx,o=t.cy,l=t.angle,d=t.startAngle,p=t.endAngle,g=t.r,v=t.radius,E=t.innerRadius,T=t.outerRadius,b=t.x,R=t.y,N=t.top,P=t.left,L=t.width,M=t.height,D=t.clockWise,U=t.labelViewBox;if(U)return U;if(Ze(L)&&Ze(M)){if(Ze(b)&&Ze(R))return{x:b,y:R,width:L,height:M};if(Ze(N)&&Ze(P))return{x:N,y:P,width:L,height:M}}return Ze(b)&&Ze(R)?{x:b,y:R,width:0,height:0}:Ze(a)&&Ze(o)?{cx:a,cy:o,startAngle:d||l||0,endAngle:p||l||0,innerRadius:E||0,outerRadius:T||v||g||0,clockWise:D}:t.viewBox?t.viewBox:{}},cBe=function(t,a){return t?t===!0?ye.createElement(Vi,{key:"label-implicit",viewBox:a}):Zr(t)?ye.createElement(Vi,{key:"label-implicit",viewBox:a,value:t}):x.isValidElement(t)?t.type===Vi?x.cloneElement(t,{key:"label-implicit",viewBox:a}):ye.createElement(Vi,{key:"label-implicit",content:t,viewBox:a}):Zt(t)?ye.createElement(Vi,{key:"label-implicit",content:t,viewBox:a}):Tp(t)?ye.createElement(Vi,Fy({viewBox:a},t,{key:"label-implicit"})):null:null},lBe=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&o&&!t.label)return null;var l=t.children,d=hQ(t),p=rs(l,Vi).map(function(v,E){return x.cloneElement(v,{viewBox:a||d,key:"label-".concat(E)})});if(!o)return p;var g=cBe(t.label,a||d);return[g].concat(zVe(p))};Vi.parseViewBox=hQ;Vi.renderCallByParent=lBe;function uBe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var dBe=uBe;const hBe=Kn(dBe);function Wy(e){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}var fBe=["valueAccessor"],pBe=["data","dataKey","clockWise","id","textBreakAll"];function mBe(e){return _Be(e)||vBe(e)||yBe(e)||gBe()}function gBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yBe(e,t){if(e){if(typeof e=="string")return nx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return nx(e,t)}}function vBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Be(e){if(Array.isArray(e))return nx(e)}function nx(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function bT(){return bT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},bT.apply(this,arguments)}function aK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function oK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?aK(Object(a),!0).forEach(function(o){EBe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):aK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function EBe(e,t,a){return t=SBe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function SBe(e){var t=bBe(e,"string");return Wy(t)=="symbol"?t:t+""}function bBe(e,t){if(Wy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Wy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sK(e,t){if(e==null)return{};var a=TBe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function TBe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var wBe=function(t){return Array.isArray(t.value)?hBe(t.value):t.value};function vd(e){var t=e.valueAccessor,a=t===void 0?wBe:t,o=sK(e,fBe),l=o.data,d=o.dataKey,p=o.clockWise,g=o.id,v=o.textBreakAll,E=sK(o,pBe);return!l||!l.length?null:ye.createElement(hi,{className:"recharts-label-list"},l.map(function(T,b){var R=Pn(d)?a(T,b):Fs(T&&T.payload,d),N=Pn(g)?{}:{id:"".concat(g,"-").concat(b)};return ye.createElement(Vi,bT({},Cn(T,!0),E,N,{parentViewBox:T.parentViewBox,value:R,textBreakAll:v,viewBox:Vi.parseViewBox(Pn(p)?T:oK(oK({},T),{},{clockWise:p})),key:"label-".concat(b),index:b}))}))}vd.displayName="LabelList";function CBe(e,t){return e?e===!0?ye.createElement(vd,{key:"labelList-implicit",data:t}):ye.isValidElement(e)||Zt(e)?ye.createElement(vd,{key:"labelList-implicit",data:t,content:e}):Tp(e)?ye.createElement(vd,bT({data:t},e,{key:"labelList-implicit"})):null:null}function RBe(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&a&&!e.label)return null;var o=e.children,l=rs(o,vd).map(function(p,g){return x.cloneElement(p,{data:t,key:"labelList-".concat(g)})});if(!a)return l;var d=CBe(e.label,t);return[d].concat(mBe(l))}vd.renderCallByParent=RBe;function Gy(e){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gy(e)}function rx(){return rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},rx.apply(this,arguments)}function cK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function lK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?cK(Object(a),!0).forEach(function(o){OBe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function OBe(e,t,a){return t=ABe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ABe(e){var t=IBe(e,"string");return Gy(t)=="symbol"?t:t+""}function IBe(e,t){if(Gy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Gy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NBe=function(t,a){var o=es(a-t),l=Math.min(Math.abs(a-t),359.999);return o*l},HS=function(t){var a=t.cx,o=t.cy,l=t.radius,d=t.angle,p=t.sign,g=t.isExternal,v=t.cornerRadius,E=t.cornerIsExternal,T=v*(g?1:-1)+l,b=Math.asin(v/T)/ST,R=E?d:d+p*b,N=Ti(a,o,T,R),P=Ti(a,o,l,R),L=E?d-p*b:d,M=Ti(a,o,T*Math.cos(b*ST),L);return{center:N,circleTangency:P,lineTangency:M,theta:b}},fQ=function(t){var a=t.cx,o=t.cy,l=t.innerRadius,d=t.outerRadius,p=t.startAngle,g=t.endAngle,v=NBe(p,g),E=p+v,T=Ti(a,o,d,p),b=Ti(a,o,d,E),R="M ".concat(T.x,",").concat(T.y,`
    A `).concat(d,",").concat(d,`,0,
    `).concat(+(Math.abs(v)>180),",").concat(+(p>E),`,
    `).concat(b.x,",").concat(b.y,`
  `);if(l>0){var N=Ti(a,o,l,p),P=Ti(a,o,l,E);R+="L ".concat(P.x,",").concat(P.y,`
            A `).concat(l,",").concat(l,`,0,
            `).concat(+(Math.abs(v)>180),",").concat(+(p<=E),`,
            `).concat(N.x,",").concat(N.y," Z")}else R+="L ".concat(a,",").concat(o," Z");return R},PBe=function(t){var a=t.cx,o=t.cy,l=t.innerRadius,d=t.outerRadius,p=t.cornerRadius,g=t.forceCornerRadius,v=t.cornerIsExternal,E=t.startAngle,T=t.endAngle,b=es(T-E),R=HS({cx:a,cy:o,radius:d,angle:E,sign:b,cornerRadius:p,cornerIsExternal:v}),N=R.circleTangency,P=R.lineTangency,L=R.theta,M=HS({cx:a,cy:o,radius:d,angle:T,sign:-b,cornerRadius:p,cornerIsExternal:v}),D=M.circleTangency,U=M.lineTangency,B=M.theta,z=v?Math.abs(E-T):Math.abs(E-T)-L-B;if(z<0)return g?"M ".concat(P.x,",").concat(P.y,`
        a`).concat(p,",").concat(p,",0,0,1,").concat(p*2,`,0
        a`).concat(p,",").concat(p,",0,0,1,").concat(-p*2,`,0
      `):fQ({cx:a,cy:o,innerRadius:l,outerRadius:d,startAngle:E,endAngle:T});var V="M ".concat(P.x,",").concat(P.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(b<0),",").concat(N.x,",").concat(N.y,`
    A`).concat(d,",").concat(d,",0,").concat(+(z>180),",").concat(+(b<0),",").concat(D.x,",").concat(D.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(b<0),",").concat(U.x,",").concat(U.y,`
  `);if(l>0){var G=HS({cx:a,cy:o,radius:l,angle:E,sign:b,isExternal:!0,cornerRadius:p,cornerIsExternal:v}),q=G.circleTangency,ne=G.lineTangency,Z=G.theta,le=HS({cx:a,cy:o,radius:l,angle:T,sign:-b,isExternal:!0,cornerRadius:p,cornerIsExternal:v}),ee=le.circleTangency,ce=le.lineTangency,be=le.theta,ae=v?Math.abs(E-T):Math.abs(E-T)-Z-be;if(ae<0&&p===0)return"".concat(V,"L").concat(a,",").concat(o,"Z");V+="L".concat(ce.x,",").concat(ce.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(b<0),",").concat(ee.x,",").concat(ee.y,`
      A`).concat(l,",").concat(l,",0,").concat(+(ae>180),",").concat(+(b>0),",").concat(q.x,",").concat(q.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(b<0),",").concat(ne.x,",").concat(ne.y,"Z")}else V+="L".concat(a,",").concat(o,"Z");return V},xBe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},pQ=function(t){var a=lK(lK({},xBe),t),o=a.cx,l=a.cy,d=a.innerRadius,p=a.outerRadius,g=a.cornerRadius,v=a.forceCornerRadius,E=a.cornerIsExternal,T=a.startAngle,b=a.endAngle,R=a.className;if(p<d||T===b)return null;var N=Sn("recharts-sector",R),P=p-d,L=wd(g,P,0,!0),M;return L>0&&Math.abs(T-b)<360?M=PBe({cx:o,cy:l,innerRadius:d,outerRadius:p,cornerRadius:Math.min(L,P/2),forceCornerRadius:v,cornerIsExternal:E,startAngle:T,endAngle:b}):M=fQ({cx:o,cy:l,innerRadius:d,outerRadius:p,startAngle:T,endAngle:b}),ye.createElement("path",rx({},Cn(a,!0),{className:N,d:M,role:"img"}))};function $y(e){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function ix(){return ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},ix.apply(this,arguments)}function uK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function dK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?uK(Object(a),!0).forEach(function(o){DBe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):uK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function DBe(e,t,a){return t=LBe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function LBe(e){var t=kBe(e,"string");return $y(t)=="symbol"?t:t+""}function kBe(e,t){if($y(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if($y(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hK={curveBasisClosed:xOe,curveBasisOpen:DOe,curveBasis:POe,curveBumpX:yOe,curveBumpY:vOe,curveLinearClosed:LOe,curveLinear:ww,curveMonotoneX:kOe,curveMonotoneY:MOe,curveNatural:UOe,curveStep:jOe,curveStepAfter:BOe,curveStepBefore:VOe},zS=function(t){return t.x===+t.x&&t.y===+t.y},Ag=function(t){return t.x},Ig=function(t){return t.y},MBe=function(t,a){if(Zt(t))return t;var o="curve".concat(bw(t));return(o==="curveMonotone"||o==="curveBump")&&a?hK["".concat(o).concat(a==="vertical"?"Y":"X")]:hK[o]||ww},UBe=function(t){var a=t.type,o=a===void 0?"linear":a,l=t.points,d=l===void 0?[]:l,p=t.baseLine,g=t.layout,v=t.connectNulls,E=v===void 0?!1:v,T=MBe(o,g),b=E?d.filter(function(L){return zS(L)}):d,R;if(Array.isArray(p)){var N=E?p.filter(function(L){return zS(L)}):p,P=b.map(function(L,M){return dK(dK({},L),{},{base:N[M]})});return g==="vertical"?R=MS().y(Ig).x1(Ag).x0(function(L){return L.base.x}):R=MS().x(Ag).y1(Ig).y0(function(L){return L.base.y}),R.defined(zS).curve(T),R(P)}return g==="vertical"&&Ze(p)?R=MS().y(Ig).x1(Ag).x0(p):Ze(p)?R=MS().x(Ag).y1(Ig).y0(p):R=pX().x(Ag).y(Ig),R.defined(zS).curve(T),R(b)},fK=function(t){var a=t.className,o=t.points,l=t.path,d=t.pathRef;if((!o||!o.length)&&!l)return null;var p=o&&o.length?UBe(t):l;return ye.createElement("path",ix({},Cn(t,!1),Hb(t),{className:Sn("recharts-curve",a),d:p,ref:d}))},mQ={exports:{}},jBe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",VBe=jBe,BBe=VBe;function gQ(){}function yQ(){}yQ.resetWarningCache=gQ;var FBe=function(){function e(o,l,d,p,g,v){if(v!==BBe){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}e.isRequired=e;function t(){return e}var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:yQ,resetWarningCache:gQ};return a.PropTypes=a,a};mQ.exports=FBe();var WBe=mQ.exports;const Nn=Kn(WBe);var GBe=Object.getOwnPropertyNames,$Be=Object.getOwnPropertySymbols,HBe=Object.prototype.hasOwnProperty;function pK(e,t){return function(o,l,d){return e(o,l,d)&&t(o,l,d)}}function KS(e){return function(a,o,l){if(!a||!o||typeof a!="object"||typeof o!="object")return e(a,o,l);var d=l.cache,p=d.get(a),g=d.get(o);if(p&&g)return p===o&&g===a;d.set(a,o),d.set(o,a);var v=e(a,o,l);return d.delete(a),d.delete(o),v}}function mK(e){return GBe(e).concat($Be(e))}var zBe=Object.hasOwn||function(e,t){return HBe.call(e,t)};function Ld(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var KBe="__v",qBe="__o",YBe="_owner",gK=Object.getOwnPropertyDescriptor,yK=Object.keys;function XBe(e,t,a){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!a.equals(e[o],t[o],o,o,e,t,a))return!1;return!0}function JBe(e,t){return Ld(e.getTime(),t.getTime())}function QBe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function ZBe(e,t){return e===t}function vK(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var l=new Array(o),d=e.entries(),p,g,v=0;(p=d.next())&&!p.done;){for(var E=t.entries(),T=!1,b=0;(g=E.next())&&!g.done;){if(l[b]){b++;continue}var R=p.value,N=g.value;if(a.equals(R[0],N[0],v,b,e,t,a)&&a.equals(R[1],N[1],R[0],N[0],e,t,a)){T=l[b]=!0;break}b++}if(!T)return!1;v++}return!0}var eFe=Ld;function tFe(e,t,a){var o=yK(e),l=o.length;if(yK(t).length!==l)return!1;for(;l-- >0;)if(!vQ(e,t,a,o[l]))return!1;return!0}function Ng(e,t,a){var o=mK(e),l=o.length;if(mK(t).length!==l)return!1;for(var d,p,g;l-- >0;)if(d=o[l],!vQ(e,t,a,d)||(p=gK(e,d),g=gK(t,d),(p||g)&&(!p||!g||p.configurable!==g.configurable||p.enumerable!==g.enumerable||p.writable!==g.writable)))return!1;return!0}function nFe(e,t){return Ld(e.valueOf(),t.valueOf())}function rFe(e,t){return e.source===t.source&&e.flags===t.flags}function _K(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var l=new Array(o),d=e.values(),p,g;(p=d.next())&&!p.done;){for(var v=t.values(),E=!1,T=0;(g=v.next())&&!g.done;){if(!l[T]&&a.equals(p.value,g.value,p.value,g.value,e,t,a)){E=l[T]=!0;break}T++}if(!E)return!1}return!0}function iFe(e,t){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(e[a]!==t[a])return!1;return!0}function aFe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function vQ(e,t,a,o){return(o===YBe||o===qBe||o===KBe)&&(e.$$typeof||t.$$typeof)?!0:zBe(t,o)&&a.equals(e[o],t[o],o,o,e,t,a)}var oFe="[object Arguments]",sFe="[object Boolean]",cFe="[object Date]",lFe="[object Error]",uFe="[object Map]",dFe="[object Number]",hFe="[object Object]",fFe="[object RegExp]",pFe="[object Set]",mFe="[object String]",gFe="[object URL]",yFe=Array.isArray,EK=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,SK=Object.assign,vFe=Object.prototype.toString.call.bind(Object.prototype.toString);function _Fe(e){var t=e.areArraysEqual,a=e.areDatesEqual,o=e.areErrorsEqual,l=e.areFunctionsEqual,d=e.areMapsEqual,p=e.areNumbersEqual,g=e.areObjectsEqual,v=e.arePrimitiveWrappersEqual,E=e.areRegExpsEqual,T=e.areSetsEqual,b=e.areTypedArraysEqual,R=e.areUrlsEqual;return function(P,L,M){if(P===L)return!0;if(P==null||L==null)return!1;var D=typeof P;if(D!==typeof L)return!1;if(D!=="object")return D==="number"?p(P,L,M):D==="function"?l(P,L,M):!1;var U=P.constructor;if(U!==L.constructor)return!1;if(U===Object)return g(P,L,M);if(yFe(P))return t(P,L,M);if(EK!=null&&EK(P))return b(P,L,M);if(U===Date)return a(P,L,M);if(U===RegExp)return E(P,L,M);if(U===Map)return d(P,L,M);if(U===Set)return T(P,L,M);var B=vFe(P);return B===cFe?a(P,L,M):B===fFe?E(P,L,M):B===uFe?d(P,L,M):B===pFe?T(P,L,M):B===hFe?typeof P.then!="function"&&typeof L.then!="function"&&g(P,L,M):B===gFe?R(P,L,M):B===lFe?o(P,L,M):B===oFe?g(P,L,M):B===sFe||B===dFe||B===mFe?v(P,L,M):!1}}function EFe(e){var t=e.circular,a=e.createCustomConfig,o=e.strict,l={areArraysEqual:o?Ng:XBe,areDatesEqual:JBe,areErrorsEqual:QBe,areFunctionsEqual:ZBe,areMapsEqual:o?pK(vK,Ng):vK,areNumbersEqual:eFe,areObjectsEqual:o?Ng:tFe,arePrimitiveWrappersEqual:nFe,areRegExpsEqual:rFe,areSetsEqual:o?pK(_K,Ng):_K,areTypedArraysEqual:o?Ng:iFe,areUrlsEqual:aFe};if(a&&(l=SK({},l,a(l))),t){var d=KS(l.areArraysEqual),p=KS(l.areMapsEqual),g=KS(l.areObjectsEqual),v=KS(l.areSetsEqual);l=SK({},l,{areArraysEqual:d,areMapsEqual:p,areObjectsEqual:g,areSetsEqual:v})}return l}function SFe(e){return function(t,a,o,l,d,p,g){return e(t,a,g)}}function bFe(e){var t=e.circular,a=e.comparator,o=e.createState,l=e.equals,d=e.strict;if(o)return function(v,E){var T=o(),b=T.cache,R=b===void 0?t?new WeakMap:void 0:b,N=T.meta;return a(v,E,{cache:R,equals:l,meta:N,strict:d})};if(t)return function(v,E){return a(v,E,{cache:new WeakMap,equals:l,meta:void 0,strict:d})};var p={cache:void 0,equals:l,meta:void 0,strict:d};return function(v,E){return a(v,E,p)}}var TFe=au();au({strict:!0});au({circular:!0});au({circular:!0,strict:!0});au({createInternalComparator:function(){return Ld}});au({strict:!0,createInternalComparator:function(){return Ld}});au({circular:!0,createInternalComparator:function(){return Ld}});au({circular:!0,createInternalComparator:function(){return Ld},strict:!0});function au(e){e===void 0&&(e={});var t=e.circular,a=t===void 0?!1:t,o=e.createInternalComparator,l=e.createState,d=e.strict,p=d===void 0?!1:d,g=EFe(e),v=_Fe(g),E=o?o(v):SFe(v);return bFe({circular:a,comparator:v,createState:l,equals:E,strict:p})}function wFe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function bK(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=-1,o=function l(d){a<0&&(a=d),d-a>t?(e(d),a=-1):wFe(l)};requestAnimationFrame(o)}function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function CFe(e){return IFe(e)||AFe(e)||OFe(e)||RFe()}function RFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OFe(e,t){if(e){if(typeof e=="string")return TK(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return TK(e,t)}}function TK(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function AFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IFe(e){if(Array.isArray(e))return e}function NFe(){var e={},t=function(){return null},a=!1,o=function l(d){if(!a){if(Array.isArray(d)){if(!d.length)return;var p=d,g=CFe(p),v=g[0],E=g.slice(1);if(typeof v=="number"){bK(l.bind(null,E),v);return}l(v),bK(l.bind(null,E));return}ax(d)==="object"&&(e=d,t(e)),typeof d=="function"&&d()}};return{stop:function(){a=!0},start:function(d){a=!1,o(d)},subscribe:function(d){return t=d,function(){t=function(){return null}}}}}function Hy(e){"@babel/helpers - typeof";return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hy(e)}function wK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function CK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?wK(Object(a),!0).forEach(function(o){_Q(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function _Q(e,t,a){return t=PFe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function PFe(e){var t=xFe(e,"string");return Hy(t)==="symbol"?t:String(t)}function xFe(e,t){if(Hy(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Hy(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DFe=function(t,a){return[Object.keys(t),Object.keys(a)].reduce(function(o,l){return o.filter(function(d){return l.includes(d)})})},LFe=function(t){return t},kFe=function(t){return t.replace(/([A-Z])/g,function(a){return"-".concat(a.toLowerCase())})},ny=function(t,a){return Object.keys(a).reduce(function(o,l){return CK(CK({},o),{},_Q({},l,t(l,a[l])))},{})},RK=function(t,a,o){return t.map(function(l){return"".concat(kFe(l)," ").concat(a,"ms ").concat(o)}).join(",")};function MFe(e,t){return VFe(e)||jFe(e,t)||EQ(e,t)||UFe()}function UFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jFe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function VFe(e){if(Array.isArray(e))return e}function BFe(e){return GFe(e)||WFe(e)||EQ(e)||FFe()}function FFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EQ(e,t){if(e){if(typeof e=="string")return ox(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ox(e,t)}}function WFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GFe(e){if(Array.isArray(e))return ox(e)}function ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var TT=1e-4,SQ=function(t,a){return[0,3*t,3*a-6*t,3*t-3*a+1]},bQ=function(t,a){return t.map(function(o,l){return o*Math.pow(a,l)}).reduce(function(o,l){return o+l})},OK=function(t,a){return function(o){var l=SQ(t,a);return bQ(l,o)}},$Fe=function(t,a){return function(o){var l=SQ(t,a),d=[].concat(BFe(l.map(function(p,g){return p*g}).slice(1)),[0]);return bQ(d,o)}},AK=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var l=a[0],d=a[1],p=a[2],g=a[3];if(a.length===1)switch(a[0]){case"linear":l=0,d=0,p=1,g=1;break;case"ease":l=.25,d=.1,p=.25,g=1;break;case"ease-in":l=.42,d=0,p=1,g=1;break;case"ease-out":l=.42,d=0,p=.58,g=1;break;case"ease-in-out":l=0,d=0,p=.58,g=1;break;default:{var v=a[0].split("(");if(v[0]==="cubic-bezier"&&v[1].split(")")[0].split(",").length===4){var E=v[1].split(")")[0].split(",").map(function(M){return parseFloat(M)}),T=MFe(E,4);l=T[0],d=T[1],p=T[2],g=T[3]}}}var b=OK(l,p),R=OK(d,g),N=$Fe(l,p),P=function(D){return D>1?1:D<0?0:D},L=function(D){for(var U=D>1?1:D,B=U,z=0;z<8;++z){var V=b(B)-U,G=N(B);if(Math.abs(V-U)<TT||G<TT)return R(B);B=P(B-V/G)}return R(B)};return L.isStepper=!1,L},HFe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=t.stiff,o=a===void 0?100:a,l=t.damping,d=l===void 0?8:l,p=t.dt,g=p===void 0?17:p,v=function(T,b,R){var N=-(T-b)*o,P=R*d,L=R+(N-P)*g/1e3,M=R*g/1e3+T;return Math.abs(M-b)<TT&&Math.abs(L)<TT?[b,0]:[M,L]};return v.isStepper=!0,v.dt=g,v},zFe=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var l=a[0];if(typeof l=="string")switch(l){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return AK(l);case"spring":return HFe();default:if(l.split("(")[0]==="cubic-bezier")return AK(l)}return typeof l=="function"?l:null};function zy(e){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(e)}function IK(e){return YFe(e)||qFe(e)||TQ(e)||KFe()}function KFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YFe(e){if(Array.isArray(e))return cx(e)}function NK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Si(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?NK(Object(a),!0).forEach(function(o){sx(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):NK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function sx(e,t,a){return t=XFe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function XFe(e){var t=JFe(e,"string");return zy(t)==="symbol"?t:String(t)}function JFe(e,t){if(zy(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(zy(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QFe(e,t){return t3e(e)||e3e(e,t)||TQ(e,t)||ZFe()}function ZFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TQ(e,t){if(e){if(typeof e=="string")return cx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return cx(e,t)}}function cx(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function e3e(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function t3e(e){if(Array.isArray(e))return e}var wT=function(t,a,o){return t+(a-t)*o},lx=function(t){var a=t.from,o=t.to;return a!==o},n3e=function e(t,a,o){var l=ny(function(d,p){if(lx(p)){var g=t(p.from,p.to,p.velocity),v=QFe(g,2),E=v[0],T=v[1];return Si(Si({},p),{},{from:E,velocity:T})}return p},a);return o<1?ny(function(d,p){return lx(p)?Si(Si({},p),{},{velocity:wT(p.velocity,l[d].velocity,o),from:wT(p.from,l[d].from,o)}):p},a):e(t,l,o-1)};const r3e=function(e,t,a,o,l){var d=DFe(e,t),p=d.reduce(function(M,D){return Si(Si({},M),{},sx({},D,[e[D],t[D]]))},{}),g=d.reduce(function(M,D){return Si(Si({},M),{},sx({},D,{from:e[D],velocity:0,to:t[D]}))},{}),v=-1,E,T,b=function(){return null},R=function(){return ny(function(D,U){return U.from},g)},N=function(){return!Object.values(g).filter(lx).length},P=function(D){E||(E=D);var U=D-E,B=U/a.dt;g=n3e(a,g,B),l(Si(Si(Si({},e),t),R())),E=D,N()||(v=requestAnimationFrame(b))},L=function(D){T||(T=D);var U=(D-T)/o,B=ny(function(V,G){return wT.apply(void 0,IK(G).concat([a(U)]))},p);if(l(Si(Si(Si({},e),t),B)),U<1)v=requestAnimationFrame(b);else{var z=ny(function(V,G){return wT.apply(void 0,IK(G).concat([a(1)]))},p);l(Si(Si(Si({},e),t),z))}};return b=a.isStepper?P:L,function(){return requestAnimationFrame(b),function(){cancelAnimationFrame(v)}}};function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}var i3e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function a3e(e,t){if(e==null)return{};var a=o3e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function o3e(e,t){if(e==null)return{};var a={},o=Object.keys(e),l,d;for(d=0;d<o.length;d++)l=o[d],!(t.indexOf(l)>=0)&&(a[l]=e[l]);return a}function eN(e){return u3e(e)||l3e(e)||c3e(e)||s3e()}function s3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c3e(e,t){if(e){if(typeof e=="string")return ux(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ux(e,t)}}function l3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function u3e(e){if(Array.isArray(e))return ux(e)}function ux(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function PK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function qo(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?PK(Object(a),!0).forEach(function(o){Bg(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):PK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Bg(e,t,a){return t=wQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h3e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,wQ(o.key),o)}}function f3e(e,t,a){return h3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wQ(e){var t=p3e(e,"string");return Zf(t)==="symbol"?t:String(t)}function p3e(e,t){if(Zf(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Zf(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dx(e,t)}function dx(e,t){return dx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},dx(e,t)}function g3e(e){var t=y3e();return function(){var o=CT(e),l;if(t){var d=CT(this).constructor;l=Reflect.construct(o,arguments,d)}else l=o.apply(this,arguments);return hx(this,l)}}function hx(e,t){if(t&&(Zf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fx(e)}function fx(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CT(e){return CT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},CT(e)}var Kl=function(e){m3e(a,e);var t=g3e(a);function a(o,l){var d;d3e(this,a),d=t.call(this,o,l);var p=d.props,g=p.isActive,v=p.attributeName,E=p.from,T=p.to,b=p.steps,R=p.children,N=p.duration;if(d.handleStyleChange=d.handleStyleChange.bind(fx(d)),d.changeStyle=d.changeStyle.bind(fx(d)),!g||N<=0)return d.state={style:{}},typeof R=="function"&&(d.state={style:T}),hx(d);if(b&&b.length)d.state={style:b[0].style};else if(E){if(typeof R=="function")return d.state={style:E},hx(d);d.state={style:v?Bg({},v,E):E}}else d.state={style:{}};return d}return f3e(a,[{key:"componentDidMount",value:function(){var l=this.props,d=l.isActive,p=l.canBegin;this.mounted=!0,!(!d||!p)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(l){var d=this.props,p=d.isActive,g=d.canBegin,v=d.attributeName,E=d.shouldReAnimate,T=d.to,b=d.from,R=this.state.style;if(g){if(!p){var N={style:v?Bg({},v,T):T};this.state&&R&&(v&&R[v]!==T||!v&&R!==T)&&this.setState(N);return}if(!(TFe(l.to,T)&&l.canBegin&&l.isActive)){var P=!l.canBegin||!l.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var L=P||E?b:l.to;if(this.state&&R){var M={style:v?Bg({},v,L):L};(v&&R[v]!==L||!v&&R!==L)&&this.setState(M)}this.runAnimation(qo(qo({},this.props),{},{from:L,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var l=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),l&&l()}},{key:"handleStyleChange",value:function(l){this.changeStyle(l)}},{key:"changeStyle",value:function(l){this.mounted&&this.setState({style:l})}},{key:"runJSAnimation",value:function(l){var d=this,p=l.from,g=l.to,v=l.duration,E=l.easing,T=l.begin,b=l.onAnimationEnd,R=l.onAnimationStart,N=r3e(p,g,zFe(E),v,this.changeStyle),P=function(){d.stopJSAnimation=N()};this.manager.start([R,T,P,v,b])}},{key:"runStepAnimation",value:function(l){var d=this,p=l.steps,g=l.begin,v=l.onAnimationStart,E=p[0],T=E.style,b=E.duration,R=b===void 0?0:b,N=function(L,M,D){if(D===0)return L;var U=M.duration,B=M.easing,z=B===void 0?"ease":B,V=M.style,G=M.properties,q=M.onAnimationEnd,ne=D>0?p[D-1]:M,Z=G||Object.keys(V);if(typeof z=="function"||z==="spring")return[].concat(eN(L),[d.runJSAnimation.bind(d,{from:ne.style,to:V,duration:U,easing:z}),U]);var le=RK(Z,U,z),ee=qo(qo(qo({},ne.style),V),{},{transition:le});return[].concat(eN(L),[ee,U,q]).filter(LFe)};return this.manager.start([v].concat(eN(p.reduce(N,[T,Math.max(R,g)])),[l.onAnimationEnd]))}},{key:"runAnimation",value:function(l){this.manager||(this.manager=NFe());var d=l.begin,p=l.duration,g=l.attributeName,v=l.to,E=l.easing,T=l.onAnimationStart,b=l.onAnimationEnd,R=l.steps,N=l.children,P=this.manager;if(this.unSubscribe=P.subscribe(this.handleStyleChange),typeof E=="function"||typeof N=="function"||E==="spring"){this.runJSAnimation(l);return}if(R.length>1){this.runStepAnimation(l);return}var L=g?Bg({},g,v):v,M=RK(Object.keys(L),p,E);P.start([T,d,qo(qo({},L),{},{transition:M}),p,b])}},{key:"render",value:function(){var l=this.props,d=l.children;l.begin;var p=l.duration;l.attributeName,l.easing;var g=l.isActive;l.steps,l.from,l.to,l.canBegin,l.onAnimationEnd,l.shouldReAnimate,l.onAnimationReStart;var v=a3e(l,i3e),E=x.Children.count(d),T=this.state.style;if(typeof d=="function")return d(T);if(!g||E===0||p<=0)return d;var b=function(N){var P=N.props,L=P.style,M=L===void 0?{}:L,D=P.className,U=x.cloneElement(N,qo(qo({},v),{},{style:qo(qo({},M),T),className:D}));return U};return E===1?b(x.Children.only(d)):ye.createElement("div",null,x.Children.map(d,function(R){return b(R)}))}}]),a}(x.PureComponent);Kl.displayName="Animate";Kl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Kl.propTypes={from:Nn.oneOfType([Nn.object,Nn.string]),to:Nn.oneOfType([Nn.object,Nn.string]),attributeName:Nn.string,duration:Nn.number,begin:Nn.number,easing:Nn.oneOfType([Nn.string,Nn.func]),steps:Nn.arrayOf(Nn.shape({duration:Nn.number.isRequired,style:Nn.object.isRequired,easing:Nn.oneOfType([Nn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Nn.func]),properties:Nn.arrayOf("string"),onAnimationEnd:Nn.func})),children:Nn.oneOfType([Nn.node,Nn.func]),isActive:Nn.bool,canBegin:Nn.bool,onAnimationEnd:Nn.func,shouldReAnimate:Nn.bool,onAnimationStart:Nn.func,onAnimationReStart:Nn.func};function Ky(e){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ky(e)}function RT(){return RT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},RT.apply(this,arguments)}function v3e(e,t){return b3e(e)||S3e(e,t)||E3e(e,t)||_3e()}function _3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E3e(e,t){if(e){if(typeof e=="string")return xK(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xK(e,t)}}function xK(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function S3e(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function b3e(e){if(Array.isArray(e))return e}function DK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function LK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?DK(Object(a),!0).forEach(function(o){T3e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):DK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function T3e(e,t,a){return t=w3e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w3e(e){var t=C3e(e,"string");return Ky(t)=="symbol"?t:t+""}function C3e(e,t){if(Ky(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Ky(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kK=function(t,a,o,l,d){var p=Math.min(Math.abs(o)/2,Math.abs(l)/2),g=l>=0?1:-1,v=o>=0?1:-1,E=l>=0&&o>=0||l<0&&o<0?1:0,T;if(p>0&&d instanceof Array){for(var b=[0,0,0,0],R=0,N=4;R<N;R++)b[R]=d[R]>p?p:d[R];T="M".concat(t,",").concat(a+g*b[0]),b[0]>0&&(T+="A ".concat(b[0],",").concat(b[0],",0,0,").concat(E,",").concat(t+v*b[0],",").concat(a)),T+="L ".concat(t+o-v*b[1],",").concat(a),b[1]>0&&(T+="A ".concat(b[1],",").concat(b[1],",0,0,").concat(E,`,
        `).concat(t+o,",").concat(a+g*b[1])),T+="L ".concat(t+o,",").concat(a+l-g*b[2]),b[2]>0&&(T+="A ".concat(b[2],",").concat(b[2],",0,0,").concat(E,`,
        `).concat(t+o-v*b[2],",").concat(a+l)),T+="L ".concat(t+v*b[3],",").concat(a+l),b[3]>0&&(T+="A ".concat(b[3],",").concat(b[3],",0,0,").concat(E,`,
        `).concat(t,",").concat(a+l-g*b[3])),T+="Z"}else if(p>0&&d===+d&&d>0){var P=Math.min(p,d);T="M ".concat(t,",").concat(a+g*P,`
            A `).concat(P,",").concat(P,",0,0,").concat(E,",").concat(t+v*P,",").concat(a,`
            L `).concat(t+o-v*P,",").concat(a,`
            A `).concat(P,",").concat(P,",0,0,").concat(E,",").concat(t+o,",").concat(a+g*P,`
            L `).concat(t+o,",").concat(a+l-g*P,`
            A `).concat(P,",").concat(P,",0,0,").concat(E,",").concat(t+o-v*P,",").concat(a+l,`
            L `).concat(t+v*P,",").concat(a+l,`
            A `).concat(P,",").concat(P,",0,0,").concat(E,",").concat(t,",").concat(a+l-g*P," Z")}else T="M ".concat(t,",").concat(a," h ").concat(o," v ").concat(l," h ").concat(-o," Z");return T},R3e=function(t,a){if(!t||!a)return!1;var o=t.x,l=t.y,d=a.x,p=a.y,g=a.width,v=a.height;if(Math.abs(g)>0&&Math.abs(v)>0){var E=Math.min(d,d+g),T=Math.max(d,d+g),b=Math.min(p,p+v),R=Math.max(p,p+v);return o>=E&&o<=T&&l>=b&&l<=R}return!1},O3e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jD=function(t){var a=LK(LK({},O3e),t),o=x.useRef(),l=x.useState(-1),d=v3e(l,2),p=d[0],g=d[1];x.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var z=o.current.getTotalLength();z&&g(z)}catch{}},[]);var v=a.x,E=a.y,T=a.width,b=a.height,R=a.radius,N=a.className,P=a.animationEasing,L=a.animationDuration,M=a.animationBegin,D=a.isAnimationActive,U=a.isUpdateAnimationActive;if(v!==+v||E!==+E||T!==+T||b!==+b||T===0||b===0)return null;var B=Sn("recharts-rectangle",N);return U?ye.createElement(Kl,{canBegin:p>0,from:{width:T,height:b,x:v,y:E},to:{width:T,height:b,x:v,y:E},duration:L,animationEasing:P,isActive:U},function(z){var V=z.width,G=z.height,q=z.x,ne=z.y;return ye.createElement(Kl,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:M,duration:L,isActive:D,easing:P},ye.createElement("path",RT({},Cn(a,!0),{className:B,d:kK(q,ne,V,G,R),ref:o})))}):ye.createElement("path",RT({},Cn(a,!0),{className:B,d:kK(v,E,T,b,R)}))};function px(){return px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},px.apply(this,arguments)}var CQ=function(t){var a=t.cx,o=t.cy,l=t.r,d=t.className,p=Sn("recharts-dot",d);return a===+a&&o===+o&&l===+l?ye.createElement("circle",px({},Cn(t,!1),Hb(t),{className:p,cx:a,cy:o,r:l})):null};function qy(e){"@babel/helpers - typeof";return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qy(e)}var A3e=["x","y","top","left","width","height","className"];function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},mx.apply(this,arguments)}function MK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function I3e(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?MK(Object(a),!0).forEach(function(o){N3e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):MK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function N3e(e,t,a){return t=P3e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function P3e(e){var t=x3e(e,"string");return qy(t)=="symbol"?t:t+""}function x3e(e,t){if(qy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(qy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D3e(e,t){if(e==null)return{};var a=L3e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function L3e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var k3e=function(t,a,o,l,d,p){return"M".concat(t,",").concat(d,"v").concat(l,"M").concat(p,",").concat(a,"h").concat(o)},M3e=function(t){var a=t.x,o=a===void 0?0:a,l=t.y,d=l===void 0?0:l,p=t.top,g=p===void 0?0:p,v=t.left,E=v===void 0?0:v,T=t.width,b=T===void 0?0:T,R=t.height,N=R===void 0?0:R,P=t.className,L=D3e(t,A3e),M=I3e({x:o,y:d,top:g,left:E,width:b,height:N},L);return!Ze(o)||!Ze(d)||!Ze(b)||!Ze(N)||!Ze(g)||!Ze(E)?null:ye.createElement("path",mx({},Cn(M,!0),{className:Sn("recharts-cross",P),d:k3e(o,d,b,N,g,E)}))},U3e=jX,j3e=U3e(Object.getPrototypeOf,Object),V3e=j3e,B3e=xc,F3e=V3e,W3e=Dc,G3e="[object Object]",$3e=Function.prototype,H3e=Object.prototype,RQ=$3e.toString,z3e=H3e.hasOwnProperty,K3e=RQ.call(Object);function q3e(e){if(!W3e(e)||B3e(e)!=G3e)return!1;var t=F3e(e);if(t===null)return!0;var a=z3e.call(t,"constructor")&&t.constructor;return typeof a=="function"&&a instanceof a&&RQ.call(a)==K3e}var Y3e=q3e;const X3e=Kn(Y3e);var J3e=xc,Q3e=Dc,Z3e="[object Boolean]";function e4e(e){return e===!0||e===!1||Q3e(e)&&J3e(e)==Z3e}var t4e=e4e;const n4e=Kn(t4e);function Yy(e){"@babel/helpers - typeof";return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yy(e)}function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},OT.apply(this,arguments)}function r4e(e,t){return s4e(e)||o4e(e,t)||a4e(e,t)||i4e()}function i4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a4e(e,t){if(e){if(typeof e=="string")return UK(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return UK(e,t)}}function UK(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function o4e(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function s4e(e){if(Array.isArray(e))return e}function jK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function VK(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?jK(Object(a),!0).forEach(function(o){c4e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function c4e(e,t,a){return t=l4e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l4e(e){var t=u4e(e,"string");return Yy(t)=="symbol"?t:t+""}function u4e(e,t){if(Yy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Yy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BK=function(t,a,o,l,d){var p=o-l,g;return g="M ".concat(t,",").concat(a),g+="L ".concat(t+o,",").concat(a),g+="L ".concat(t+o-p/2,",").concat(a+d),g+="L ".concat(t+o-p/2-l,",").concat(a+d),g+="L ".concat(t,",").concat(a," Z"),g},d4e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},h4e=function(t){var a=VK(VK({},d4e),t),o=x.useRef(),l=x.useState(-1),d=r4e(l,2),p=d[0],g=d[1];x.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var B=o.current.getTotalLength();B&&g(B)}catch{}},[]);var v=a.x,E=a.y,T=a.upperWidth,b=a.lowerWidth,R=a.height,N=a.className,P=a.animationEasing,L=a.animationDuration,M=a.animationBegin,D=a.isUpdateAnimationActive;if(v!==+v||E!==+E||T!==+T||b!==+b||R!==+R||T===0&&b===0||R===0)return null;var U=Sn("recharts-trapezoid",N);return D?ye.createElement(Kl,{canBegin:p>0,from:{upperWidth:0,lowerWidth:0,height:R,x:v,y:E},to:{upperWidth:T,lowerWidth:b,height:R,x:v,y:E},duration:L,animationEasing:P,isActive:D},function(B){var z=B.upperWidth,V=B.lowerWidth,G=B.height,q=B.x,ne=B.y;return ye.createElement(Kl,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:M,duration:L,easing:P},ye.createElement("path",OT({},Cn(a,!0),{className:U,d:BK(q,ne,z,V,G),ref:o})))}):ye.createElement("g",null,ye.createElement("path",OT({},Cn(a,!0),{className:U,d:BK(v,E,T,b,R)})))},f4e=["option","shapeType","propTransformer","activeClassName","isActive"];function Xy(e){"@babel/helpers - typeof";return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xy(e)}function p4e(e,t){if(e==null)return{};var a=m4e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function m4e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function FK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function AT(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?FK(Object(a),!0).forEach(function(o){g4e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):FK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function g4e(e,t,a){return t=y4e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y4e(e){var t=v4e(e,"string");return Xy(t)=="symbol"?t:t+""}function v4e(e,t){if(Xy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Xy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _4e(e,t){return AT(AT({},t),e)}function E4e(e,t){return e==="symbols"}function WK(e){var t=e.shapeType,a=e.elementProps;switch(t){case"rectangle":return ye.createElement(jD,a);case"trapezoid":return ye.createElement(h4e,a);case"sector":return ye.createElement(pQ,a);case"symbols":if(E4e(t))return ye.createElement(nD,a);break;default:return null}}function S4e(e){return x.isValidElement(e)?e.props:e}function b4e(e){var t=e.option,a=e.shapeType,o=e.propTransformer,l=o===void 0?_4e:o,d=e.activeClassName,p=d===void 0?"recharts-active-shape":d,g=e.isActive,v=p4e(e,f4e),E;if(x.isValidElement(t))E=x.cloneElement(t,AT(AT({},v),S4e(t)));else if(Zt(t))E=t(v);else if(X3e(t)&&!n4e(t)){var T=l(t,v);E=ye.createElement(WK,{shapeType:a,elementProps:T})}else{var b=v;E=ye.createElement(WK,{shapeType:a,elementProps:b})}return g?ye.createElement(hi,{className:p},E):E}function Bw(e,t){return t!=null&&"trapezoids"in e.props}function Fw(e,t){return t!=null&&"sectors"in e.props}function Jy(e,t){return t!=null&&"points"in e.props}function T4e(e,t){var a,o,l=e.x===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.x)||e.x===t.x,d=e.y===(t==null||(o=t.labelViewBox)===null||o===void 0?void 0:o.y)||e.y===t.y;return l&&d}function w4e(e,t){var a=e.endAngle===t.endAngle,o=e.startAngle===t.startAngle;return a&&o}function C4e(e,t){var a=e.x===t.x,o=e.y===t.y,l=e.z===t.z;return a&&o&&l}function R4e(e,t){var a;return Bw(e,t)?a=T4e:Fw(e,t)?a=w4e:Jy(e,t)&&(a=C4e),a}function O4e(e,t){var a;return Bw(e,t)?a="trapezoids":Fw(e,t)?a="sectors":Jy(e,t)&&(a="points"),a}function A4e(e,t){if(Bw(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}if(Fw(e,t)){var o;return(o=t.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}return Jy(e,t)?t.payload:{}}function I4e(e){var t=e.activeTooltipItem,a=e.graphicalItem,o=e.itemData,l=O4e(a,t),d=A4e(a,t),p=o.filter(function(v,E){var T=LD(d,v),b=a.props[l].filter(function(P){var L=R4e(a,t);return L(P,t)}),R=a.props[l].indexOf(b[b.length-1]),N=E===R;return T&&N}),g=o.indexOf(p[p.length-1]);return g}var N4e=Math.ceil,P4e=Math.max;function x4e(e,t,a,o){for(var l=-1,d=P4e(N4e((t-e)/(a||1)),0),p=Array(d);d--;)p[o?d:++l]=e,e+=a;return p}var D4e=x4e,L4e=rJ,k4e=1/0,M4e=17976931348623157e292;function U4e(e){if(!e)return e===0?e:0;if(e=L4e(e),e===k4e||e===-1/0){var t=e<0?-1:1;return t*M4e}return e===e?e:0}var OQ=U4e,j4e=D4e,V4e=Aw,tN=OQ;function B4e(e){return function(t,a,o){return o&&typeof o!="number"&&V4e(t,a,o)&&(a=o=void 0),t=tN(t),a===void 0?(a=t,t=0):a=tN(a),o=o===void 0?t<a?1:-1:tN(o),j4e(t,a,o,e)}}var F4e=B4e,W4e=F4e,G4e=W4e(),$4e=G4e;const IT=Kn($4e);function Qy(e){"@babel/helpers - typeof";return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(e)}function GK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function $K(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?GK(Object(a),!0).forEach(function(o){AQ(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):GK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function AQ(e,t,a){return t=H4e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function H4e(e){var t=z4e(e,"string");return Qy(t)=="symbol"?t:t+""}function z4e(e,t){if(Qy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Qy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K4e=["Webkit","Moz","O","ms"],q4e=function(t,a){var o=t.replace(/(\w)/,function(d){return d.toUpperCase()}),l=K4e.reduce(function(d,p){return $K($K({},d),{},AQ({},p+o,a))},{});return l[t]=a,l};function ep(e){"@babel/helpers - typeof";return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(e)}function NT(){return NT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},NT.apply(this,arguments)}function HK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function nN(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?HK(Object(a),!0).forEach(function(o){La(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Y4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zK(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,NQ(o.key),o)}}function X4e(e,t,a){return zK(e.prototype,t),zK(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function J4e(e,t,a){return t=PT(t),Q4e(e,IQ()?Reflect.construct(t,a,PT(e).constructor):t.apply(e,a))}function Q4e(e,t){if(t&&(ep(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z4e(e)}function Z4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IQ=function(){return!!e})()}function PT(e){return PT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},PT(e)}function e5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gx(e,t)}function gx(e,t){return gx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},gx(e,t)}function La(e,t,a){return t=NQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function NQ(e){var t=t5e(e,"string");return ep(t)=="symbol"?t:t+""}function t5e(e,t){if(ep(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(ep(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n5e=function(t){var a=t.data,o=t.startIndex,l=t.endIndex,d=t.x,p=t.width,g=t.travellerWidth;if(!a||!a.length)return{};var v=a.length,E=ey().domain(IT(0,v)).range([d,d+p-g]),T=E.domain().map(function(b){return E(b)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:E(o),endX:E(l),scale:E,scaleValues:T}},KK=function(t){return t.changedTouches&&!!t.changedTouches.length},tp=function(e){function t(a){var o;return Y4e(this,t),o=J4e(this,t,[a]),La(o,"handleDrag",function(l){o.leaveTimer&&(clearTimeout(o.leaveTimer),o.leaveTimer=null),o.state.isTravellerMoving?o.handleTravellerMove(l):o.state.isSlideMoving&&o.handleSlideDrag(l)}),La(o,"handleTouchMove",function(l){l.changedTouches!=null&&l.changedTouches.length>0&&o.handleDrag(l.changedTouches[0])}),La(o,"handleDragEnd",function(){o.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var l=o.props,d=l.endIndex,p=l.onDragEnd,g=l.startIndex;p==null||p({endIndex:d,startIndex:g})}),o.detachDragEndListener()}),La(o,"handleLeaveWrapper",function(){(o.state.isTravellerMoving||o.state.isSlideMoving)&&(o.leaveTimer=window.setTimeout(o.handleDragEnd,o.props.leaveTimeOut))}),La(o,"handleEnterSlideOrTraveller",function(){o.setState({isTextActive:!0})}),La(o,"handleLeaveSlideOrTraveller",function(){o.setState({isTextActive:!1})}),La(o,"handleSlideDragStart",function(l){var d=KK(l)?l.changedTouches[0]:l;o.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:d.pageX}),o.attachDragEndListener()}),o.travellerDragStartHandlers={startX:o.handleTravellerDragStart.bind(o,"startX"),endX:o.handleTravellerDragStart.bind(o,"endX")},o.state={},o}return e5e(t,e),X4e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(o){var l=o.startX,d=o.endX,p=this.state.scaleValues,g=this.props,v=g.gap,E=g.data,T=E.length-1,b=Math.min(l,d),R=Math.max(l,d),N=t.getIndexInRange(p,b),P=t.getIndexInRange(p,R);return{startIndex:N-N%v,endIndex:P===T?T:P-P%v}}},{key:"getTextOfTick",value:function(o){var l=this.props,d=l.data,p=l.tickFormatter,g=l.dataKey,v=Fs(d[o],g,o);return Zt(p)?p(v,o):v}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(o){var l=this.state,d=l.slideMoveStartX,p=l.startX,g=l.endX,v=this.props,E=v.x,T=v.width,b=v.travellerWidth,R=v.startIndex,N=v.endIndex,P=v.onChange,L=o.pageX-d;L>0?L=Math.min(L,E+T-b-g,E+T-b-p):L<0&&(L=Math.max(L,E-p,E-g));var M=this.getIndex({startX:p+L,endX:g+L});(M.startIndex!==R||M.endIndex!==N)&&P&&P(M),this.setState({startX:p+L,endX:g+L,slideMoveStartX:o.pageX})}},{key:"handleTravellerDragStart",value:function(o,l){var d=KK(l)?l.changedTouches[0]:l;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:o,brushMoveStartX:d.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(o){var l=this.state,d=l.brushMoveStartX,p=l.movingTravellerId,g=l.endX,v=l.startX,E=this.state[p],T=this.props,b=T.x,R=T.width,N=T.travellerWidth,P=T.onChange,L=T.gap,M=T.data,D={startX:this.state.startX,endX:this.state.endX},U=o.pageX-d;U>0?U=Math.min(U,b+R-N-E):U<0&&(U=Math.max(U,b-E)),D[p]=E+U;var B=this.getIndex(D),z=B.startIndex,V=B.endIndex,G=function(){var ne=M.length-1;return p==="startX"&&(g>v?z%L===0:V%L===0)||g<v&&V===ne||p==="endX"&&(g>v?V%L===0:z%L===0)||g>v&&V===ne};this.setState(La(La({},p,E+U),"brushMoveStartX",o.pageX),function(){P&&G()&&P(B)})}},{key:"handleTravellerMoveKeyboard",value:function(o,l){var d=this,p=this.state,g=p.scaleValues,v=p.startX,E=p.endX,T=this.state[l],b=g.indexOf(T);if(b!==-1){var R=b+o;if(!(R===-1||R>=g.length)){var N=g[R];l==="startX"&&N>=E||l==="endX"&&N<=v||this.setState(La({},l,N),function(){d.props.onChange(d.getIndex({startX:d.state.startX,endX:d.state.endX}))})}}}},{key:"renderBackground",value:function(){var o=this.props,l=o.x,d=o.y,p=o.width,g=o.height,v=o.fill,E=o.stroke;return ye.createElement("rect",{stroke:E,fill:v,x:l,y:d,width:p,height:g})}},{key:"renderPanorama",value:function(){var o=this.props,l=o.x,d=o.y,p=o.width,g=o.height,v=o.data,E=o.children,T=o.padding,b=x.Children.only(E);return b?ye.cloneElement(b,{x:l,y:d,width:p,height:g,margin:T,compact:!0,data:v}):null}},{key:"renderTravellerLayer",value:function(o,l){var d,p,g=this,v=this.props,E=v.y,T=v.travellerWidth,b=v.height,R=v.traveller,N=v.ariaLabel,P=v.data,L=v.startIndex,M=v.endIndex,D=Math.max(o,this.props.x),U=nN(nN({},Cn(this.props,!1)),{},{x:D,y:E,width:T,height:b}),B=N||"Min value: ".concat((d=P[L])===null||d===void 0?void 0:d.name,", Max value: ").concat((p=P[M])===null||p===void 0?void 0:p.name);return ye.createElement(hi,{tabIndex:0,role:"slider","aria-label":B,"aria-valuenow":o,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[l],onTouchStart:this.travellerDragStartHandlers[l],onKeyDown:function(V){["ArrowLeft","ArrowRight"].includes(V.key)&&(V.preventDefault(),V.stopPropagation(),g.handleTravellerMoveKeyboard(V.key==="ArrowRight"?1:-1,l))},onFocus:function(){g.setState({isTravellerFocused:!0})},onBlur:function(){g.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(R,U))}},{key:"renderSlide",value:function(o,l){var d=this.props,p=d.y,g=d.height,v=d.stroke,E=d.travellerWidth,T=Math.min(o,l)+E,b=Math.max(Math.abs(l-o)-E,0);return ye.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:v,fillOpacity:.2,x:T,y:p,width:b,height:g})}},{key:"renderText",value:function(){var o=this.props,l=o.startIndex,d=o.endIndex,p=o.y,g=o.height,v=o.travellerWidth,E=o.stroke,T=this.state,b=T.startX,R=T.endX,N=5,P={pointerEvents:"none",fill:E};return ye.createElement(hi,{className:"recharts-brush-texts"},ye.createElement(oT,NT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(b,R)-N,y:p+g/2},P),this.getTextOfTick(l)),ye.createElement(oT,NT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(b,R)+v+N,y:p+g/2},P),this.getTextOfTick(d)))}},{key:"render",value:function(){var o=this.props,l=o.data,d=o.className,p=o.children,g=o.x,v=o.y,E=o.width,T=o.height,b=o.alwaysShowText,R=this.state,N=R.startX,P=R.endX,L=R.isTextActive,M=R.isSlideMoving,D=R.isTravellerMoving,U=R.isTravellerFocused;if(!l||!l.length||!Ze(g)||!Ze(v)||!Ze(E)||!Ze(T)||E<=0||T<=0)return null;var B=Sn("recharts-brush",d),z=ye.Children.count(p)===1,V=q4e("userSelect","none");return ye.createElement(hi,{className:B,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:V},this.renderBackground(),z&&this.renderPanorama(),this.renderSlide(N,P),this.renderTravellerLayer(N,"startX"),this.renderTravellerLayer(P,"endX"),(L||M||D||U||b)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(o){var l=o.x,d=o.y,p=o.width,g=o.height,v=o.stroke,E=Math.floor(d+g/2)-1;return ye.createElement(ye.Fragment,null,ye.createElement("rect",{x:l,y:d,width:p,height:g,fill:v,stroke:"none"}),ye.createElement("line",{x1:l+1,y1:E,x2:l+p-1,y2:E,fill:"none",stroke:"#fff"}),ye.createElement("line",{x1:l+1,y1:E+2,x2:l+p-1,y2:E+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(o,l){var d;return ye.isValidElement(o)?d=ye.cloneElement(o,l):Zt(o)?d=o(l):d=t.renderDefaultTraveller(l),d}},{key:"getDerivedStateFromProps",value:function(o,l){var d=o.data,p=o.width,g=o.x,v=o.travellerWidth,E=o.updateId,T=o.startIndex,b=o.endIndex;if(d!==l.prevData||E!==l.prevUpdateId)return nN({prevData:d,prevTravellerWidth:v,prevUpdateId:E,prevX:g,prevWidth:p},d&&d.length?n5e({data:d,width:p,x:g,travellerWidth:v,startIndex:T,endIndex:b}):{scale:null,scaleValues:null});if(l.scale&&(p!==l.prevWidth||g!==l.prevX||v!==l.prevTravellerWidth)){l.scale.range([g,g+p-v]);var R=l.scale.domain().map(function(N){return l.scale(N)});return{prevData:d,prevTravellerWidth:v,prevUpdateId:E,prevX:g,prevWidth:p,startX:l.scale(o.startIndex),endX:l.scale(o.endIndex),scaleValues:R}}return null}},{key:"getIndexInRange",value:function(o,l){for(var d=o.length,p=0,g=d-1;g-p>1;){var v=Math.floor((p+g)/2);o[v]>l?g=v:p=v}return l>=o[g]?g:p}}])}(x.PureComponent);La(tp,"displayName","Brush");La(tp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var r5e=lD;function i5e(e,t){var a;return r5e(e,function(o,l,d){return a=t(o,l,d),!a}),!!a}var a5e=i5e,o5e=NX,s5e=nu,c5e=a5e,l5e=Sa,u5e=Aw;function d5e(e,t,a){var o=l5e(e)?o5e:c5e;return a&&u5e(e,t,a)&&(t=void 0),o(e,s5e(t))}var h5e=d5e;const f5e=Kn(h5e);var Vs=function(t,a){var o=t.alwaysShow,l=t.ifOverflow;return o&&(l="extendDomain"),l===a},qK=QX;function p5e(e,t,a){t=="__proto__"&&qK?qK(e,t,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[t]=a}var m5e=p5e,g5e=m5e,y5e=XX,v5e=nu;function _5e(e,t){var a={};return t=v5e(t),y5e(e,function(o,l,d){g5e(a,l,t(o,l,d))}),a}var E5e=_5e;const S5e=Kn(E5e);function b5e(e,t){for(var a=-1,o=e==null?0:e.length;++a<o;)if(!t(e[a],a,e))return!1;return!0}var T5e=b5e,w5e=lD;function C5e(e,t){var a=!0;return w5e(e,function(o,l,d){return a=!!t(o,l,d),a}),a}var R5e=C5e,O5e=T5e,A5e=R5e,I5e=nu,N5e=Sa,P5e=Aw;function x5e(e,t,a){var o=N5e(e)?O5e:A5e;return a&&P5e(e,t,a)&&(t=void 0),o(e,I5e(t))}var D5e=x5e;const PQ=Kn(D5e);var L5e=["x","y"];function Zy(e){"@babel/helpers - typeof";return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(e)}function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},yx.apply(this,arguments)}function YK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Pg(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?YK(Object(a),!0).forEach(function(o){k5e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):YK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function k5e(e,t,a){return t=M5e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function M5e(e){var t=U5e(e,"string");return Zy(t)=="symbol"?t:t+""}function U5e(e,t){if(Zy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Zy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j5e(e,t){if(e==null)return{};var a=V5e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function V5e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function B5e(e,t){var a=e.x,o=e.y,l=j5e(e,L5e),d="".concat(a),p=parseInt(d,10),g="".concat(o),v=parseInt(g,10),E="".concat(t.height||l.height),T=parseInt(E,10),b="".concat(t.width||l.width),R=parseInt(b,10);return Pg(Pg(Pg(Pg(Pg({},t),l),p?{x:p}:{}),v?{y:v}:{}),{},{height:T,width:R,name:t.name,radius:t.radius})}function XK(e){return ye.createElement(b4e,yx({shapeType:"rectangle",propTransformer:B5e,activeClassName:"recharts-active-bar"},e))}var F5e=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(o,l){if(typeof t=="number")return t;var d=typeof o=="number";return d?t(o,l):(d||Rd(),a)}},W5e=["value","background"],xQ;function np(e){"@babel/helpers - typeof";return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(e)}function G5e(e,t){if(e==null)return{};var a=$5e(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function $5e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function xT(){return xT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},xT.apply(this,arguments)}function JK(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Wr(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?JK(Object(a),!0).forEach(function(o){xl(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):JK(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function H5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QK(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,LQ(o.key),o)}}function z5e(e,t,a){return QK(e.prototype,t),QK(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function K5e(e,t,a){return t=DT(t),q5e(e,DQ()?Reflect.construct(t,a,DT(e).constructor):t.apply(e,a))}function q5e(e,t){if(t&&(np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y5e(e)}function Y5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DQ=function(){return!!e})()}function DT(e){return DT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},DT(e)}function X5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vx(e,t)}function vx(e,t){return vx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},vx(e,t)}function xl(e,t,a){return t=LQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function LQ(e){var t=J5e(e,"string");return np(t)=="symbol"?t:t+""}function J5e(e,t){if(np(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(np(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ql=function(e){function t(){var a;H5e(this,t);for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return a=K5e(this,t,[].concat(l)),xl(a,"state",{isAnimationFinished:!1}),xl(a,"id",Sw("recharts-bar-")),xl(a,"handleAnimationEnd",function(){var p=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),p&&p()}),xl(a,"handleAnimationStart",function(){var p=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),p&&p()}),a}return X5e(t,e),z5e(t,[{key:"renderRectanglesStatically",value:function(o){var l=this,d=this.props,p=d.shape,g=d.dataKey,v=d.activeIndex,E=d.activeBar,T=Cn(this.props,!1);return o&&o.map(function(b,R){var N=R===v,P=N?E:p,L=Wr(Wr(Wr({},T),b),{},{isActive:N,option:P,index:R,dataKey:g,onAnimationStart:l.handleAnimationStart,onAnimationEnd:l.handleAnimationEnd});return ye.createElement(hi,xT({className:"recharts-bar-rectangle"},zb(l.props,b,R),{key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value)}),ye.createElement(XK,L))})}},{key:"renderRectanglesWithAnimation",value:function(){var o=this,l=this.props,d=l.data,p=l.layout,g=l.isAnimationActive,v=l.animationBegin,E=l.animationDuration,T=l.animationEasing,b=l.animationId,R=this.state.prevData;return ye.createElement(Kl,{begin:v,duration:E,isActive:g,easing:T,from:{t:0},to:{t:1},key:"bar-".concat(b),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var P=N.t,L=d.map(function(M,D){var U=R&&R[D];if(U){var B=nf(U.x,M.x),z=nf(U.y,M.y),V=nf(U.width,M.width),G=nf(U.height,M.height);return Wr(Wr({},M),{},{x:B(P),y:z(P),width:V(P),height:G(P)})}if(p==="horizontal"){var q=nf(0,M.height),ne=q(P);return Wr(Wr({},M),{},{y:M.y+M.height-ne,height:ne})}var Z=nf(0,M.width),le=Z(P);return Wr(Wr({},M),{},{width:le})});return ye.createElement(hi,null,o.renderRectanglesStatically(L))})}},{key:"renderRectangles",value:function(){var o=this.props,l=o.data,d=o.isAnimationActive,p=this.state.prevData;return d&&l&&l.length&&(!p||!LD(p,l))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(l)}},{key:"renderBackground",value:function(){var o=this,l=this.props,d=l.data,p=l.dataKey,g=l.activeIndex,v=Cn(this.props.background,!1);return d.map(function(E,T){E.value;var b=E.background,R=G5e(E,W5e);if(!b)return null;var N=Wr(Wr(Wr(Wr(Wr({},R),{},{fill:"#eee"},b),v),zb(o.props,E,T)),{},{onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd,dataKey:p,index:T,className:"recharts-bar-background-rectangle"});return ye.createElement(XK,xT({key:"background-bar-".concat(T),option:o.props.background,isActive:T===g},N))})}},{key:"renderErrorBar",value:function(o,l){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var d=this.props,p=d.data,g=d.xAxis,v=d.yAxis,E=d.layout,T=d.children,b=rs(T,Vw);if(!b)return null;var R=E==="vertical"?p[0].height/2:p[0].width/2,N=function(M,D){var U=Array.isArray(M.value)?M.value[1]:M.value;return{x:M.x,y:M.y,value:U,errorVal:Fs(M,D)}},P={clipPath:o?"url(#clipPath-".concat(l,")"):null};return ye.createElement(hi,P,b.map(function(L){return ye.cloneElement(L,{key:"error-bar-".concat(l,"-").concat(L.props.dataKey),data:p,xAxis:g,yAxis:v,layout:E,offset:R,dataPointFormatter:N})}))}},{key:"render",value:function(){var o=this.props,l=o.hide,d=o.data,p=o.className,g=o.xAxis,v=o.yAxis,E=o.left,T=o.top,b=o.width,R=o.height,N=o.isAnimationActive,P=o.background,L=o.id;if(l||!d||!d.length)return null;var M=this.state.isAnimationFinished,D=Sn("recharts-bar",p),U=g&&g.allowDataOverflow,B=v&&v.allowDataOverflow,z=U||B,V=Pn(L)?this.id:L;return ye.createElement(hi,{className:D},U||B?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(V)},ye.createElement("rect",{x:U?E:E-b/2,y:B?T:T-R/2,width:U?b:b*2,height:B?R:R*2}))):null,ye.createElement(hi,{className:"recharts-bar-rectangles",clipPath:z?"url(#clipPath-".concat(V,")"):null},P?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(z,V),(!N||M)&&vd.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(o,l){return o.animationId!==l.prevAnimationId?{prevAnimationId:o.animationId,curData:o.data,prevData:l.curData}:o.data!==l.curData?{curData:o.data}:null}}])}(x.PureComponent);xQ=ql;xl(ql,"displayName","Bar");xl(ql,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Gl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});xl(ql,"getComposedData",function(e){var t=e.props,a=e.item,o=e.barPosition,l=e.bandSize,d=e.xAxis,p=e.yAxis,g=e.xAxisTicks,v=e.yAxisTicks,E=e.stackedData,T=e.dataStartIndex,b=e.displayedData,R=e.offset,N=RVe(o,a);if(!N)return null;var P=t.layout,L=a.type.defaultProps,M=L!==void 0?Wr(Wr({},L),a.props):a.props,D=M.dataKey,U=M.children,B=M.minPointSize,z=P==="horizontal"?p:d,V=E?z.scale.domain():null,G=LVe({numericAxis:z}),q=rs(U,aJ),ne=b.map(function(Z,le){var ee,ce,be,ae,fe,me;E?ee=OVe(E[T+le],V):(ee=Fs(Z,D),Array.isArray(ee)||(ee=[G,ee]));var _e=F5e(B,xQ.defaultProps.minPointSize)(ee[1],le);if(P==="horizontal"){var ue,ve=[p.scale(ee[0]),p.scale(ee[1])],Ce=ve[0],Ve=ve[1];ce=Jz({axis:d,ticks:g,bandSize:l,offset:N.offset,entry:Z,index:le}),be=(ue=Ve??Ce)!==null&&ue!==void 0?ue:void 0,ae=N.size;var Pe=Ce-Ve;if(fe=Number.isNaN(Pe)?0:Pe,me={x:ce,y:p.y,width:ae,height:p.height},Math.abs(_e)>0&&Math.abs(fe)<Math.abs(_e)){var Ge=es(fe||_e)*(Math.abs(_e)-Math.abs(fe));be-=Ge,fe+=Ge}}else{var nt=[d.scale(ee[0]),d.scale(ee[1])],Re=nt[0],wt=nt[1];if(ce=Re,be=Jz({axis:p,ticks:v,bandSize:l,offset:N.offset,entry:Z,index:le}),ae=wt-Re,fe=N.size,me={x:d.x,y:be,width:d.width,height:fe},Math.abs(_e)>0&&Math.abs(ae)<Math.abs(_e)){var It=es(ae||_e)*(Math.abs(_e)-Math.abs(ae));ae+=It}}return Wr(Wr(Wr({},Z),{},{x:ce,y:be,width:ae,height:fe,value:E?ee:ee[1],payload:Z,background:me},q[le]&&q[le].props),{},{tooltipPayload:[dQ(a,Z)],tooltipPosition:{x:ce+ae/2,y:be+fe/2}})});return Wr({data:ne,layout:P},R)});function ev(e){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}function Q5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZK(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,kQ(o.key),o)}}function Z5e(e,t,a){return ZK(e.prototype,t),ZK(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function eq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Jo(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(a),!0).forEach(function(o){Ww(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Ww(e,t,a){return t=kQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function kQ(e){var t=e6e(e,"string");return ev(t)=="symbol"?t:t+""}function e6e(e,t){if(ev(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(ev(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t6e=function(t,a,o,l,d){var p=t.width,g=t.height,v=t.layout,E=t.children,T=Object.keys(a),b={left:o.left,leftMirror:o.left,right:p-o.right,rightMirror:p-o.right,top:o.top,topMirror:o.top,bottom:g-o.bottom,bottomMirror:g-o.bottom},R=!!Ma(E,ql);return T.reduce(function(N,P){var L=a[P],M=L.orientation,D=L.domain,U=L.padding,B=U===void 0?{}:U,z=L.mirror,V=L.reversed,G="".concat(M).concat(z?"Mirror":""),q,ne,Z,le,ee;if(L.type==="number"&&(L.padding==="gap"||L.padding==="no-gap")){var ce=D[1]-D[0],be=1/0,ae=L.categoricalDomain.sort();if(ae.forEach(function(nt,Re){Re>0&&(be=Math.min((nt||0)-(ae[Re-1]||0),be))}),Number.isFinite(be)){var fe=be/ce,me=L.layout==="vertical"?o.height:o.width;if(L.padding==="gap"&&(q=fe*me/2),L.padding==="no-gap"){var _e=wd(t.barCategoryGap,fe*me),ue=fe*me/2;q=ue-_e-(ue-_e)/me*_e}}}l==="xAxis"?ne=[o.left+(B.left||0)+(q||0),o.left+o.width-(B.right||0)-(q||0)]:l==="yAxis"?ne=v==="horizontal"?[o.top+o.height-(B.bottom||0),o.top+(B.top||0)]:[o.top+(B.top||0)+(q||0),o.top+o.height-(B.bottom||0)-(q||0)]:ne=L.range,V&&(ne=[ne[1],ne[0]]);var ve=wVe(L,d,R),Ce=ve.scale,Ve=ve.realScaleType;Ce.domain(D).range(ne),CVe(Ce);var Pe=DVe(Ce,Jo(Jo({},L),{},{realScaleType:Ve}));l==="xAxis"?(ee=M==="top"&&!z||M==="bottom"&&z,Z=o.left,le=b[G]-ee*L.height):l==="yAxis"&&(ee=M==="left"&&!z||M==="right"&&z,Z=b[G]-ee*L.width,le=o.top);var Ge=Jo(Jo(Jo({},L),Pe),{},{realScaleType:Ve,x:Z,y:le,scale:Ce,width:l==="xAxis"?o.width:L.width,height:l==="yAxis"?o.height:L.height});return Ge.bandSize=ET(Ge,Pe),!L.hide&&l==="xAxis"?b[G]+=(ee?-1:1)*Ge.height:L.hide||(b[G]+=(ee?-1:1)*Ge.width),Jo(Jo({},N),{},Ww({},P,Ge))},{})},MQ=function(t,a){var o=t.x,l=t.y,d=a.x,p=a.y;return{x:Math.min(o,d),y:Math.min(l,p),width:Math.abs(d-o),height:Math.abs(p-l)}},n6e=function(t){var a=t.x1,o=t.y1,l=t.x2,d=t.y2;return MQ({x:a,y:o},{x:l,y:d})},UQ=function(){function e(t){Q5e(this,e),this.scale=t}return Z5e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=o.bandAware,d=o.position;if(a!==void 0){if(d)switch(d){case"start":return this.scale(a);case"middle":{var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+p}case"end":{var g=this.bandwidth?this.bandwidth():0;return this.scale(a)+g}default:return this.scale(a)}if(l){var v=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+v}return this.scale(a)}}},{key:"isInRange",value:function(a){var o=this.range(),l=o[0],d=o[o.length-1];return l<=d?a>=l&&a<=d:a>=d&&a<=l}}],[{key:"create",value:function(a){return new e(a)}}])}();Ww(UQ,"EPS",1e-4);var VD=function(t){var a=Object.keys(t).reduce(function(o,l){return Jo(Jo({},o),{},Ww({},l,UQ.create(t[l])))},{});return Jo(Jo({},a),{},{apply:function(l){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=d.bandAware,g=d.position;return S5e(l,function(v,E){return a[E].apply(v,{bandAware:p,position:g})})},isInRange:function(l){return PQ(l,function(d,p){return a[p].isInRange(d)})}})};function r6e(e){return(e%180+180)%180}var i6e=function(t){var a=t.width,o=t.height,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=r6e(l),p=d*Math.PI/180,g=Math.atan(o/a),v=p>g&&p<Math.PI-g?o/Math.sin(p):a/Math.cos(p);return Math.abs(v)},a6e=nu,o6e=mv,s6e=Rw;function c6e(e){return function(t,a,o){var l=Object(t);if(!o6e(t)){var d=a6e(a);t=s6e(t),a=function(g){return d(l[g],g,l)}}var p=e(t,a,o);return p>-1?l[d?t[p]:p]:void 0}}var l6e=c6e,u6e=OQ;function d6e(e){var t=u6e(e),a=t%1;return t===t?a?t-a:t:0}var h6e=d6e,f6e=$X,p6e=nu,m6e=h6e,g6e=Math.max;function y6e(e,t,a){var o=e==null?0:e.length;if(!o)return-1;var l=a==null?0:m6e(a);return l<0&&(l=g6e(o+l,0)),f6e(e,p6e(t),l)}var v6e=y6e,_6e=l6e,E6e=v6e,S6e=_6e(E6e),b6e=S6e;const T6e=Kn(b6e);var w6e=dRe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),BD=x.createContext(void 0),FD=x.createContext(void 0),jQ=x.createContext(void 0),VQ=x.createContext({}),BQ=x.createContext(void 0),FQ=x.createContext(0),WQ=x.createContext(0),tq=function(t){var a=t.state,o=a.xAxisMap,l=a.yAxisMap,d=a.offset,p=t.clipPathId,g=t.children,v=t.width,E=t.height,T=w6e(d);return ye.createElement(BD.Provider,{value:o},ye.createElement(FD.Provider,{value:l},ye.createElement(VQ.Provider,{value:d},ye.createElement(jQ.Provider,{value:T},ye.createElement(BQ.Provider,{value:p},ye.createElement(FQ.Provider,{value:E},ye.createElement(WQ.Provider,{value:v},g)))))))},C6e=function(){return x.useContext(BQ)},GQ=function(t){var a=x.useContext(BD);a==null&&Rd();var o=a[t];return o==null&&Rd(),o},R6e=function(){var t=x.useContext(BD);return Ol(t)},O6e=function(){var t=x.useContext(FD),a=T6e(t,function(o){return PQ(o.domain,Number.isFinite)});return a||Ol(t)},$Q=function(t){var a=x.useContext(FD);a==null&&Rd();var o=a[t];return o==null&&Rd(),o},A6e=function(){var t=x.useContext(jQ);return t},I6e=function(){return x.useContext(VQ)},WD=function(){return x.useContext(WQ)},GD=function(){return x.useContext(FQ)};function rp(e){"@babel/helpers - typeof";return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(e)}function N6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P6e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,zQ(o.key),o)}}function x6e(e,t,a){return P6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function D6e(e,t,a){return t=LT(t),L6e(e,HQ()?Reflect.construct(t,a||[],LT(e).constructor):t.apply(e,a))}function L6e(e,t){if(t&&(rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k6e(e)}function k6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HQ=function(){return!!e})()}function LT(e){return LT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},LT(e)}function M6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_x(e,t)}function _x(e,t){return _x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},_x(e,t)}function nq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function rq(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?nq(Object(a),!0).forEach(function(o){$D(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function $D(e,t,a){return t=zQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zQ(e){var t=U6e(e,"string");return rp(t)=="symbol"?t:t+""}function U6e(e,t){if(rp(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(rp(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j6e(e,t){return W6e(e)||F6e(e,t)||B6e(e,t)||V6e()}function V6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B6e(e,t){if(e){if(typeof e=="string")return iq(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return iq(e,t)}}function iq(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function F6e(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function W6e(e){if(Array.isArray(e))return e}function Ex(){return Ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Ex.apply(this,arguments)}var G6e=function(t,a){var o;return ye.isValidElement(t)?o=ye.cloneElement(t,a):Zt(t)?o=t(a):o=ye.createElement("line",Ex({},a,{className:"recharts-reference-line-line"})),o},$6e=function(t,a,o,l,d,p,g,v,E){var T=d.x,b=d.y,R=d.width,N=d.height;if(o){var P=E.y,L=t.y.apply(P,{position:p});if(Vs(E,"discard")&&!t.y.isInRange(L))return null;var M=[{x:T+R,y:L},{x:T,y:L}];return v==="left"?M.reverse():M}if(a){var D=E.x,U=t.x.apply(D,{position:p});if(Vs(E,"discard")&&!t.x.isInRange(U))return null;var B=[{x:U,y:b+N},{x:U,y:b}];return g==="top"?B.reverse():B}if(l){var z=E.segment,V=z.map(function(G){return t.apply(G,{position:p})});return Vs(E,"discard")&&f5e(V,function(G){return!t.isInRange(G)})?null:V}return null};function H6e(e){var t=e.x,a=e.y,o=e.segment,l=e.xAxisId,d=e.yAxisId,p=e.shape,g=e.className,v=e.alwaysShow,E=C6e(),T=GQ(l),b=$Q(d),R=A6e();if(!E||!R)return null;bc(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var N=VD({x:T.scale,y:b.scale}),P=Zr(t),L=Zr(a),M=o&&o.length===2,D=$6e(N,P,L,M,R,e.position,T.orientation,b.orientation,e);if(!D)return null;var U=j6e(D,2),B=U[0],z=B.x,V=B.y,G=U[1],q=G.x,ne=G.y,Z=Vs(e,"hidden")?"url(#".concat(E,")"):void 0,le=rq(rq({clipPath:Z},Cn(e,!0)),{},{x1:z,y1:V,x2:q,y2:ne});return ye.createElement(hi,{className:Sn("recharts-reference-line",g)},G6e(p,le),Vi.renderCallByParent(e,n6e({x1:z,y1:V,x2:q,y2:ne})))}var HD=function(e){function t(){return N6e(this,t),D6e(this,t,arguments)}return M6e(t,e),x6e(t,[{key:"render",value:function(){return ye.createElement(H6e,this.props)}}])}(ye.Component);$D(HD,"displayName","ReferenceLine");$D(HD,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Sx(){return Sx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Sx.apply(this,arguments)}function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function aq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function oq(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?aq(Object(a),!0).forEach(function(o){Gw(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):aq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function z6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K6e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,qQ(o.key),o)}}function q6e(e,t,a){return K6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y6e(e,t,a){return t=kT(t),X6e(e,KQ()?Reflect.construct(t,a||[],kT(e).constructor):t.apply(e,a))}function X6e(e,t){if(t&&(ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J6e(e)}function J6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KQ=function(){return!!e})()}function kT(e){return kT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},kT(e)}function Q6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bx(e,t)}function bx(e,t){return bx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},bx(e,t)}function Gw(e,t,a){return t=qQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function qQ(e){var t=Z6e(e,"string");return ip(t)=="symbol"?t:t+""}function Z6e(e,t){if(ip(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(ip(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eWe=function(t){var a=t.x,o=t.y,l=t.xAxis,d=t.yAxis,p=VD({x:l.scale,y:d.scale}),g=p.apply({x:a,y:o},{bandAware:!0});return Vs(t,"discard")&&!p.isInRange(g)?null:g},$w=function(e){function t(){return z6e(this,t),Y6e(this,t,arguments)}return Q6e(t,e),q6e(t,[{key:"render",value:function(){var o=this.props,l=o.x,d=o.y,p=o.r,g=o.alwaysShow,v=o.clipPathId,E=Zr(l),T=Zr(d);if(bc(g===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!E||!T)return null;var b=eWe(this.props);if(!b)return null;var R=b.x,N=b.y,P=this.props,L=P.shape,M=P.className,D=Vs(this.props,"hidden")?"url(#".concat(v,")"):void 0,U=oq(oq({clipPath:D},Cn(this.props,!0)),{},{cx:R,cy:N});return ye.createElement(hi,{className:Sn("recharts-reference-dot",M)},t.renderDot(L,U),Vi.renderCallByParent(this.props,{x:R-p,y:N-p,width:2*p,height:2*p}))}}])}(ye.Component);Gw($w,"displayName","ReferenceDot");Gw($w,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Gw($w,"renderDot",function(e,t){var a;return ye.isValidElement(e)?a=ye.cloneElement(e,t):Zt(e)?a=e(t):a=ye.createElement(CQ,Sx({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),a});function Tx(){return Tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Tx.apply(this,arguments)}function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function sq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function cq(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(a),!0).forEach(function(o){Hw(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function tWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nWe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,XQ(o.key),o)}}function rWe(e,t,a){return nWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iWe(e,t,a){return t=MT(t),aWe(e,YQ()?Reflect.construct(t,a||[],MT(e).constructor):t.apply(e,a))}function aWe(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oWe(e)}function oWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YQ=function(){return!!e})()}function MT(e){return MT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},MT(e)}function sWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wx(e,t)}function wx(e,t){return wx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},wx(e,t)}function Hw(e,t,a){return t=XQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function XQ(e){var t=cWe(e,"string");return ap(t)=="symbol"?t:t+""}function cWe(e,t){if(ap(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(ap(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lWe=function(t,a,o,l,d){var p=d.x1,g=d.x2,v=d.y1,E=d.y2,T=d.xAxis,b=d.yAxis;if(!T||!b)return null;var R=VD({x:T.scale,y:b.scale}),N={x:t?R.x.apply(p,{position:"start"}):R.x.rangeMin,y:o?R.y.apply(v,{position:"start"}):R.y.rangeMin},P={x:a?R.x.apply(g,{position:"end"}):R.x.rangeMax,y:l?R.y.apply(E,{position:"end"}):R.y.rangeMax};return Vs(d,"discard")&&(!R.isInRange(N)||!R.isInRange(P))?null:MQ(N,P)},zw=function(e){function t(){return tWe(this,t),iWe(this,t,arguments)}return sWe(t,e),rWe(t,[{key:"render",value:function(){var o=this.props,l=o.x1,d=o.x2,p=o.y1,g=o.y2,v=o.className,E=o.alwaysShow,T=o.clipPathId;bc(E===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var b=Zr(l),R=Zr(d),N=Zr(p),P=Zr(g),L=this.props.shape;if(!b&&!R&&!N&&!P&&!L)return null;var M=lWe(b,R,N,P,this.props);if(!M&&!L)return null;var D=Vs(this.props,"hidden")?"url(#".concat(T,")"):void 0;return ye.createElement(hi,{className:Sn("recharts-reference-area",v)},t.renderRect(L,cq(cq({clipPath:D},Cn(this.props,!0)),M)),Vi.renderCallByParent(this.props,M))}}])}(ye.Component);Hw(zw,"displayName","ReferenceArea");Hw(zw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Hw(zw,"renderRect",function(e,t){var a;return ye.isValidElement(e)?a=ye.cloneElement(e,t):Zt(e)?a=e(t):a=ye.createElement(jD,Tx({},t,{className:"recharts-reference-area-rect"})),a});function JQ(e,t,a){if(t<1)return[];if(t===1&&a===void 0)return e;for(var o=[],l=0;l<e.length;l+=t)o.push(e[l]);return o}function uWe(e,t,a){var o={width:e.width+t.width,height:e.height+t.height};return i6e(o,a)}function dWe(e,t,a){var o=a==="width",l=e.x,d=e.y,p=e.width,g=e.height;return t===1?{start:o?l:d,end:o?l+p:d+g}:{start:o?l+p:d+g,end:o?l:d}}function UT(e,t,a,o,l){if(e*t<e*o||e*t>e*l)return!1;var d=a();return e*(t-e*d/2-o)>=0&&e*(t+e*d/2-l)<=0}function hWe(e,t){return JQ(e,t+1)}function fWe(e,t,a,o,l){for(var d=(o||[]).slice(),p=t.start,g=t.end,v=0,E=1,T=p,b=function(){var P=o==null?void 0:o[v];if(P===void 0)return{v:JQ(o,E)};var L=v,M,D=function(){return M===void 0&&(M=a(P,L)),M},U=P.coordinate,B=v===0||UT(e,U,D,T,g);B||(v=0,T=p,E+=1),B&&(T=U+e*(D()/2+l),v+=E)},R;E<=d.length;)if(R=b(),R)return R.v;return[]}function tv(e){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(e)}function lq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Ui(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?lq(Object(a),!0).forEach(function(o){pWe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function pWe(e,t,a){return t=mWe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function mWe(e){var t=gWe(e,"string");return tv(t)=="symbol"?t:t+""}function gWe(e,t){if(tv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(tv(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yWe(e,t,a,o,l){for(var d=(o||[]).slice(),p=d.length,g=t.start,v=t.end,E=function(R){var N=d[R],P,L=function(){return P===void 0&&(P=a(N,R)),P};if(R===p-1){var M=e*(N.coordinate+e*L()/2-v);d[R]=N=Ui(Ui({},N),{},{tickCoord:M>0?N.coordinate-M*e:N.coordinate})}else d[R]=N=Ui(Ui({},N),{},{tickCoord:N.coordinate});var D=UT(e,N.tickCoord,L,g,v);D&&(v=N.tickCoord-e*(L()/2+l),d[R]=Ui(Ui({},N),{},{isShow:!0}))},T=p-1;T>=0;T--)E(T);return d}function vWe(e,t,a,o,l,d){var p=(o||[]).slice(),g=p.length,v=t.start,E=t.end;if(d){var T=o[g-1],b=a(T,g-1),R=e*(T.coordinate+e*b/2-E);p[g-1]=T=Ui(Ui({},T),{},{tickCoord:R>0?T.coordinate-R*e:T.coordinate});var N=UT(e,T.tickCoord,function(){return b},v,E);N&&(E=T.tickCoord-e*(b/2+l),p[g-1]=Ui(Ui({},T),{},{isShow:!0}))}for(var P=d?g-1:g,L=function(U){var B=p[U],z,V=function(){return z===void 0&&(z=a(B,U)),z};if(U===0){var G=e*(B.coordinate-e*V()/2-v);p[U]=B=Ui(Ui({},B),{},{tickCoord:G<0?B.coordinate-G*e:B.coordinate})}else p[U]=B=Ui(Ui({},B),{},{tickCoord:B.coordinate});var q=UT(e,B.tickCoord,V,v,E);q&&(v=B.tickCoord+e*(V()/2+l),p[U]=Ui(Ui({},B),{},{isShow:!0}))},M=0;M<P;M++)L(M);return p}function zD(e,t,a){var o=e.tick,l=e.ticks,d=e.viewBox,p=e.minTickGap,g=e.orientation,v=e.interval,E=e.tickFormatter,T=e.unit,b=e.angle;if(!l||!l.length||!o)return[];if(Ze(v)||Gl.isSsr)return hWe(l,typeof v=="number"&&Ze(v)?v:0);var R=[],N=g==="top"||g==="bottom"?"width":"height",P=T&&N==="width"?Zg(T,{fontSize:t,letterSpacing:a}):{width:0,height:0},L=function(B,z){var V=Zt(E)?E(B.value,z):B.value;return N==="width"?uWe(Zg(V,{fontSize:t,letterSpacing:a}),P,b):Zg(V,{fontSize:t,letterSpacing:a})[N]},M=l.length>=2?es(l[1].coordinate-l[0].coordinate):1,D=dWe(d,M,N);return v==="equidistantPreserveStart"?fWe(M,D,L,l,p):(v==="preserveStart"||v==="preserveStartEnd"?R=vWe(M,D,L,l,p,v==="preserveStartEnd"):R=yWe(M,D,L,l,p),R.filter(function(U){return U.isShow}))}var _We=["viewBox"],EWe=["viewBox"],SWe=["ticks"];function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function Tf(){return Tf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Tf.apply(this,arguments)}function uq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function qi(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?uq(Object(a),!0).forEach(function(o){KD(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):uq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function rN(e,t){if(e==null)return{};var a=bWe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function bWe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function TWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dq(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ZQ(o.key),o)}}function wWe(e,t,a){return dq(e.prototype,t),dq(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function CWe(e,t,a){return t=jT(t),RWe(e,QQ()?Reflect.construct(t,a,jT(e).constructor):t.apply(e,a))}function RWe(e,t){if(t&&(op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OWe(e)}function OWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QQ=function(){return!!e})()}function jT(e){return jT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},jT(e)}function AWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cx(e,t)}function Cx(e,t){return Cx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},Cx(e,t)}function KD(e,t,a){return t=ZQ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ZQ(e){var t=IWe(e,"string");return op(t)=="symbol"?t:t+""}function IWe(e,t){if(op(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(op(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dp=function(e){function t(a){var o;return TWe(this,t),o=CWe(this,t,[a]),o.state={fontSize:"",letterSpacing:""},o}return AWe(t,e),wWe(t,[{key:"shouldComponentUpdate",value:function(o,l){var d=o.viewBox,p=rN(o,_We),g=this.props,v=g.viewBox,E=rN(g,EWe);return!Lf(d,v)||!Lf(p,E)||!Lf(l,this.state)}},{key:"componentDidMount",value:function(){var o=this.layerReference;if(o){var l=o.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];l&&this.setState({fontSize:window.getComputedStyle(l).fontSize,letterSpacing:window.getComputedStyle(l).letterSpacing})}}},{key:"getTickLineCoord",value:function(o){var l=this.props,d=l.x,p=l.y,g=l.width,v=l.height,E=l.orientation,T=l.tickSize,b=l.mirror,R=l.tickMargin,N,P,L,M,D,U,B=b?-1:1,z=o.tickSize||T,V=Ze(o.tickCoord)?o.tickCoord:o.coordinate;switch(E){case"top":N=P=o.coordinate,M=p+ +!b*v,L=M-B*z,U=L-B*R,D=V;break;case"left":L=M=o.coordinate,P=d+ +!b*g,N=P-B*z,D=N-B*R,U=V;break;case"right":L=M=o.coordinate,P=d+ +b*g,N=P+B*z,D=N+B*R,U=V;break;default:N=P=o.coordinate,M=p+ +b*v,L=M+B*z,U=L+B*R,D=V;break}return{line:{x1:N,y1:L,x2:P,y2:M},tick:{x:D,y:U}}}},{key:"getTickTextAnchor",value:function(){var o=this.props,l=o.orientation,d=o.mirror,p;switch(l){case"left":p=d?"start":"end";break;case"right":p=d?"end":"start";break;default:p="middle";break}return p}},{key:"getTickVerticalAnchor",value:function(){var o=this.props,l=o.orientation,d=o.mirror,p="end";switch(l){case"left":case"right":p="middle";break;case"top":p=d?"start":"end";break;default:p=d?"end":"start";break}return p}},{key:"renderAxisLine",value:function(){var o=this.props,l=o.x,d=o.y,p=o.width,g=o.height,v=o.orientation,E=o.mirror,T=o.axisLine,b=qi(qi(qi({},Cn(this.props,!1)),Cn(T,!1)),{},{fill:"none"});if(v==="top"||v==="bottom"){var R=+(v==="top"&&!E||v==="bottom"&&E);b=qi(qi({},b),{},{x1:l,y1:d+R*g,x2:l+p,y2:d+R*g})}else{var N=+(v==="left"&&!E||v==="right"&&E);b=qi(qi({},b),{},{x1:l+N*p,y1:d,x2:l+N*p,y2:d+g})}return ye.createElement("line",Tf({},b,{className:Sn("recharts-cartesian-axis-line",Eo(T,"className"))}))}},{key:"renderTicks",value:function(o,l,d){var p=this,g=this.props,v=g.tickLine,E=g.stroke,T=g.tick,b=g.tickFormatter,R=g.unit,N=zD(qi(qi({},this.props),{},{ticks:o}),l,d),P=this.getTickTextAnchor(),L=this.getTickVerticalAnchor(),M=Cn(this.props,!1),D=Cn(T,!1),U=qi(qi({},M),{},{fill:"none"},Cn(v,!1)),B=N.map(function(z,V){var G=p.getTickLineCoord(z),q=G.line,ne=G.tick,Z=qi(qi(qi(qi({textAnchor:P,verticalAnchor:L},M),{},{stroke:"none",fill:E},D),ne),{},{index:V,payload:z,visibleTicksCount:N.length,tickFormatter:b});return ye.createElement(hi,Tf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},zb(p.props,z,V)),v&&ye.createElement("line",Tf({},U,q,{className:Sn("recharts-cartesian-axis-tick-line",Eo(v,"className"))})),T&&t.renderTickItem(T,Z,"".concat(Zt(b)?b(z.value,V):z.value).concat(R||"")))});return ye.createElement("g",{className:"recharts-cartesian-axis-ticks"},B)}},{key:"render",value:function(){var o=this,l=this.props,d=l.axisLine,p=l.width,g=l.height,v=l.ticksGenerator,E=l.className,T=l.hide;if(T)return null;var b=this.props,R=b.ticks,N=rN(b,SWe),P=R;return Zt(v)&&(P=R&&R.length>0?v(this.props):v(N)),p<=0||g<=0||!P||!P.length?null:ye.createElement(hi,{className:Sn("recharts-cartesian-axis",E),ref:function(M){o.layerReference=M}},d&&this.renderAxisLine(),this.renderTicks(P,this.state.fontSize,this.state.letterSpacing),Vi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(o,l,d){var p;return ye.isValidElement(o)?p=ye.cloneElement(o,l):Zt(o)?p=o(l):p=ye.createElement(oT,Tf({},l,{className:"recharts-cartesian-axis-tick-value"}),d),p}}])}(x.Component);KD(Dp,"displayName","CartesianAxis");KD(Dp,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var NWe=["x1","y1","x2","y2","key"],PWe=["offset"];function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function hq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Bi(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?hq(Object(a),!0).forEach(function(o){xWe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function xWe(e,t,a){return t=DWe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function DWe(e){var t=LWe(e,"string");return Od(t)=="symbol"?t:t+""}function LWe(e,t){if(Od(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(Od(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hd(){return hd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},hd.apply(this,arguments)}function fq(e,t){if(e==null)return{};var a=kWe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function kWe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var MWe=function(t){var a=t.fill;if(!a||a==="none")return null;var o=t.fillOpacity,l=t.x,d=t.y,p=t.width,g=t.height,v=t.ry;return ye.createElement("rect",{x:l,y:d,ry:v,width:p,height:g,stroke:"none",fill:a,fillOpacity:o,className:"recharts-cartesian-grid-bg"})};function eZ(e,t){var a;if(ye.isValidElement(e))a=ye.cloneElement(e,t);else if(Zt(e))a=e(t);else{var o=t.x1,l=t.y1,d=t.x2,p=t.y2,g=t.key,v=fq(t,NWe),E=Cn(v,!1);E.offset;var T=fq(E,PWe);a=ye.createElement("line",hd({},T,{x1:o,y1:l,x2:d,y2:p,fill:"none",key:g}))}return a}function UWe(e){var t=e.x,a=e.width,o=e.horizontal,l=o===void 0?!0:o,d=e.horizontalPoints;if(!l||!d||!d.length)return null;var p=d.map(function(g,v){var E=Bi(Bi({},e),{},{x1:t,y1:g,x2:t+a,y2:g,key:"line-".concat(v),index:v});return eZ(l,E)});return ye.createElement("g",{className:"recharts-cartesian-grid-horizontal"},p)}function jWe(e){var t=e.y,a=e.height,o=e.vertical,l=o===void 0?!0:o,d=e.verticalPoints;if(!l||!d||!d.length)return null;var p=d.map(function(g,v){var E=Bi(Bi({},e),{},{x1:g,y1:t,x2:g,y2:t+a,key:"line-".concat(v),index:v});return eZ(l,E)});return ye.createElement("g",{className:"recharts-cartesian-grid-vertical"},p)}function VWe(e){var t=e.horizontalFill,a=e.fillOpacity,o=e.x,l=e.y,d=e.width,p=e.height,g=e.horizontalPoints,v=e.horizontal,E=v===void 0?!0:v;if(!E||!t||!t.length)return null;var T=g.map(function(R){return Math.round(R+l-l)}).sort(function(R,N){return R-N});l!==T[0]&&T.unshift(0);var b=T.map(function(R,N){var P=!T[N+1],L=P?l+p-R:T[N+1]-R;if(L<=0)return null;var M=N%t.length;return ye.createElement("rect",{key:"react-".concat(N),y:R,x:o,height:L,width:d,stroke:"none",fill:t[M],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},b)}function BWe(e){var t=e.vertical,a=t===void 0?!0:t,o=e.verticalFill,l=e.fillOpacity,d=e.x,p=e.y,g=e.width,v=e.height,E=e.verticalPoints;if(!a||!o||!o.length)return null;var T=E.map(function(R){return Math.round(R+d-d)}).sort(function(R,N){return R-N});d!==T[0]&&T.unshift(0);var b=T.map(function(R,N){var P=!T[N+1],L=P?d+g-R:T[N+1]-R;if(L<=0)return null;var M=N%o.length;return ye.createElement("rect",{key:"react-".concat(N),x:R,y:p,width:L,height:v,stroke:"none",fill:o[M],fillOpacity:l,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},b)}var FWe=function(t,a){var o=t.xAxis,l=t.width,d=t.height,p=t.offset;return lQ(zD(Bi(Bi(Bi({},Dp.defaultProps),o),{},{ticks:_c(o,!0),viewBox:{x:0,y:0,width:l,height:d}})),p.left,p.left+p.width,a)},WWe=function(t,a){var o=t.yAxis,l=t.width,d=t.height,p=t.offset;return lQ(zD(Bi(Bi(Bi({},Dp.defaultProps),o),{},{ticks:_c(o,!0),viewBox:{x:0,y:0,width:l,height:d}})),p.top,p.top+p.height,a)},of={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function tZ(e){var t,a,o,l,d,p,g=WD(),v=GD(),E=I6e(),T=Bi(Bi({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:of.stroke,fill:(a=e.fill)!==null&&a!==void 0?a:of.fill,horizontal:(o=e.horizontal)!==null&&o!==void 0?o:of.horizontal,horizontalFill:(l=e.horizontalFill)!==null&&l!==void 0?l:of.horizontalFill,vertical:(d=e.vertical)!==null&&d!==void 0?d:of.vertical,verticalFill:(p=e.verticalFill)!==null&&p!==void 0?p:of.verticalFill,x:Ze(e.x)?e.x:E.left,y:Ze(e.y)?e.y:E.top,width:Ze(e.width)?e.width:E.width,height:Ze(e.height)?e.height:E.height}),b=T.x,R=T.y,N=T.width,P=T.height,L=T.syncWithTicks,M=T.horizontalValues,D=T.verticalValues,U=R6e(),B=O6e();if(!Ze(N)||N<=0||!Ze(P)||P<=0||!Ze(b)||b!==+b||!Ze(R)||R!==+R)return null;var z=T.verticalCoordinatesGenerator||FWe,V=T.horizontalCoordinatesGenerator||WWe,G=T.horizontalPoints,q=T.verticalPoints;if((!G||!G.length)&&Zt(V)){var ne=M&&M.length,Z=V({yAxis:B?Bi(Bi({},B),{},{ticks:ne?M:B.ticks}):void 0,width:g,height:v,offset:E},ne?!0:L);bc(Array.isArray(Z),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Od(Z),"]")),Array.isArray(Z)&&(G=Z)}if((!q||!q.length)&&Zt(z)){var le=D&&D.length,ee=z({xAxis:U?Bi(Bi({},U),{},{ticks:le?D:U.ticks}):void 0,width:g,height:v,offset:E},le?!0:L);bc(Array.isArray(ee),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Od(ee),"]")),Array.isArray(ee)&&(q=ee)}return ye.createElement("g",{className:"recharts-cartesian-grid"},ye.createElement(MWe,{fill:T.fill,fillOpacity:T.fillOpacity,x:T.x,y:T.y,width:T.width,height:T.height,ry:T.ry}),ye.createElement(UWe,hd({},T,{offset:E,horizontalPoints:G,xAxis:U,yAxis:B})),ye.createElement(jWe,hd({},T,{offset:E,verticalPoints:q,xAxis:U,yAxis:B})),ye.createElement(VWe,hd({},T,{horizontalPoints:G})),ye.createElement(BWe,hd({},T,{verticalPoints:q})))}tZ.displayName="CartesianGrid";function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function GWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $We(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,iZ(o.key),o)}}function HWe(e,t,a){return $We(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zWe(e,t,a){return t=VT(t),KWe(e,nZ()?Reflect.construct(t,a||[],VT(e).constructor):t.apply(e,a))}function KWe(e,t){if(t&&(sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qWe(e)}function qWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nZ=function(){return!!e})()}function VT(e){return VT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},VT(e)}function YWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rx(e,t)}function Rx(e,t){return Rx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},Rx(e,t)}function rZ(e,t,a){return t=iZ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function iZ(e){var t=XWe(e,"string");return sp(t)=="symbol"?t:t+""}function XWe(e,t){if(sp(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(sp(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Ox.apply(this,arguments)}function JWe(e){var t=e.xAxisId,a=WD(),o=GD(),l=GQ(t);return l==null?null:ye.createElement(Dp,Ox({},l,{className:Sn("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:a,height:o},ticksGenerator:function(p){return _c(p,!0)}}))}var Kw=function(e){function t(){return GWe(this,t),zWe(this,t,arguments)}return YWe(t,e),HWe(t,[{key:"render",value:function(){return ye.createElement(JWe,this.props)}}])}(ye.Component);rZ(Kw,"displayName","XAxis");rZ(Kw,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function cp(e){"@babel/helpers - typeof";return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function QWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZWe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,sZ(o.key),o)}}function eGe(e,t,a){return ZWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tGe(e,t,a){return t=BT(t),nGe(e,aZ()?Reflect.construct(t,a||[],BT(e).constructor):t.apply(e,a))}function nGe(e,t){if(t&&(cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rGe(e)}function rGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aZ=function(){return!!e})()}function BT(e){return BT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},BT(e)}function iGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ax(e,t)}function Ax(e,t){return Ax=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},Ax(e,t)}function oZ(e,t,a){return t=sZ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sZ(e){var t=aGe(e,"string");return cp(t)=="symbol"?t:t+""}function aGe(e,t){if(cp(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(cp(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ix(){return Ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Ix.apply(this,arguments)}var oGe=function(t){var a=t.yAxisId,o=WD(),l=GD(),d=$Q(a);return d==null?null:ye.createElement(Dp,Ix({},d,{className:Sn("recharts-".concat(d.axisType," ").concat(d.axisType),d.className),viewBox:{x:0,y:0,width:o,height:l},ticksGenerator:function(g){return _c(g,!0)}}))},nv=function(e){function t(){return QWe(this,t),tGe(this,t,arguments)}return iGe(t,e),eGe(t,[{key:"render",value:function(){return ye.createElement(oGe,this.props)}}])}(ye.Component);oZ(nv,"displayName","YAxis");oZ(nv,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function pq(e){return uGe(e)||lGe(e)||cGe(e)||sGe()}function sGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cGe(e,t){if(e){if(typeof e=="string")return Nx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Nx(e,t)}}function lGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uGe(e){if(Array.isArray(e))return Nx(e)}function Nx(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var Px=function(t,a,o,l,d){var p=rs(t,HD),g=rs(t,$w),v=[].concat(pq(p),pq(g)),E=rs(t,zw),T="".concat(l,"Id"),b=l[0],R=a;if(v.length&&(R=v.reduce(function(L,M){if(M.props[T]===o&&Vs(M.props,"extendDomain")&&Ze(M.props[b])){var D=M.props[b];return[Math.min(L[0],D),Math.max(L[1],D)]}return L},R)),E.length){var N="".concat(b,"1"),P="".concat(b,"2");R=E.reduce(function(L,M){if(M.props[T]===o&&Vs(M.props,"extendDomain")&&Ze(M.props[N])&&Ze(M.props[P])){var D=M.props[N],U=M.props[P];return[Math.min(L[0],D,U),Math.max(L[1],D,U)]}return L},R)}return d&&d.length&&(R=d.reduce(function(L,M){return Ze(M)?[Math.min(L[0],M),Math.max(L[1],M)]:L},R)),R},cZ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(v,E,T){this.fn=v,this.context=E,this.once=T||!1}function d(v,E,T,b,R){if(typeof T!="function")throw new TypeError("The listener must be a function");var N=new l(T,b||v,R),P=a?a+E:E;return v._events[P]?v._events[P].fn?v._events[P]=[v._events[P],N]:v._events[P].push(N):(v._events[P]=N,v._eventsCount++),v}function p(v,E){--v._eventsCount===0?v._events=new o:delete v._events[E]}function g(){this._events=new o,this._eventsCount=0}g.prototype.eventNames=function(){var E=[],T,b;if(this._eventsCount===0)return E;for(b in T=this._events)t.call(T,b)&&E.push(a?b.slice(1):b);return Object.getOwnPropertySymbols?E.concat(Object.getOwnPropertySymbols(T)):E},g.prototype.listeners=function(E){var T=a?a+E:E,b=this._events[T];if(!b)return[];if(b.fn)return[b.fn];for(var R=0,N=b.length,P=new Array(N);R<N;R++)P[R]=b[R].fn;return P},g.prototype.listenerCount=function(E){var T=a?a+E:E,b=this._events[T];return b?b.fn?1:b.length:0},g.prototype.emit=function(E,T,b,R,N,P){var L=a?a+E:E;if(!this._events[L])return!1;var M=this._events[L],D=arguments.length,U,B;if(M.fn){switch(M.once&&this.removeListener(E,M.fn,void 0,!0),D){case 1:return M.fn.call(M.context),!0;case 2:return M.fn.call(M.context,T),!0;case 3:return M.fn.call(M.context,T,b),!0;case 4:return M.fn.call(M.context,T,b,R),!0;case 5:return M.fn.call(M.context,T,b,R,N),!0;case 6:return M.fn.call(M.context,T,b,R,N,P),!0}for(B=1,U=new Array(D-1);B<D;B++)U[B-1]=arguments[B];M.fn.apply(M.context,U)}else{var z=M.length,V;for(B=0;B<z;B++)switch(M[B].once&&this.removeListener(E,M[B].fn,void 0,!0),D){case 1:M[B].fn.call(M[B].context);break;case 2:M[B].fn.call(M[B].context,T);break;case 3:M[B].fn.call(M[B].context,T,b);break;case 4:M[B].fn.call(M[B].context,T,b,R);break;default:if(!U)for(V=1,U=new Array(D-1);V<D;V++)U[V-1]=arguments[V];M[B].fn.apply(M[B].context,U)}}return!0},g.prototype.on=function(E,T,b){return d(this,E,T,b,!1)},g.prototype.once=function(E,T,b){return d(this,E,T,b,!0)},g.prototype.removeListener=function(E,T,b,R){var N=a?a+E:E;if(!this._events[N])return this;if(!T)return p(this,N),this;var P=this._events[N];if(P.fn)P.fn===T&&(!R||P.once)&&(!b||P.context===b)&&p(this,N);else{for(var L=0,M=[],D=P.length;L<D;L++)(P[L].fn!==T||R&&!P[L].once||b&&P[L].context!==b)&&M.push(P[L]);M.length?this._events[N]=M.length===1?M[0]:M:p(this,N)}return this},g.prototype.removeAllListeners=function(E){var T;return E?(T=a?a+E:E,this._events[T]&&p(this,T)):(this._events=new o,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=a,g.EventEmitter=g,e.exports=g})(cZ);var dGe=cZ.exports;const hGe=Kn(dGe);var iN=new hGe,aN="recharts.syncMouseEvents";function rv(e){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rv(e)}function fGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pGe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,lZ(o.key),o)}}function mGe(e,t,a){return pGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oN(e,t,a){return t=lZ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function lZ(e){var t=gGe(e,"string");return rv(t)=="symbol"?t:t+""}function gGe(e,t){if(rv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(rv(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yGe=function(){function e(){fGe(this,e),oN(this,"activeIndex",0),oN(this,"coordinateList",[]),oN(this,"layout","horizontal")}return mGe(e,[{key:"setDetails",value:function(a){var o,l=a.coordinateList,d=l===void 0?null:l,p=a.container,g=p===void 0?null:p,v=a.layout,E=v===void 0?null:v,T=a.offset,b=T===void 0?null:T,R=a.mouseHandlerCallback,N=R===void 0?null:R;this.coordinateList=(o=d??this.coordinateList)!==null&&o!==void 0?o:[],this.container=g??this.container,this.layout=E??this.layout,this.offset=b??this.offset,this.mouseHandlerCallback=N??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(a){if(this.coordinateList.length!==0)switch(a.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(a){this.activeIndex=a}},{key:"spoofMouse",value:function(){var a,o;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var l=this.container.getBoundingClientRect(),d=l.x,p=l.y,g=l.height,v=this.coordinateList[this.activeIndex].coordinate,E=((a=window)===null||a===void 0?void 0:a.scrollX)||0,T=((o=window)===null||o===void 0?void 0:o.scrollY)||0,b=d+v+E,R=p+this.offset.top+g/2+T;this.mouseHandlerCallback({pageX:b,pageY:R})}}}])}();function vGe(e,t,a){if(a==="number"&&t===!0&&Array.isArray(e)){var o=e==null?void 0:e[0],l=e==null?void 0:e[1];if(o&&l&&Ze(o)&&Ze(l))return!0}return!1}function _Ge(e,t,a,o){var l=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-l:a.left+.5,y:e==="horizontal"?a.top+.5:t.y-l,width:e==="horizontal"?o:a.width-1,height:e==="horizontal"?a.height-1:o}}function uZ(e){var t=e.cx,a=e.cy,o=e.radius,l=e.startAngle,d=e.endAngle,p=Ti(t,a,o,l),g=Ti(t,a,o,d);return{points:[p,g],cx:t,cy:a,radius:o,startAngle:l,endAngle:d}}function EGe(e,t,a){var o,l,d,p;if(e==="horizontal")o=t.x,d=o,l=a.top,p=a.top+a.height;else if(e==="vertical")l=t.y,p=l,o=a.left,d=a.left+a.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var g=t.cx,v=t.cy,E=t.innerRadius,T=t.outerRadius,b=t.angle,R=Ti(g,v,E,b),N=Ti(g,v,T,b);o=R.x,l=R.y,d=N.x,p=N.y}else return uZ(t);return[{x:o,y:l},{x:d,y:p}]}function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function mq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function qS(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?mq(Object(a),!0).forEach(function(o){SGe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function SGe(e,t,a){return t=bGe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function bGe(e){var t=TGe(e,"string");return iv(t)=="symbol"?t:t+""}function TGe(e,t){if(iv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(iv(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wGe(e){var t,a,o=e.element,l=e.tooltipEventType,d=e.isActive,p=e.activeCoordinate,g=e.activePayload,v=e.offset,E=e.activeTooltipIndex,T=e.tooltipAxisBandSize,b=e.layout,R=e.chartName,N=(t=o.props.cursor)!==null&&t!==void 0?t:(a=o.type.defaultProps)===null||a===void 0?void 0:a.cursor;if(!o||!N||!d||!p||R!=="ScatterChart"&&l!=="axis")return null;var P,L=fK;if(R==="ScatterChart")P=p,L=M3e;else if(R==="BarChart")P=_Ge(b,p,v,T),L=jD;else if(b==="radial"){var M=uZ(p),D=M.cx,U=M.cy,B=M.radius,z=M.startAngle,V=M.endAngle;P={cx:D,cy:U,startAngle:z,endAngle:V,innerRadius:B,outerRadius:B},L=pQ}else P={points:EGe(b,p,v)},L=fK;var G=qS(qS(qS(qS({stroke:"#ccc",pointerEvents:"none"},v),P),Cn(N,!1)),{},{payload:g,payloadIndex:E,className:Sn("recharts-tooltip-cursor",N.className)});return x.isValidElement(N)?x.cloneElement(N,G):x.createElement(L,G)}var CGe=["item"],RGe=["children","className","width","height","style","compact","title","desc"];function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function wf(){return wf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},wf.apply(this,arguments)}function gq(e,t){return IGe(e)||AGe(e,t)||hZ(e,t)||OGe()}function OGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AGe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,l,d,p,g=[],v=!0,E=!1;try{if(d=(a=a.call(e)).next,t!==0)for(;!(v=(o=d.call(a)).done)&&(g.push(o.value),g.length!==t);v=!0);}catch(T){E=!0,l=T}finally{try{if(!v&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(E)throw l}}return g}}function IGe(e){if(Array.isArray(e))return e}function yq(e,t){if(e==null)return{};var a=NGe(e,t),o,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)o=d[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function NGe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function PGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xGe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,fZ(o.key),o)}}function DGe(e,t,a){return xGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LGe(e,t,a){return t=FT(t),kGe(e,dZ()?Reflect.construct(t,a,FT(e).constructor):t.apply(e,a))}function kGe(e,t){if(t&&(lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MGe(e)}function MGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dZ=function(){return!!e})()}function FT(e){return FT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},FT(e)}function UGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xx(e,t)}function xx(e,t){return xx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},xx(e,t)}function up(e){return BGe(e)||VGe(e)||hZ(e)||jGe()}function jGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hZ(e,t){if(e){if(typeof e=="string")return Dx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Dx(e,t)}}function VGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BGe(e){if(Array.isArray(e))return Dx(e)}function Dx(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function vq(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),a.push.apply(a,o)}return a}function Le(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?vq(Object(a),!0).forEach(function(o){Rt(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vq(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Rt(e,t,a){return t=fZ(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function fZ(e){var t=FGe(e,"string");return lp(t)=="symbol"?t:t+""}function FGe(e,t){if(lp(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(lp(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WGe={xAxis:["bottom","top"],yAxis:["left","right"]},GGe={width:"100%",height:"100%"},pZ={x:0,y:0};function YS(e){return e}var $Ge=function(t,a){return a==="horizontal"?t.x:a==="vertical"?t.y:a==="centric"?t.angle:t.radius},HGe=function(t,a,o,l){var d=a.find(function(T){return T&&T.index===o});if(d){if(t==="horizontal")return{x:d.coordinate,y:l.y};if(t==="vertical")return{x:l.x,y:d.coordinate};if(t==="centric"){var p=d.coordinate,g=l.radius;return Le(Le(Le({},l),Ti(l.cx,l.cy,g,p)),{},{angle:p,radius:g})}var v=d.coordinate,E=l.angle;return Le(Le(Le({},l),Ti(l.cx,l.cy,v,E)),{},{angle:E,radius:v})}return pZ},qw=function(t,a){var o=a.graphicalItems,l=a.dataStartIndex,d=a.dataEndIndex,p=(o??[]).reduce(function(g,v){var E=v.props.data;return E&&E.length?[].concat(up(g),up(E)):g},[]);return p.length>0?p:t&&t.length&&Ze(l)&&Ze(d)?t.slice(l,d+1):[]};function mZ(e){return e==="number"?[0,"auto"]:void 0}var Lx=function(t,a,o,l){var d=t.graphicalItems,p=t.tooltipAxis,g=qw(a,t);return o<0||!d||!d.length||o>=g.length?null:d.reduce(function(v,E){var T,b=(T=E.props.data)!==null&&T!==void 0?T:a;b&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=o&&(b=b.slice(t.dataStartIndex,t.dataEndIndex+1));var R;if(p.dataKey&&!p.allowDuplicatedCategory){var N=b===void 0?g:b;R=fP(N,p.dataKey,l)}else R=b&&b[o]||g[o];return R?[].concat(up(v),[dQ(E,R)]):v},[])},_q=function(t,a,o,l){var d=l||{x:t.chartX,y:t.chartY},p=$Ge(d,o),g=t.orderedTooltipTicks,v=t.tooltipAxis,E=t.tooltipTicks,T=vVe(p,g,E,v);if(T>=0&&E){var b=E[T]&&E[T].value,R=Lx(t,a,T,b),N=HGe(o,g,T,d);return{activeTooltipIndex:T,activeLabel:b,activePayload:R,activeCoordinate:N}}return null},zGe=function(t,a){var o=a.axes,l=a.graphicalItems,d=a.axisType,p=a.axisIdKey,g=a.stackGroups,v=a.dataStartIndex,E=a.dataEndIndex,T=t.layout,b=t.children,R=t.stackOffset,N=cQ(T,d);return o.reduce(function(P,L){var M,D=L.type.defaultProps!==void 0?Le(Le({},L.type.defaultProps),L.props):L.props,U=D.type,B=D.dataKey,z=D.allowDataOverflow,V=D.allowDuplicatedCategory,G=D.scale,q=D.ticks,ne=D.includeHidden,Z=D[p];if(P[Z])return P;var le=qw(t.data,{graphicalItems:l.filter(function(Pe){var Ge,nt=p in Pe.props?Pe.props[p]:(Ge=Pe.type.defaultProps)===null||Ge===void 0?void 0:Ge[p];return nt===Z}),dataStartIndex:v,dataEndIndex:E}),ee=le.length,ce,be,ae;vGe(D.domain,z,U)&&(ce=ex(D.domain,null,z),N&&(U==="number"||G!=="auto")&&(ae=ty(le,B,"category")));var fe=mZ(U);if(!ce||ce.length===0){var me,_e=(me=D.domain)!==null&&me!==void 0?me:fe;if(B){if(ce=ty(le,B,U),U==="category"&&N){var ue=o0e(ce);V&&ue?(be=ce,ce=IT(0,ee)):V||(ce=eK(_e,ce,L).reduce(function(Pe,Ge){return Pe.indexOf(Ge)>=0?Pe:[].concat(up(Pe),[Ge])},[]))}else if(U==="category")V?ce=ce.filter(function(Pe){return Pe!==""&&!Pn(Pe)}):ce=eK(_e,ce,L).reduce(function(Pe,Ge){return Pe.indexOf(Ge)>=0||Ge===""||Pn(Ge)?Pe:[].concat(up(Pe),[Ge])},[]);else if(U==="number"){var ve=TVe(le,l.filter(function(Pe){var Ge,nt,Re=p in Pe.props?Pe.props[p]:(Ge=Pe.type.defaultProps)===null||Ge===void 0?void 0:Ge[p],wt="hide"in Pe.props?Pe.props.hide:(nt=Pe.type.defaultProps)===null||nt===void 0?void 0:nt.hide;return Re===Z&&(ne||!wt)}),B,d,T);ve&&(ce=ve)}N&&(U==="number"||G!=="auto")&&(ae=ty(le,B,"category"))}else N?ce=IT(0,ee):g&&g[Z]&&g[Z].hasStack&&U==="number"?ce=R==="expand"?[0,1]:uQ(g[Z].stackGroups,v,E):ce=sQ(le,l.filter(function(Pe){var Ge=p in Pe.props?Pe.props[p]:Pe.type.defaultProps[p],nt="hide"in Pe.props?Pe.props.hide:Pe.type.defaultProps.hide;return Ge===Z&&(ne||!nt)}),U,T,!0);if(U==="number")ce=Px(b,ce,Z,d,q),_e&&(ce=ex(_e,ce,z));else if(U==="category"&&_e){var Ce=_e,Ve=ce.every(function(Pe){return Ce.indexOf(Pe)>=0});Ve&&(ce=Ce)}}return Le(Le({},P),{},Rt({},Z,Le(Le({},D),{},{axisType:d,domain:ce,categoricalDomain:ae,duplicateDomain:be,originalDomain:(M=D.domain)!==null&&M!==void 0?M:fe,isCategorical:N,layout:T})))},{})},KGe=function(t,a){var o=a.graphicalItems,l=a.Axis,d=a.axisType,p=a.axisIdKey,g=a.stackGroups,v=a.dataStartIndex,E=a.dataEndIndex,T=t.layout,b=t.children,R=qw(t.data,{graphicalItems:o,dataStartIndex:v,dataEndIndex:E}),N=R.length,P=cQ(T,d),L=-1;return o.reduce(function(M,D){var U=D.type.defaultProps!==void 0?Le(Le({},D.type.defaultProps),D.props):D.props,B=U[p],z=mZ("number");if(!M[B]){L++;var V;return P?V=IT(0,N):g&&g[B]&&g[B].hasStack?(V=uQ(g[B].stackGroups,v,E),V=Px(b,V,B,d)):(V=ex(z,sQ(R,o.filter(function(G){var q,ne,Z=p in G.props?G.props[p]:(q=G.type.defaultProps)===null||q===void 0?void 0:q[p],le="hide"in G.props?G.props.hide:(ne=G.type.defaultProps)===null||ne===void 0?void 0:ne.hide;return Z===B&&!le}),"number",T),l.defaultProps.allowDataOverflow),V=Px(b,V,B,d)),Le(Le({},M),{},Rt({},B,Le(Le({axisType:d},l.defaultProps),{},{hide:!0,orientation:Eo(WGe,"".concat(d,".").concat(L%2),null),domain:V,originalDomain:z,isCategorical:P,layout:T})))}return M},{})},qGe=function(t,a){var o=a.axisType,l=o===void 0?"xAxis":o,d=a.AxisComp,p=a.graphicalItems,g=a.stackGroups,v=a.dataStartIndex,E=a.dataEndIndex,T=t.children,b="".concat(l,"Id"),R=rs(T,d),N={};return R.length?N=zGe(t,{axes:R,graphicalItems:p,axisType:l,axisIdKey:b,stackGroups:g,dataStartIndex:v,dataEndIndex:E}):p&&p.length&&(N=KGe(t,{Axis:d,graphicalItems:p,axisType:l,axisIdKey:b,stackGroups:g,dataStartIndex:v,dataEndIndex:E})),N},YGe=function(t){var a=Ol(t),o=_c(a,!1,!0);return{tooltipTicks:o,orderedTooltipTicks:uD(o,function(l){return l.coordinate}),tooltipAxis:a,tooltipAxisBandSize:ET(a,o)}},Eq=function(t){var a=t.children,o=t.defaultShowTooltip,l=Ma(a,tp),d=0,p=0;return t.data&&t.data.length!==0&&(p=t.data.length-1),l&&l.props&&(l.props.startIndex>=0&&(d=l.props.startIndex),l.props.endIndex>=0&&(p=l.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:d,dataEndIndex:p,activeTooltipIndex:-1,isTooltipActive:!!o}},XGe=function(t){return!t||!t.length?!1:t.some(function(a){var o=Sc(a&&a.type);return o&&o.indexOf("Bar")>=0})},Sq=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},JGe=function(t,a){var o=t.props,l=t.graphicalItems,d=t.xAxisMap,p=d===void 0?{}:d,g=t.yAxisMap,v=g===void 0?{}:g,E=o.width,T=o.height,b=o.children,R=o.margin||{},N=Ma(b,tp),P=Ma(b,md),L=Object.keys(v).reduce(function(V,G){var q=v[G],ne=q.orientation;return!q.mirror&&!q.hide?Le(Le({},V),{},Rt({},ne,V[ne]+q.width)):V},{left:R.left||0,right:R.right||0}),M=Object.keys(p).reduce(function(V,G){var q=p[G],ne=q.orientation;return!q.mirror&&!q.hide?Le(Le({},V),{},Rt({},ne,Eo(V,"".concat(ne))+q.height)):V},{top:R.top||0,bottom:R.bottom||0}),D=Le(Le({},M),L),U=D.bottom;N&&(D.bottom+=N.props.height||tp.defaultProps.height),P&&a&&(D=SVe(D,l,o,a));var B=E-D.left-D.right,z=T-D.top-D.bottom;return Le(Le({brushBottom:U},D),{},{width:Math.max(B,0),height:Math.max(z,0)})},QGe=function(t,a){if(a==="xAxis")return t[a].width;if(a==="yAxis")return t[a].height},ZGe=function(t){var a=t.chartName,o=t.GraphicalChild,l=t.defaultTooltipEventType,d=l===void 0?"axis":l,p=t.validateTooltipEventTypes,g=p===void 0?["axis"]:p,v=t.axisComponents,E=t.legendContent,T=t.formatAxisMap,b=t.defaultProps,R=function(D,U){var B=U.graphicalItems,z=U.stackGroups,V=U.offset,G=U.updateId,q=U.dataStartIndex,ne=U.dataEndIndex,Z=D.barSize,le=D.layout,ee=D.barGap,ce=D.barCategoryGap,be=D.maxBarSize,ae=Sq(le),fe=ae.numericAxisName,me=ae.cateAxisName,_e=XGe(B),ue=[];return B.forEach(function(ve,Ce){var Ve=qw(D.data,{graphicalItems:[ve],dataStartIndex:q,dataEndIndex:ne}),Pe=ve.type.defaultProps!==void 0?Le(Le({},ve.type.defaultProps),ve.props):ve.props,Ge=Pe.dataKey,nt=Pe.maxBarSize,Re=Pe["".concat(fe,"Id")],wt=Pe["".concat(me,"Id")],It={},lt=v.reduce(function(Ri,$a){var Oo=U["".concat($a.axisType,"Map")],gr=Pe["".concat($a.axisType,"Id")];Oo&&Oo[gr]||$a.axisType==="zAxis"||Rd();var kc=Oo[gr];return Le(Le({},Ri),{},Rt(Rt({},$a.axisType,kc),"".concat($a.axisType,"Ticks"),_c(kc)))},It),ze=lt[me],He=lt["".concat(me,"Ticks")],tt=z&&z[Re]&&z[Re].hasStack&&kVe(ve,z[Re].stackGroups),Be=Sc(ve.type).indexOf("Bar")>=0,zt=ET(ze,He),Wt=[],Ct=_e&&_Ve({barSize:Z,stackGroups:z,totalSize:QGe(lt,me)});if(Be){var Tn,xr,Bn=Pn(nt)?be:nt,er=(Tn=(xr=ET(ze,He,!0))!==null&&xr!==void 0?xr:Bn)!==null&&Tn!==void 0?Tn:0;Wt=EVe({barGap:ee,barCategoryGap:ce,bandSize:er!==zt?er:zt,sizeList:Ct[wt],maxBarSize:Bn}),er!==zt&&(Wt=Wt.map(function(Ri){return Le(Le({},Ri),{},{position:Le(Le({},Ri.position),{},{offset:Ri.position.offset-er/2})})}))}var Ro=ve&&ve.type&&ve.type.getComposedData;Ro&&ue.push({props:Le(Le({},Ro(Le(Le({},lt),{},{displayedData:Ve,props:D,dataKey:Ge,item:ve,bandSize:zt,barPosition:Wt,offset:V,stackedData:tt,layout:le,dataStartIndex:q,dataEndIndex:ne}))),{},Rt(Rt(Rt({key:ve.key||"item-".concat(Ce)},fe,lt[fe]),me,lt[me]),"animationId",G)),childIndex:y0e(ve,D.children),item:ve})}),ue},N=function(D,U){var B=D.props,z=D.dataStartIndex,V=D.dataEndIndex,G=D.updateId;if(!q8({props:B}))return null;var q=B.children,ne=B.layout,Z=B.stackOffset,le=B.data,ee=B.reverseStackOrder,ce=Sq(ne),be=ce.numericAxisName,ae=ce.cateAxisName,fe=rs(q,o),me=xVe(le,fe,"".concat(be,"Id"),"".concat(ae,"Id"),Z,ee),_e=v.reduce(function(Pe,Ge){var nt="".concat(Ge.axisType,"Map");return Le(Le({},Pe),{},Rt({},nt,qGe(B,Le(Le({},Ge),{},{graphicalItems:fe,stackGroups:Ge.axisType===be&&me,dataStartIndex:z,dataEndIndex:V}))))},{}),ue=JGe(Le(Le({},_e),{},{props:B,graphicalItems:fe}),U==null?void 0:U.legendBBox);Object.keys(_e).forEach(function(Pe){_e[Pe]=T(B,_e[Pe],ue,Pe.replace("Map",""),a)});var ve=_e["".concat(ae,"Map")],Ce=YGe(ve),Ve=R(B,Le(Le({},_e),{},{dataStartIndex:z,dataEndIndex:V,updateId:G,graphicalItems:fe,stackGroups:me,offset:ue}));return Le(Le({formattedGraphicalItems:Ve,graphicalItems:fe,offset:ue,stackGroups:me},Ce),_e)},P=function(M){function D(U){var B,z,V;return PGe(this,D),V=LGe(this,D,[U]),Rt(V,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Rt(V,"accessibilityManager",new yGe),Rt(V,"handleLegendBBoxUpdate",function(G){if(G){var q=V.state,ne=q.dataStartIndex,Z=q.dataEndIndex,le=q.updateId;V.setState(Le({legendBBox:G},N({props:V.props,dataStartIndex:ne,dataEndIndex:Z,updateId:le},Le(Le({},V.state),{},{legendBBox:G}))))}}),Rt(V,"handleReceiveSyncEvent",function(G,q,ne){if(V.props.syncId===G){if(ne===V.eventEmitterSymbol&&typeof V.props.syncMethod!="function")return;V.applySyncEvent(q)}}),Rt(V,"handleBrushChange",function(G){var q=G.startIndex,ne=G.endIndex;if(q!==V.state.dataStartIndex||ne!==V.state.dataEndIndex){var Z=V.state.updateId;V.setState(function(){return Le({dataStartIndex:q,dataEndIndex:ne},N({props:V.props,dataStartIndex:q,dataEndIndex:ne,updateId:Z},V.state))}),V.triggerSyncEvent({dataStartIndex:q,dataEndIndex:ne})}}),Rt(V,"handleMouseEnter",function(G){var q=V.getMouseInfo(G);if(q){var ne=Le(Le({},q),{},{isTooltipActive:!0});V.setState(ne),V.triggerSyncEvent(ne);var Z=V.props.onMouseEnter;Zt(Z)&&Z(ne,G)}}),Rt(V,"triggeredAfterMouseMove",function(G){var q=V.getMouseInfo(G),ne=q?Le(Le({},q),{},{isTooltipActive:!0}):{isTooltipActive:!1};V.setState(ne),V.triggerSyncEvent(ne);var Z=V.props.onMouseMove;Zt(Z)&&Z(ne,G)}),Rt(V,"handleItemMouseEnter",function(G){V.setState(function(){return{isTooltipActive:!0,activeItem:G,activePayload:G.tooltipPayload,activeCoordinate:G.tooltipPosition||{x:G.cx,y:G.cy}}})}),Rt(V,"handleItemMouseLeave",function(){V.setState(function(){return{isTooltipActive:!1}})}),Rt(V,"handleMouseMove",function(G){G.persist(),V.throttleTriggeredAfterMouseMove(G)}),Rt(V,"handleMouseLeave",function(G){V.throttleTriggeredAfterMouseMove.cancel();var q={isTooltipActive:!1};V.setState(q),V.triggerSyncEvent(q);var ne=V.props.onMouseLeave;Zt(ne)&&ne(q,G)}),Rt(V,"handleOuterEvent",function(G){var q=g0e(G),ne=Eo(V.props,"".concat(q));if(q&&Zt(ne)){var Z,le;/.*touch.*/i.test(q)?le=V.getMouseInfo(G.changedTouches[0]):le=V.getMouseInfo(G),ne((Z=le)!==null&&Z!==void 0?Z:{},G)}}),Rt(V,"handleClick",function(G){var q=V.getMouseInfo(G);if(q){var ne=Le(Le({},q),{},{isTooltipActive:!0});V.setState(ne),V.triggerSyncEvent(ne);var Z=V.props.onClick;Zt(Z)&&Z(ne,G)}}),Rt(V,"handleMouseDown",function(G){var q=V.props.onMouseDown;if(Zt(q)){var ne=V.getMouseInfo(G);q(ne,G)}}),Rt(V,"handleMouseUp",function(G){var q=V.props.onMouseUp;if(Zt(q)){var ne=V.getMouseInfo(G);q(ne,G)}}),Rt(V,"handleTouchMove",function(G){G.changedTouches!=null&&G.changedTouches.length>0&&V.throttleTriggeredAfterMouseMove(G.changedTouches[0])}),Rt(V,"handleTouchStart",function(G){G.changedTouches!=null&&G.changedTouches.length>0&&V.handleMouseDown(G.changedTouches[0])}),Rt(V,"handleTouchEnd",function(G){G.changedTouches!=null&&G.changedTouches.length>0&&V.handleMouseUp(G.changedTouches[0])}),Rt(V,"handleDoubleClick",function(G){var q=V.props.onDoubleClick;if(Zt(q)){var ne=V.getMouseInfo(G);q(ne,G)}}),Rt(V,"handleContextMenu",function(G){var q=V.props.onContextMenu;if(Zt(q)){var ne=V.getMouseInfo(G);q(ne,G)}}),Rt(V,"triggerSyncEvent",function(G){V.props.syncId!==void 0&&iN.emit(aN,V.props.syncId,G,V.eventEmitterSymbol)}),Rt(V,"applySyncEvent",function(G){var q=V.props,ne=q.layout,Z=q.syncMethod,le=V.state.updateId,ee=G.dataStartIndex,ce=G.dataEndIndex;if(G.dataStartIndex!==void 0||G.dataEndIndex!==void 0)V.setState(Le({dataStartIndex:ee,dataEndIndex:ce},N({props:V.props,dataStartIndex:ee,dataEndIndex:ce,updateId:le},V.state)));else if(G.activeTooltipIndex!==void 0){var be=G.chartX,ae=G.chartY,fe=G.activeTooltipIndex,me=V.state,_e=me.offset,ue=me.tooltipTicks;if(!_e)return;if(typeof Z=="function")fe=Z(ue,G);else if(Z==="value"){fe=-1;for(var ve=0;ve<ue.length;ve++)if(ue[ve].value===G.activeLabel){fe=ve;break}}var Ce=Le(Le({},_e),{},{x:_e.left,y:_e.top}),Ve=Math.min(be,Ce.x+Ce.width),Pe=Math.min(ae,Ce.y+Ce.height),Ge=ue[fe]&&ue[fe].value,nt=Lx(V.state,V.props.data,fe),Re=ue[fe]?{x:ne==="horizontal"?ue[fe].coordinate:Ve,y:ne==="horizontal"?Pe:ue[fe].coordinate}:pZ;V.setState(Le(Le({},G),{},{activeLabel:Ge,activeCoordinate:Re,activePayload:nt,activeTooltipIndex:fe}))}else V.setState(G)}),Rt(V,"renderCursor",function(G){var q,ne=V.state,Z=ne.isTooltipActive,le=ne.activeCoordinate,ee=ne.activePayload,ce=ne.offset,be=ne.activeTooltipIndex,ae=ne.tooltipAxisBandSize,fe=V.getTooltipEventType(),me=(q=G.props.active)!==null&&q!==void 0?q:Z,_e=V.props.layout,ue=G.key||"_recharts-cursor";return ye.createElement(wGe,{key:ue,activeCoordinate:le,activePayload:ee,activeTooltipIndex:be,chartName:a,element:G,isActive:me,layout:_e,offset:ce,tooltipAxisBandSize:ae,tooltipEventType:fe})}),Rt(V,"renderPolarAxis",function(G,q,ne){var Z=Eo(G,"type.axisType"),le=Eo(V.state,"".concat(Z,"Map")),ee=G.type.defaultProps,ce=ee!==void 0?Le(Le({},ee),G.props):G.props,be=le&&le[ce["".concat(Z,"Id")]];return x.cloneElement(G,Le(Le({},be),{},{className:Sn(Z,be.className),key:G.key||"".concat(q,"-").concat(ne),ticks:_c(be,!0)}))}),Rt(V,"renderPolarGrid",function(G){var q=G.props,ne=q.radialLines,Z=q.polarAngles,le=q.polarRadius,ee=V.state,ce=ee.radiusAxisMap,be=ee.angleAxisMap,ae=Ol(ce),fe=Ol(be),me=fe.cx,_e=fe.cy,ue=fe.innerRadius,ve=fe.outerRadius;return x.cloneElement(G,{polarAngles:Array.isArray(Z)?Z:_c(fe,!0).map(function(Ce){return Ce.coordinate}),polarRadius:Array.isArray(le)?le:_c(ae,!0).map(function(Ce){return Ce.coordinate}),cx:me,cy:_e,innerRadius:ue,outerRadius:ve,key:G.key||"polar-grid",radialLines:ne})}),Rt(V,"renderLegend",function(){var G=V.state.formattedGraphicalItems,q=V.props,ne=q.children,Z=q.width,le=q.height,ee=V.props.margin||{},ce=Z-(ee.left||0)-(ee.right||0),be=aQ({children:ne,formattedGraphicalItems:G,legendWidth:ce,legendContent:E});if(!be)return null;var ae=be.item,fe=yq(be,CGe);return x.cloneElement(ae,Le(Le({},fe),{},{chartWidth:Z,chartHeight:le,margin:ee,onBBoxUpdate:V.handleLegendBBoxUpdate}))}),Rt(V,"renderTooltip",function(){var G,q=V.props,ne=q.children,Z=q.accessibilityLayer,le=Ma(ne,xs);if(!le)return null;var ee=V.state,ce=ee.isTooltipActive,be=ee.activeCoordinate,ae=ee.activePayload,fe=ee.activeLabel,me=ee.offset,_e=(G=le.props.active)!==null&&G!==void 0?G:ce;return x.cloneElement(le,{viewBox:Le(Le({},me),{},{x:me.left,y:me.top}),active:_e,label:fe,payload:_e?ae:[],coordinate:be,accessibilityLayer:Z})}),Rt(V,"renderBrush",function(G){var q=V.props,ne=q.margin,Z=q.data,le=V.state,ee=le.offset,ce=le.dataStartIndex,be=le.dataEndIndex,ae=le.updateId;return x.cloneElement(G,{key:G.key||"_recharts-brush",onChange:$S(V.handleBrushChange,G.props.onChange),data:Z,x:Ze(G.props.x)?G.props.x:ee.left,y:Ze(G.props.y)?G.props.y:ee.top+ee.height+ee.brushBottom-(ne.bottom||0),width:Ze(G.props.width)?G.props.width:ee.width,startIndex:ce,endIndex:be,updateId:"brush-".concat(ae)})}),Rt(V,"renderReferenceElement",function(G,q,ne){if(!G)return null;var Z=V,le=Z.clipPathId,ee=V.state,ce=ee.xAxisMap,be=ee.yAxisMap,ae=ee.offset,fe=G.type.defaultProps||{},me=G.props,_e=me.xAxisId,ue=_e===void 0?fe.xAxisId:_e,ve=me.yAxisId,Ce=ve===void 0?fe.yAxisId:ve;return x.cloneElement(G,{key:G.key||"".concat(q,"-").concat(ne),xAxis:ce[ue],yAxis:be[Ce],viewBox:{x:ae.left,y:ae.top,width:ae.width,height:ae.height},clipPathId:le})}),Rt(V,"renderActivePoints",function(G){var q=G.item,ne=G.activePoint,Z=G.basePoint,le=G.childIndex,ee=G.isRange,ce=[],be=q.props.key,ae=q.item.type.defaultProps!==void 0?Le(Le({},q.item.type.defaultProps),q.item.props):q.item.props,fe=ae.activeDot,me=ae.dataKey,_e=Le(Le({index:le,dataKey:me,cx:ne.x,cy:ne.y,r:4,fill:UD(q.item),strokeWidth:2,stroke:"#fff",payload:ne.payload,value:ne.value},Cn(fe,!1)),Hb(fe));return ce.push(D.renderActiveDot(fe,_e,"".concat(be,"-activePoint-").concat(le))),Z?ce.push(D.renderActiveDot(fe,Le(Le({},_e),{},{cx:Z.x,cy:Z.y}),"".concat(be,"-basePoint-").concat(le))):ee&&ce.push(null),ce}),Rt(V,"renderGraphicChild",function(G,q,ne){var Z=V.filterFormatItem(G,q,ne);if(!Z)return null;var le=V.getTooltipEventType(),ee=V.state,ce=ee.isTooltipActive,be=ee.tooltipAxis,ae=ee.activeTooltipIndex,fe=ee.activeLabel,me=V.props.children,_e=Ma(me,xs),ue=Z.props,ve=ue.points,Ce=ue.isRange,Ve=ue.baseLine,Pe=Z.item.type.defaultProps!==void 0?Le(Le({},Z.item.type.defaultProps),Z.item.props):Z.item.props,Ge=Pe.activeDot,nt=Pe.hide,Re=Pe.activeBar,wt=Pe.activeShape,It=!!(!nt&&ce&&_e&&(Ge||Re||wt)),lt={};le!=="axis"&&_e&&_e.props.trigger==="click"?lt={onClick:$S(V.handleItemMouseEnter,G.props.onClick)}:le!=="axis"&&(lt={onMouseLeave:$S(V.handleItemMouseLeave,G.props.onMouseLeave),onMouseEnter:$S(V.handleItemMouseEnter,G.props.onMouseEnter)});var ze=x.cloneElement(G,Le(Le({},Z.props),lt));function He($a){return typeof be.dataKey=="function"?be.dataKey($a.payload):null}if(It)if(ae>=0){var tt,Be;if(be.dataKey&&!be.allowDuplicatedCategory){var zt=typeof be.dataKey=="function"?He:"payload.".concat(be.dataKey.toString());tt=fP(ve,zt,fe),Be=Ce&&Ve&&fP(Ve,zt,fe)}else tt=ve==null?void 0:ve[ae],Be=Ce&&Ve&&Ve[ae];if(wt||Re){var Wt=G.props.activeIndex!==void 0?G.props.activeIndex:ae;return[x.cloneElement(G,Le(Le(Le({},Z.props),lt),{},{activeIndex:Wt})),null,null]}if(!Pn(tt))return[ze].concat(up(V.renderActivePoints({item:Z,activePoint:tt,basePoint:Be,childIndex:ae,isRange:Ce})))}else{var Ct,Tn=(Ct=V.getItemByXY(V.state.activeCoordinate))!==null&&Ct!==void 0?Ct:{graphicalItem:ze},xr=Tn.graphicalItem,Bn=xr.item,er=Bn===void 0?G:Bn,Ro=xr.childIndex,Ri=Le(Le(Le({},Z.props),lt),{},{activeIndex:Ro});return[x.cloneElement(er,Ri),null,null]}return Ce?[ze,null,null]:[ze,null]}),Rt(V,"renderCustomized",function(G,q,ne){return x.cloneElement(G,Le(Le({key:"recharts-customized-".concat(ne)},V.props),V.state))}),Rt(V,"renderMap",{CartesianGrid:{handler:YS,once:!0},ReferenceArea:{handler:V.renderReferenceElement},ReferenceLine:{handler:YS},ReferenceDot:{handler:V.renderReferenceElement},XAxis:{handler:YS},YAxis:{handler:YS},Brush:{handler:V.renderBrush,once:!0},Bar:{handler:V.renderGraphicChild},Line:{handler:V.renderGraphicChild},Area:{handler:V.renderGraphicChild},Radar:{handler:V.renderGraphicChild},RadialBar:{handler:V.renderGraphicChild},Scatter:{handler:V.renderGraphicChild},Pie:{handler:V.renderGraphicChild},Funnel:{handler:V.renderGraphicChild},Tooltip:{handler:V.renderCursor,once:!0},PolarGrid:{handler:V.renderPolarGrid,once:!0},PolarAngleAxis:{handler:V.renderPolarAxis},PolarRadiusAxis:{handler:V.renderPolarAxis},Customized:{handler:V.renderCustomized}}),V.clipPathId="".concat((B=U.id)!==null&&B!==void 0?B:Sw("recharts"),"-clip"),V.throttleTriggeredAfterMouseMove=iJ(V.triggeredAfterMouseMove,(z=U.throttleDelay)!==null&&z!==void 0?z:1e3/60),V.state={},V}return UGe(D,M),DGe(D,[{key:"componentDidMount",value:function(){var B,z;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(B=this.props.margin.left)!==null&&B!==void 0?B:0,top:(z=this.props.margin.top)!==null&&z!==void 0?z:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var B=this.props,z=B.children,V=B.data,G=B.height,q=B.layout,ne=Ma(z,xs);if(ne){var Z=ne.props.defaultIndex;if(!(typeof Z!="number"||Z<0||Z>this.state.tooltipTicks.length-1)){var le=this.state.tooltipTicks[Z]&&this.state.tooltipTicks[Z].value,ee=Lx(this.state,V,Z,le),ce=this.state.tooltipTicks[Z].coordinate,be=(this.state.offset.top+G)/2,ae=q==="horizontal",fe=ae?{x:ce,y:be}:{y:ce,x:be},me=this.state.formattedGraphicalItems.find(function(ue){var ve=ue.item;return ve.type.name==="Scatter"});me&&(fe=Le(Le({},fe),me.props.points[Z].tooltipPosition),ee=me.props.points[Z].tooltipPayload);var _e={activeTooltipIndex:Z,isTooltipActive:!0,activeLabel:le,activePayload:ee,activeCoordinate:fe};this.setState(_e),this.renderCursor(ne),this.accessibilityManager.setIndex(Z)}}}},{key:"getSnapshotBeforeUpdate",value:function(B,z){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==z.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==B.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==B.margin){var V,G;this.accessibilityManager.setDetails({offset:{left:(V=this.props.margin.left)!==null&&V!==void 0?V:0,top:(G=this.props.margin.top)!==null&&G!==void 0?G:0}})}return null}},{key:"componentDidUpdate",value:function(B){mP([Ma(B.children,xs)],[Ma(this.props.children,xs)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var B=Ma(this.props.children,xs);if(B&&typeof B.props.shared=="boolean"){var z=B.props.shared?"axis":"item";return g.indexOf(z)>=0?z:d}return d}},{key:"getMouseInfo",value:function(B){if(!this.container)return null;var z=this.container,V=z.getBoundingClientRect(),G=$ke(V),q={chartX:Math.round(B.pageX-G.left),chartY:Math.round(B.pageY-G.top)},ne=V.width/z.offsetWidth||1,Z=this.inRange(q.chartX,q.chartY,ne);if(!Z)return null;var le=this.state,ee=le.xAxisMap,ce=le.yAxisMap,be=this.getTooltipEventType();if(be!=="axis"&&ee&&ce){var ae=Ol(ee).scale,fe=Ol(ce).scale,me=ae&&ae.invert?ae.invert(q.chartX):null,_e=fe&&fe.invert?fe.invert(q.chartY):null;return Le(Le({},q),{},{xValue:me,yValue:_e})}var ue=_q(this.state,this.props.data,this.props.layout,Z);return ue?Le(Le({},q),ue):null}},{key:"inRange",value:function(B,z){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,G=this.props.layout,q=B/V,ne=z/V;if(G==="horizontal"||G==="vertical"){var Z=this.state.offset,le=q>=Z.left&&q<=Z.left+Z.width&&ne>=Z.top&&ne<=Z.top+Z.height;return le?{x:q,y:ne}:null}var ee=this.state,ce=ee.angleAxisMap,be=ee.radiusAxisMap;if(ce&&be){var ae=Ol(ce);return rK({x:q,y:ne},ae)}return null}},{key:"parseEventsOfWrapper",value:function(){var B=this.props.children,z=this.getTooltipEventType(),V=Ma(B,xs),G={};V&&z==="axis"&&(V.props.trigger==="click"?G={onClick:this.handleClick}:G={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var q=Hb(this.props,this.handleOuterEvent);return Le(Le({},q),G)}},{key:"addListener",value:function(){iN.on(aN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){iN.removeListener(aN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(B,z,V){for(var G=this.state.formattedGraphicalItems,q=0,ne=G.length;q<ne;q++){var Z=G[q];if(Z.item===B||Z.props.key===B.key||z===Sc(Z.item.type)&&V===Z.childIndex)return Z}return null}},{key:"renderClipPath",value:function(){var B=this.clipPathId,z=this.state.offset,V=z.left,G=z.top,q=z.height,ne=z.width;return ye.createElement("defs",null,ye.createElement("clipPath",{id:B},ye.createElement("rect",{x:V,y:G,height:q,width:ne})))}},{key:"getXScales",value:function(){var B=this.state.xAxisMap;return B?Object.entries(B).reduce(function(z,V){var G=gq(V,2),q=G[0],ne=G[1];return Le(Le({},z),{},Rt({},q,ne.scale))},{}):null}},{key:"getYScales",value:function(){var B=this.state.yAxisMap;return B?Object.entries(B).reduce(function(z,V){var G=gq(V,2),q=G[0],ne=G[1];return Le(Le({},z),{},Rt({},q,ne.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(B){var z;return(z=this.state.xAxisMap)===null||z===void 0||(z=z[B])===null||z===void 0?void 0:z.scale}},{key:"getYScaleByAxisId",value:function(B){var z;return(z=this.state.yAxisMap)===null||z===void 0||(z=z[B])===null||z===void 0?void 0:z.scale}},{key:"getItemByXY",value:function(B){var z=this.state,V=z.formattedGraphicalItems,G=z.activeItem;if(V&&V.length)for(var q=0,ne=V.length;q<ne;q++){var Z=V[q],le=Z.props,ee=Z.item,ce=ee.type.defaultProps!==void 0?Le(Le({},ee.type.defaultProps),ee.props):ee.props,be=Sc(ee.type);if(be==="Bar"){var ae=(le.data||[]).find(function(ue){return R3e(B,ue)});if(ae)return{graphicalItem:Z,payload:ae}}else if(be==="RadialBar"){var fe=(le.data||[]).find(function(ue){return rK(B,ue)});if(fe)return{graphicalItem:Z,payload:fe}}else if(Bw(Z,G)||Fw(Z,G)||Jy(Z,G)){var me=I4e({graphicalItem:Z,activeTooltipItem:G,itemData:ce.data}),_e=ce.activeIndex===void 0?me:ce.activeIndex;return{graphicalItem:Le(Le({},Z),{},{childIndex:_e}),payload:Jy(Z,G)?ce.data[me]:Z.props.data[me]}}}return null}},{key:"render",value:function(){var B=this;if(!q8(this))return null;var z=this.props,V=z.children,G=z.className,q=z.width,ne=z.height,Z=z.style,le=z.compact,ee=z.title,ce=z.desc,be=yq(z,RGe),ae=Cn(be,!1);if(le)return ye.createElement(tq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement(yP,wf({},ae,{width:q,height:ne,title:ee,desc:ce}),this.renderClipPath(),X8(V,this.renderMap)));if(this.props.accessibilityLayer){var fe,me;ae.tabIndex=(fe=this.props.tabIndex)!==null&&fe!==void 0?fe:0,ae.role=(me=this.props.role)!==null&&me!==void 0?me:"application",ae.onKeyDown=function(ue){B.accessibilityManager.keyboardEvent(ue)},ae.onFocus=function(){B.accessibilityManager.focus()}}var _e=this.parseEventsOfWrapper();return ye.createElement(tq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement("div",wf({className:Sn("recharts-wrapper",G),style:Le({position:"relative",cursor:"default",width:q,height:ne},Z)},_e,{ref:function(ve){B.container=ve}}),ye.createElement(yP,wf({},ae,{width:q,height:ne,title:ee,desc:ce,style:GGe}),this.renderClipPath(),X8(V,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(x.Component);Rt(P,"displayName",a),Rt(P,"defaultProps",Le({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},b)),Rt(P,"getDerivedStateFromProps",function(M,D){var U=M.dataKey,B=M.data,z=M.children,V=M.width,G=M.height,q=M.layout,ne=M.stackOffset,Z=M.margin,le=D.dataStartIndex,ee=D.dataEndIndex;if(D.updateId===void 0){var ce=Eq(M);return Le(Le(Le({},ce),{},{updateId:0},N(Le(Le({props:M},ce),{},{updateId:0}),D)),{},{prevDataKey:U,prevData:B,prevWidth:V,prevHeight:G,prevLayout:q,prevStackOffset:ne,prevMargin:Z,prevChildren:z})}if(U!==D.prevDataKey||B!==D.prevData||V!==D.prevWidth||G!==D.prevHeight||q!==D.prevLayout||ne!==D.prevStackOffset||!Lf(Z,D.prevMargin)){var be=Eq(M),ae={chartX:D.chartX,chartY:D.chartY,isTooltipActive:D.isTooltipActive},fe=Le(Le({},_q(D,B,q)),{},{updateId:D.updateId+1}),me=Le(Le(Le({},be),ae),fe);return Le(Le(Le({},me),N(Le({props:M},me),D)),{},{prevDataKey:U,prevData:B,prevWidth:V,prevHeight:G,prevLayout:q,prevStackOffset:ne,prevMargin:Z,prevChildren:z})}if(!mP(z,D.prevChildren)){var _e,ue,ve,Ce,Ve=Ma(z,tp),Pe=Ve&&(_e=(ue=Ve.props)===null||ue===void 0?void 0:ue.startIndex)!==null&&_e!==void 0?_e:le,Ge=Ve&&(ve=(Ce=Ve.props)===null||Ce===void 0?void 0:Ce.endIndex)!==null&&ve!==void 0?ve:ee,nt=Pe!==le||Ge!==ee,Re=!Pn(B),wt=Re&&!nt?D.updateId:D.updateId+1;return Le(Le({updateId:wt},N(Le(Le({props:M},D),{},{updateId:wt,dataStartIndex:Pe,dataEndIndex:Ge}),D)),{},{prevChildren:z,dataStartIndex:Pe,dataEndIndex:Ge})}return null}),Rt(P,"renderActiveDot",function(M,D,U){var B;return x.isValidElement(M)?B=x.cloneElement(M,D):Zt(M)?B=M(D):B=ye.createElement(CQ,D),ye.createElement(hi,{className:"recharts-active-dot",key:U},B)});var L=x.forwardRef(function(D,U){return ye.createElement(P,wf({},D,{ref:U}))});return L.displayName=P.displayName,L},e$e=ZGe({chartName:"BarChart",GraphicalChild:ql,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Kw},{axisType:"yAxis",AxisComp:nv}],formatAxisMap:t6e});const qD=({source:e,destinations:t,totalSupply:a,onDataUpdate:o})=>{const[l,d]=x.useState(!1),[p,g]=x.useState(""),[v,E]=x.useState(e),[T,b]=x.useState(t),[R,N]=x.useState(a),[P,L]=x.useState([]),[M,D]=x.useState(0),[U,B]=x.useState(0),[z,V]=x.useState({place:"",demand:0}),G=async(ae,fe)=>{try{d(!0);const me=fe.join("|"),_e=await fetch(`https://maps.gomaps.pro/maps/api/distancematrix/json?origins=${encodeURIComponent(ae)}&destinations=${encodeURIComponent(me)}&units=metric&mode=driving&key=AlzaSyplubBLrYqUCH-O7Xk_sKMz1sAZTVzizke`);if(!_e.ok)throw new Error("Failed to fetch distance data");const ue=await _e.json();if(ue.status!=="OK")throw new Error(`API Error: ${ue.status}`);return ue.rows[0].elements.map(Ce=>({distance:Ce.distance.value/1e3,duration:Ce.duration.text}))}catch(me){return g(`API Error: ${me.message}`),null}finally{d(!1)}},q=(ae,fe)=>fe/ae*100,ne=ae=>ae.reduce((fe,me)=>fe+Number(me.distance)*2,0),Z=ae=>ae.map(fe=>{var me;return{place:fe.place,recommendation:fe.distance&&fe.distance<100?"High Priority":fe.distance&&fe.distance<150?"Medium Priority":"Low Priority",reason:`${(me=fe.distance)==null?void 0:me.toFixed(1)}km distance, ${fe.demand}kg demand`}}),le=async()=>{if(z.place&&z.demand)try{const ae=await G(v,[z.place]);if(ae&&ae[0]){const fe={...z,distance:ae[0].distance,duration:ae[0].duration};b([...T,fe]),V({place:"",demand:0})}}catch{g("Failed to fetch distance for new destination")}},ee=ae=>{b(T.filter((fe,me)=>me!==ae))},ce=ae=>{const fe=[...ae].sort((ue,ve)=>(ue.distance||0)-(ve.distance||0));let me=R;const _e=fe.map((ue,ve)=>{const Ce=Math.min(ue.demand,me);return me-=Ce,{...ue,sequence:ve+1,allocatedSupply:Ce,efficiencyScore:q(ue.distance||0,Ce),unmetDemand:Math.max(0,ue.demand-Ce)}});return D(me),B(ne(_e)),o&&o(_e),_e};if(x.useEffect(()=>{(async()=>{if(T.length>0){const fe=T.map(_e=>_e.place),me=await G(v,fe);if(me){const _e=T.map((ue,ve)=>({...ue,distance:me[ve].distance,duration:me[ve].duration}));b(_e)}}})()},[v]),x.useEffect(()=>{if(T.length>0){const ae=ce(T);L(ae)}},[T,R]),l)return C.jsx("div",{className:"flex items-center justify-center min-h-screen",children:C.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})});const be=Z(P);return C.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:C.jsxs("div",{className:"max-w-6xl mx-auto",children:[C.jsxs("header",{className:"mb-8",children:[C.jsxs("h1",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[C.jsx(aP,{className:"w-6 h-6"}),"Supply Route Distribution"]}),C.jsx("p",{className:"text-gray-600",children:"Add destinations and calculate optimal routes"})]}),C.jsxs(Wl,{className:"mb-6",children:[C.jsx(Jg,{children:C.jsx(Qg,{children:"Route Configuration"})}),C.jsx(Df,{children:C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Location"}),C.jsx("input",{type:"text",value:v,onChange:ae=>E(ae.target.value),placeholder:"Enter source location",className:"w-full p-2 border rounded"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Supply (kg)"}),C.jsx("input",{type:"number",value:R,onChange:ae=>N(Number(ae.target.value)),placeholder:"Enter total supply",className:"w-full p-2 border rounded"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destinations"}),C.jsx("div",{className:"space-y-2",children:T.map((ae,fe)=>{var me;return C.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[C.jsx("span",{className:"flex-1",children:ae.place}),C.jsxs("span",{className:"flex-1",children:[ae.demand,"kg"]}),C.jsxs("span",{className:"flex-1",children:[(me=ae.distance)==null?void 0:me.toFixed(1),"km"]}),C.jsx("span",{className:"flex-1",children:ae.duration}),C.jsx("button",{onClick:()=>ee(fe),className:"text-red-600 hover:text-red-800",children:C.jsx(p9,{className:"h-4 w-4"})})]},fe)})})]}),C.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[C.jsx("input",{type:"text",value:z.place,onChange:ae=>V({...z,place:ae.target.value}),placeholder:"Destination name",className:"p-2 border rounded"}),C.jsx("input",{type:"number",value:z.demand||"",onChange:ae=>V({...z,demand:Number(ae.target.value)}),placeholder:"Demand (kg)",className:"p-2 border rounded"})]}),C.jsxs("button",{onClick:le,disabled:!z.place||!z.demand,className:"w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[C.jsx(vp,{className:"h-4 w-4"}),"Add Destination"]})]})})]}),p&&C.jsxs(V1,{variant:"destructive",className:"mb-6",children:[C.jsx(d$,{className:"h-4 w-4"}),C.jsx(B1,{children:p})]}),T.length>0&&C.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[C.jsxs(Wl,{children:[C.jsx(Jg,{children:C.jsx(Qg,{children:"Route Details"})}),C.jsxs(Df,{children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("h3",{className:"font-medium mb-2",children:"Delivery Priorities"}),C.jsx("div",{className:"space-y-2",children:be.map((ae,fe)=>C.jsxs("div",{className:`p-3 rounded flex items-center justify-between ${ae.recommendation==="High Priority"?"bg-green-50":ae.recommendation==="Medium Priority"?"bg-yellow-50":"bg-red-50"}`,children:[C.jsxs("div",{children:[C.jsx("p",{className:"font-medium",children:ae.place}),C.jsx("p",{className:"text-sm text-gray-600",children:ae.reason})]}),C.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${ae.recommendation==="High Priority"?"bg-green-100 text-green-800":ae.recommendation==="Medium Priority"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ae.recommendation})]},fe))})]}),C.jsxs("div",{children:[C.jsx("h3",{className:"font-medium mb-2",children:"Supply Allocation"}),C.jsx("div",{className:"space-y-2",children:P.map((ae,fe)=>C.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[C.jsxs("div",{className:"flex justify-between mb-1",children:[C.jsx("span",{className:"font-medium",children:ae.place}),C.jsxs("span",{children:[ae.allocatedSupply,"kg / ",ae.demand,"kg"]})]}),C.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:C.jsx("div",{className:"bg-green-600 rounded-full h-2",style:{width:`${(ae.allocatedSupply||0)/ae.demand*100}%`}})})]},fe))})]}),C.jsxs("div",{className:"mt-8 overflow-hidden",children:[C.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[C.jsx(aP,{className:"w-5 h-5 text-green-600"}),C.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Route Sequence"})]}),C.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border border-green-100 shadow-sm",children:[C.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-sm font-medium text-green-600 mb-1",children:"Total Round Trip Distance"}),C.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[U.toFixed(1)," km"]})]}),C.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[C.jsx(Ls,{className:"w-4 h-4"}),C.jsxs("span",{children:["Starting from ",v]})]})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[C.jsx("div",{className:"flex-shrink-0",children:C.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border-2 border-green-500 flex items-center gap-2",children:[C.jsx(Ls,{className:"w-4 h-4 text-green-600"}),C.jsx("span",{className:"font-medium text-green-800",children:v})]})}),P.map((ae,fe)=>{var me;return C.jsxs(ye.Fragment,{children:[C.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[C.jsx("div",{className:"h-0.5 w-8 bg-green-500"}),C.jsx("div",{className:"text-green-500",children:C.jsx(RI,{className:"w-6 h-6"})}),C.jsx("div",{className:"h-0.5 w-2 bg-green-500"})]}),C.jsx("div",{className:"flex-shrink-0",children:C.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border border-green-200 flex items-center gap-3",children:[C.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center",children:C.jsx("span",{className:"text-sm font-bold text-green-600",children:ae.sequence})}),C.jsxs("div",{className:"flex flex-col",children:[C.jsx("span",{className:"font-medium text-green-800",children:ae.place}),C.jsxs("span",{className:"text-xs text-green-600",children:[(me=ae.distance)==null?void 0:me.toFixed(1)," km"]})]})]})})]},fe)}),C.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[C.jsx("div",{className:"h-0.5 w-8 bg-green-500"}),C.jsx("div",{className:"text-green-500",children:C.jsx(RI,{className:"w-6 h-6"})}),C.jsx("div",{className:"h-0.5 w-2 bg-green-500"})]}),C.jsx("div",{className:"flex-shrink-0",children:C.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border-2 border-green-500 flex items-center gap-2",children:[C.jsx(Ls,{className:"w-4 h-4 text-green-600"}),C.jsx("span",{className:"font-medium text-green-800",children:v})]})})]}),C.jsxs("div",{className:"mt-6 pt-4 border-t border-green-100 flex items-center gap-4 text-sm text-green-600",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(Ls,{className:"w-4 h-4"}),C.jsx("span",{children:"Source Location"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500"}),C.jsx("span",{children:"Delivery Stop"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(RI,{className:"w-4 h-4"}),C.jsx("span",{children:"Travel Direction"})]})]})]})]})]})]}),C.jsxs(Wl,{children:[C.jsx(Jg,{children:C.jsx(Qg,{children:"Distribution Analysis"})}),C.jsxs(Df,{children:[P.length>0&&C.jsx("div",{style:{width:"100%",height:200},children:C.jsx(Uke,{children:C.jsxs(e$e,{data:P,children:[C.jsx(tZ,{strokeDasharray:"3 3"}),C.jsx(Kw,{dataKey:"place"}),C.jsx(nv,{yAxisId:"left",orientation:"left",stroke:"#059669"}),C.jsx(nv,{yAxisId:"right",orientation:"right",stroke:"#2563eb"}),C.jsx(xs,{}),C.jsx(md,{}),C.jsx(ql,{yAxisId:"left",dataKey:"demand",name:"Demand (kg)",fill:"#059669"}),C.jsx(ql,{yAxisId:"right",dataKey:"distance",name:"Distance (km)",fill:"#2563eb"})]})})}),C.jsx("div",{className:"grid grid-cols-1 gap-4 mt-6",children:C.jsxs("div",{className:"bg-blue-50 p-4 rounded",children:[C.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Supply Coverage"}),C.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[(R/P.reduce((ae,fe)=>ae+fe.demand,0)*100).toFixed(1),"%"]})]})}),C.jsxs("div",{className:"mt-6 bg-yellow-50 p-4 rounded",children:[C.jsxs("h4",{className:"font-medium flex items-center gap-2 mb-2",children:[C.jsx(d$,{className:"w-4 h-4 text-yellow-600"}),"Optimization Suggestions"]}),C.jsxs("ul",{className:"text-sm space-y-1",children:[P.filter(ae=>(ae.unmetDemand||0)>0).map((ae,fe)=>C.jsxs("li",{className:"text-gray-600",children:[" ",ae.place,": Unmet demand of ",ae.unmetDemand,"kg"]},fe)),M>0&&C.jsxs("li",{className:"text-gray-600",children:[" Unused supply: ",M,"kg could be allocated to closer destinations"]})]})]})]})]})]})]})})},t$e=()=>{const{user:e}=dv(),{getProductsByFarmer:t,addProduct:a,deleteProduct:o}=n9(),[l,d]=x.useState([]),[p,g]=x.useState(!1),[v,E]=x.useState(""),[T,b]=x.useState({name:"",description:"",price:0,quantity:0,unit:"kg",category:"Vegetables"});x.useEffect(()=>{if(e!=null&&e.id){const D=t(e.id);d(D)}},[e==null?void 0:e.id,t]);const R=()=>T.price<=0?(E("Price must be greater than 0"),!1):T.quantity<=0?(E("Quantity must be greater than 0"),!1):(E(""),!0),N=D=>{if(D.preventDefault(),!R())return;const U={...T,price:Math.round(T.price*100)/100,quantity:Math.round(T.quantity*1e3)/1e3,farmerId:(e==null?void 0:e.id)||"",farmerName:(e==null?void 0:e.name)||""};a(U),d(B=>[...B,{...U,id:Date.now().toString()}]),g(!1),b({name:"",description:"",price:0,quantity:0,unit:"kg",category:"Vegetables"}),E("")},P=D=>{const U=parseFloat(D.target.value);if(!isNaN(U)){const B=Math.round(U*100)/100;b({...T,price:B})}},L=D=>{const U=parseFloat(D.target.value);if(!isNaN(U)){const B=Math.round(U*1e3)/1e3;b({...T,quantity:B})}},M=D=>{o(D),d(l.filter(U=>U.id!==D))};return C.jsxs("div",{className:"container mx-auto p-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-6",children:[C.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"My Products"}),C.jsxs("button",{onClick:()=>g(!0),className:"btn bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-700",children:[C.jsx(vp,{size:20}),"Add New Product"]})]}),p&&C.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg shadow",children:[C.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Product"}),C.jsxs("form",{onSubmit:N,className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),C.jsx("input",{type:"text",value:T.name,onChange:D=>b({...T,name:D.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",required:!0})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),C.jsx("textarea",{value:T.description,onChange:D=>b({...T,description:D.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",rows:3,required:!0})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[C.jsxs("div",{children:[C.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Price ()",C.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(up to 2 decimals)"})]}),C.jsx("input",{type:"number",value:T.price,onChange:P,step:"0.01",min:"0.01",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",required:!0})]}),C.jsxs("div",{children:[C.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Quantity",C.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(up to 3 decimals)"})]}),C.jsx("input",{type:"number",value:T.quantity,onChange:L,step:"0.001",min:"0.001",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",required:!0})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit"}),C.jsxs("select",{value:T.unit,onChange:D=>b({...T,unit:D.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",children:[C.jsx("option",{value:"kg",children:"Kilogram (kg)"}),C.jsx("option",{value:"g",children:"Gram (g)"}),C.jsx("option",{value:"piece",children:"Piece"}),C.jsx("option",{value:"dozen",children:"Dozen"}),C.jsx("option",{value:"quintal",children:"Quintal"}),C.jsx("option",{value:"ton",children:"Ton"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),C.jsxs("select",{value:T.category,onChange:D=>b({...T,category:D.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",children:[C.jsx("option",{value:"Vegetables",children:"Vegetables"}),C.jsx("option",{value:"Fruits",children:"Fruits"}),C.jsx("option",{value:"Grains",children:"Grains"}),C.jsx("option",{value:"Dairy",children:"Dairy"}),C.jsx("option",{value:"Other",children:"Other"})]})]})]}),v&&C.jsx("div",{className:"text-red-600 text-sm",children:v}),C.jsxs("div",{className:"flex justify-end gap-4",children:[C.jsx("button",{type:"button",onClick:()=>{g(!1),E("")},className:"btn bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200",children:"Cancel"}),C.jsx("button",{type:"submit",className:"btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Add Product"})]})]})]}),C.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(D=>C.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[C.jsxs("div",{className:"flex justify-between items-start mb-4",children:[C.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:D.name}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("button",{className:"text-gray-600 hover:text-blue-600",children:C.jsx(qEe,{size:18})}),C.jsx("button",{onClick:()=>M(D.id),className:"text-gray-600 hover:text-red-600",children:C.jsx(D1,{size:18})})]})]}),C.jsx("p",{className:"text-gray-600 mb-4",children:D.description}),C.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[C.jsxs("span",{children:["Price: ",D.price.toFixed(2),"/",D.unit]}),C.jsxs("span",{children:["Stock: ",D.quantity.toFixed(3)," ",D.unit]})]}),C.jsx("div",{className:"mt-2 text-sm text-gray-500",children:C.jsxs("span",{children:["Category: ",D.category]})})]},D.id))})]})},gZ=6048e5,n$e=864e5,bq=Symbol.for("constructDateFrom");function Yl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&bq in e?e[bq](t):e instanceof Date?new e.constructor(t):new Date(t)}function os(e,t){return Yl(t||e,e)}let r$e={};function Yw(){return r$e}function av(e,t){var g,v,E,T;const a=Yw(),o=(t==null?void 0:t.weekStartsOn)??((v=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??a.weekStartsOn??((T=(E=a.locale)==null?void 0:E.options)==null?void 0:T.weekStartsOn)??0,l=os(e,t==null?void 0:t.in),d=l.getDay(),p=(d<o?7:0)+d-o;return l.setDate(l.getDate()-p),l.setHours(0,0,0,0),l}function WT(e,t){return av(e,{...t,weekStartsOn:1})}function yZ(e,t){const a=os(e,t==null?void 0:t.in),o=a.getFullYear(),l=Yl(a,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const d=WT(l),p=Yl(a,0);p.setFullYear(o,0,4),p.setHours(0,0,0,0);const g=WT(p);return a.getTime()>=d.getTime()?o+1:a.getTime()>=g.getTime()?o:o-1}function Tq(e){const t=os(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),+e-+a}function i$e(e,...t){const a=Yl.bind(null,t.find(o=>typeof o=="object"));return t.map(a)}function wq(e,t){const a=os(e,t==null?void 0:t.in);return a.setHours(0,0,0,0),a}function a$e(e,t,a){const[o,l]=i$e(a==null?void 0:a.in,e,t),d=wq(o),p=wq(l),g=+d-Tq(d),v=+p-Tq(p);return Math.round((g-v)/n$e)}function o$e(e,t){const a=yZ(e,t),o=Yl(e,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),WT(o)}function s$e(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function c$e(e){return!(!s$e(e)&&typeof e!="number"||isNaN(+os(e)))}function l$e(e,t){const a=os(e,t==null?void 0:t.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const u$e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},d$e=(e,t,a)=>{let o;const l=u$e[e];return typeof l=="string"?o=l:t===1?o=l.one:o=l.other.replace("{{count}}",t.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+o:o+" ago":o};function sN(e){return(t={})=>{const a=t.width?String(t.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const h$e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},f$e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},p$e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},m$e={date:sN({formats:h$e,defaultWidth:"full"}),time:sN({formats:f$e,defaultWidth:"full"}),dateTime:sN({formats:p$e,defaultWidth:"full"})},g$e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},y$e=(e,t,a,o)=>g$e[e];function xg(e){return(t,a)=>{const o=a!=null&&a.context?String(a.context):"standalone";let l;if(o==="formatting"&&e.formattingValues){const p=e.defaultFormattingWidth||e.defaultWidth,g=a!=null&&a.width?String(a.width):p;l=e.formattingValues[g]||e.formattingValues[p]}else{const p=e.defaultWidth,g=a!=null&&a.width?String(a.width):e.defaultWidth;l=e.values[g]||e.values[p]}const d=e.argumentCallback?e.argumentCallback(t):t;return l[d]}}const v$e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},_$e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},E$e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},S$e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},b$e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},T$e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},w$e=(e,t)=>{const a=Number(e),o=a%100;if(o>20||o<10)switch(o%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},C$e={ordinalNumber:w$e,era:xg({values:v$e,defaultWidth:"wide"}),quarter:xg({values:_$e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xg({values:E$e,defaultWidth:"wide"}),day:xg({values:S$e,defaultWidth:"wide"}),dayPeriod:xg({values:b$e,defaultWidth:"wide",formattingValues:T$e,defaultFormattingWidth:"wide"})};function Dg(e){return(t,a={})=>{const o=a.width,l=o&&e.matchPatterns[o]||e.matchPatterns[e.defaultMatchWidth],d=t.match(l);if(!d)return null;const p=d[0],g=o&&e.parsePatterns[o]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(g)?O$e(g,b=>b.test(p)):R$e(g,b=>b.test(p));let E;E=e.valueCallback?e.valueCallback(v):v,E=a.valueCallback?a.valueCallback(E):E;const T=t.slice(p.length);return{value:E,rest:T}}}function R$e(e,t){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t(e[a]))return a}function O$e(e,t){for(let a=0;a<e.length;a++)if(t(e[a]))return a}function A$e(e){return(t,a={})=>{const o=t.match(e.matchPattern);if(!o)return null;const l=o[0],d=t.match(e.parsePattern);if(!d)return null;let p=e.valueCallback?e.valueCallback(d[0]):d[0];p=a.valueCallback?a.valueCallback(p):p;const g=t.slice(l.length);return{value:p,rest:g}}}const I$e=/^(\d+)(th|st|nd|rd)?/i,N$e=/\d+/i,P$e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},x$e={any:[/^b/i,/^(a|c)/i]},D$e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},L$e={any:[/1/i,/2/i,/3/i,/4/i]},k$e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},M$e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},U$e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},j$e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},V$e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},B$e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},F$e={ordinalNumber:A$e({matchPattern:I$e,parsePattern:N$e,valueCallback:e=>parseInt(e,10)}),era:Dg({matchPatterns:P$e,defaultMatchWidth:"wide",parsePatterns:x$e,defaultParseWidth:"any"}),quarter:Dg({matchPatterns:D$e,defaultMatchWidth:"wide",parsePatterns:L$e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Dg({matchPatterns:k$e,defaultMatchWidth:"wide",parsePatterns:M$e,defaultParseWidth:"any"}),day:Dg({matchPatterns:U$e,defaultMatchWidth:"wide",parsePatterns:j$e,defaultParseWidth:"any"}),dayPeriod:Dg({matchPatterns:V$e,defaultMatchWidth:"any",parsePatterns:B$e,defaultParseWidth:"any"})},W$e={code:"en-US",formatDistance:d$e,formatLong:m$e,formatRelative:y$e,localize:C$e,match:F$e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function G$e(e,t){const a=os(e,t==null?void 0:t.in);return a$e(a,l$e(a))+1}function $$e(e,t){const a=os(e,t==null?void 0:t.in),o=+WT(a)-+o$e(a);return Math.round(o/gZ)+1}function vZ(e,t){var T,b,R,N;const a=os(e,t==null?void 0:t.in),o=a.getFullYear(),l=Yw(),d=(t==null?void 0:t.firstWeekContainsDate)??((b=(T=t==null?void 0:t.locale)==null?void 0:T.options)==null?void 0:b.firstWeekContainsDate)??l.firstWeekContainsDate??((N=(R=l.locale)==null?void 0:R.options)==null?void 0:N.firstWeekContainsDate)??1,p=Yl((t==null?void 0:t.in)||e,0);p.setFullYear(o+1,0,d),p.setHours(0,0,0,0);const g=av(p,t),v=Yl((t==null?void 0:t.in)||e,0);v.setFullYear(o,0,d),v.setHours(0,0,0,0);const E=av(v,t);return+a>=+g?o+1:+a>=+E?o:o-1}function H$e(e,t){var g,v,E,T;const a=Yw(),o=(t==null?void 0:t.firstWeekContainsDate)??((v=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??a.firstWeekContainsDate??((T=(E=a.locale)==null?void 0:E.options)==null?void 0:T.firstWeekContainsDate)??1,l=vZ(e,t),d=Yl((t==null?void 0:t.in)||e,0);return d.setFullYear(l,0,o),d.setHours(0,0,0,0),av(d,t)}function z$e(e,t){const a=os(e,t==null?void 0:t.in),o=+av(a,t)-+H$e(a,t);return Math.round(o/gZ)+1}function Un(e,t){const a=e<0?"-":"",o=Math.abs(e).toString().padStart(t,"0");return a+o}const _l={y(e,t){const a=e.getFullYear(),o=a>0?a:1-a;return Un(t==="yy"?o%100:o,t.length)},M(e,t){const a=e.getMonth();return t==="M"?String(a+1):Un(a+1,2)},d(e,t){return Un(e.getDate(),t.length)},a(e,t){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(e,t){return Un(e.getHours()%12||12,t.length)},H(e,t){return Un(e.getHours(),t.length)},m(e,t){return Un(e.getMinutes(),t.length)},s(e,t){return Un(e.getSeconds(),t.length)},S(e,t){const a=t.length,o=e.getMilliseconds(),l=Math.trunc(o*Math.pow(10,a-3));return Un(l,t.length)}},sf={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Cq={G:function(e,t,a){const o=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return a.era(o,{width:"abbreviated"});case"GGGGG":return a.era(o,{width:"narrow"});case"GGGG":default:return a.era(o,{width:"wide"})}},y:function(e,t,a){if(t==="yo"){const o=e.getFullYear(),l=o>0?o:1-o;return a.ordinalNumber(l,{unit:"year"})}return _l.y(e,t)},Y:function(e,t,a,o){const l=vZ(e,o),d=l>0?l:1-l;if(t==="YY"){const p=d%100;return Un(p,2)}return t==="Yo"?a.ordinalNumber(d,{unit:"year"}):Un(d,t.length)},R:function(e,t){const a=yZ(e);return Un(a,t.length)},u:function(e,t){const a=e.getFullYear();return Un(a,t.length)},Q:function(e,t,a){const o=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(o);case"QQ":return Un(o,2);case"Qo":return a.ordinalNumber(o,{unit:"quarter"});case"QQQ":return a.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(o,{width:"wide",context:"formatting"})}},q:function(e,t,a){const o=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(o);case"qq":return Un(o,2);case"qo":return a.ordinalNumber(o,{unit:"quarter"});case"qqq":return a.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(o,{width:"wide",context:"standalone"})}},M:function(e,t,a){const o=e.getMonth();switch(t){case"M":case"MM":return _l.M(e,t);case"Mo":return a.ordinalNumber(o+1,{unit:"month"});case"MMM":return a.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(o,{width:"wide",context:"formatting"})}},L:function(e,t,a){const o=e.getMonth();switch(t){case"L":return String(o+1);case"LL":return Un(o+1,2);case"Lo":return a.ordinalNumber(o+1,{unit:"month"});case"LLL":return a.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(o,{width:"wide",context:"standalone"})}},w:function(e,t,a,o){const l=z$e(e,o);return t==="wo"?a.ordinalNumber(l,{unit:"week"}):Un(l,t.length)},I:function(e,t,a){const o=$$e(e);return t==="Io"?a.ordinalNumber(o,{unit:"week"}):Un(o,t.length)},d:function(e,t,a){return t==="do"?a.ordinalNumber(e.getDate(),{unit:"date"}):_l.d(e,t)},D:function(e,t,a){const o=G$e(e);return t==="Do"?a.ordinalNumber(o,{unit:"dayOfYear"}):Un(o,t.length)},E:function(e,t,a){const o=e.getDay();switch(t){case"E":case"EE":case"EEE":return a.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(o,{width:"short",context:"formatting"});case"EEEE":default:return a.day(o,{width:"wide",context:"formatting"})}},e:function(e,t,a,o){const l=e.getDay(),d=(l-o.weekStartsOn+8)%7||7;switch(t){case"e":return String(d);case"ee":return Un(d,2);case"eo":return a.ordinalNumber(d,{unit:"day"});case"eee":return a.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(l,{width:"short",context:"formatting"});case"eeee":default:return a.day(l,{width:"wide",context:"formatting"})}},c:function(e,t,a,o){const l=e.getDay(),d=(l-o.weekStartsOn+8)%7||7;switch(t){case"c":return String(d);case"cc":return Un(d,t.length);case"co":return a.ordinalNumber(d,{unit:"day"});case"ccc":return a.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(l,{width:"narrow",context:"standalone"});case"cccccc":return a.day(l,{width:"short",context:"standalone"});case"cccc":default:return a.day(l,{width:"wide",context:"standalone"})}},i:function(e,t,a){const o=e.getDay(),l=o===0?7:o;switch(t){case"i":return String(l);case"ii":return Un(l,t.length);case"io":return a.ordinalNumber(l,{unit:"day"});case"iii":return a.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(o,{width:"short",context:"formatting"});case"iiii":default:return a.day(o,{width:"wide",context:"formatting"})}},a:function(e,t,a){const l=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(e,t,a){const o=e.getHours();let l;switch(o===12?l=sf.noon:o===0?l=sf.midnight:l=o/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(e,t,a){const o=e.getHours();let l;switch(o>=17?l=sf.evening:o>=12?l=sf.afternoon:o>=4?l=sf.morning:l=sf.night,t){case"B":case"BB":case"BBB":return a.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(e,t,a){if(t==="ho"){let o=e.getHours()%12;return o===0&&(o=12),a.ordinalNumber(o,{unit:"hour"})}return _l.h(e,t)},H:function(e,t,a){return t==="Ho"?a.ordinalNumber(e.getHours(),{unit:"hour"}):_l.H(e,t)},K:function(e,t,a){const o=e.getHours()%12;return t==="Ko"?a.ordinalNumber(o,{unit:"hour"}):Un(o,t.length)},k:function(e,t,a){let o=e.getHours();return o===0&&(o=24),t==="ko"?a.ordinalNumber(o,{unit:"hour"}):Un(o,t.length)},m:function(e,t,a){return t==="mo"?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):_l.m(e,t)},s:function(e,t,a){return t==="so"?a.ordinalNumber(e.getSeconds(),{unit:"second"}):_l.s(e,t)},S:function(e,t){return _l.S(e,t)},X:function(e,t,a){const o=e.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return Oq(o);case"XXXX":case"XX":return id(o);case"XXXXX":case"XXX":default:return id(o,":")}},x:function(e,t,a){const o=e.getTimezoneOffset();switch(t){case"x":return Oq(o);case"xxxx":case"xx":return id(o);case"xxxxx":case"xxx":default:return id(o,":")}},O:function(e,t,a){const o=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Rq(o,":");case"OOOO":default:return"GMT"+id(o,":")}},z:function(e,t,a){const o=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Rq(o,":");case"zzzz":default:return"GMT"+id(o,":")}},t:function(e,t,a){const o=Math.trunc(+e/1e3);return Un(o,t.length)},T:function(e,t,a){return Un(+e,t.length)}};function Rq(e,t=""){const a=e>0?"-":"+",o=Math.abs(e),l=Math.trunc(o/60),d=o%60;return d===0?a+String(l):a+String(l)+t+Un(d,2)}function Oq(e,t){return e%60===0?(e>0?"-":"+")+Un(Math.abs(e)/60,2):id(e,t)}function id(e,t=""){const a=e>0?"-":"+",o=Math.abs(e),l=Un(Math.trunc(o/60),2),d=Un(o%60,2);return a+l+t+d}const Aq=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},_Z=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},K$e=(e,t)=>{const a=e.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return Aq(e,t);let d;switch(o){case"P":d=t.dateTime({width:"short"});break;case"PP":d=t.dateTime({width:"medium"});break;case"PPP":d=t.dateTime({width:"long"});break;case"PPPP":default:d=t.dateTime({width:"full"});break}return d.replace("{{date}}",Aq(o,t)).replace("{{time}}",_Z(l,t))},q$e={p:_Z,P:K$e},Y$e=/^D+$/,X$e=/^Y+$/,J$e=["D","DD","YY","YYYY"];function Q$e(e){return Y$e.test(e)}function Z$e(e){return X$e.test(e)}function e8e(e,t,a){const o=t8e(e,t,a);if(console.warn(o),J$e.includes(e))throw new RangeError(o)}function t8e(e,t,a){const o=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${o} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const n8e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,r8e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,i8e=/^'([^]*?)'?$/,a8e=/''/g,o8e=/[a-zA-Z]/;function s8e(e,t,a){var T,b,R,N;const o=Yw(),l=o.locale??W$e,d=o.firstWeekContainsDate??((b=(T=o.locale)==null?void 0:T.options)==null?void 0:b.firstWeekContainsDate)??1,p=o.weekStartsOn??((N=(R=o.locale)==null?void 0:R.options)==null?void 0:N.weekStartsOn)??0,g=os(e,a==null?void 0:a.in);if(!c$e(g))throw new RangeError("Invalid time value");let v=t.match(r8e).map(P=>{const L=P[0];if(L==="p"||L==="P"){const M=q$e[L];return M(P,l.formatLong)}return P}).join("").match(n8e).map(P=>{if(P==="''")return{isToken:!1,value:"'"};const L=P[0];if(L==="'")return{isToken:!1,value:c8e(P)};if(Cq[L])return{isToken:!0,value:P};if(L.match(o8e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+L+"`");return{isToken:!1,value:P}});l.localize.preprocessor&&(v=l.localize.preprocessor(g,v));const E={firstWeekContainsDate:d,weekStartsOn:p,locale:l};return v.map(P=>{if(!P.isToken)return P.value;const L=P.value;(Z$e(L)||Q$e(L))&&e8e(L,t,String(e));const M=Cq[L[0]];return M(g,L,l.localize,E)}).join("")}function c8e(e){const t=e.match(i8e);return t?t[1].replace(a8e,"'"):e}const l8e=()=>{const{priceData:e,loading:t,error:a,refreshPrices:o}=REe(),[l,d]=x.useState(""),[p,g]=x.useState(""),[v,E]=x.useState("price"),[T,b]=x.useState("desc"),R=x.useMemo(()=>{const L=new Set;return Object.values(e).flat().forEach(M=>L.add(M.location)),Array.from(L).sort()},[e]),N=x.useMemo(()=>Object.values(e).flat().filter(L=>L.crop.toLowerCase().includes(l.toLowerCase())&&(!p||L.location===p)).sort((L,M)=>v==="price"?T==="asc"?L.price-M.price:M.price-L.price:v==="crop"?T==="asc"?L.crop.localeCompare(M.crop):M.crop.localeCompare(L.crop):T==="asc"?L.location.localeCompare(M.location):M.location.localeCompare(L.location)),[e,l,p,v,T]),P=L=>{v===L?b(T==="asc"?"desc":"asc"):(E(L),b("desc"))};return t?C.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-7xl mx-auto",children:C.jsx("div",{className:"flex items-center justify-center h-64",children:C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})})}):a?C.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-7xl mx-auto",children:C.jsxs("div",{className:"text-center py-12",children:[C.jsx("div",{className:"text-red-500 text-xl mb-4",children:a}),C.jsx("button",{onClick:o,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Try Again"})]})}):C.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-7xl mx-auto",children:[C.jsx("div",{className:"mb-8",children:C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Real-Time Market Prices"}),C.jsx("p",{className:"text-gray-600",children:"Track current agricultural commodity prices across different locations"})]}),C.jsxs("button",{onClick:o,className:"px-4 py-2 bg-green-100 text-green-700 rounded-md hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center gap-2",children:[C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Crops"}),C.jsx("input",{type:"text",value:l,onChange:L=>d(L.target.value),placeholder:"Search by crop name...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Location"}),C.jsxs("select",{value:p,onChange:L=>g(L.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[C.jsx("option",{value:"",children:"All Locations"}),R.map(L=>C.jsx("option",{value:L,children:L},L))]})]}),C.jsx("div",{className:"flex items-end",children:C.jsx("button",{onClick:()=>{d(""),g("")},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Clear Filters"})})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[C.jsx("thead",{className:"bg-gray-50",children:C.jsxs("tr",{children:[C.jsxs("th",{onClick:()=>P("crop"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Crop Name",v==="crop"&&C.jsx("span",{className:"ml-1",children:T==="asc"?"":""})]}),C.jsxs("th",{onClick:()=>P("price"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Price ()",v==="price"&&C.jsx("span",{className:"ml-1",children:T==="asc"?"":""})]}),C.jsxs("th",{onClick:()=>P("location"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Location",v==="location"&&C.jsx("span",{className:"ml-1",children:T==="asc"?"":""})]}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"})]})}),C.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map((L,M)=>C.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.crop})}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.jsxs("div",{className:"text-sm text-gray-900 font-semibold",children:["",L.price.toLocaleString(),"/",L.unit]})}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.jsx("div",{className:"text-sm text-gray-900",children:L.location})}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s8e(new Date(L.date),"MMM d, yyyy")})]},`${L.crop}-${L.location}-${M}`))})]})}),C.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",N.length," results",p&&` in ${p}`,l&&` for "${l}"`]})]})},XS=({title:e,value:t,icon:a,trend:o,color:l="bg-white"})=>C.jsx("div",{className:`stat-card ${l} p-6 rounded-xl shadow-sm`,children:C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-500 text-sm",children:e}),C.jsx("h3",{className:"text-xl font-bold mt-1",children:t}),o&&C.jsx("p",{className:"text-green-500 text-sm mt-2",children:o})]}),C.jsx("div",{className:"text-green-600 transition-transform duration-300 hover:scale-110",children:a})]})}),u8e=()=>{const[e,t]=x.useState("dashboard"),[a,o]=x.useState(!1),l=[{id:"dashboard",label:"Dashboard",icon:C.jsx(h$,{className:"w-5 h-5"})},{id:"market-prices",label:"Market Prices",icon:C.jsx(nSe,{className:"w-5 h-5"})},{id:"weather",label:"Weather",icon:C.jsx(kEe,{className:"w-5 h-5"})},{id:"crops",label:"Crops",icon:C.jsx(BEe,{className:"w-5 h-5"})},{id:"machinery",label:"Machinery",icon:C.jsx(tSe,{className:"w-5 h-5"})},{id:"inventory",label:"Inventory",icon:C.jsx(DEe,{className:"w-5 h-5"})},{id:"shop",label:"Shop",icon:C.jsx(u9,{className:"w-5 h-5"})},{id:"video-calls",label:"Video Calls",icon:C.jsx(f9,{className:"w-5 h-5"})},{id:"nearby",label:"Nearby",icon:C.jsx(Ls,{className:"w-5 h-5"})},{id:"routes",label:"Supply Routes",icon:C.jsx(aP,{className:"w-5 h-5"})},{id:"team",label:"Team",icon:C.jsx(h9,{className:"w-5 h-5"})}],d=()=>{switch(e){case"market-prices":return C.jsx(a9,{children:C.jsx(l8e,{})});case"video-calls":return C.jsx(v9,{});case"shop":return C.jsx(t$e,{});case"nearby":return C.jsx(G9,{});case"routes":return C.jsx(qD,{source:"Mandya",destinations:[{place:"Bangalore",demand:2e3},{place:"Mysuru",demand:1500},{place:"Hassan",demand:800},{place:"Chikkamagaluru",demand:700}],totalSupply:5e3,onDataUpdate:p=>console.log("Optimized routes:",p)});case"dashboard":return C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8",children:[C.jsx(XS,{title:"Crop Health Index",value:"92%",icon:C.jsx(NEe,{className:"w-6 h-6"}),trend:"+2.5% from last week"}),C.jsx(XS,{title:"Temperature",value:"24C",icon:C.jsx(eSe,{className:"w-6 h-6"}),color:"bg-blue-50"}),C.jsx(XS,{title:"Active Orders",value:"12",icon:C.jsx(kb,{className:"w-6 h-6"}),color:"bg-green-50"}),C.jsx(XS,{title:"Revenue (MTD)",value:"125,000",icon:C.jsx(UEe,{className:"w-6 h-6"}),trend:"+18% vs last month"})]}),C.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[C.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[C.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Yield Forecast"}),C.jsxs("div",{className:"h-64 flex items-center justify-center text-gray-400",children:[C.jsx(FEe,{className:"w-8 h-8"}),C.jsx("span",{className:"ml-2",children:"Chart will be implemented here"})]})]}),C.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[C.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Resource Usage"}),C.jsxs("div",{className:"h-64 flex items-center justify-center text-gray-400",children:[C.jsx(h$,{className:"w-8 h-8"}),C.jsx("span",{className:"ml-2",children:"Chart will be implemented here"})]})]})]}),C.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm mb-8",children:[C.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Farm Overview"}),C.jsx(qbe,{})]}),C.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[C.jsxs("div",{className:"flex items-center justify-between mb-4",children:[C.jsx("h2",{className:"text-lg font-semibold",children:"Upcoming Tasks"}),C.jsxs("button",{className:"px-4 py-2 bg-green-100 text-green-700 rounded-md hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center gap-2",children:[C.jsx(o9,{className:"w-4 h-4"}),C.jsx("span",{children:"View Calendar"})]})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"font-medium",children:"Fertilizer Application - Field A"}),C.jsx("p",{className:"text-sm text-gray-500",children:"Scheduled for tomorrow"})]}),C.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm",children:"Pending"})]}),C.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"font-medium",children:"Machinery Maintenance"}),C.jsx("p",{className:"text-sm text-gray-500",children:"Due in 3 days"})]}),C.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:"Scheduled"})]})]})]})]});default:return C.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[C.jsx("h2",{className:"text-lg font-semibold",children:e.charAt(0).toUpperCase()+e.slice(1)}),C.jsx("p",{className:"text-gray-500 mt-2",children:"This section is under development."})]})}};return C.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[C.jsx("div",{className:`fixed inset-0 bg-gray-600 bg-opacity-50 transition-opacity lg:hidden ${a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>o(!1)}),C.jsx("aside",{className:`
        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:h-screen
        ${a?"translate-x-0":"-translate-x-full"}
      `,children:C.jsxs("div",{className:"p-6",children:[C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsxs("div",{children:[C.jsx("h1",{className:"text-2xl font-bold text-green-600",children:"FreshChain"}),C.jsx("p",{className:"text-sm text-gray-500",children:"Farmer Dashboard"})]}),C.jsx("button",{className:"lg:hidden text-gray-500 hover:text-gray-700",onClick:()=>o(!1),children:C.jsx(p9,{className:"w-6 h-6"})})]}),C.jsx("nav",{className:"mt-8 space-y-2",children:l.map(p=>C.jsxs("button",{onClick:()=>{t(p.id),o(!1)},className:`
                  w-full flex items-center gap-3 px-4 py-3 text-sm rounded-lg transition-colors
                  ${e===p.id?"bg-green-50 text-green-700 font-medium":"text-gray-600 hover:bg-gray-50"}
                `,children:[p.icon,C.jsx("span",{children:p.label})]},p.id))})]})}),C.jsxs("main",{className:"flex-1 p-6 lg:p-8",children:[C.jsxs("header",{className:"lg:hidden flex items-center justify-between mb-6",children:[C.jsx("button",{onClick:()=>o(!0),className:"text-gray-600 hover:text-gray-900",children:C.jsx(HEe,{className:"w-6 h-6"})}),C.jsxs("div",{className:"flex items-center gap-4",children:[C.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:C.jsx(xEe,{className:"w-6 h-6"})}),C.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:C.jsx(QEe,{className:"w-6 h-6"})})]})]}),d()]})]})},Iq="AlzaSyplubBLrYqUCH-O7Xk_sKMz1sAZTVzizke",d8e="https://maps.gomaps.pro/maps/api/directions/json",h8e=({origin:e,destination:t})=>{const[a,o]=x.useState(null),[l,d]=x.useState(null),[p,g]=x.useState(!1),v=async()=>{g(!0);try{const b=await fetch(`${d8e}?origin=${encodeURIComponent(e)}&destination=${encodeURIComponent(t)}&key=${Iq}`);if(!b.ok)throw new Error("Failed to fetch directions");const R=await b.json();R.status==="OK"?(o(R),d(null)):d("Could not find directions for the specified route")}catch(b){d("Error fetching directions"),console.error("Error:",b)}finally{g(!1)}};if(x.useEffect(()=>{e&&t&&v()},[e,t]),p)return C.jsx("div",{className:"flex items-center justify-center p-8",children:C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})});if(l)return C.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg",children:C.jsx("p",{children:l})});if(!a)return null;const T=a.routes[0].legs[0];return C.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Delivery Route Details"}),C.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-sm text-gray-600",children:"From"}),C.jsx("p",{className:"font-medium",children:T.start_address})]}),C.jsxs("div",{children:[C.jsx("p",{className:"text-sm text-gray-600",children:"To"}),C.jsx("p",{className:"font-medium",children:T.end_address})]})]}),C.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-sm text-gray-600",children:"Distance"}),C.jsx("p",{className:"font-medium",children:T.distance.text})]}),C.jsxs("div",{children:[C.jsx("p",{className:"text-sm text-gray-600",children:"Duration"}),C.jsx("p",{className:"font-medium",children:T.duration.text})]})]})]}),C.jsxs("div",{className:"border-t pt-6",children:[C.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Step by Step Directions"}),C.jsx("div",{className:"space-y-4",children:T.steps.map((b,R)=>C.jsxs("div",{className:"flex items-start space-x-4",children:[C.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:C.jsx("span",{className:"text-green-600 font-medium",children:R+1})}),C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-700",dangerouslySetInnerHTML:{__html:b.html_instructions}}),C.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[b.distance.text," - ",b.duration.text]})]})]},R))})]}),C.jsx("div",{className:"mt-6",children:C.jsx(L1,{googleMapsApiKey:Iq,children:C.jsx(E9,{mapContainerClassName:"w-full h-96 rounded-lg",center:{lat:T.start_location.lat,lng:T.start_location.lng},zoom:12,children:a&&C.jsx(k9,{directions:a,options:{polylineOptions:{strokeColor:"#22C55E",strokeWeight:4}}})})})})]})},f8e=()=>{const e=yp(),{user:t,logout:a}=dv(),[o,l]=x.useState(null),[d]=x.useState([{id:"DEL001",origin:"Mysore",destination:"Bangalore",status:"pending",orderDate:"2024-02-15",items:[{name:"Tomatoes",quantity:100,unit:"kg"},{name:"Potatoes",quantity:150,unit:"kg"}]},{id:"DEL002",origin:"Davangere",destination:"Shimoga",status:"in-progress",agentName:"John Doe",estimatedTime:"2 hours",orderDate:"2024-02-15",items:[{name:"Onions",quantity:200,unit:"kg"},{name:"Carrots",quantity:100,unit:"kg"}]}]),p=()=>{a(),e("/login")};return C.jsxs("div",{className:"min-h-screen bg-gray-50",children:[C.jsx("nav",{className:"bg-white shadow-sm",children:C.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:C.jsxs("div",{className:"flex justify-between h-16",children:[C.jsxs("div",{className:"flex",children:[C.jsx("div",{className:"flex-shrink-0 flex items-center",children:C.jsx("h1",{className:"text-2xl font-bold text-green-600",children:"FreshChain"})}),C.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[C.jsxs(DS,{to:"/retailer/dashboard",className:"border-green-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:[C.jsx(VEe,{className:"w-4 h-4 mr-1"}),"Dashboard"]}),C.jsxs(DS,{to:"/retailer/shop",className:"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:[C.jsx(u9,{className:"w-4 h-4 mr-1"}),"Shop"]}),C.jsxs(DS,{to:"/retailer/cart",className:"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:[C.jsx(oP,{className:"w-4 h-4 mr-1"}),"Cart"]}),C.jsxs(DS,{to:"/retailer/orders",className:"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:[C.jsx(jEe,{className:"w-4 h-4 mr-1"}),"Orders"]})]})]}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("div",{className:"flex-shrink-0",children:C.jsxs("button",{onClick:p,className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[C.jsx(GEe,{className:"w-4 h-4 mr-1"}),"Logout"]})}),C.jsx("div",{className:"ml-4 flex items-center",children:C.jsxs("span",{className:"text-gray-700 text-sm font-medium",children:["Welcome, ",t==null?void 0:t.name]})})]})]})})}),C.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[C.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-500 text-sm",children:"Total Deliveries"}),C.jsx("p",{className:"text-2xl font-semibold",children:d.length})]}),C.jsx(kb,{className:"w-8 h-8 text-green-500"})]})}),C.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-500 text-sm",children:"In Progress"}),C.jsx("p",{className:"text-2xl font-semibold",children:d.filter(g=>g.status==="in-progress").length})]}),C.jsx(iP,{className:"w-8 h-8 text-blue-500"})]})}),C.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-500 text-sm",children:"Completed Today"}),C.jsx("p",{className:"text-2xl font-semibold",children:d.filter(g=>g.status==="delivered").length})]}),C.jsx(o9,{className:"w-8 h-8 text-purple-500"})]})})]}),C.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[C.jsx("div",{className:"lg:col-span-1",children:C.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[C.jsxs("div",{className:"flex justify-between items-center mb-6",children:[C.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[C.jsx(rSe,{className:"w-6 h-6 mr-2 text-green-600"}),"Active Deliveries"]}),C.jsx("button",{onClick:()=>e("/retailer/orders"),className:"p-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors",children:C.jsx(vp,{className:"w-5 h-5"})})]}),C.jsx("div",{className:"space-y-4",children:d.map(g=>C.jsxs("div",{className:`p-4 rounded-lg cursor-pointer transition-all ${(o==null?void 0:o.id)===g.id?"bg-green-50 border-2 border-green-500":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>l(g),children:[C.jsxs("div",{className:"flex justify-between items-start mb-2",children:[C.jsxs("div",{children:[C.jsxs("p",{className:"font-medium text-gray-800",children:[g.origin,"  ",g.destination]}),C.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",g.id]})]}),C.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${g.status==="pending"?"bg-yellow-100 text-yellow-800":g.status==="in-progress"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.status})]}),g.agentName&&C.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[C.jsx(d9,{className:"w-4 h-4 mr-1"}),"Agent: ",g.agentName]}),g.estimatedTime&&C.jsxs("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[C.jsx(iP,{className:"w-4 h-4 mr-1"}),"ETA: ",g.estimatedTime]}),C.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[C.jsx("p",{className:"font-medium",children:"Items:"}),C.jsx("ul",{className:"list-disc list-inside",children:g.items.map((v,E)=>C.jsxs("li",{children:[v.name,": ",v.quantity," ",v.unit]},E))})]})]},g.id))})]})}),C.jsx("div",{className:"lg:col-span-2",children:o?C.jsx(h8e,{origin:o.origin,destination:o.destination}):C.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 flex items-center justify-center min-h-[400px]",children:C.jsxs("div",{className:"text-center text-gray-500",children:[C.jsx(Ls,{className:"w-12 h-12 mx-auto mb-4"}),C.jsx("p",{className:"text-lg",children:"Select a delivery to view route details"})]})})})]})]})]})},p8e=()=>{const{inventory:e,addInventoryItem:t,deleteInventoryItem:a,getInventoryStats:o}=wEe(),[l,d]=x.useState({name:"",quantity:0,price:0,supplier:"",category:""}),[p,g]=x.useState(!1),v=o(),E=T=>{T.preventDefault(),t({...l,lastUpdated:new Date}),d({name:"",quantity:0,price:0,supplier:"",category:""}),g(!1)};return C.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:C.jsxs("div",{className:"max-w-7xl mx-auto",children:[C.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Admin Dashboard"}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[C.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[C.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Total Items"}),C.jsx("p",{className:"text-2xl font-bold",children:v.totalItems})]}),C.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[C.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Total Value"}),C.jsxs("p",{className:"text-2xl font-bold",children:["",v.totalValue.toFixed(2)]})]}),C.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[C.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Low Stock Items"}),C.jsx("p",{className:"text-2xl font-bold",children:v.lowStockItems.length})]})]}),C.jsx("div",{className:"bg-white rounded-lg shadow mb-8",children:C.jsxs("div",{className:"p-6",children:[C.jsxs("div",{className:"flex justify-between items-center mb-6",children:[C.jsx("h2",{className:"text-2xl font-bold",children:"Inventory Management"}),C.jsx("button",{onClick:()=>g(!p),className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:p?"Cancel":"Add New Item"})]}),p&&C.jsxs("form",{onSubmit:E,className:"mb-6 grid grid-cols-2 gap-4",children:[C.jsx("input",{type:"text",placeholder:"Item Name",value:l.name,onChange:T=>d({...l,name:T.target.value}),className:"border p-2 rounded",required:!0}),C.jsx("input",{type:"number",placeholder:"Quantity",value:l.quantity,onChange:T=>d({...l,quantity:parseInt(T.target.value)}),className:"border p-2 rounded",required:!0}),C.jsx("input",{type:"number",placeholder:"Price",value:l.price,onChange:T=>d({...l,price:parseFloat(T.target.value)}),className:"border p-2 rounded",required:!0}),C.jsx("input",{type:"text",placeholder:"Supplier",value:l.supplier,onChange:T=>d({...l,supplier:T.target.value}),className:"border p-2 rounded",required:!0}),C.jsx("input",{type:"text",placeholder:"Category",value:l.category,onChange:T=>d({...l,category:T.target.value}),className:"border p-2 rounded",required:!0}),C.jsx("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"Add Item"})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"min-w-full",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"bg-gray-50",children:[C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),C.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),C.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(T=>C.jsxs("tr",{children:[C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.name}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.quantity}),C.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["",T.price]}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.supplier}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.category}),C.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.jsx("button",{onClick:()=>a(T.id),className:"text-red-600 hover:text-red-900",children:"Delete"})})]},T.id))})]})})]})}),C.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[C.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Supply Route Calculator"}),C.jsx(qD,{source:"Warehouse",destinations:[{place:"Store 1",demand:1e3},{place:"Store 2",demand:800},{place:"Store 3",demand:1200},{place:"Store 4",demand:500}],totalSupply:3500,onDataUpdate:T=>console.log("Optimized routes:",T)})]})]})})},m8e=()=>{const e=yp(),{getAllProducts:t}=n9(),{addToCart:a,getItemCount:o}=e9(),[l,d]=x.useState(""),[p,g]=x.useState("all"),[v,E]=x.useState({}),T=t(),b=o(),R=T.filter(D=>{const U=D.name.toLowerCase().includes(l.toLowerCase())||D.description.toLowerCase().includes(l.toLowerCase())||D.farmerName.toLowerCase().includes(l.toLowerCase());return p==="all"?U:U&&D.category===p}),N=["all","Vegetables","Fruits","Grains","Dairy","Other"],P=(D,U)=>{E(B=>{const z=B[D]||0,V=Math.max(0,z+U);return{...B,[D]:V}})},L=D=>{const U=v[D.id]||0;U>0&&(a(D,U),E(B=>({...B,[D.id]:0})))},M=()=>{e("/retailer/cart")};return C.jsxs("div",{className:"container mx-auto p-4",children:[C.jsx("div",{className:"mb-8",children:C.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[C.jsxs("div",{className:"flex-1 relative",children:[C.jsx(l9,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),C.jsx("input",{type:"text",placeholder:"Search products, farmers...",value:l,onChange:D=>d(D.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),C.jsxs("div",{className:"flex gap-4 items-center",children:[C.jsx("select",{value:p,onChange:D=>g(D.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:N.map(D=>C.jsx("option",{value:D,children:D.charAt(0).toUpperCase()+D.slice(1)},D))}),C.jsxs("button",{onClick:M,className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[C.jsx(oP,{className:"w-5 h-5 mr-2"}),"Cart",b>0&&C.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:b})]})]})]})}),C.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:R.map(D=>C.jsxs("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[C.jsx("div",{className:"h-48 bg-gray-200 rounded-t-lg overflow-hidden",children:D.image?C.jsx("img",{src:D.image,alt:D.name,className:"w-full h-full object-cover"}):C.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"No Image"})}),C.jsxs("div",{className:"p-4",children:[C.jsxs("div",{className:"flex justify-between items-start mb-2",children:[C.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:D.name}),C.jsxs("div",{className:"flex items-center text-yellow-400",children:[C.jsx(ZEe,{size:16,fill:"currentColor"}),C.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"4.5"})]})]}),C.jsx("p",{className:"text-sm text-gray-600 mb-2",children:D.description}),C.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[C.jsx(Ls,{size:16,className:"mr-1"}),C.jsx("span",{children:D.farmerName})]}),C.jsxs("div",{className:"text-sm text-gray-500 mb-3",children:["Category: ",D.category]}),C.jsxs("div",{className:"flex justify-between items-center mb-3",children:[C.jsxs("div",{className:"text-green-600 font-semibold",children:["",D.price.toFixed(2),"/",D.unit]}),C.jsxs("div",{className:"text-sm text-gray-500",children:["Available: ",D.quantity.toFixed(3)," ",D.unit]})]}),C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{onClick:()=>P(D.id,-1),className:"p-1 rounded-full hover:bg-gray-100",disabled:!v[D.id],children:C.jsx(c9,{size:16,className:v[D.id]?"text-gray-600":"text-gray-300"})}),C.jsx("span",{className:"w-8 text-center",children:v[D.id]||0}),C.jsx("button",{onClick:()=>P(D.id,1),className:"p-1 rounded-full hover:bg-gray-100",disabled:v[D.id]>=D.quantity,children:C.jsx(vp,{size:16,className:v[D.id]>=D.quantity?"text-gray-300":"text-gray-600"})})]}),C.jsxs("button",{onClick:()=>L(D),disabled:!v[D.id],className:`px-4 py-2 rounded-lg flex items-center gap-2 ${v[D.id]?"bg-green-600 text-white hover:bg-green-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[C.jsx(oP,{size:16}),"Add"]})]})]})]},D.id))}),R.length===0&&C.jsxs("div",{className:"text-center py-12",children:[C.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No products found"}),C.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filters"})]})]})},g8e=({origin:e,destination:t})=>{const[a,o]=x.useState(!0),[l,d]=x.useState(""),[p,g]=x.useState(""),[v,E]=x.useState("");return x.useEffect(()=>{e&&t&&(async()=>{try{o(!0);const b=await fetch(`https://maps.gomaps.pro/maps/api/directions/json?origin=${encodeURIComponent(e)}&destination=${encodeURIComponent(t)}&key=AlzaSyplubBLrYqUCH-O7Xk_sKMz1sAZTVzizke`);if(!b.ok)throw new Error("Failed to fetch directions");const R=await b.json();if(R.routes&&R.routes[0]&&R.routes[0].legs&&R.routes[0].legs[0]){const N=R.routes[0].legs[0];d(N.distance.text),g(N.duration.text)}}catch(b){console.error("Error fetching directions:",b),E("Unable to calculate route. Please try again.")}finally{o(!1)}})()},[e,t]),a?C.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-100 rounded-lg",children:C.jsx(s9,{className:"w-8 h-8 animate-spin text-green-600"})}):v?C.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-100 rounded-lg",children:C.jsx("p",{className:"text-red-500",children:v})}):C.jsxs("div",{className:"space-y-4",children:[C.jsx("div",{className:"bg-gray-100 rounded-lg p-6",children:C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{className:"flex items-center space-x-2",children:[C.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),C.jsx("p",{className:"text-gray-700",children:e})]}),C.jsx("div",{className:"border-l-2 border-dashed border-gray-300 h-8 ml-1.5"}),C.jsxs("div",{className:"flex items-center space-x-2",children:[C.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),C.jsx("p",{className:"text-gray-700",children:t})]})]})}),l&&p&&C.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:C.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[C.jsxs("div",{className:"text-center",children:[C.jsx("p",{className:"text-sm text-gray-500",children:"Estimated Distance"}),C.jsx("p",{className:"text-lg font-semibold text-gray-900",children:l})]}),C.jsxs("div",{className:"text-center border-l border-gray-200",children:[C.jsx("p",{className:"text-sm text-gray-500",children:"Estimated Time"}),C.jsx("p",{className:"text-lg font-semibold text-gray-900",children:p})]})]})})]})},y8e=()=>{const e=yp(),{items:t,updateQuantity:a,removeFromCart:o,getTotal:l}=e9(),[d,p]=x.useState(""),[g,v]=x.useState(""),E=(b,R,N)=>{const P=R+N;P<=0?o(b):a(b,P)},T=()=>{if(!d||!g){alert("Please enter both pickup and delivery addresses");return}e("/retailer/checkout")};return C.jsx("div",{className:"container mx-auto px-4 py-8",children:C.jsxs("div",{className:"max-w-4xl mx-auto",children:[C.jsxs("div",{className:"flex items-center justify-between mb-8",children:[C.jsxs("button",{onClick:()=>e("/retailer/shop"),className:"flex items-center text-gray-600 hover:text-gray-800",children:[C.jsx(PEe,{className:"w-5 h-5 mr-2"}),"Continue Shopping"]}),C.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"})]}),t.length>0?C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-8",children:t.map(b=>C.jsxs("div",{className:"flex items-center p-6 border-b last:border-b-0",children:[C.jsxs("div",{className:"flex-1",children:[C.jsx("h3",{className:"text-lg font-medium text-gray-900",children:b.name}),C.jsxs("p",{className:"text-sm text-gray-500",children:["Farmer: ",b.farmerName]})]}),C.jsxs("div",{className:"flex items-center gap-6",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{onClick:()=>E(b.id,b.quantity,-1),className:"p-1 rounded-full hover:bg-gray-100",children:C.jsx(c9,{className:"w-4 h-4 text-gray-600"})}),C.jsx("span",{className:"w-12 text-center",children:b.quantity}),C.jsx("button",{onClick:()=>E(b.id,b.quantity,1),className:"p-1 rounded-full hover:bg-gray-100",children:C.jsx(vp,{className:"w-4 h-4 text-gray-600"})})]}),C.jsxs("div",{className:"w-24 text-right",children:[C.jsxs("div",{className:"text-lg font-medium text-gray-900",children:["",(b.price*b.quantity).toFixed(2)]}),C.jsxs("div",{className:"text-sm text-gray-500",children:["",b.price.toFixed(2),"/",b.unit]})]}),C.jsx("button",{onClick:()=>o(b.id),className:"p-2 text-gray-400 hover:text-red-500",children:C.jsx(D1,{className:"w-5 h-5"})})]})]},b.id))}),C.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[C.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Delivery Details"}),C.jsxs("div",{className:"mb-6",children:[C.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Address"}),C.jsx("div",{className:"flex gap-2",children:C.jsxs("div",{className:"relative flex-1",children:[C.jsx(Ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),C.jsx("input",{type:"text",id:"origin",value:d,onChange:b=>p(b.target.value),placeholder:"Enter pickup address",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})})]}),C.jsxs("div",{className:"mb-6",children:[C.jsx("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Address"}),C.jsx("div",{className:"flex gap-2",children:C.jsxs("div",{className:"relative flex-1",children:[C.jsx(Ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),C.jsx("input",{type:"text",id:"destination",value:g,onChange:b=>v(b.target.value),placeholder:"Enter delivery address",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})})]}),d&&g&&C.jsx(g8e,{origin:d,destination:g})]}),C.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[C.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Summary"}),C.jsxs("div",{className:"flex justify-between mb-2",children:[C.jsx("span",{className:"text-gray-600",children:"Subtotal"}),C.jsxs("span",{className:"text-gray-900",children:["",l().toFixed(2)]})]}),C.jsxs("div",{className:"flex justify-between mb-2",children:[C.jsx("span",{className:"text-gray-600",children:"Shipping"}),C.jsx("span",{className:"text-gray-900",children:"0.00"})]}),C.jsxs("div",{className:"border-t pt-4 mt-4",children:[C.jsxs("div",{className:"flex justify-between mb-4",children:[C.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Total"}),C.jsxs("span",{className:"text-lg font-medium text-gray-900",children:["",l().toFixed(2)]})]}),C.jsx("button",{onClick:T,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"Proceed to Checkout"})]})]})]}):C.jsxs("div",{className:"text-center py-12",children:[C.jsx("h2",{className:"text-2xl font-medium text-gray-900 mb-4",children:"Your cart is empty"}),C.jsx("p",{className:"text-gray-500 mb-8",children:"Add some items to your cart to proceed"}),C.jsx("button",{onClick:()=>e("/retailer/shop"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Start Shopping"})]})]})})},Nq=[{id:"1",date:"2024-02-01",status:"delivered",total:156.78,items:[{name:"Fresh Tomatoes",quantity:5,price:2.99},{name:"Organic Apples",quantity:3,price:3.99}]},{id:"2",date:"2024-01-30",status:"processing",total:89.97,items:[{name:"Carrots",quantity:2,price:1.99},{name:"Potatoes",quantity:4,price:2.49}]}],v8e={processing:"text-blue-600",delivered:"text-green-600",cancelled:"text-red-600"},_8e={processing:C.jsx(iP,{className:"w-5 h-5"}),delivered:C.jsx(LEe,{className:"w-5 h-5"}),cancelled:C.jsx(aSe,{className:"w-5 h-5"})},E8e=()=>{const[e,t]=x.useState("all"),a=e==="all"?Nq:Nq.filter(o=>o.status===e);return C.jsxs("div",{className:"space-y-6",children:[C.jsx("div",{className:"flex gap-4",children:["all","processing","delivered","cancelled"].map(o=>C.jsx("button",{onClick:()=>t(o),className:`px-4 py-2 rounded-lg border-2 transition-colors
              ${e===o?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-200"}`,children:o.charAt(0).toUpperCase()+o.slice(1)},o))}),C.jsx("div",{className:"space-y-4",children:a.map(o=>C.jsx(Wl,{children:C.jsxs(Df,{className:"p-6",children:[C.jsxs("div",{className:"flex justify-between items-start mb-4",children:[C.jsxs("div",{children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(kb,{className:"w-5 h-5 text-gray-500"}),C.jsxs("span",{className:"font-semibold",children:["Order #",o.id]})]}),C.jsxs("p",{className:"text-gray-500 text-sm",children:["Placed on ",new Date(o.date).toLocaleDateString()]})]}),C.jsxs("div",{className:`flex items-center gap-2 ${v8e[o.status]}`,children:[_8e[o.status],C.jsx("span",{className:"font-medium",children:o.status.charAt(0).toUpperCase()+o.status.slice(1)})]})]}),C.jsx("div",{className:"border-t border-b py-4 mb-4",children:C.jsxs("table",{className:"w-full",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"text-left text-gray-500",children:[C.jsx("th",{className:"pb-2",children:"Item"}),C.jsx("th",{className:"pb-2",children:"Quantity"}),C.jsx("th",{className:"pb-2 text-right",children:"Price"}),C.jsx("th",{className:"pb-2 text-right",children:"Total"})]})}),C.jsx("tbody",{children:o.items.map((l,d)=>C.jsxs("tr",{children:[C.jsx("td",{className:"py-2",children:l.name}),C.jsx("td",{className:"py-2",children:l.quantity}),C.jsxs("td",{className:"py-2 text-right",children:["$",l.price.toFixed(2)]}),C.jsxs("td",{className:"py-2 text-right",children:["$",(l.quantity*l.price).toFixed(2)]})]},d))})]})}),C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsx("div",{className:"text-gray-500",children:"Total Amount"}),C.jsxs("div",{className:"text-xl font-bold text-green-600",children:["$",o.total.toFixed(2)]})]})]})},o.id))}),a.length===0&&C.jsxs("div",{className:"text-center py-12",children:[C.jsx(kb,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),C.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No orders found"}),C.jsx("p",{className:"text-gray-500",children:e==="all"?"You haven't placed any orders yet":`No ${e} orders found`})]})]})},S8e=()=>{const{user:e}=dv(),[t,a]=x.useState(!1),[o,l]=x.useState(""),[d,p]=x.useState({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",phone:"123-456-7890",address:"123 Main St, City, Country",businessName:"My Retail Store",businessType:"Grocery Store"}),g=async E=>{E.preventDefault();try{await new Promise(T=>setTimeout(T,1e3)),l("Profile updated successfully"),a(!1)}catch{l("Failed to update profile")}},v=E=>{const{name:T,value:b}=E.target;p(R=>({...R,[T]:b}))};return C.jsx("div",{className:"max-w-2xl mx-auto",children:C.jsxs(Wl,{children:[C.jsx(Jg,{children:C.jsx(Qg,{className:"text-2xl",children:"Profile Settings"})}),C.jsx(Df,{children:C.jsxs("form",{onSubmit:g,className:"space-y-6",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium mb-4",children:"Personal Information"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),C.jsxs("div",{className:"relative",children:[C.jsx(d9,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"text",name:"name",value:d.name,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),C.jsxs("div",{className:"relative",children:[C.jsx($Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"email",name:"email",value:d.email,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),C.jsxs("div",{className:"relative",children:[C.jsx(XEe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"tel",name:"phone",value:d.phone,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]})]})]}),C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium mb-4",children:"Business Information"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Name"}),C.jsxs("div",{className:"relative",children:[C.jsx(f$,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"text",name:"businessName",value:d.businessName,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Type"}),C.jsxs("div",{className:"relative",children:[C.jsx(f$,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"text",name:"businessType",value:d.businessType,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Address"}),C.jsxs("div",{className:"relative",children:[C.jsx(Ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),C.jsx("input",{type:"text",name:"address",value:d.address,onChange:v,disabled:!t,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]})]})]}),o&&C.jsx(V1,{variant:o.includes("success")?"default":"destructive",children:C.jsx(B1,{children:o})}),C.jsx("div",{className:"flex justify-end gap-4",children:t?C.jsxs(C.Fragment,{children:[C.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),C.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[C.jsx(JEe,{className:"w-5 h-5"}),"Save Changes"]})]}):C.jsx("button",{type:"button",onClick:()=>a(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Edit Profile"})})]})})]})})},b8e=()=>C.jsx(mEe,{children:C.jsx(EEe,{children:C.jsx(CEe,{children:C.jsx(TEe,{children:C.jsx(SEe,{children:C.jsx(a9,{children:C.jsx("div",{className:"min-h-screen bg-gray-50 font-sans",children:C.jsxs(TI,{children:[C.jsx(li,{path:"/login",element:C.jsx(OEe,{})}),C.jsx(li,{path:"/",element:C.jsx(Sf,{to:"/login",replace:!0})}),C.jsx(li,{path:"/admin/*",element:C.jsx(CI,{allowedUserTypes:["admin"],children:C.jsx(p8e,{})})}),C.jsx(li,{path:"/farmer/*",element:C.jsx(CI,{allowedUserTypes:["farmer"],children:C.jsxs(TI,{children:[C.jsx(li,{path:"/",element:C.jsx(Sf,{to:"dashboard",replace:!0})}),C.jsx(li,{path:"dashboard",element:C.jsx(u8e,{})}),C.jsx(li,{path:"video-call",element:C.jsx(v9,{})}),C.jsx(li,{path:"nearby-places",element:C.jsx(G9,{})}),C.jsx(li,{path:"supply-routes",element:C.jsx(qD,{source:"Mandya",destinations:[{place:"Bangalore",demand:2e3},{place:"Mysuru",demand:1500},{place:"Hassan",demand:800},{place:"Chikkamagaluru",demand:700}],totalSupply:5e3,onDataUpdate:e=>console.log("Optimized routes:",e)})})]})})}),C.jsx(li,{path:"/retailer/*",element:C.jsx(CI,{allowedUserTypes:["retailer"],children:C.jsxs(TI,{children:[C.jsx(li,{path:"/",element:C.jsx(Sf,{to:"dashboard",replace:!0})}),C.jsx(li,{path:"dashboard",element:C.jsx(f8e,{})}),C.jsx(li,{path:"shop",element:C.jsx(m8e,{})}),C.jsx(li,{path:"cart",element:C.jsx(y8e,{})}),C.jsx(li,{path:"orders",element:C.jsx(E8e,{})}),C.jsx(li,{path:"profile",element:C.jsx(S8e,{})})]})})}),C.jsx(li,{path:"*",element:C.jsx(Sf,{to:"/login",replace:!0})})]})})})})})})})});cN.createRoot(document.getElementById("root")).render(C.jsx(ye.StrictMode,{children:C.jsx(b8e,{})}));
